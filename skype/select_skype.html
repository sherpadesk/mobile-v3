<html lang="en" manifest="manifest.appcache">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<link rel="stylesheet" type="text/css" href="style.css">
<link rel="shortcut icon" href="https://s4w.cdn.skype.com/0-238-0/images/favicon.ico" id="favicon">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Select Skype Users v1.1</title>
</head>

<body>
	<!-- Learn about this code on MDN: https://developer.mozilla.org/en-US/docs/Learn/HTML/Forms/Sending_forms_through_JavaScript -->
  <header>
    <div class="container">
    <img src="https://support.sherpadesk.com/images/icons/Metro/mountain.png" alt="label-mountain">
    <div class="line"></div>
    <h3>SherpaDesk Skype App v1.1</h3>
    </div>
  </header>
<main>
  <div id="navigation">
    <div class="container">
    <br/>
      <div id="fountainG">
            <br/>
            <br/>
         <div id="fountainG_1" class="fountainG"></div>
         <div id="fountainG_2" class="fountainG"></div>
         <div id="fountainG_3" class="fountainG"></div>
         <div id="fountainG_4" class="fountainG"></div>
         <div id="fountainG_5" class="fountainG"></div>
         <div id="fountainG_6" class="fountainG"></div>
         <div id="fountainG_7" class="fountainG"></div>
         <div id="fountainG_8" class="fountainG"></div>
      </div>
    </div>
  </div>
  <div class="navBar">
    <div class="container search-box">
      <div class="lupa">  
        <svg class="search-icon" viewBox="0 0 24 24">
          <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path>
        <path d="M0 0h24v24H0z" fill="none"></path>
        </svg>
      </div>
        <input id="myName" name="searchstring" onkeydown="if (event.keyCode == 13 &amp;&amp; this.value) search('', -1)" value="" placeholder="Search by mobile, email or name (Skype)" class="Search"> 
    </div>
                  <a href="javascript:search('', -1);" style="color: #000; font-size: 22px;font-weight: 900;font-family:exo2light !important;">Search</a>
    <div class="right">
      <a href="javascript:void(0);" onclick="startChat(1);" id="StartChat">Skype Client</a>
      <!--button onclick="reset();" class="Buttons">Remove All</button-->
 
      <a href="javascript:void(0);" onclick="startChat();" id="StartChat">Web Chat</a>
      <!--button onclick="reset();" class="Buttons">Remove All</button-->
    </div>
  </div>

<!-- Modals-->
<div id="win" style="display:none;">
   <div class="overlay"  onClick="getElementById('win').style.display='none';"></div>
      <div id="visible">
      	<div style="background: #003a70;background-size: cover !important; height: 50px;"><p style="font-family: Helvetica,Arial,sans-serif; font-size:25px;    -webkit-margin-before: 0; padding: 14px 23px; color:#fff;">Error message</p></div>
        <p id="content"></p>
        
        <button type="button" onClick="getElementById('win').style.display='none';">Close</button>
    </div>
</div>

<div id="win1" style="display:none;">
   <div class="overlay"></div>
      <div id="visible">
      	<div style="background: #003a70;background-size: cover !important; height: 50px;"><p style="font-family: Helvetica,Arial,sans-serif; font-size:25px;    -webkit-margin-before: 0; padding: 14px 23px; color:#fff;">Info message</p></div>
        <p id="modal-content">Do you want the Web (YES) or Desktop (NO) version?</p>
        <div style="float: right">
	        <button type="button" onClick="getElementById('win1').style.display='none';">YES</button>
	        <button type="button" onClick="getElementById('win1').style.display='none';">NO</button>
        </div>
    </div>
</div>


<!-- Table-->
<table id="notfound" style="display:none; width: 100%; padding-bottom:12px;">
  <tbody ><tr class="headerTable"><th></th>
    <th style="width:55px"></th><th style="width: 30%">Save Skype</th><th style="width: 15%">Email</th><th style="width: 15%">Name</th><th style="width: 15%">Mobile tel</th><th style="width: 10%">Invitation</th></tr>
  </tbody></table>
  
  <table id="apps"><tbody><tr class="headerTable"><th>Invite</th><th></th><th>Skype ID</th><th>Name</th><th>Info</th><th></th></tr></tbody></table>

</main>



<script>

  var API = "https://api.sherpadesk.com";
  var searchData = [];
  var skypeData = [];
  var data=[];
  var skype_names = ",";
  var no_skype_names = "";
  //var notfound_users = "";

  function startChat(isSkype){
    web = !(isSkype || 0);
    if (web)
    {
      var checkboxes = document.querySelectorAll('table tr td input[type="checkbox"]:checked');
      if (!checkboxes.length)
      {
        alert("No users selected! Cannot start chat!")
        return;
      }
      console.log(checkboxes.length + " users selected!");
      fillData(checkboxes);
    }
    else
      fillUserData();
    location.href =  "loading.html".addp("ticket", ticket)
    .addp("subject", subject)
    .addp("note", note)
    .addp("key", key)
    .addp("token", token)
    .addp("test", testq)
    .addp("data", JSON.stringify(data))
    .addp("skype",skype_names)
    .addp("emails",no_skype_names)
    .addp("w",web);
    return false;
  }

  function fillData(checkboxes) {
    skype_names = ",";
    no_skype_names = "";
    data = [];
    for (var i = 0; i < checkboxes.length; i++) {
      var user = {};
      var cname = checkboxes[i].name;
      var cid = checkboxes[i].id || "";
      var cvalue = checkboxes[i].value || "";
      if (!isNaN(cname))
      {
        var el = document.getElementById("nfi" + cname);
        var nf_skype = el.value.trim();
        if (nf_skype)
        {
          cid = cname;
          saveSkype(cname, nf_skype);
        }
        else 
          no_skype_names += el.name + ",";
        cname = nf_skype;
      }
      if (cname && skype_names.indexOf(","+cname+",")<0)
      {
        skype_names += cname + ",";
        //console.log(cid, cname,cvalue);
        if (cid && cname && cvalue)
          data.push({"id": cid, "skype": cname, "name": cvalue})
      }
    }
    //console.log(skype_names);
    //console.log(data);
    skype_names = skype_names.length == 1 ? "" : skype_names.substring(1,skype_names.length-1);
    no_skype_names = no_skype_names.substring(0,no_skype_names.length-1);
  }

  function fillUserData() {
    skype_names = ",";
    no_skype_names = "";
    data = [];
    for (var i = 0; i < searchData.length; i++) {
    if (!searchData[i].user) continue;
    if (searchData[i].skype.trim())
    {
      data.push({"id": searchData[i].id, "skype": searchData[i].skype,"name":searchData[i].name});
      skype_names += searchData[i].skype.trim() + ",";
    }
    else
    {
      no_skype_names += searchData[i].skype || searchData[i].tel ||  searchData[i].email || searchData[i].name + ",";
    }
    }
    //console.log(skype_names);
    //console.log(data);
    skype_names = skype_names.length == 1 ? "" : skype_names.substring(1,skype_names.length-1);
    no_skype_names = no_skype_names.substring(0,no_skype_names.length-1);
  }

  String.prototype.addp = function(param, value) {
    if (!value || !param)
      return this;
    var pos = this.indexOf(param + '=');
        //if parameter exists
        if (pos != -1)
          return this.slice(0, pos + param.length) + '=' + value;
        var ch = this.indexOf('?') > 0 ? '&' : '?';
        return this + ch + param + '=' + value;
      };

      function checkall(e)
      {
        var checkboxes = document.querySelectorAll('table#apps tr td input[type="checkbox"]');
        for (var i = 0; i < checkboxes.length; i++)
          checkboxes[i].checked = e.checked;
        return false;
      }

      function remove(el)
      {
        el.parentNode.parentNode.parentNode.remove();
        return false;
      }

      function removeall(){
        var checkboxes = document.querySelectorAll('table#apps tr td input.checkbox-custom:checked');
        for (var i = 0; i < checkboxes.length; i++) {
         remove(checkboxes[i]);
       }
       return false;
     }

     function deleteUnchecked(){
        var checkboxes = document.querySelectorAll('table#apps tr td input.checkbox-custom:not(:checked)');
        for (var i = 0; i < checkboxes.length; i++) {
         remove(checkboxes[i]);
       }
       return false;
     }

     function saveSkype(userId, skype_name) {

      var XHR = new XMLHttpRequest();

    // Define what happens on successful data submission
    XHR.addEventListener("load", function(event) {
      console.log("save skype to profile: " + skype_name);
      window.opener.postMessage("reload", "*");
    });

    // Define what happens in case of error
    XHR.addEventListener("error", function(event) {
      console.log('Oups! saveSkype goes wrong.');
    });

    XHR.open('PUT', API+"/profile/"+userId, false);
    XHR.setRequestHeader("Authorization", "Basic " + token);

    var formData = new FormData();
    formData.append("skype", skype_name);

    // execute results
    XHR.send(formData);
  }

  function reset()
  {
    table.innerHTML = "<tr class='headerTable'><th style='width:5%'>Invite</th>"
    + "<th style='width:55px'></th>"
    + "<th style='width: 30%; min-width: 185px;'>Skype ID</th><th style='width: 15%'>Name</th><th style='width: 15%'>CountryCode</th><th style='width: 15%'>Info</th><th style='width: 10%'></th></tr>";
  }

  function getParameterByName(name) {
    var match = RegExp('[?&]' + name + '=([^&]*)').exec(window.location.href);
    return match && decodeURIComponent(match[1].replace(/\+/g, ' '));
  }

  var ticket,subject,note,web,key,emails,testq,token, table;

  window.addEventListener("load", function () {

    table = document.getElementById("apps");
    //nf_table = document.getElementById("notfound");

    ticket = getParameterByName("ticket") || "";
    subject = encodeURIComponent(getParameterByName("subject") || "");
    note = getParameterByName("note") || " ";
    key = getParameterByName("key") || "";
    web = Number(getParameterByName("w") || "1");
    testq = getParameterByName("test") || "";
    emails = getParameterByName("emails") || "";
    token = getParameterByName("t");

    var link = "";


    //if (~note.indexOf("https://join.skype.com") && !web)
    //    link = note;

    if (testq)
    {
      alert("test ok " + emails);
      return;
    }

    //if (link)
    //{
    //  console.log("existing " + link);
    //  location.href = link;
    //  return;
    //}

    reset();

    var test = '';
    emails = getParameterByName("emails");

    emails = emails || test.substring(test.indexOf("emails=")+7);

    if (!emails)
      return;

    searchData = JSON.parse(emails);
  //console.log(searchData);

  if (!searchData){
    alert('Oups! Incorrect query string parameters');
    return;
  }

  //if (!web)
  // {
  //      startChat();
  //      return;
  // }

  var search_string = "";
  var contact = "";
  for (var i = 0; i < searchData.length; i++) {
    if (searchData[i].skype.trim())
    {
      AddSkypeRow({"id": searchData[i].id, "skypeId": searchData[i].skype,"name":searchData[i].name,"avatarUrl":"https://api.skype.com/users/"+searchData[i].skype+"/profile/avatar","contactType":"Skype", "lang": "", "info": ""}, "checked", false);
    }
    else
    {
      contact = searchData[i].skype || searchData[i].tel ||  searchData[i].email || searchData[i].name;
      search(contact, i);
    }
  }
});

  function search(name, i)
  {
    i = i || 0;
  //notfound_users = "";
  if (name)
  {
   document.getElementById("myName").value = name;
 }
 else
  deleteUnchecked();

 name = name || document.getElementById("myName").value;
 if (!name){
  alert('Oups! No search parameters found');
  return;
}

showLoading(true);
sendData(name, i);
}

function showLoading(show)
{
  document.getElementById("fountainG").style.display = show ? "block" : "none";
  var chat= document.getElementById("StartChat");
  chat.disabled = show ? "disabled" : "";
  chat.style.pointerEvents = show ? "none" : "";
  chat.style.background= show ? "grey" : "";
}

function sendData(name, index) {
  var XHR = new XMLHttpRequest();

    // Define what happens on successful data submission
    XHR.addEventListener("load", function(event) {
      showLoading(false);
      showResult(event.target.responseText, name.trim(), index);
      var all_index = document.getElementById("myName").value.split(",").length - 1;
      document.getElementById("myName").value = "";
      if (index == all_index && event.target.responseText)
      {
        setTimeout(showChatLogic, 1000);
      }
    });

    // Define what happens in case of error
    XHR.addEventListener("error", function(event) {
      showLoading(false);
      //AddNoSkypeRow(searchData[index]);
      alert('Oups! Something goes wrong.');
      document.getElementById("myName").value = "";
    });

    // Set up our request
    XHR.open("GET", API+"/skype_search?name="+name);
    // The data sent is what the user provided in the form
    XHR.send();
  }

  function showChatLogic()
  {
    /*var nfu_length = notfound_users.length;
    if (nfu_length > 1)
    {
      notfound_users = notfound_users.substring(0, nfu_length -1);
    }
    */
    document.getElementById("myName").value = "";
    searchData = [];
  }

  function alert(text)
  {
      document.getElementById('win').removeAttribute('style');
      document.getElementById('content').innerHTML='<p id="modal-content">'+text+'</p>';
  }

  function showResult(test, name, index) {

    index = index || 0;

    if (!test){
      alert("Oups. Skype server is busy. Please try again in a moment. <br>OR add skype name manually please");
      if (searchData[index]){
    //nf_table.style.display = "table";
    AddNoSkypeRow(searchData[index]);
    }
    else
    {
    	AddNoSkypeRow({"id": "", "skypeId": "","email":name,"avatarUrl":"","contactType":"Skype", "lang": "", "info": ""});
    }
      return;
    }

    var dataObj = JSON.parse(test);

    var dictionaryData = dataObj["results"];
  //console.log(dictionaryData);

  var only_1_result = dictionaryData.length == 1;

  if (!dictionaryData.length || !only_1_result){
    if (searchData[index]){
    //nf_table.style.display = "table";
    AddNoSkypeRow(searchData[index]);
    }
    //notfound_users += name + ",";
    //if (!dictionaryData.length)
    //alert('Oups! Cannot search '+ name + "! Please try to search by user mobile or email");
  }

  var checked_flag = only_1_result ? "checked" : "";

  for (var i in dictionaryData) {  
    //if (autostart)
      //dictionaryData[i]["nodeProfileData"].id = searchData[index].id;
    AddSkypeRow(dictionaryData[i]["nodeProfileData"], checked_flag, only_1_result);
  }

  if (only_1_result && !searchData[index].skype)
    saveSkype(searchData[index].id, dictionaryData[0]["nodeProfileData"]["skypeId"]);

}

function AddNoSkypeRow(data)
{
  
  var checked_flag = "";//"checked";
  var tr = table.insertRow(2);
  var td = document.createElement("td");
    //delete link
    //td.innerHTML = "<center><a href='javascript:void(0);' onclick='remove(this)'><div class=\"box box3  \"><svg viewbox=\"0 0 40 40\"><path class=\"close-x\" d=\"M 12,12 L 28,28 M 28,12 L 12,28\" /></svg></div></a></center>";
    //tr.appendChild(td);
    //td = document.createElement("td");
    //checkbox link
    td.innerHTML = '<div><input type="checkbox" value="'+ (data.name || "")+'" class="radio-custom"  name="'+data.id+'" '+checked_flag+'><label for="checkbox-1" class="radio-custom-label"></label></div>';
    tr.appendChild(td);
    td = document.createElement("td");
    //avatar url
    td.innerHTML = '<img src="https://www.gravatar.com/avatar/' + MD5(data.email) + '?s=96" width="45" height="45" class="img">';
    tr.appendChild(td);
    td = document.createElement("td");
    //avatar url
    td.innerHTML = '<input id="nfi'+data.id+'" name='+data.email+' value="'+ (data.skype || "")+'" style="font-size: 16;font-weight: 600;" placeholder="Add skype name" class="AddSkypeName"></input>';
    tr.appendChild(td);
    var txt = document.createTextNode(data.email || "");
    td = document.createElement("td");
    td.appendChild(txt);
    tr.appendChild(td);
    txt = document.createTextNode(data.name || "");
    td = document.createElement("td");
    td.appendChild(txt);
    tr.appendChild(td);    
    txt = document.createTextNode(data.tel || "");
    td = document.createElement("td");
    td.appendChild(txt);
    tr.appendChild(td);
    txt = document.createTextNode("By Email or SMS");
    td = document.createElement("td");
    td.appendChild(txt);
    tr.appendChild(td);    
    //nf_table.appendChild(tr);
    //<th>Avatar</th><th>Enter Skype</th><th>Email</th><th>Name</th><th>Mobile tel</th><th>Invitation</th></tr>
    //skypeData.push({name : data["name"], skype: data["skypeId"]});
  }

  function AddSkypeRow(nodeProfileData, checked_flag, only_1_result)
  {
    var tr = only_1_result ? table.insertRow(1) : document.createElement("tr");
    var td = document.createElement("td");
    //delete link
   //td.innerHTML = "<center><a href='javascript:void(0);' onclick='remove(this)'><div class=\"box box3\"><svg viewbox=\"0 0 40 40\"><path class=\"close-x\" d=\"M 12,12 L 28,28 M 28,12 L 12,28\" /></svg></div></a></center>";
    //tr.appendChild(td);
    //td = document.createElement("td");
    //checkbox link
    td.innerHTML = '<div><input type="checkbox" class="checkbox-custom" value="'+(nodeProfileData["name"] || "")+'" id="'+(nodeProfileData["id"] || "")+'" name="'+nodeProfileData["skypeId"]+'" '+checked_flag+'><label for="checkbox-1" class="checkbox-custom-label"></label></div>';
    tr.appendChild(td);
    td = document.createElement("td");
    //avatar url
    td.innerHTML = '<img src="'+ (nodeProfileData["avatarUrl"] || 'https://api.skype.com/users/default/profile/avatar') +'" width="45" height="45" class="img">';
    tr.appendChild(td);
    var i=0;
    for (var key in nodeProfileData) {
      if (key == "avatarUrl")
        continue;
      if (key == "id")
        continue;
      if(i>4) break;
      var txt = document.createTextNode(nodeProfileData[key].substring(0, 50));
      td = document.createElement("td");
      td.appendChild(txt);
      tr.appendChild(td);
      i++;
    }
    if (!only_1_result)
     table.appendChild(tr);
   skypeData.push({name : nodeProfileData["name"], skype: nodeProfileData["skypeId"]});
 }

!function(n){"use strict";function t(n,t){var r=(65535&n)+(65535&t),e=(n>>16)+(t>>16)+(r>>16);return e<<16|65535&r}function r(n,t){return n<<t|n>>>32-t}function e(n,e,o,u,c,f){return t(r(t(t(e,n),t(u,f)),c),o)}function o(n,t,r,o,u,c,f){return e(t&r|~t&o,n,t,u,c,f)}function u(n,t,r,o,u,c,f){return e(t&o|r&~o,n,t,u,c,f)}function c(n,t,r,o,u,c,f){return e(t^r^o,n,t,u,c,f)}function f(n,t,r,o,u,c,f){return e(r^(t|~o),n,t,u,c,f)}function i(n,r){n[r>>5]|=128<<r%32,n[(r+64>>>9<<4)+14]=r;var e,i,a,h,d,l=1732584193,g=-271733879,v=-1732584194,m=271733878;for(e=0;e<n.length;e+=16)i=l,a=g,h=v,d=m,l=o(l,g,v,m,n[e],7,-680876936),m=o(m,l,g,v,n[e+1],12,-389564586),v=o(v,m,l,g,n[e+2],17,606105819),g=o(g,v,m,l,n[e+3],22,-1044525330),l=o(l,g,v,m,n[e+4],7,-176418897),m=o(m,l,g,v,n[e+5],12,1200080426),v=o(v,m,l,g,n[e+6],17,-1473231341),g=o(g,v,m,l,n[e+7],22,-45705983),l=o(l,g,v,m,n[e+8],7,1770035416),m=o(m,l,g,v,n[e+9],12,-1958414417),v=o(v,m,l,g,n[e+10],17,-42063),g=o(g,v,m,l,n[e+11],22,-1990404162),l=o(l,g,v,m,n[e+12],7,1804603682),m=o(m,l,g,v,n[e+13],12,-40341101),v=o(v,m,l,g,n[e+14],17,-1502002290),g=o(g,v,m,l,n[e+15],22,1236535329),l=u(l,g,v,m,n[e+1],5,-165796510),m=u(m,l,g,v,n[e+6],9,-1069501632),v=u(v,m,l,g,n[e+11],14,643717713),g=u(g,v,m,l,n[e],20,-373897302),l=u(l,g,v,m,n[e+5],5,-701558691),m=u(m,l,g,v,n[e+10],9,38016083),v=u(v,m,l,g,n[e+15],14,-660478335),g=u(g,v,m,l,n[e+4],20,-405537848),l=u(l,g,v,m,n[e+9],5,568446438),m=u(m,l,g,v,n[e+14],9,-1019803690),v=u(v,m,l,g,n[e+3],14,-187363961),g=u(g,v,m,l,n[e+8],20,1163531501),l=u(l,g,v,m,n[e+13],5,-1444681467),m=u(m,l,g,v,n[e+2],9,-51403784),v=u(v,m,l,g,n[e+7],14,1735328473),g=u(g,v,m,l,n[e+12],20,-1926607734),l=c(l,g,v,m,n[e+5],4,-378558),m=c(m,l,g,v,n[e+8],11,-2022574463),v=c(v,m,l,g,n[e+11],16,1839030562),g=c(g,v,m,l,n[e+14],23,-35309556),l=c(l,g,v,m,n[e+1],4,-1530992060),m=c(m,l,g,v,n[e+4],11,1272893353),v=c(v,m,l,g,n[e+7],16,-155497632),g=c(g,v,m,l,n[e+10],23,-1094730640),l=c(l,g,v,m,n[e+13],4,681279174),m=c(m,l,g,v,n[e],11,-358537222),v=c(v,m,l,g,n[e+3],16,-722521979),g=c(g,v,m,l,n[e+6],23,76029189),l=c(l,g,v,m,n[e+9],4,-640364487),m=c(m,l,g,v,n[e+12],11,-421815835),v=c(v,m,l,g,n[e+15],16,530742520),g=c(g,v,m,l,n[e+2],23,-995338651),l=f(l,g,v,m,n[e],6,-198630844),m=f(m,l,g,v,n[e+7],10,1126891415),v=f(v,m,l,g,n[e+14],15,-1416354905),g=f(g,v,m,l,n[e+5],21,-57434055),l=f(l,g,v,m,n[e+12],6,1700485571),m=f(m,l,g,v,n[e+3],10,-1894986606),v=f(v,m,l,g,n[e+10],15,-1051523),g=f(g,v,m,l,n[e+1],21,-2054922799),l=f(l,g,v,m,n[e+8],6,1873313359),m=f(m,l,g,v,n[e+15],10,-30611744),v=f(v,m,l,g,n[e+6],15,-1560198380),g=f(g,v,m,l,n[e+13],21,1309151649),l=f(l,g,v,m,n[e+4],6,-145523070),m=f(m,l,g,v,n[e+11],10,-1120210379),v=f(v,m,l,g,n[e+2],15,718787259),g=f(g,v,m,l,n[e+9],21,-343485551),l=t(l,i),g=t(g,a),v=t(v,h),m=t(m,d);return[l,g,v,m]}function a(n){var t,r="",e=32*n.length;for(t=0;t<e;t+=8)r+=String.fromCharCode(n[t>>5]>>>t%32&255);return r}function h(n){var t,r=[];for(r[(n.length>>2)-1]=void 0,t=0;t<r.length;t+=1)r[t]=0;var e=8*n.length;for(t=0;t<e;t+=8)r[t>>5]|=(255&n.charCodeAt(t/8))<<t%32;return r}function d(n){return a(i(h(n),8*n.length))}function l(n,t){var r,e,o=h(n),u=[],c=[];for(u[15]=c[15]=void 0,o.length>16&&(o=i(o,8*n.length)),r=0;r<16;r+=1)u[r]=909522486^o[r],c[r]=1549556828^o[r];return e=i(u.concat(h(t)),512+8*t.length),a(i(c.concat(e),640))}function g(n){var t,r,e="0123456789abcdef",o="";for(r=0;r<n.length;r+=1)t=n.charCodeAt(r),o+=e.charAt(t>>>4&15)+e.charAt(15&t);return o}function v(n){return unescape(encodeURIComponent(n))}function m(n){return d(v(n))}function p(n){return g(m(n))}function s(n,t){return l(v(n),v(t))}function C(n,t){return g(s(n,t))}function A(n,t,r){return t?r?s(t,n):C(t,n):r?m(n):p(n)}"function"==typeof define&&define.amd?define(function(){return A}):"object"==typeof module&&module.exports?module.exports=A:n.MD5=A}(this);

</script>

</body></html>