<script type="text/javascript" src="https://www.usefomo.com/api/v1/M949IjzF31-KIUyo8hY58g/load.js" async></script>

<!-- Google Tag Manager --> 
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-T4JW3M7');</script>
<!-- End Google Tag Manager -->

<!-- Icon for iOs device -->
  <meta name="apple-mobile-web-app-title" content="SherpaDesk">
  <link rel="apple-touch-icon" sizes="52x52" href="https://cdn2.hubspot.net/hubfs/2629098/Design/Icons/iOS/apple-touch-icon-52x52.png">
  <link rel="apple-touch-icon" sizes="80x80" href="https://cdn2.hubspot.net/hubfs/2629098/Design/Icons/iOS/apple-touch-icon-80x80.png">
  <link rel="apple-touch-icon" sizes="120x120" href="https://cdn2.hubspot.net/hubfs/2629098/Design/Icons/iOS/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="152x152" href="https://cdn2.hubspot.net/hubfs/2629098/Design/Icons/iOS/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="167x167" href="https://cdn2.hubspot.net/hubfs/2629098/Design/Icons/iOS/apple-touch-icon-167x167.png">
  <link rel="apple-touch-icon" sizes="180x180" href="https://cdn2.hubspot.net/hubfs/2629098/Design/Icons/iOS/apple-touch-icon-180x180.png">
  <link rel="apple-touch-startup-image" href="https://cdn2.hubspot.net/hubfs/2629098/Design/Icons/iOS/launch.png">


<!-- Signup code - DONT TOUCH! -->

<style type="text/css">
@media (min-width: 768px) {
[data-form-id="bccafcb5-2405-4d07-92be-dad8713d94e2"] .hs-form-field, [data-form-id="bccafcb5-2405-4d07-92be-dad8713d94e2"] .hs_submit{
        display: none;
    }
    .hs_name.hs-form-field, .hs_newsletter_checkbox.hs-form-field, .hs_email.hs-form-field{
        display: block;
    }
    .form-title
    {
        text-align: center;
    }
    #next_step{
    display:block;
}
}
    <!-- begin mobile style sigup -->
@media (max-width: 767px) {
    [data-form-id="bccafcb5-2405-4d07-92be-dad8713d94e2"] .hs-form-field,
    [data-form-id="bccafcb5-2405-4d07-92be-dad8713d94e2"] .hs_submit
    {
    display:block !important;
     }
#next_step{
    display:none !important;
}
}
</style>

<script>

window.addEventListener("error", function (e) {
   alert("Error occured: " + e.error.message);
   return false;
})

function getParameterByName(name) {
    var match = RegExp('[?&]' + name + '=([^&]*)').exec(window.location.search);
    return match && decodeURIComponent(match[1].replace(/\+/g, ' '));
}

function cleanQuerystring() {
    try {window.history.replaceState({}, document.title, location.origin+location.pathname);}
    catch (err){}
}

    var res, $company, $custom_url, $name, $url, $email, $password, $confirm_password, $submit;
    var $divEmail, $divCompany, $divUrl, $divIndustry, $divTechs, $divSubmit, $divForm, $industry, $techs, $divPass1, $divPass2;
        
        function seterror(element, text, isclear)
        {
            element[0].validationMessage = isclear ? "": "Incorrect";
            (element.next("ul") || {}).remove();
            if (!isclear){
            element[0].classList.add("error");
            element[0].classList.add("invalid");
            if (text)
            element.after('<ul class="hs-error-msgs inputs-list hs-error-msgs1" style="display:block;"><li><label>'+text+'</label></li></ul>');
            }   
            else
            {
            element[0].classList.remove("error");
            element[0].classList.remove("invalid");
            }
            $submit.attr("disabled", isclear && !$("ul.hs-error-msgs1").length ? false : true);
        }

        function init_vars($form)
        {
            $divEmail=$('.hs_email');
        $divCompany=$('.hs_company');
        $divUrl=$('.hs_custom_url');
        $divIndustry=$('.hs_your_industry_');
        $divTechs=$('.hs_number_of_techs');
        $divPass1=$('.hs_password');
        $divPass2=$('.hs_confirm_password');
        $divSubmit=$('.hs_submit');
            $form = $($form);
        $company = $form.find( "input[name='company']" );
        $name = $form.find( "input[name='name']" );
        $custom_url = $form.find( "input[name='custom_url']" );
        $url = $form.find("strong:contains('yourcompanyname')");
        $email = $form.find( "input[name='email']" );
        $password = $form.find( "input[name='password']" );
        $confirm_password = $form.find( "input[name='confirm_password']" );
        $submit = $form.find( "input[type='submit']" );
        
        $industry = $form.find( "select[name='your_industry_']" );
        $techs = $form.find("select[name='number_of_techs']");

        $custom_url.parent().css('position', 'relative');
        $custom_url.attr('maxlength','20');
        $custom_url.after("<div class='HolderOrgDomain'>.sherpadesk.com</div>");
        
        }
        
        </script>
        
        <style>
.HolderOrgDomain{
    position: absolute; 
    top: 0;
    transform: translate(0, 60%);
    right: 30px; 
    font: 18px Arial; 
    font-weight: 400; 
    letter-spacing: 0.5px; 
}

.hs-error-msgs1 {
   padding: 5px 0 0 0;
}

@media only screen and (max-width: 530px) and (min-width: 400px)  {
   .HolderOrgDomain{
       font-size:85%;
       transform: translate(0, 100%) !important;
   } 
   
   input::-webkit-input-placeholder{
       font-size:100%;
   }
   .hs-input{
       font-size:85% !important;
   }
    
}

@media only screen and (max-width: 400px){
     .HolderOrgDomain{
       font-size:69% !important;
       transform: translate(0, 135%) !important;
   } 
   
   input::-webkit-input-placeholder{
       font-size:69%;
   }
    .hs-input{
       font-size:69% !important;
   }
}

.hs_submit .hs-error-msgs1 {
    padding-top: 10px;
}

<!-- end mobile style sigup -->

        </style>

<!--Bing Ads -->
<script>(function(w,d,t,r,u){var f,n,i;w[u]=w[u]||[],f=function(){var o={ti:"6014948"};o.q=w[u],w[u]=new UET(o),w[u].push("pageLoad")},n=d.createElement(t),n.src=r,n.async=1,n.onload=n.onreadystatechange=function(){var s=this.readyState;s&&s!=="loaded"&&s!=="complete"||(f(),n.onload=n.onreadystatechange=null)},i=d.getElementsByTagName(t)[0],i.parentNode.insertBefore(n,i)})(window,document,"script","//bat.bing.com/bat.js","uetq");</script>

<!--Pingdom Ads -->
<script src="//rum-static.pingdom.net/pa-5a2853b06f8fe500080000e5.js" async></script>
        <!-- End Signup code - DONT TOUCH! -->

        <!-- footer -->

<!-- Google Tag Manager (noscript) --> 
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T4JW3M7"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->

    <!-- Google Code for Adwords Conversion Conversion Page -->
    <script type="text/javascript"> 
        /* <![CDATA[ */
      var google_conversion_id = 1040470683;
      var google_conversion_label = "IUuFCP62ynUQm6WR8AM";
      var google_remarketing_only = "false";
      /* ]]> */ 
  </script>
  <script>
    if(!~location.href.indexOf("thank-you"))
    {
        console.log("empty");
        window["google_conversion_id"] = 0;
        window["google_conversion_label"] = "";
    }
</script>
<script type="text/javascript" 
src="//www.googleadservices.com/pagead/conversion.js">
</script>
<noscript>
  <img height=1 width=1 border=0 
  src="//www.googleadservices.com/pagead/
  conversion/1040470683/
  ?label=IUuFCP62ynUQm6WR8AM&amp;guid=ON&amp;script=0">
</noscript>
<!-- Signup code - DONT TOUCH! -->

<iframe hidden name="hubspot-iframe" id="hubspot-iframe"></iframe>

<script>// <![CDATA[

    var num_click=0;
    var x = window.matchMedia("(max-width: 767px)");
    function hideNext(x) {
    if (x.matches) { // If media query matches
        $("#next_step").hide();
    } else {
        $("#next_step").show();
    }
}
function nextStepDesktop(){
    if(!$('div.NO-NextStep').length && !$('#next_step').length) {
        $("<center><button id='next_step'> </button></center>").insertBefore('p:contains("100% privacy guarantee.")');
    }
hideNext(x); // Call listener function at run time
x.addListener(hideNext); // Attach listener function on state changes

$("#next_step").click(function(){
    num_click++;
    if (num_click==1) {
     $name.keypress();
     $email.keypress();

 }
 else if (num_click==2) {
  $company.keypress();
  $url.keypress();

} 
else if (num_click==3) {
  $divTechs.fadeIn('slow');
  $techs.focus();
  $("#next_step").hide();
} 

});
}
// ]]></script>
<script>

//set how
function set_how()
{
    var test = $("input[name=hs_context]");
    test = test && test.first();
    if (test)
    {
        var obj = test.val();
        if (obj && obj.length)
        {
           obj = JSON.parse(obj);
           test = obj.urlParams || {}; 
           localStorage.setItem("utm_campaign", test.utm_campaign || localStorage.utm_campaign || "");
           if (test.utm_content)
               test.utm_content = obj.pageTitle || test.utm_content;
           localStorage.setItem("utm_content", test.utm_content || localStorage.utm_content || "");
           localStorage.setItem("utm_medium", test.utm_medium || localStorage.utm_medium || "");
           localStorage.setItem("utm_source", test.utm_source || localStorage.utm_source || "");
           if (obj.referrer && !~obj.referrer.indexOf("sherpadesk.com"))
            localStorage.setItem("referrer", obj.referrer || "");
    }
}
}

// sigup image preload
var images = new Array();
function preload() {
    for (i = 0; i < preload.arguments.length; i++) {
     images[i] = new Image();
     images[i].src = preload.arguments[i];
 }
}


function get_how(){
    var nav = navigator.userAgent.match(/(iPhone|iPod|iPad|Android|BlackBerry|IEMobile)/);
    nav = nav && nav[0] || "Desktop";

    var referrer = localStorage.referrer || "";
    if (referrer.length > 50) referrer = referrer.substring(0,50); 
    var how = "from " + nav +" " + referrer + " ";
    if (localStorage.utm_medium || localStorage.utm_source)
        how += "by " + localStorage.utm_medium + "(" + localStorage.utm_source + ") "
    if (localStorage.utm_campaign)
        how += "in campaign:" + localStorage.utm_campaign + " ";
    if (localStorage.utm_content)
        how += "(" + localStorage.utm_content + ")";
    return how.substring(0,254);
}

var interval = setInterval(function(){
    var $form = $('.hs-form');
    if ($form && $form[0]){
        if(~$form[0].id.indexOf("bccafcb5-2405-4d07-92be-dad8713d94e2"))
        {
            clearInterval(window.interval);
            onFormReady1($($form[0]));
        }


    }
}, 200);

setTimeout(function(){clearInterval(window.interval);set_how();}, 3000);
setTimeout(function(){
    if (res)
        $("#anivideo").prepend("<br/><br/><a style='color:#002d52' href='" + "https://www.sherpadesk.com/thank-you?redirect="+res+"'>Please click here if page is not redirected...</a>")
}, 20000);

function safechar(text)
{
    return (text || "").toLowerCase().replace(/[^a-zA-Z0-9-]/g, '').trim();
}

function onFormReady1($form){
    preload(
       "https://cdn2.hubspot.net/hubfs/2629098/Rocket%20LP/Buttons_Start%20a%20Free%20Trial%20Blue_small.png",
       "https://cdn2.hubspot.net/hubfs/2629098/Rocket%20LP/Buttons_Start%20a%20Free%20Trial%20(Orange)_small.png",
       "https://cdn2.hubspot.net/hubfs/2629098/Rocket%20LP/BIG-ROCKET_without-fire_v2.png"
       );
    console.log("test"+$form[0].id);
    setTimeout(function(){
      $(".hs-button").attr('id', 'ImageButton');
  },1000);

    $('body').on('hsvalidatedsubmit', $form, function (e) {
        e.preventDefault();
        var form = $(e.target); 

        if(~form[0].id.indexOf("bccafcb5-2405-4d07-92be-dad8713d94e2"))
        {
          onFormSubmit1(form);
      }
  });

    $($form).prop('target', 'hubspot-iframe');
    init_vars($form);

    nextStepDesktop();

    $name.val($name.val()).change().focus(); 
    $company.val("").change();
    $email.val("").change();
    $custom_url.val("").change();

    $password.val("").change();
    $confirm_password.val("").change();

    if ($name.val())
        $divEmail.fadeIn('slow');

    /*$name.keypress(function(){
        $divEmail.fadeIn('slow');$(this).unbind(event);});
    $name.change(function(){
        $divEmail.fadeIn('slow');$email.focus();});*/
        $email.keypress(function(){
            $divCompany.fadeIn('slow');$divUrl.fadeIn('slow');});
        $email.change(function(){
            $divCompany.fadeIn('slow');$divUrl.fadeIn('slow');$company.focus();});
        $company.keypress(function(){
            $divPass1.fadeIn('slow');
            $divPass2.fadeIn('slow');
            $divIndustry.fadeIn('slow');});
        $company.change(function(){
            $divPass1.fadeIn('slow');
            $divPass2.fadeIn('slow');
            $divIndustry.fadeIn('slow');$industry.focus();if($industry.val()) $divTechs.fadeIn('slow');});
        $industry.focus(function(){
            if($industry.val()) $divTechs.fadeIn('slow');if($divTechs.is(':visible') && $techs.val()) {$("#next_step").hide();$divSubmit.fadeIn('slow');}});
        $industry.change(function(){
            if($industry.val()) $divTechs.fadeIn('slow');if($divTechs.is(':visible') && $techs.val()) {$("#next_step").hide();$divSubmit.fadeIn('slow');}});
        $techs.change(function(){
            $("#next_step").hide();
            $divSubmit.fadeIn('slow');});
        $techs.focus(function(){
            $("#next_step").hide();
            $divSubmit.fadeIn('slow');});

        setTimeout(function(){$("li","ul.hs-error-msgs").remove()}, 10);

        $password.prop("type", "password");
        $confirm_password.prop("type", "password");

        $company.change(function() {
            var company = $(this).val();
            if(company && !$custom_url.val()){
                var url = safechar(company);
                $custom_url.val(url).change();
                ($url[0] || {}).innerText = url; 
            }
        });


        $password.change(function() {
            var password = $(this).val();
            if(password){
              if (password.trim().length < 5){ 
                seterror($(this), "Password must be not less than 5 chars.");
                return;
            }
            else
                seterror($password, "", true);
            if ($confirm_password.val().length > 0 && $confirm_password.val() != password){ 
                seterror($confirm_password, "Passwords must match.");
                return;
            }
            else
                seterror($confirm_password, "", true);
        }
        seterror($(this), "", true);
    });


        $confirm_password.focusout(function() {
            var password = $password.val();
            var confirm_password = $confirm_password.val();

            if(password && confirm_password == password){ 
                seterror($(this), "", true);
            }
            else if (confirm_password && password !=confirm_password)
                seterror($(this), "Passwords must match.");
        });


        $custom_url.change(function() {
            var url = safechar($(this).val());
            if ($(this).val() != url)
            {
                $custom_url.val(url).change();
            }
            ($url[0] || {}).innerText = url || "yourcompanyname"; 
            if (url)
            {
                if (url.length < 3 || url.length > 20)
                { 
                    seterror($(this), "This Url is incorrect. Please enter between 3 and 20 characters.");
                    return;
                }
                var xhr = new XMLHttpRequest();
                xhr.open('GET', "https://api.sherpadesk.com/validate_organization?format=json&url="+url, true);
                xhr.onload = function(e) { 
                    if (e.target.status == 200)
                    {
                        var data = JSON.parse(e.target.response);
                        if (data.isUrlExists)
                        {
                            seterror($custom_url, "This Url is already in use");
                        }
                        else
                            seterror($custom_url, "", true);
                    }
                    else
                    {
                    //alert(e.target.response);
                    console.log(e);
                }
            }
            xhr.send();
        }
        else
            seterror($custom_url, "", true);
        //console.log($(this).val());
    });
    }

    function onFormSubmit1($form){
        //alert("OK");
        //return;
        //console.log('$form', $form); 
        init_vars($form);
        seterror($submit, "Redirecting to SherpaDesk app. Please wait...");

        var pass1 = $password.val(), 
        pass2 = $confirm_password.val();

        $password.val("").change();
        $confirm_password.val("").change();

        var formData = new FormData();

        formData.append("name", $company.val());
        formData.append("email", $email.val());
        formData.append("url", $custom_url.val());
        formData.append("firstname", $name.val());
        formData.append("lastname", " ");
        formData.append("password", pass1);
        formData.append("password_confirm", pass2);
        formData.append("techs_number", $($techs).val());
        formData.append("industry", $($industry).val());
        formData.append("how", get_how());
        formData.append("note", "Industry: " + $industry.val() + " - Techs: " + $techs.val() + " url:" + location.href.substring(0,50));

                // Append extra data before send.
                formData.append('is_force_registration', 'true'); 
                formData.append('is_force_redirect', 'true');
                formData.append("is_send_hubSpot", "false");
                
                window.onbeforeunload = function(){
                    if (res)
                      localStorage.redirect = res;
            //window.location = "https://www.sherpadesk.com/thank-you?redirect="+res;
        };

        var xhr = new XMLHttpRequest();
        xhr.open('POST', "https://api.sherpadesk.com/organizations?format=json", false);
        xhr.onload = function(e) { 
            if (e.target.status == 200 || e.target.status == 201)
            {
                var data = JSON.parse(e.target.response);
                        //if (testpage)
                        //{
                            console.log(data);
                            res = encodeURIComponent(data.url);
                            localStorage.redirect = res;
                            //window.location = "https://www.sherpadesk.com/thank-you?redirect="+res;
                            //return;
                        //}
                        //window.location = data.url;
                    }
                    else
                    {
                        seterror($submit, "Error occured: " + (e.target.response || e.target.status) +". Please contact SherpaDesk administrator (support@sherpadesk.com)");
                        $custom_url.change();
                        $password.val(pass1).change();
                        $confirm_password.val(pass2).change();
                        //console.log(e);
                    } 
                }
                xhr.onerror = function () {
                    console.log("** An error occurred during the transaction");
                    $password.val(pass1).change();
                    $confirm_password.val(pass2).change();
                    seterror($submit, "Error occured. Please try again later or contact SherpaDesk administrator (support@sherpadesk.com)");
                };

                xhr.send(formData);
                
                setTimeout(function(){seterror($submit, "", true)}, 6000);
            }    

        </script>
      <!-- End Signup code - DONT TOUCH! -->