!function t(e,i,n){function s(a,r){if(!i[a]){if(!e[a]){var c="function"==typeof require&&require;if(!r&&c)return c(a,!0);if(o)return o(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var d=i[a]={exports:{}};e[a][0].call(d.exports,function(t){var i=e[a][1][t];return s(i?i:t)},d,d.exports,t,e,i,n)}return i[a].exports}for(var o="function"==typeof require&&require,a=0;a<n.length;a++)s(n[a]);return s}({1:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("@angular/core"),a=t("ionic-angular"),r=t("./providers/providers"),c=t("./providers/config"),l=t("./providers/mocks"),d=t("./directives/helpers"),u=t("./pages/pages"),p=t("./pages/modals/modals");(function(){function t(t,e,i,n,s,o,a){var r=this;if(this.app=t,this.platform=e,this.config=i,this.events=n,this.menu=s,this.ticketProvider=o,this.dataProvider=a,this.is_offline=!1,this.is_phonegap=!1,this.img=new Image,!this.isStorage())return void console.log("Please enable coockies!");this.is_phonegap="true"===localStorage.getItem("isPhonegap"),this.initializeApp(),this.ExtendConfig(),setTimeout(function(){return r.ExtendNavAlert()},0),(document.getElementsByTagName("ion-loading")[0]||{}).outerHTML="";var p=document.getElementsByTagName("ion-app1");p&&p[0]&&(p[0].classList.add("loaded"),setTimeout(function(){document.getElementsByTagName("ion-app1")[0].outerHTML=""},1500)),setTimeout(function(){window.dash&&localStorage.setItem("dash_cache",window.dash||"")},7e3);var h=(localStorage.getItem("ios_action")||"",d.getParameterByName("t")),m=d.getParameterByName("e"),g=d.getParameterByName("ionicPlatform");if(h)return i.clearCurrent(h),localStorage.setItem("isGoogle","true"),localStorage.setItem("username",(m||"").replace("#","")),i.saveCurrent(),this.rootPage=u.OrganizationsPage,void d.cleanQuerystring("ionicPlatform",g);var f=d.getParameterByName("f");if(f&&setTimeout(function(){return r.nav.alert(f,!0)},3e3),localStorage.setItem("isGoogle",""),d.cleanQuerystring("ionicPlatform",g),c.dontClearCache)i.setCurrent(l.MOCKS.config);else if(!i.getCurrent("is_logged"))return void(this.rootPage=u.LoginPage);return i.getCurrent("is_chosen")?void setTimeout(function(){return r.redirect(!0)},c.dontClearCache?1e3:0):void(this.rootPage=u.OrganizationsPage)}return t.prototype.redirect=function(t){var e=this;this.dataProvider.getConfig().subscribe(function(i){var n=localStorage.getItem("skype")||"";return n?void e.redirect_skype(i):(e.onLine(!0),clearInterval(e.interval),e.interval=setInterval(function(){return e.redirect()},3e5),void e.redirect_logic(t,i))},function(i){clearInterval(e.interval),e.nav.alert(i||"Server error",!0),e.is_offline&&e.config.getCurrent("user").firstname?e.redirect_logic(t,e.config.getCurrent()):e.config.setCurrent({org:""})})},t.prototype.ok=function(t){},t.prototype.fail=function(t){alert(t)},t.prototype.initOrgPreferences=function(t){if(window.cordova){var e=(window.plugins||{}).appPreferences;if(e){var i=e.iosSuite("group.io.sherpadesk.mobile");i.store(this.ok,this.fail,"org",t)}if(window.sswc){var n=function(t){var e=JSON.parse(t);console.log(e.message)},s=function(){console.log("Message send success")},o=function(){console.log("Error")},a=function(){window.sswc.messageReceiver(n,o),window.sswc.sendMessage(t,s,o)};window.sswc.init(a,o),console.log("window.sswc",window.sswc)}else console.log("no watch")}},t.prototype.redirect_skype=function(t){this.config.setCurrent(t),this.nav.setRoot(u.SkypePage,null,{animation:"wp-transition"})},t.prototype.redirect_logic=function(t,e){if(this.config.setCurrent(e),this.config.current.user.is_techoradmin?this.pages=[{title:"Dashboard",component:u.DashboardPage,icon:"speedometer",is_active:!0},{title:e.names.ticket.p,component:u.TicketsPage,icon:"create",is_active:!0},{title:"Timelogs",component:u.TimelogsPage,icon:"md-time",is_active:this.config.current.is_time_tracking},{title:e.names.account.p,component:u.AccountsPage,icon:"people",is_active:this.config.current.is_account_manager},{title:e.names.location.p,component:u.LocationsPage,icon:"navigate",is_active:this.config.current.is_location_tracking},{title:e.names.tech.p,component:u.TechniciansPage,icon:"people-outline",is_active:!0},{title:"Invoices",component:u.InvoicesPage,icon:"card",is_active:this.config.current.is_time_tracking&&this.config.current.is_invoice&&(this.config.current.is_financial_info_for_tech||this.config.current.user.is_admin)},{title:"Queues",component:u.QueuesPage,icon:"md-list-box",is_active:this.config.current.is_unassigned_queue&&(!this.config.current.user.is_limit_assigned_tkts||this.config.current.user.is_admin)},{title:"ToDos",component:u.TodosPage,icon:"list-box",is_active:this.config.current.is_todos},{title:"Switch Org",component:u.OrganizationsPage,icon:"md-swap",is_active:this.config.current.is_multiple_org},{title:"Signout",component:u.LoginPage,icon:"md-log-in",is_active:!0},{title:"Full App",component:null,icon:"md-share-alt",is_active:!0}]:this.pages=[{title:e.names.ticket.p,component:u.TicketsPage,icon:"create",is_active:!0},{title:"Switch Org",component:u.OrganizationsPage,icon:"md-swap",is_active:this.config.current.is_multiple_org},{title:"Signout",component:u.LoginPage,icon:"md-log-in",is_active:!0},{title:"Full App",component:null,icon:"md-share-alt",is_active:!0}],"true"===localStorage.getItem("isPhonegap")&&this.initOrgPreferences(this.config.current.org+"-"+this.config.current.instance+":"+this.config.current.key),t&&"true"===localStorage.getItem("isExtension")){var i="login?t="+this.config.current.key+"&o="+this.config.current.org+"&i="+this.config.current.instance;window.top.postMessage(i,"*")}var n=localStorage.getItem("version");n!==e.mobile_ver&&Number(e.mobile_ver)>Number(n)?this.presentConfirm(e.mobile_ver,t):this.force_redirect(t)},t.prototype.force_redirect=function(t){if(t){var e=null,i=localStorage.getItem("loadTicketNumber")||"";i&&(localStorage.setItem("loadTicketNumber",""),localStorage.setItem("loadOrgKey",""),e={key:i});var n=this.config.current.user.is_techoradmin&&!i?u.DashboardPage:u.TicketsPage;this.nav.setRoot(n,e,{animation:"wp-transition"})}},t.prototype.presentConfirm=function(t,e){var i=this;localStorage.setItem("version",t),this.config.saveCurrent();var n=a.Alert.create({title:"There is a new update available!",message:"Page will reload in 2 seconds",cssClass:"hello",buttons:[{text:"Yes, do it now",role:"cancel",handler:function(){var t=document.createElement("script");t.src=c.MobileSite+"build/js/app.js?_d="+Date.now(),document.body.appendChild(t),setTimeout(function(){return location.reload(!0)},2e3)}},{text:"No, I'll do it later",handler:function(){return n.dismiss().then(function(){i.force_redirect(e)}),!1}}]});this.nav.present(n)},t.prototype.isStorage=function(){var t="modernizr";try{return localStorage.setItem(t,t),localStorage.removeItem(t),!0}catch(e){var i=a.Toast.create({message:"Please enable Cookies to work with site!",enableBackdropDismiss:!1,showCloseButton:!0,cssClass:"toast-error"});return this.nav.present(i),!1}},t.prototype.initializeApp=function(){var t=this;this.platform.ready().then(function(){"true"===localStorage.getItem("isPhonegap")&&console.log("cordova ready"),window.addEventListener("online",function(){return t.onLine(!0)}),window.addEventListener("offline",function(){return t.onLine(!1)}),document.addEventListener("handle",function(e){return t.handle(e)},!1)})},t.prototype.handle=function(t){var e,i=t.detail,n=Object.keys(i)[0],s={},o=!1;switch(n){case"ticket":this.config.getCurrent("is_logged")?(e=u.TicketsPage,s={key:i[n]}):localStorage.setItem("loadTicketNumber",i[n]);break;case"add_time":o=!0,e=u.TimelogPage;break;case"add_tkt":o=!0,e=p.TicketCreatePage;break;case"list":o=!0,e=u.TicketsPage,s={tab:i[n]}}e&&(o?this.nav.push(e,s,{animation:"wp-transition"}):this.nav.setRoot(e,s,{animation:"wp-transition"}))},t.prototype.checkConnection=function(){var t=this;navigator.onLine?"true"!==localStorage.getItem("isPhonegap")&&(this.img.onload=function(){return t.onLine(!0)},this.img.onerror=function(){return t.onLine(!1)},this.img.src=c.MobileSite+"img/select_arrow.png?rand="+Math.random()):this.onLine(!1)},t.prototype.onLine=function(t){var e=this;this.is_offline!=!t&&(this.offlineTimer&&this.offlineTimer.runCount>=1&&this.nav.alert(t?"Hey! You online now! Try again your action":"Sorry! You are offline now. Please check your internet connection!",!t),"true"!==localStorage.getItem("isPhonegap")&&(t?(clearInterval(this.offlineTimer),this.offlineTimer=null):(clearInterval(this.offlineTimer),this.offlineTimer=null,this.offlineTimer=setInterval(function(){return e.checkConnection()},1e4)))),this.is_offline=!t},t.prototype.openPage=function(t,e){if(this.menu.close(),!t.component){var i=this.config.getCurrent();return void d.fullapplink(c.AppSite,"",i.instance,i.org)}!this.interval||t.component!=u.LoginPage&&t.component!=u.OrganizationsPage||clearInterval(this.interval),t.index?this.nav.setRoot(t.component||t,{tabIndex:t.index}):this.nav.setRoot(t.component||t)},t.prototype.ngOnInit=function(){this.subscribeToEvents()},t.prototype.ngOnDestroy=function(){this.unsubscribeToEvents(),clearInterval(this.offlineTimer),clearInterval(this.interval),"true"===localStorage.getItem("isPhonegap")&&(this.disconnectSubscription.unsubscribe(),this.connectSubscription.unsubscribe())},t.prototype.logout=function(t){this.config.clearCurrent(t),"true"===localStorage.getItem("isPhonegap")&&this.initOrgPreferences("")},t.prototype.subscribeToEvents=function(){var t=this;this.events.subscribe("login:failed",function(){t.logout(),t.openPage({component:u.LoginPage})}),this.events.subscribe("app:logout",function(e){t.logout(e&&e[0])}),this.events.subscribe("connection:error",function(e){t.checkConnection()}),this.events.subscribe("config:get",function(e){t.redirect(e)})},t.prototype.unsubscribeToEvents=function(){this.events.unsubscribe("login:failed",null),this.events.unsubscribe("connection:error",null),this.events.unsubscribe("config:get",null),this.events.unsubscribe("app:logout",null)},t.prototype.ExtendConfig=function(){localStorage.setItem("isExtension",window.self!==window.top?"true":""),localStorage.setItem("version",c.appVersion),this.config.getCurrent=function(t){var e=this.current||JSON.parse(localStorage.getItem("current")||"null")||{};e.is_logged=!!e.key,e.is_chosen=!!e.instance&&!!e.org&&!!e.key,e.is_online=!this.is_offline;var i=localStorage.getItem("version");return e.is_updated=!(i!==e.mobile_ver&&Number(e.mobile_ver)>Number(i)),e.stat||(e.stat={}),e.user||(e.user={}),e.recent||(e.recent={}),e.cache||(e.cache={}),t?e[t]||"":e},this.config.current=this.config.getCurrent(),this.config.saveCurrent=function(){var t=this.getCurrent();localStorage.setItem("current",JSON.stringify(t)),localStorage.setItem("dateformat",t.user.date_format||0),localStorage.setItem("timeformat",t.user.time_format||0),localStorage.setItem("currency",t.currency||"$")},this.config.setCurrent=function(t,e){this.current=Object.assign({},this.current||{},t||{}),e||this.saveCurrent()},this.config.clearCurrent=function(t){localStorage.removeItem("dash_cache"),localStorage.removeItem("current"),this.setCurrent({key:t||"",org:"",instance:"",user:{},stat:{},recent:{},cache:{}})},this.config.getStat=function(t){var e=this.getCurrent("stat")[t];return"undefined"==typeof e?-1:e||{}},this.config.setStat=function(t,e){this.current.stat[t]=e},this.config.getRecent=function(t){var e=this.getCurrent("recent")[t];return e||{}},this.config.setRecent=function(t,e){e?this.current.recent[t]=e:this.current.recent=Object.assign({},this.current.recent||{},t||{})},this.config.getCache=function(t){var e=this.getCurrent("cache")[t];return"undefined"==typeof e?[]:e||{}},this.config.setCache=function(t,e){this.current.cache[t]=e}},t.prototype.ExtendNavAlert=function(){this.nav.alert=function(t,e){var i=a.Toast.create({message:t,duration:e?7e3:3e3,cssClass:e?"toast-error":"toast-ok",showCloseButton:!0,closeButtonText:"X"});this.present(i)}},n([o.ViewChild(a.Nav),s("design:type",a.Nav)],t.prototype,"nav",void 0),t=n([a.App({template:'<ion-menu id="leftMenu" [content]="content"><ion-content class="menu-bg"><ion-list no-lines><div *ngFor="let p of pages" (click)="openPage(p)"><button detail-none *ngIf="p.is_active" ion-item><i><ion-icon name="{{p.icon}}"></ion-icon></i><h3>{{p.title}}</h3></button></div></ion-list></ion-content></ion-menu><div *ngIf="is_offline" class="offline_status {{ is_phonegap ? \'ios7style\' : \'\'}}">OFFLINE</div><ion-nav id="nav" [root]="rootPage" #content swipe-back-enabled="false"></ion-nav>',providers:[r.ApiData,r.DataProvider,r.TicketProvider,r.TimeProvider,r.TodoProvider],prodMode:!0,config:{tabbarPlacement:"top",pageTransitionDelay:0,prodMode:!0,activator:"ripple",ios:{activator:"ripple"}}}),s("design:paramtypes",[a.IonicApp,a.Platform,a.Config,a.Events,a.MenuController,r.TicketProvider,r.DataProvider])],t)})()},{"./directives/helpers":19,"./pages/modals/modals":41,"./pages/pages":47,"./providers/config":71,"./providers/mocks":73,"./providers/providers":74,"@angular/core":"@angular/core","ionic-angular":"ionic-angular"}],2:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),a=t("@angular/core"),r=t("../../pages/account-details/account-details"),c=t("../../pipes/pipes"),l=function(){function t(t,e){this.nav=t,this.config=e,this.is_empty=!1}return t.prototype.itemTapped=function(t,e){e.account_statistics.ticket_counts.closed=null,this.nav.push(r.AccountDetailsPage,e)},t.prototype.ngOnChanges=function(t){if(this.simple&&"accounts"in t){if(t.accounts.isFirstChange()&&null!==t.accounts.currentValue)return;this.is_empty=!t.accounts.currentValue||0==t.accounts.currentValue.length}},n([a.Input(),s("design:type",Array)],t.prototype,"accounts",void 0),n([a.Input(),s("design:type",Boolean)],t.prototype,"simple",void 0),t=n([a.Component({selector:"accounts-list",template:'<ion-list class="list" no-lines><div *ngIf="!simple && accounts?.length" class="flexed color"><div detail-none><span>&nbsp;&nbsp;&nbsp;</span> <span [hidden]="!config.current.is_time_tracking">Hours</span> <span [hidden]="!config.current.is_expenses">Expenses</span> <span>{{config.current.names.ticket.ap}}</span></div></div><div class="accountlist flexed"><div detail-none href="#" *ngFor="let account of accounts" (click)="itemTapped($event, account)"><span>{{account.name}}</span> <span [hidden]="simple || !config.current.is_time_tracking" [innerHTML]="account.account_statistics.hours | More:[1000]"></span> <span [hidden]="simple || !config.current.is_expenses" [innerHTML]="account.account_statistics.expenses | More:[1000,\'$VV\']"></span> <span [innerHTML]="account.account_statistics.ticket_counts.open | More:[1000]"></span></div></div></ion-list><div *ngIf="is_empty && !simple" class="table grey2 menu-text">No Accounts</div>',directives:[o.IONIC_DIRECTIVES],pipes:[c.MorePipe]}),s("design:paramtypes",[o.Nav,o.Config])],t)}();i.AccountsListComponent=l},{"../../pages/account-details/account-details":20,"../../pipes/pipes":69,"@angular/core":"@angular/core","ionic-angular":"ionic-angular"}],3:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),a=t("@angular/core"),r=t("../../pages/modals/modals"),c=t("../../pages/timelog/timelog"),l=t("../../pages/ticket-details/ticket-details"),d=t("../../pages/expense-create/expense-create"),u=t("../../pages/todo-create/todo-create"),p=t("../../pages/invoices/invoices"),h=t("../../pages/invoice-create/invoice-create"),m=function(){function t(t,e,i){this.navParams=t,this.nav=e,this.config=i,this.data={}}return t.prototype.ngOnInit=function(){},t.prototype.openModal=function(t){var e=this,i=o.Modal.create(t,this.data);i.onDismiss(function(t){t&&t.number&&e.nav.push(l.TicketDetailsPage,t)}),this.nav.present(i)},t.prototype.presentActionSheet=function(){var t=this;if(!this.config.current.user.is_techoradmin)return void this.openModal(r.TicketCreatePage);var e=[{icon:"create",text:"Add "+this.config.current.names.ticket.s,role:"",handler:function(){return t.actionSheet.dismiss().then(function(){return t.openModal(r.TicketCreatePage)}),!1}}];this.config.current.is_time_tracking&&(e.push({icon:"md-time",text:"Add Time",role:"",handler:function(){return t.actionSheet.dismiss().then(function(){return t.openModal(c.TimelogPage)}),!1}}),this.config.current.is_invoice&&(this.config.current.is_financial_info_for_tech||this.config.current.user.is_admin)&&e.push({icon:"card",text:"Create Invoice",role:"",handler:function(){return t.actionSheet.dismiss().then(function(){return t.nav.push(h.InvoiceCreatePage,t.data)}),!1}}),this.config.current.is_invoice&&(this.config.current.is_financial_info_for_tech||this.config.current.user.is_admin)&&e.push({icon:"card",text:"Show Invoices",role:"",handler:function(){return t.actionSheet.dismiss().then(function(){return t.nav.push(p.InvoicesPage,t.data)}),!1}}),this.config.current.is_todos&&e.push({icon:"ios-list-box-outline",text:"Add ToDo",role:"",handler:function(){return t.actionSheet.dismiss().then(function(){return t.nav.push(u.TodoCreatePage)}),!1}})),this.config.current.is_expenses&&e.push({icon:"md-list-box",text:"Add Expense",role:"",handler:function(){return t.actionSheet.dismiss().then(function(){return t.openModal(d.ExpenseCreatePage)}),!1}}),e.push({icon:"",text:"Cancel",role:"cancel",handler:function(){return console.log("Cancel clicked"),!0}}),this.actionSheet=o.ActionSheet.create({title:"",buttons:e}),this.nav.present(this.actionSheet)},n([a.Input(),s("design:type",Object)],t.prototype,"data",void 0),t=n([a.Component({selector:"action-button",template:'<button (click)="presentActionSheet()" secondary item-right fab fab-right fab-bottom style="z-index: 2"><ion-icon class="button_circle action-but" name="md-add"></ion-icon></button>',directives:[o.IONIC_DIRECTIVES]}),s("design:paramtypes",[o.NavParams,o.Nav,o.Config])],t)}();i.ActionButtonComponent=m},{"../../pages/expense-create/expense-create":25,"../../pages/invoice-create/invoice-create":27,"../../pages/invoices/invoices":29,"../../pages/modals/modals":41,"../../pages/ticket-details/ticket-details":54,"../../pages/timelog/timelog":56,"../../pages/todo-create/todo-create":58,"@angular/core":"@angular/core","ionic-angular":"ionic-angular"}],4:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),a=t("../../providers/api-data"),r=t("@angular/core"),c=t("../../pages/modals/modals");t("rxjs");var l=function(){function t(t,e,i){this.nav=t,this.apiData=e,this.config=i,this.list={},this.onChanged=new r.EventEmitter(!1),this.init=!0,this.selected={}}return t.prototype.ngOnInit=function(){return this.config.current.is_class_tracking?void(this.list.url&&(this.url=this.list.url,this.preload&&this.loadData(!1))):void(this.list.hidden=!0)},t.prototype.open=function(){this.loadData(!0)},t.prototype.loadData=function(t){var e=this;this.url==this.list.url&&this.list.items&&0!=this.list.items.length?this.proceed_list(t):this.list.url?this.apiData.get(this.list.url).subscribe(function(i){e.list.items=i,e.proceed_list(t),e.url=e.list.url},function(t){e.error("Cannot get "+e.list.name+" list! Error: "+t),console.log(t||"Server error")}):this.error(this.list.name+" list is empty!")},t.prototype.error=function(t){this.nav.alert(t,!0)},t.prototype.proceed_list=function(t){return this.config.getCurrent("user").is_techoradmin||(this.list.items=this.list.items.filter(function(t){return!t.is_restrict_to_techs})),this.list.items=this.list.items.filter(function(t){return t.is_active}),this.list.items&&0!=this.list.items.length?void(t&&("Default (no selection)"!=this.list.items[0].name&&this.list.items.splice(0,0,{hierarchy_level:0,id:0,is_active:!0,is_lastchild:!0,name:"Default (no selection)"}),this.openModal())):void(this.list.value="Default (nothing to select)")},t.prototype.emit_changed=function(t){t.name=this.findPath(" ",this.list.items,t.id),t.type="class",this.onChanged.emit(t)},t.prototype.findPath=function(t,e,i){if("undefined"!=typeof e&&e)for(var n=0;n<e.length;n++){if(e[n].id==i)return e[n].name;var t=this.findPath(t,e[n].sub,i);if(null!=t)return e[n].name+" / "+t}return null},t.prototype.openRadio=function(){var t=this,e=this.list.name,i=o.Alert.create({title:"Choose "+e,buttons:[{text:"Cancel",role:"cancel",handler:function(){console.log("Cancel clicked")}},{text:"OK",handler:function(e){e&&(t.selected=e,t.emit_changed(e))}}]});this.list.items.forEach(function(t){i.addInput({type:"radio",label:t.name,value:t})}),this.nav.present(i)},t.prototype.openModal=function(){var t=this,e=o.Modal.create(c.TreeModal,this.list);e.onDismiss(function(e){e.name&&(t.selected=e,t.emit_changed(e))}),this.nav.present(e)},n([r.Input(),s("design:type",Object)],t.prototype,"list",void 0),n([r.Input(),s("design:type",Boolean)],t.prototype,"preload",void 0),n([r.Output(),s("design:type",r.EventEmitter)],t.prototype,"onChanged",void 0),t=n([r.Component({selector:"class-list",template:'<div *ngIf="!list.hidden"><ion-item no-lines class="labels color">Class:&nbsp;</ion-item></div><button *ngIf="!list.hidden" (click)="open()" class="blue4 width100 disable-hover button button-default button-select"><ion-label class="tkts-table">{{list.value}}</ion-label><ion-icon name="arrow-down"></ion-icon></button>',directives:[o.IONIC_DIRECTIVES]}),s("design:paramtypes",[o.Nav,a.ApiData,o.Config])],t)}();i.ClassListComponent=l},{"../../pages/modals/modals":41,"../../providers/api-data":70,"@angular/core":"@angular/core","ionic-angular":"ionic-angular",rxjs:"rxjs"}],5:[function(t,e,i){"use strict";function n(t){for(var e in t)i.hasOwnProperty(e)||(i[e]=t[e])}n(t("./queues-list/queues-list")),n(t("./accounts-list/accounts-list")),n(t("./todo-list/todo-list")),n(t("./tickets-list/tickets-list")),n(t("./posts-list/posts-list")),n(t("./select-list/select-list")),n(t("./multi-select/multi-select")),n(t("./class-list/class-list")),n(t("./action-button/action-button")),n(t("./locations-list/locations-list")),n(t("./location-list/location-list")),n(t("./techs-list/techs-list")),n(t("./custom-field/custom-field"))},{"./accounts-list/accounts-list":2,"./action-button/action-button":3,"./class-list/class-list":4,"./custom-field/custom-field":6,"./location-list/location-list":7,"./locations-list/locations-list":8,"./multi-select/multi-select":9,"./posts-list/posts-list":10,"./queues-list/queues-list":11,"./select-list/select-list":12,"./techs-list/techs-list":13,"./tickets-list/tickets-list":14,"./todo-list/todo-list":15}],6:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),a=t("../../providers/api-data"),r=t("../../directives/helpers"),c=t("@angular/core"),l=function(){function t(t,e,i){this.nav=t,this.apiData=e,this.config=i,this.onChanged=new c.EventEmitter(!1),this.selected={},this.init=!0}return t.prototype.ngOnInit=function(){this.displayFormat=r.getPickerDateTimeFormat(!1,!0),"select"==this.type&&(this.custom_choices=this.choices.split(/\r?\n/)),"checkbox"==this.type&&(this.custom_choices=this.choices.split(/\r?\n/)),"date"==this.type&&(this.custom_date=new Date(this.value))},t.prototype.AddHours=function(t,e){if(t){19==t.length&&(t=t.slice(0,-3));var i=new Date(t);return new Date(i.setTime(i.getTime()+60*e*60*1e3)).toJSON()}return t},t.prototype.getStartDate=function(t){return t=this.AddHours(t,this.config.getCurrent("timezone_offset"))},t.prototype.setStartDate=function(t){var e=this.AddHours(t,-1*this.config.getCurrent("timezone_offset")),i={id:this.id,name:this.name,value:e};this.onChanged.emit(i)},t.prototype.error=function(t){this.nav.alert(t,!0)},t.prototype.changeText=function(t){this.value=t.value.trim();var e={id:this.id,name:this.name,value:this.value};this.onChanged.emit(e)},t.prototype.openRadio=function(){var t=this,e=this.name,i=o.Alert.create({title:"Choose "+e,buttons:[{text:"Cancel",role:"cancel",handler:function(){console.log("Cancel clicked")}},{text:"OK",handler:function(e){if(e){t.selected=e,t.value=e;var i={id:t.id,name:t.name,value:e};t.onChanged.emit(i)}}}]});this.custom_choices.forEach(function(t){i.addInput({type:"radio",label:t,value:t})}),this.nav.present(i)},t.prototype.openCheckbox=function(){var t=this,e=this.name,i=o.Alert.create({title:"Choose "+e,buttons:[{text:"Cancel",role:"cancel",handler:function(){console.log("Cancel clicked")}},{text:"OK",handler:function(e){if(e){t.value=e.join(", ");var i={id:t.id,name:t.name,value:t.value};t.onChanged.emit(i)}}}]}),n=this.value.split(", ");this.custom_choices.forEach(function(t){i.addInput({type:"checkbox",label:t,value:t,checked:n.filter(function(e){return e==t}).length>0})}),this.nav.present(i)},n([c.Input(),s("design:type",String)],t.prototype,"type",void 0),n([c.Input(),s("design:type",Number)],t.prototype,"id",void 0),n([c.Input(),s("design:type",String)],t.prototype,"name",void 0),n([c.Input(),s("design:type",String)],t.prototype,"choices",void 0),n([c.Input(),s("design:type",String)],t.prototype,"value",void 0),n([c.Input(),s("design:type",Boolean)],t.prototype,"required",void 0),n([c.Output(),s("design:type",c.EventEmitter)],t.prototype,"onChanged",void 0),t=n([c.Component({selector:"custom-field",template:'<center><div *ngIf="type == \'select\'"><ion-item no-lines class="labels color width100">{{name}}</ion-item></div><button *ngIf="type == \'select\'" class="blue4 width100 disable-hover button button-default button-select" (click)="openRadio()"><ion-label class="{{isbutton ? \'center\' : \'tkts-table\'}} select-list">&nbsp;&nbsp;{{value || \'&nbsp;\'}}</ion-label><ion-icon name="arrow-down"></ion-icon></button></center><center><div *ngIf="type == \'checkbox\'"><ion-item no-lines class="labels color width100">{{name}}</ion-item></div><button *ngIf="type == \'checkbox\'" class="blue4 width100 disable-hover button button-default button-select" (click)="openCheckbox()"><ion-label class="{{isbutton ? \'center\' : \'tkts-table\'}} select-list">&nbsp;&nbsp;{{value || \'&nbsp;\'}}</ion-label><ion-icon name="arrow-down"></ion-icon></button></center><div *ngIf="type == \'date\'" style="font-size: 1.5rem;"><ion-item no-lines class="labels color">{{name}}</ion-item><ion-item no-lines class="blue3 top0 bottom5"><ion-label class="start-end2"></ion-label><ion-datetime [ngClass]="{\'nocolor\': value == \'0001-01-01T00:00:00.0000000\', \'text-color\': value !=\'0001-01-01T00:00:00.0000000\'}" class="text-color" (ngModelChange)="setStartDate($event)" [ngModel]="getStartDate(value)" [displayFormat]="displayFormat"></ion-datetime></ion-item></div><div *ngIf="type == \'text\'"><form #loginForm="ngForm" novalidate><ion-item no-lines class="labels color" style="font-size: 1.5rem;">{{name}}</ion-item><input class="width100 blue3 subject-create commentText margin-bottom3" placeholder="please add text" required maxlength="200" (ngModelChange)="changeText(name1)" #name1="ngForm" [ngModel]="value"></form></div><div *ngIf="type == \'num\'"><form #loginForm="ngForm" novalidate><ion-item no-lines class="labels color" style="font-size: 1.5rem;">{{name}}</ion-item><input class="width100 blue3 subject-create commentText margin-bottom3" placeholder="please add number" type="number" (ngModelChange)="changeText(name1)" #name1="ngForm" [ngModel]="value" required></form></div>',directives:[o.IONIC_DIRECTIVES]}),s("design:paramtypes",[o.Nav,a.ApiData,o.Config])],t)}();i.CustomFieldComponent=l},{"../../directives/helpers":19,"../../providers/api-data":70,"@angular/core":"@angular/core","ionic-angular":"ionic-angular"}],7:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),a=t("../../providers/api-data"),r=t("@angular/core"),c=t("../../pages/modals/modals"),l=t("../../directives/helpers");t("rxjs");var d=function(){function t(t,e,i){this.nav=t,this.apiData=e,this.config=i,this.list={},this.onChanged=new r.EventEmitter(!1),this.init=!0,this.selected={}}return t.prototype.ngOnInit=function(){return this.config.current.is_location_tracking?(this.name=(this.config.current.names[this.list.name]||{}).s||this.list.name,void(this.list.url&&(this.url=this.list.url,this.preload&&this.loadData(!1)))):void(this.list.hidden=!0)},t.prototype.open=function(){this.loadData(!0)},t.prototype.loadData=function(t){var e=this;this.url==this.list.url&&this.list.items&&0!=this.list.items.length?this.proceed_list(t):this.list.url?this.apiData.get(l.addp(this.list.url,"is_tree","true")).subscribe(function(i){e.list.items=i,e.proceed_list(t),e.url=e.list.url},function(t){e.error("Cannot get "+e.name+" list! Error: "+t),console.log(t||"Server error")}):this.error(this.name+" list is empty!")},t.prototype.error=function(t){this.nav.alert(t,!0)},t.prototype.proceed_list=function(t){return this.list.items&&0!=this.list.items.length?void(t&&("Default (no selection)"!=this.list.items[0].name&&this.list.items.splice(0,0,{hierarchy_level:0,id:0,is_active:!0,is_lastchild:!0,name:"Default (no selection)"}),this.openModal())):void(this.list.value="Default (nothing to select)")},t.prototype.emit_changed=function(t){t.name=this.findPath(" ",this.list.items,t.id),t.type="location",this.onChanged.emit(t)},t.prototype.findPath=function(t,e,i){if("undefined"!=typeof e&&e)for(var n=0;n<e.length;n++){if(e[n].id==i)return e[n].name;var t=this.findPath(t,e[n].sub,i);if(null!=t)return e[n].name+" / "+t;
}return null},t.prototype.openRadio=function(){var t=this,e=this.name,i=o.Alert.create({title:"Choose "+e,buttons:[{text:"Cancel",role:"cancel",handler:function(){console.log("Cancel clicked")}},{text:"OK",handler:function(e){e&&(t.selected=e,t.emit_changed(e))}}]});this.list.items.forEach(function(t){i.addInput({type:"radio",label:t.name,value:t})}),this.nav.present(i)},t.prototype.openModal=function(){var t=this,e=o.Modal.create(c.TreeModal,this.list);e.onDismiss(function(e){e.name&&(t.selected=e,t.emit_changed(e))}),this.nav.present(e)},n([r.Input(),s("design:type",Object)],t.prototype,"list",void 0),n([r.Input(),s("design:type",Boolean)],t.prototype,"preload",void 0),n([r.Output(),s("design:type",r.EventEmitter)],t.prototype,"onChanged",void 0),t=n([r.Component({selector:"location-list",template:'<div *ngIf="!list.hidden"><ion-item no-lines class="labels color">{{list.name}}:&nbsp;</ion-item></div><button *ngIf="!list.hidden" (click)="open()" class="blue4 width100 disable-hover button button-default button-select"><ion-label class="tkts-table">{{list.value}}</ion-label><ion-icon name="arrow-down"></ion-icon></button>',directives:[o.IONIC_DIRECTIVES]}),s("design:paramtypes",[o.Nav,a.ApiData,o.Config])],t)}();i.LocationListComponent=d},{"../../directives/helpers":19,"../../pages/modals/modals":41,"../../providers/api-data":70,"@angular/core":"@angular/core","ionic-angular":"ionic-angular",rxjs:"rxjs"}],8:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),a=t("@angular/core"),r=t("../../pages/location-details/location-details"),c=t("../../pipes/pipes"),l=function(){function t(t,e){this.nav=t,this.config=e,this.is_empty=!1}return t.prototype.itemTapped=function(t,e){this.nav.push(r.LocationDetailsPage,e)},t.prototype.ngOnChanges=function(t){if(this.simple&&"locations"in t){if(t.locations.isFirstChange()&&null!==t.locations.currentValue)return;this.is_empty=!t.locations.currentValue||0==t.locations.currentValue.length}},n([a.Input(),s("design:type",Array)],t.prototype,"locations",void 0),n([a.Input(),s("design:type",Boolean)],t.prototype,"simple",void 0),t=n([a.Component({selector:"locations-list",template:'<ion-list class="list" no-lines><div *ngIf="!simple && locations?.length" class="flexed color"><div detail-none><span>&nbsp;&nbsp;&nbsp;</span> <span>{{config.current.names.ticket.ap}}</span></div></div><div class="locationlist flexed"><div detail-none href="#" *ngFor="let location of locations" (click)="itemTapped($event, location)"><span>{{location.name}}</span> <span>{{location.tickets_count}}</span></div></div></ion-list><div *ngIf="is_empty && !simple" class="table grey2 menu-text">No Locations</div>',directives:[o.IONIC_DIRECTIVES],pipes:[c.MorePipe]}),s("design:paramtypes",[o.Nav,o.Config])],t)}();i.LocationsListComponent=l},{"../../pages/location-details/location-details":30,"../../pipes/pipes":69,"@angular/core":"@angular/core","ionic-angular":"ionic-angular"}],9:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),a=t("../../providers/api-data"),r=t("../../directives/helpers"),c=t("@angular/core"),l=t("../../pages/modals/modals"),d=function(){function t(t,e,i){this.nav=t,this.apiData=e,this.config=i,this.is_enabled=!0,this.onChanged=new c.EventEmitter(!1),this.selected={},this.init=!0,this.name="",this.list={}}return t.prototype.ngOnInit=function(){var t=this.list.name.toLowerCase();this.is_enabled=!this.list.is_disabled,"alt techs"==t?this.name="Alt "+this.config.current.names.tech.p:"alt users"==t&&(this.name="Alt "+this.config.current.names.user.p),this.list.url&&(this.url=this.list.url,this.preload&&this.loadData(!1))},t.prototype.open=function(){this.loadData(!0)},t.prototype.loadData=function(t){var e=this;if(this.url==this.list.url&&this.list.items&&0!=this.list.items.length)this.proceed_list(t);else if(this.list.url){var i=null;t&&(i=o.Loading.create({content:"Please wait...",dismissOnPageChange:!0}),this.nav.present(i)),this.apiData.get(this.list.url).subscribe(function(n){e.list.items=n,t&&i.dismiss(),e.proceed_list(t),e.url=e.list.url},function(n){t&&i.dismiss(),e.error("Cannot get "+e.name+" list! Error: "+n),console.log(n||"Server error")})}else this.list.hidden=!0,this.error(this.name+" list is empty!")},t.prototype.error=function(t){this.nav.alert(t,!0)},t.prototype.proceed_list=function(t){var e=this;if(!this.list.items||0==this.list.items.length)return void(this.list.value="Default (nothing to select)");if(t){if(!this.list.items[0].name){var i=[];this.list.items.forEach(function(t){var n,s=t.id;t.email?n=r.getFullName(t.firstname,t.lastname,t.email,e.isbutton?"":" "):t.number?n="#"+t.number+": "+t.subject:t.prepaid_pack_id&&(n=t.prepaid_pack_name,s=t.prepaid_pack_id),i.push({id:s,name:n,email:t.email})}),this.list.items=i}this.openModal()}},t.prototype.emit_changed=function(t){for(var e="",i="",n=0;n<t.length;n++)e+=t[n].name.replace(" ("+t[n].email+")",","),i+=t[n].id+", ";i=i.slice(0,-1),e=e.slice(0,-1),this.list.value=e,t={id:i,name:e},t.type=this.list.name.split(" ").join("").toLowerCase(),this.selected=this.list.value,this.onChanged.emit(t)},t.prototype.openModal=function(){var t=this;this.list.isbutton=this.isbutton;var e=(this.list.items.length||0,l.InfinityMultiSelectModal),i=o.Modal.create(e,this.list);i.onDismiss(function(e){e&&(t.selected=t.list.selected_items=e,t.list.selected_items.forEach(function(t){t.is_selected=!0}),t.emit_changed(e))}),this.nav.present(i)},n([c.Input(),s("design:type",Object)],t.prototype,"list",void 0),n([c.Input(),s("design:type",Boolean)],t.prototype,"isbutton",void 0),n([c.Input(),s("design:type",Boolean)],t.prototype,"is_enabled",void 0),n([c.Input(),s("design:type",Boolean)],t.prototype,"is_me",void 0),n([c.Input(),s("design:type",Boolean)],t.prototype,"preload",void 0),n([c.Input(),s("design:type",Boolean)],t.prototype,"ajax",void 0),n([c.Output(),s("design:type",c.EventEmitter)],t.prototype,"onChanged",void 0),t=n([c.Component({selector:"multi-select",template:'<div *ngIf="!list.hidden && !isbutton"><ion-item no-lines class="labels color">{{name}}:&nbsp;</ion-item></div><button [disabled]="!is_enabled" *ngIf="!list.hidden" (click)="open()" class="{{ isbutton? \'blue2 button-block\' : \'blue4\'}} {{ is_me ? \'left button-calc\' : \'width100\'}} disable-hover button button-default button-select"><ion-label class="{{isbutton ? \'center\' : \'tkts-table\'}}">Select {{name}}</ion-label><ion-icon [hidden]="isbutton" name="arrow-down"></ion-icon></button>',directives:[o.IONIC_DIRECTIVES]}),s("design:paramtypes",[o.Nav,a.ApiData,o.Config])],t)}();i.MultiSelectComponent=d},{"../../directives/helpers":19,"../../pages/modals/modals":41,"../../providers/api-data":70,"@angular/core":"@angular/core","ionic-angular":"ionic-angular"}],10:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),a=t("@angular/core"),r=t("../../directives/helpers"),c=t("../../pipes/pipes"),l=function(){function t(t){this.config=t,this.posts=[],this._posts=[],this.attachments=[]}return t.prototype.filter=function(){var t=[];t=this.is_showlogs?this.posts:this.posts.filter(function(t){return!!~["Initial Post","Response","Closed","ReOpened"].indexOf(t.log_type)}),this._posts=this.is_first?[t[0]]:t.slice(1)},t.prototype.ngOnInit=function(){this.filter()},t.prototype.ngOnChanges=function(t){if("is_showlogs"in t)return void this.filter();if("posts"in t){if("posts"in t&&(t.posts.isFirstChange()||(t.posts.currentValue[0]||{}).id==(t.posts.previousValue[0]||{}).id))return;this.filter()}},t.prototype.setDate=function(t,e,i){return t?(t=new Date(t.substring(0,23)+"Z"),r.getDateTime(t,e,i)):null},n([a.Input(),s("design:type",Array)],t.prototype,"posts",void 0),n([a.Input(),s("design:type",Array)],t.prototype,"attachments",void 0),n([a.Input(),s("design:type",Boolean)],t.prototype,"is_showlogs",void 0),n([a.Input(),s("design:type",Boolean)],t.prototype,"is_first",void 0),t=n([a.Component({selector:"posts-list",template:'<div><ion-card-content class="card-content" *ngFor="let post of _posts"><div></div><ion-avatar><img [alt]="post.user_firstname" [src]="post.user_email | Gravatar"><p>{{post.user_firstname || post.user_email}}</p></ion-avatar><span class="postlist"><p>{{post.record_date | Daysold}}</p><p>{{setDate(post.record_date, false, true)}}</p><p>{{post.log_type}}</p></span><p style="height: 60px">&nbsp;</p><p class="post-note textCopy postWhite" [innerHTML]="post.note | Linebreaks | Files : attachments" style="color: #ffffff;"></p><ion-item no-lines></ion-item></ion-card-content></div>',directives:[o.IONIC_DIRECTIVES],pipes:[c.LinebreaksPipe,c.GravatarPipe,c.DaysoldPipe,c.FilesPipe]}),s("design:paramtypes",[o.Config])],t)}();i.PostsListComponent=l},{"../../directives/helpers":19,"../../pipes/pipes":69,"@angular/core":"@angular/core","ionic-angular":"ionic-angular"}],11:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),a=t("@angular/core"),r=t("../../pages/queue-tickets/queue-tickets"),c=t("../../pipes/pipes"),l=function(){function t(t){this.nav=t,this.is_empty=!1}return t.prototype.ngOnChanges=function(t){if(this.simple&&"queues"in t){if(t.queues.isFirstChange()&&null!==t.queues.currentValue)return;this.is_empty=!t.queues.currentValue||0==t.queues.currentValue.length}},t.prototype.goToQueueTicketsPage=function(t){this.nav.push(r.QueueTicketsPage,t)},n([a.Input(),s("design:type",Object)],t.prototype,"queues",void 0),n([a.Input(),s("design:type",Boolean)],t.prototype,"simple",void 0),t=n([a.Component({selector:"queues-list",template:'<ion-list class="queues-list list" no-lines><a detail-none href="#" *ngFor="let queue of queues" class="queues" (click)="goToQueueTicketsPage(queue)"><span>{{queue.fullname}}</span> <span [innerHTML]="queue.tickets_count | More:[10000]"></span></a></ion-list><div *ngIf="is_empty" class="table grey2 menu-text">No Queues</div>',directives:[o.IONIC_DIRECTIVES],pipes:[c.MorePipe]}),s("design:paramtypes",[o.Nav])],t)}();i.QueuesListComponent=l},{"../../pages/queue-tickets/queue-tickets":48,"../../pipes/pipes":69,"@angular/core":"@angular/core","ionic-angular":"ionic-angular"}],12:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),a=t("../../providers/api-data"),r=t("../../directives/helpers"),c=t("@angular/core"),l=t("../../pages/modals/modals"),d=function(){function t(t,e,i){this.nav=t,this.apiData=e,this.config=i,this.is_enabled=!0,this.is_once=!1,this.onChanged=new c.EventEmitter(!1),this.selected={},this.init=!0,this.name="",this.list={}}return t.prototype.ngOnInit=function(){var t=this.list.name.toLowerCase();("project"==t&&!this.config.current.is_project_tracking||"location"==t&&!this.config.current.is_location_tracking||("contract"==t||"prepaid pack"==t)&&!this.config.current.is_invoice||"priority"==t&&!this.config.current.is_priorities_general||"account"==t&&!this.config.current.is_account_manager||"level"==t&&(!this.config.current.is_ticket_levels||this.config.current.is_restrict_tech_escalate&&!this.config.current.user.is_admin)||("resolution"==t||"category"==t)&&!this.config.current.is_resolution_tracking)&&(this.list.hidden=!0),this.is_enabled=!this.list.is_disabled,this.is_once=this.list.is_once,this.list.hidden||("tech"==t||"user"==t?this.name=(this.config.current.names[t]||{}).a:this.name=(this.config.current.names[t]||{}).s||this.list.name,this.list.url&&(this.url=this.list.url,this.preload&&this.loadData(!1)))},t.prototype.me=function(){var t=this.config.getCurrent("user"),e={id:t.user_id,name:r.getFullName(t.firstname,t.lastname,t.email)};this.emit_changed(e)},t.prototype.open=function(){this.is_enabled=!this.list.is_disabled,this.is_enabled&&this.loadData(!0)},t.prototype.loadData=function(t){var e=this;if(this.url==this.list.url&&this.list.items&&0!=this.list.items.length)this.proceed_list(t);else{var i=null;this.list.url?(t&&(i=o.Loading.create({content:"Please wait...",duration:2e3,dismissOnPageChange:!0}),this.nav.present(i)),this.apiData.get(this.list.url).subscribe(function(n){e.list.items=n,i&&i.dismiss(),e.proceed_list(t),e.url=e.list.url},function(t){i&&i.dismiss(),e.error("Cannot get "+e.name+" list! Error: "+t),console.log(t||"Server error")})):(this.list.hidden=!0,this.error(this.name+" list is empty!"))}},t.prototype.error=function(t){this.nav.alert(t,!0)},t.prototype.proceed_list=function(t){var e=this;if(!this.list.items||0==this.list.items.length)return this.list.value="Default (nothing to select)",void this.onChanged.emit({type:this.name.split(" ").join("").toLowerCase(),id:0});if(t){if(!this.list.items[0].name){var i=[];this.list.items.forEach(function(t){var n,s=t.id;t.email?n=r.getFullName(t.firstname,t.lastname,t.email,e.isbutton?"":" "):t.number?n="#"+t.number+": "+t.subject:t.prepaid_pack_id&&(n=t.prepaid_pack_name,s=t.prepaid_pack_id),i.push({id:s,name:n,email:t.email})}),this.list.items=i}this.openModal()}},t.prototype.emit_changed=function(t){t&&this.is_once&&(this.is_enabled=!1),this.list.value=t.name,t.type=this.list.name.split(" ").join("").toLowerCase(),this.onChanged.emit(t)},t.prototype.openRadio=function(){var t=this,e=this.name,i=o.Alert.create({title:"Choose "+e,buttons:[{text:"Cancel",role:"cancel",handler:function(){console.log("Cancel clicked")}},{text:"OK",handler:function(e){e&&(t.selected=e,t.emit_changed(e))}}]});this.list.items.forEach(function(t){i.addInput({type:"radio",label:t.name,value:t})}),this.nav.present(i)},t.prototype.openModal=function(){var t=this;this.list.isbutton=this.isbutton;var e=this.list.items.length||0,i=e>=25&&e%25==0?l.InfinitySelectModal:l.BasicSelectModal,n=o.Modal.create(i,this.list);n.onDismiss(function(e){e.name&&(t.selected=e,t.emit_changed(e))}),this.nav.present(n)},n([c.Input(),s("design:type",Object)],t.prototype,"list",void 0),n([c.Input(),s("design:type",Boolean)],t.prototype,"isbutton",void 0),n([c.Input(),s("design:type",Boolean)],t.prototype,"is_enabled",void 0),n([c.Input(),s("design:type",Boolean)],t.prototype,"is_once",void 0),n([c.Input(),s("design:type",Boolean)],t.prototype,"is_me",void 0),n([c.Input(),s("design:type",Boolean)],t.prototype,"preload",void 0),n([c.Input(),s("design:type",Boolean)],t.prototype,"ajax",void 0),n([c.Output(),s("design:type",c.EventEmitter)],t.prototype,"onChanged",void 0),t=n([c.Component({selector:"select-list",template:'<div *ngIf="!list.hidden && !isbutton"><ion-item no-lines class="labels color">{{name}}:&nbsp;</ion-item><button [disabled]="!is_enabled" *ngIf="!list.hidden" (click)="open()" class="blue4 {{ is_me ? \'left button-calc\' : \'width100\'}} disable-hover button button-default button-select"><ion-label class="tkts-table">{{list.value}}</ion-label><ion-icon name="arrow-down"></ion-icon></button></div><div *ngIf="!list.hidden && isbutton"><ion-icon [disabled]="!is_enabled" *ngIf="!list.hidden" (click)="open()" name="add-circle" role="img" class="ion-ios-add-circle item-icon" aria-label="add circle" style="font-size: 1.8em; position: relative; top: 4px; color: #64be42"></ion-icon></div><button *ngIf="is_me" class="buttonTicket button-ticket attach right color" (click)="me()"><u>Me</u></button>',directives:[o.IONIC_DIRECTIVES]}),s("design:paramtypes",[o.Nav,a.ApiData,o.Config])],t)}();i.SelectListComponent=d},{"../../directives/helpers":19,"../../pages/modals/modals":41,"../../providers/api-data":70,"@angular/core":"@angular/core","ionic-angular":"ionic-angular"}],13:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),a=t("@angular/core"),r=t("../../pages/tech-tickets/tech-tickets"),c=t("../../pipes/pipes"),l=function(){function t(t,e){this.nav=t,this.config=e,this.is_empty=!1}return t.prototype.itemTapped=function(t,e){},t.prototype.goToTechTicketsPage=function(t){this.nav.push(r.TechTicketsPage,t)},t.prototype.ngOnChanges=function(t){if(this.simple&&"technicians"in t){if(t.technicians.isFirstChange()&&null!==t.technicians.currentValue)return;this.is_empty=!t.technicians.currentValue||0==t.technicians.currentValue.length}},n([a.Input(),s("design:type",Array)],t.prototype,"technicians",void 0),n([a.Input(),s("design:type",Boolean)],t.prototype,"simple",void 0),t=n([a.Component({selector:"techs-list",template:'<ion-list class="list" no-lines><div *ngIf="!simple && technicians?.length" class="flexed color"><div detail-none><span>&nbsp;&nbsp;&nbsp;</span> <span>{{config.current.names.ticket.ap}}</span></div></div><div class="accountlist flexed"><div detail-none href="#" *ngFor="let technician of technicians" (click)="goToTechTicketsPage(technician)"><span>{{technician.firstname}} {{technician.lastname}}</span> <span [innerHTML]="technician.opencount | More:[1000]"></span></div></div></ion-list><div *ngIf="is_empty && !simple" class="table grey2 menu-text">No Technicians</div>',directives:[o.IONIC_DIRECTIVES],pipes:[c.MorePipe]}),s("design:paramtypes",[o.Nav,o.Config])],t)}();i.TechniciansListComponent=l},{"../../pages/tech-tickets/tech-tickets":52,"../../pipes/pipes":69,"@angular/core":"@angular/core","ionic-angular":"ionic-angular"}],14:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),a=t("@angular/core"),r=t("../../providers/ticket-provider"),c=t("../../pages/ticket-details/ticket-details"),l=t("../../pages/modals/modals"),d=t("../../directives/helpers"),u=t("../../pipes/pipes"),p=function(){function t(t,e,i,n){this.nav=t,this.navParams=e,this.config=i,this.ticketProvider=n,this.LIMIT=6,this.is_empty=!1,this.pager={page:0,limit:this.LIMIT}}return t.prototype.ngOnChanges=function(t){},t.prototype.ngOnInit=function(){var t=this;this.he=this.config.getCurrent("user"),this.cachename=this.mode[0]+(this.mode[1]||"")+(this.mode[2]||""),this.cachelen=(this.ticketProvider._dataStore[this.cachename]||{}).length,"all"==this.mode[0]&&(this.pager.limit=this.LIMIT=15),this.preload&&!this.cachelen?setTimeout(function(){t.onLoad()},this.preload):this.onLoad()},t.prototype.onLoad=function(){var t=this;if(this.mode){var e=this.config.getStat("tickets")[this.mode[0]];if(this.count=e?e:this.count,0!==this.count){if(this.ticketProvider.getTicketsList(this.mode[0],this.mode[1],this.mode[2],this.pager),this.tickets=this.ticketProvider.tickets$[this.cachename],!this.ticketProvider._dataStore[this.cachename].length){var i=setTimeout(function(){t.busy=!0},500);this.tickets.subscribe(function(e){clearTimeout(i),t.busy=!1,t.is_empty=!e.length})}}else this.is_empty=!0}},t.prototype.itemTapped=function(t,e,i){"ION-ITEM-SLIDING"!=t.srcElement.tagName.toUpperCase()&&(i.close(),e.clicked=!0,e.cachename=this.cachename,e.technician_email==this.he.email&&(e.is_new_tech_post=!1),e.technician_email==this.he.email&&(e.is_new_user_post=!1),this.nav.push(c.TicketDetailsPage,e))},t.prototype.addPost=function(t,e){var i=this;e.close();var n=o.Alert.create({title:"Add Response to #"+t.number,inputs:[{name:"note",placeholder:"Note"}],buttons:[{text:"Cancel",handler:function(t){console.log("Cancel clicked")}},{text:"Post",handler:function(e){if(e.note.trim()){var n=d.htmlEscape(e.note.trim()).substr(0,5e3);i.ticketProvider.addTicketPost(t.id,n).subscribe(function(t){i.nav.alert("Note added :)")},function(t){i.nav.alert(t,!0),console.log(t||"Server error")})}}}]});this.nav.present(n)},t.prototype.closeTicket=function(t,e){var i=this;if(e.close(),"Closed"==t.status)return void this.reopenTicket(t);var n=o.Modal.create(l.CloseTicketModal,t);n.onDismiss(function(e){e&&(i.count-=e,i.ticketProvider._dataStore[i.cachename].splice(i.ticketProvider._dataStore[i.cachename].indexOf(t),1),i.ticketProvider.getTicketsList(i.mode[0],i.mode[1],i.mode[2],{limit:25}),i.count<1?i.is_empty=!0:i.is_empty=!1)}),this.nav.present(n)},t.prototype.reopenTicket=function(t){var e=this,i={status:"open",note_text:""};this.ticketProvider.closeOpenTicket(t.key,i).subscribe(function(i){e.nav.alert("Ticket has been Reopened!"),t.status="Open"},function(t){e.nav.alert(t,!0),console.log(t||"Server error")})},t.prototype.doInfinite=function(t){var e=this;if(this.is_empty||this.count>0&&this.count<this.LIMIT||this.cachelen>0&&(this.cachelen>=this.count||this.cachelen<this.LIMIT))return t.enable(!1),void t.complete();this.pager.page+=1;var i=(this.ticketProvider._dataStore[this.cachename]||{}).length;this.ticketProvider.getTicketsList(this.mode[0],this.mode[1],this.mode[2],this.pager),this.tickets.subscribe(function(n){t.complete();var s=n.length;t.enable(!(i==s||s%e.LIMIT)),e.cachelen=s})},n([a.Input(),s("design:type",Array)],t.prototype,"mode",void 0),n([a.Input(),s("design:type",Number)],t.prototype,"count",void 0),n([a.Input(),s("design:type",Number)],t.prototype,"preload",void 0),n([a.Input(),s("design:type",String)],t.prototype,"filter",void 0),t=n([a.Component({selector:"tickets-list",template:'<ion-content style="height: 90vh;"><ion-list class="Tktlist indent-bottom general-alignment2" no-lines><img *ngIf="busy" class="imglogo img-padding" src="img/loading2.gif"><ion-item-sliding class="border" *ngFor="let ticket of tickets | async" #slidingItem><a detail-none href="#" ion-item (click)="itemTapped($event, ticket, slidingItem)" class="item margin" [class.only-click]="!ticket.clicked" [class.activated]="ticket.clicked"><ion-avatar padding item-left><li><span item-left>#{{ticket.number}}</span> <img class="img_avatar" [alt]="ticket.user_firstname" [src]="ticket.user_email | Gravatar"><p>{{ticket.user_firstname}} {{ticket.user_lastname}}</p></li></ion-avatar><div class="alignment"><li><h2><ion-icon *ngIf="(ticket.is_new_tech_post && ticket.technician_email != he.email) || (ticket.is_new_user_post && ticket.user_email != he.email)" dark name="mail">&nbsp;</ion-icon><span *ngIf="ticket.status == \'On Hold\'" style="color:#CA7C16 !important">(On&nbsp;Hold)&nbsp;</span>{{ticket.subject | Htmlsafe}}</h2><h4 *ngIf="ticket.next_step != \'\'" class="width90 span-left" style="margin-top: -5px; margin-bottom: 5px; padding: 0px !important;">( {{ticket.next_step}} - <span class="grey3_color">{{ticket.next_step_date | Daysago}}</span> )</h4><h3 [innerHTML]="ticket.initial_post | Linebreaks" class="postGrey" style="color: #dadada;"></h3><p>{{ticket.class_name}}&nbsp;</p></li></div></a><ion-item-options><button (click)="addPost(ticket, slidingItem)" class="grey3 disable-hover button button-default"><ion-icon></ion-icon>Add Response</button> <button (click)="closeTicket(ticket, slidingItem)" class="disable-hover button button-default close-ticket"><ion-icon></ion-icon><p class="close-ticket2">{{ticket.status != \'Closed\' ? "Close" : "ReOpen"}} {{config.current.names.ticket.a}}</p></button></ion-item-options></ion-item-sliding></ion-list><div *ngIf="is_empty" class="table grey2 menu-text">No {{mode[0] | Capitalize}} {{config.current.names.ticket.p}} yet</div><ion-infinite-scroll threshold="30%" (infinite)="doInfinite($event)"><ion-infinite-scroll-content loadingSpinner="circles" loadingText="Loading more data..."></ion-infinite-scroll-content></ion-infinite-scroll></ion-content>',directives:[o.IONIC_DIRECTIVES],pipes:[u.GravatarPipe,u.LinebreaksPipe,u.CapitalizePipe,u.DaysagoPipe,u.HtmlsafePipe]}),s("design:paramtypes",[o.Nav,o.NavParams,o.Config,r.TicketProvider])],t)}();i.TicketsListComponent=p},{"../../directives/helpers":19,"../../pages/modals/modals":41,"../../pages/ticket-details/ticket-details":54,"../../pipes/pipes":69,"../../providers/ticket-provider":75,"@angular/core":"@angular/core","ionic-angular":"ionic-angular"}],15:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),a=t("@angular/core"),r=t("../../providers/todo-provider"),c=t("../../pages/todo-create/todo-create"),l=t("../../directives/helpers"),d=t("../../pages/ticket-details/ticket-details"),u=function(){function t(t,e,i,n){this.nav=t,this.todoProvider=e,this.config=i,this.navParams=n,this.ticket="",this.user="",this.LIMIT=5e3,this.is_empty=!1,this.is_empty_list=!0,this.undone=0,this.initial_load=!0,this.is_empty=!1,this.pager={page:0,limit:this.LIMIT}}return t.prototype.ngOnInit=function(){this.config.current.user.is_techoradmin&&(this.hidden=this.simple,this.is_empty_list=this.simple,this.params=this.navParams.data||{},this.params.user={id:this.params.user_id||this.config.current.user.user_id,name:this.params.user_name||""},this.user&&(this.params.user.id="all"==this.user?"":this.user),this.cachename="todos",this.params.user.id&&(this.cachename=l.addp(this.cachename,"assigned_id",this.params.user.id)),this.ticket&&(this.cachename=l.addp(this.cachename,"ticket",this.ticket||"")),this.cachelen=(this.todoProvider._dataStore[this.cachename]||{}).length,this.params.is_empty&&(this.params.count=0),this.getTodos())},t.prototype.getTodos=function(){var t=this;this.todoProvider.getTodos(this.params.user.id,this.ticket,this.pager),this.todoLists=this.todoProvider.todos$[this.cachename];var e=setTimeout(function(){t.busy=!0},500);setTimeout(function(){t.busy=!1},3e3),this.todoLists.subscribe(function(i){clearTimeout(e);var n=[];i.length&&0==i.filter(function(t){return 1==t.type}).length&&(n[0]=i[0],n[0].sub=i,i=n),t.busy=!1,t.is_empty=!i.length;var s=0,o=0;for(var a in i)for(var r in i[a].sub)o++,i[a].sub[r].is_completed||s++;t.undone=s,t.is_empty_list=t.simple&&!o})},t.prototype.AddTodo=function(t){t.hidden=!(t.sub||{}).length||!t.hidden;var e=o.Modal.create(c.TodoCreatePage,{list_id:(t||{}).list_id||""});this.nav.present(e)},t.prototype.setDone=function(t){this.undone=Math.max(t.is_completed?--this.undone:++this.undone,0);var e="todos?assigned_id="+this.config.current.user.user_id;((this.todoProvider._dataStore[e].filter(function(e){return e.list_id==t.list_id})||[{}])[0].sub.filter(function(e){return e.id==t.id})[0]||{}).is_completed=t.is_completed,this.todoProvider.setCompletedTodo(t.id,t.is_completed)},t.prototype.setDate=function(t,e,i){if(t){var n=this.config.getCurrent("timezone_offset");return t=new Date(t.substring(0,23)+"Z"),t=new Date(t.setTime(t.getTime()+60*n*60*1e3)).toJSON(),l.getDateTime(t,e,i)}return null},t.prototype.getFixed=function(t){return t=(t||"0").toString(),~t.indexOf(".")?Number(t).toFixed(2).toString():t},t.prototype.itemTapped=function(t){t.hidden=!(t.sub||{}).length||!t.hidden;var e={key:t.list_ticket_id};this.nav.push(d.TicketDetailsPage,e)},n([a.Input(),s("design:type",Boolean)],t.prototype,"simple",void 0),n([a.Input(),s("design:type",String)],t.prototype,"ticket",void 0),n([a.Input(),s("design:type",String)],t.prototype,"user",void 0),t=n([a.Component({selector:"todo-list",template:'<div class="todos list general-alignment" [hidden]="is_empty_list || !config.current.user.is_techoradmin"><img *ngIf="busy && !simple" class="imglogo img-padding" src="img/loading2.gif"><div *ngIf="is_empty && !simple && !ticket" class="table grey2 menu-text">No ToDo\'s yet</div><div *ngIf="simple" class="blue1back alignment-bottom" style="height: 50px;" (click)="hidden = !hidden"><span><ion-icon [ngClass]="{\'ion-ios-arrow-down font18 margin-top3 margin-right10\':!hidden, \'pr8 button-arrow ion-ios-arrow-forward padding-top5\':hidden}" class="left todos-arrow padding-left15 left" role="img"></ion-icon><h5 style="color:white; padding-top: 7px;">ToDo\'s</h5></span> <button fab class="right buttonInvoice email-invoice position-initial margin-right10 general-alignment2">{{undone}}</button></div><block [hidden]="hidden"><template ngFor let-todoList [ngForOf]="todoLists | async" let-even="even" let-odd="odd"><div [ngClass]="{\'\': todoList.sub?.length}" (click)="todoList.hidden = !todoList.sub?.length || !todoList.hidden"><ion-icon [style.visibility]="!todoList.sub?.length ?\'hidden\':\'inherit\'" role="img" [ngClass]="{\'ion-ios-arrow-down font18 margin-right10\':!todoList.hidden, \'pr8 button-arrow ion-ios-arrow-forward left\':todoList.hidden}" class="todos-arrow padding-left15"></ion-icon><h5 class="color">{{todoList.name}} <span *ngIf="todoList.list_ticket_id && !ticket" (click)="itemTapped(todoList)" class="ticketNumber">(Tkt #{{todoList.list_ticket_number}}<ion-icon class="outline ion-ios-open-outline" name="ios-open-outline" role="img" aria-label="open outline"></ion-icon><span class="TktSubject">{{todoList.list_ticket_subject}}</span>)</span></h5><ion-icon (click)="AddTodo(todoList)" name="md-add" role="img" style="padding-right: 10px;" [ngClass]="{\'\':!todoList.sub?.length, \'color\':!todoList.sub?.length}" class="ion-md-add padding-left15 todos-arrow right" aria-label="arrow down"></ion-icon></div><template [ngIf]="!todoList?.hidden"><template ngFor let-todo [ngForOf]="todoList?.sub" let-last="last" let-even="seven" let-odd="sodd"><div (click)="todo.is_completed = !todo.is_completed;setDone(todo)"><ion-icon [ngClass]="{\'ion-ios-checkmark-circle secondary\' : todo.is_completed, \'ion-ios-radio-button-on grey2\' : !todo.is_completed}" class="font18 todos-padding margin-top3"></ion-icon><h5 [ngClass]="{\'color decoration_line grey3_color\' : todo.is_completed, \'color\' : !todo.is_completed}" class="textCopy"><span style="font-size: 1.6rem">{{todo.title}}<i *ngIf="todo.text">{{" - " + todo.text}}</i></span></h5></div><div class="todos-flex right color"><h6></h6><h6 *ngIf="todo.assigned_name && !simple">{{todo.assigned_name}}</h6><h6 *ngIf="todo.due_date">Due&nbsp;{{setDate(todo.due_date)}}</h6><h6 *ngIf="todo.estimated_remain">{{getFixed(todo.estimated_remain)}}&nbsp;hrs</h6></div><hr *ngIf="!last" class="width_calc100-40"></template></template><hr class="width100"></template></block></div>',
directives:[o.IONIC_DIRECTIVES]}),s("design:paramtypes",[o.Nav,r.TodoProvider,o.Config,o.NavParams])],t)}();i.TodoListComponent=u},{"../../directives/helpers":19,"../../pages/ticket-details/ticket-details":54,"../../pages/todo-create/todo-create":58,"../../providers/todo-provider":77,"@angular/core":"@angular/core","ionic-angular":"ionic-angular"}],16:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),a=t("@angular/core"),r=function(){function t(){this.onSelectedChanged=new a.EventEmitter}return t.prototype.onSelectNode=function(t){this.onSelectedChanged.emit(t)},t.prototype.onExpand=function(t){t.sub&&(t.isExpanded=!t.isExpanded)},t.prototype.onRequest=function(t){console.log("inner request")},n([a.Input(),s("design:type",Array)],t.prototype,"Nodes",void 0),n([a.Input(),s("design:type",Object)],t.prototype,"SelectedNode",void 0),n([a.Output(),s("design:type",a.EventEmitter)],t.prototype,"onSelectedChanged",void 0),t=n([a.Component({selector:"tree-view",template:'<ul class="inner"><li *ngFor="let node of Nodes" class="list-tree"><a detail-none href="#" (click)="onSelectNode(node); onExpand(node)"><span><li class="left icon-class"><ion-icon [hidden]="node != SelectedNode" class="button-arrow margin-top-2" name="checkmark" role="img" aria-label="checkmark"></ion-icon></li>{{node.name}}</span><ion-icon [hidden]="!node.sub" name="ios-arrow-{{node.isExpanded ? \'down\' : \'forward\'}}" role="img" class="button-arrow right" aria-label="arrow"></ion-icon></a><tree-view [Nodes]="node.sub" [SelectedNode]="SelectedNode" (onSelectedChanged)="onSelectNode($event)" *ngIf="node.isExpanded"></tree-view></li></ul>',directives:[t,o.IONIC_DIRECTIVES]}),s("design:paramtypes",[])],t)}();i.TreeViewComponent=r},{"@angular/core":"@angular/core","ionic-angular":"ionic-angular"}],17:[function(t,e,i){"use strict";function n(t){for(var e in t)i.hasOwnProperty(e)||(i[e]=t[e])}n(t("./focuser"))},{"./focuser":18}],18:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("@angular/core"),a=function(){function t(t,e){this.renderer=t,this.elementRef=e}return t.prototype.ngOnInit=function(){return},t=n([o.Directive({selector:"[focuser]"}),s("design:paramtypes",[o.Renderer,o.ElementRef])],t)}();i.Focuser=a},{"@angular/core":"@angular/core"}],19:[function(t,e,i){"use strict";function n(t,e){localStorage.setItem(t,JSON.stringify(e||{}))}function s(t){return JSON.parse(localStorage.getItem(t))}function o(t){var e=RegExp("[?&]"+t+"=([^&]*)").exec(window.location.href);return e&&decodeURIComponent(e[1].replace(/\+/g," "))}function a(t,e){var i=l(location.origin+location.pathname,t,e);try{window.history.replaceState({},"",i)}catch(n){}}function r(t){var e=!1;if(!e&&!confirm("Do you want to stay logged in Google account?")){"https://www.google.com/accounts/Logout?continue=https://appengine.google.com/_ah/logout?continue="+C.MobileSite}}function c(t){if(!t||t.length<9)return null;if("undefined"!=typeof window.DOMParser)return(new window.DOMParser).parseFromString(t,"text/xml");if("undefined"!=typeof window.ActiveXObject&&new window.ActiveXObject("Microsoft.XMLDOM")){var e=new window.ActiveXObject("Microsoft.XMLDOM");return e.async="false",e.loadXML(t),e}return console.log("No XML parser found"),null}function l(t,e,i){if(!t||!i||!e)return t;var n=t.indexOf(e+"=");if(-1!=n)return t.slice(0,n+e.length)+"="+i;var s=t.indexOf("?")>0?"&":"?";return t+s+e+"="+i}function d(t,e,i,n){var s=C.AppSite;e&&(s=l(s,"tkt",e)),s=l(s,"dept",i),s=l(s,"org",n),g(s)}function u(t,e,i){var n="mailto:r."+i+"."+e+"."+t+"@app.sherpadesk.com";g(n)}function p(t){return String(t).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function h(t,e){t=(t||"").trim();var i=e;return t.length&&(t=t.replace(/&lt;br&gt;/gi,"\n").replace(/<br\s*[\/]?>/gi,"\n").replace(/\r/g,"").replace(/\n\n/g,i?"\n":"<br>")),t}function m(t){return window.open(t,"_blank","location=no,EnableViewPortScale=yes")}function g(t){if("true"===localStorage.getItem("isPhonegap")&&device){if("ANDROID"===device.platform.toUpperCase())return navigator.app.loadUrl(t,{openExternal:!0});if("IOS"===device.platform.toUpperCase())return window.open(t,"_system")}return window.open(t,"_blank")}function f(t){return String(t).replace(/&lt;br&gt;/gi,"\n").replace(/<br\s*[\/]?>/gi,"\n").replace(/\n/g,"<p></p>")}function v(t,e){var i="";return i=t?"1"!==localStorage.getItem("dateformat")?"MMM DD / YYYY":"DD MMM YYYY":"1"!==localStorage.getItem("dateformat")?"MM/DD/YYYY":"DD/MM/YYYY",i+(e?"1"!==localStorage.getItem("timeformat")?" hh:mm A":" HH:mm":"")}function b(t,e){var i="";return i=t?"1"!==localStorage.getItem("dateformat")?"mmm d / yyyy":"d mmm yyyy":"1"!==localStorage.getItem("dateformat")?"m/d/yy":"d/m/yy",i+(e?"1"!==localStorage.getItem("timeformat")?" hh:MM TT":" HH:MM":"")}function _(t,e,i){return T(t,b(e,i))}function y(t){return localStorage.getItem("currency")+Number(t||"0").toFixed(2).toString()}function k(t,e,i,n){var s="";return n&&(s=n+" "),e&&(s+=e+" "),t&&(s+=t+" "),i&&i.indexOf("@")>0&&(s.trim()?n&&(s+=" ("+i+")"):s=i),s||"NoName"}function w(t){return t.replace(/\w\S*/g,function(t){return t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()})}function x(t){var e=document.referrer,i=window.location.href,n="1",s=t||"",o="102459",a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src="https://www.getapp.com/conversion/"+encodeURIComponent(o)+"/r.js?p="+encodeURIComponent(n)+"&h="+encodeURIComponent(i)+"&r="+encodeURIComponent(e)+"&e="+encodeURIComponent(s);var r=document.getElementsByTagName("script")[0];r.parentNode.insertBefore(a,r)}function P(){var t=new Image,e=document.getElementsByTagName("body")[0];t.onload=function(){e.appendChild(t)},t.src="http://px.spiceworks.com/px/8oxz";var i=i||{};i.cmd=i.cmd||[],i.cmd.push(function(){i.pixel.setPixel("8oxz"),i.pixel.setIdentifier("121806"),i.pixel.fire()})}var C=t("../providers/config");i.saveCache=n,i.loadCache=s,i.getParameterByName=o,i.cleanQuerystring=a,i.GooglelogOut=r,i.parseXml=c,i.addp=l,i.fullapplink=d,i.mailtolink=u,i.htmlEscape=p,i.linebreaks=h,i.FileUrlHelper={isPhonegap:function(){return"true"===localStorage.getItem("isPhonegap")},ReplaceAll:function(t,e,i){return t.split(e).join(i)},checkURL:function(t){return t?null!==t.trim().match(/.(jpeg|jpg|gif|png|ico)/i):!1},matchKey:function(t,e){for(var i=Object.keys(e),n=i.length;n-- >0;){var s=i[n];if(s=s.replace(/[^0-9a-z]/gi,""),-1!=s.indexOf(t))return i[n]}return""},addUrls:function(t,e){var n=e.length,s={};if(n){for(var o=t.match(/\[cid:[^\[\]]*]/g),a=0;n>a;a++){var r=e[a].name;t=i.FileUrlHelper.ReplaceAll(t," "+r,e[a].is_deleted?"":i.FileUrlHelper.getFileLink(e[a].url,r)),s['"'+r.substring(0,r.lastIndexOf("."))+'"']=e[a].url}if(o)for(var c=0;c<o.length;c++){var l=o[c].slice(5,-1);l.indexOf("_link_")>=0?l=l.replace("_link_",""):(l=i.FileUrlHelper.matchKey(l.slice(0,-3),s),l=l&&"undefined"!=typeof s[l]?s[l]:""),l.length&&(t=i.FileUrlHelper.ReplaceAll(t,o[c],i.FileUrlHelper.getFileLink(l,o[c].slice(5,-1))))}n>1&&(t=i.FileUrlHelper.ReplaceAll(t,"a>,","a>")),t=i.FileUrlHelper.ReplaceAll(t,"a>.","a>")}return t},getFileLink:function(t,e){var n="";return n=i.FileUrlHelper.checkURL(t)||i.FileUrlHelper.checkURL(e)?'<img class="attachment" src="'+t+'">':'<ion-icon name="md-document" role=img dark class="button_circle ion-md-document" aria-label="md-document"></ion-icon>&nbsp;<span class="decoration width100 color">'+(e||decodeURIComponent(t.split("/").slice(-1)))+"</span><p></p>",'<p/><a class="comment_image_link files-tkts color margin-right_10"'+(i.FileUrlHelper.isPhonegap()?" href=# onclick='window.open(\""+t+'", "_blank", "location=no,EnableViewPortScale=yes")\'>'+n+"</a>":' target="_blank" href="'+t+'">'+n+"</a>")}},i.openURL=m,i.openURLsystem=g,i.symbolEscape=f,i.getPickerDateTimeFormat=v,i.getDateTime=_,i.getCurrency=y,i.getFullName=k,i.toTitleCase=w,i.getappTrackConversion=x,i.spicePixelTrackConversion=P;var T=function(t,e,i){var n=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,s=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,o=/[^-+\dA-Z]/g,a=function(t,e){for(t=String(t),e=e||2;t.length<e;)t="0"+t;return t};return function(t,e,i){var r=T;if(1!=arguments.length||"[object String]"!=Object.prototype.toString.call(t)||/\d/.test(t)||(e=t,t=void 0),t=t?new Date(t):new Date,isNaN(t))throw SyntaxError("invalid date");e=String(r.masks[e]||e||r.masks["default"]),"UTC:"==e.slice(0,4)&&(e=e.slice(4),i=!0);var c=i?"getUTC":"get",l=t[c+"Date"](),d=t[c+"Day"](),u=t[c+"Month"](),p=t[c+"FullYear"](),h=t[c+"Hours"](),m=t[c+"Minutes"](),g=t[c+"Seconds"](),f=t[c+"Milliseconds"](),v=i?0:t.getTimezoneOffset(),b={d:l,dd:a(l),ddd:r.i18n.dayNames[d],dddd:r.i18n.dayNames[d+7],m:u+1,mm:a(u+1),mmm:r.i18n.monthNames[u],mmmm:r.i18n.monthNames[u+12],yy:String(p).slice(2),yyyy:p,h:h%12||12,hh:a(h%12||12),H:h,HH:a(h),M:m,MM:a(m),s:g,ss:a(g),l:a(f,3),L:a(f>99?Math.round(f/10):f),t:12>h?"a":"p",tt:12>h?"am":"pm",T:12>h?"A":"P",TT:12>h?"AM":"PM",Z:i?"UTC":(String(t).match(s)||[""]).pop().replace(o,""),o:(v>0?"-":"+")+a(100*Math.floor(Math.abs(v)/60)+Math.abs(v)%60,4),S:["th","st","nd","rd"][l%10>3?0:Number(l%100-l%10!=10)*l%10]};return e.replace(n,function(t){return t in b?b[t]:t.slice(1,t.length-1)})}}();T.masks={"default":"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"},T.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]}},{"../providers/config":71}],20:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),a=t("../../providers/providers"),r=t("../../providers/data-provider"),c=t("../timelogs/timelogs"),l=t("../contracts/contracts"),d=t("../../directives/helpers"),u=t("../../components/tickets-list/tickets-list"),p=t("../ticket-details/ticket-details"),h=t("../../components/action-button/action-button"),m=t("../../pipes/pipes"),g=t("../expenses/expenses"),f=t("../ajax-search/ajax-search"),v=function(){function t(t,e,i,n,s,o,a){this.nav=t,this.navParams=e,this.apiData=i,this.dataProvider=n,this.ticketProvider=s,this.config=o,this.view=a,this.is_editnote=!0,this.is_ready=!1,this.term="",this.details_tab="Stat",this.pages=[l.ContractsPage,g.ExpensesPage,c.TimelogsPage]}return t.prototype.onPageDidEnter=function(){var t=document.getElementsByClassName("searchbar-input");t=t[t.length-1],t&&t.focus()},t.prototype.onPageLoaded=function(){this.account=this.navParams.data||{},this.details_tab="Stat",this.tabsTicket="Open"},t.prototype.onPageWillEnter=function(){var t=this;this.ticketProvider.getTicketsList("open",this.account.id,"",{limit:25}),this.view.setBackButtonText(""),this.dataProvider.getAccountDetails(this.account.id).subscribe(function(e){t.account=e,t.is_editnote=!(t.account.note||"").length,t.is_ready=!0},function(t){console.log(t||"Server error")})},t.prototype.saveNote=function(t){var e=this,i=(t.value||"").trim();i!=(this.account.note||"").trim()?this.dataProvider.addAccountNote(this.account.id,i).subscribe(function(t){return e.saveNoteSuccess(i)},function(t){console.log(t||"Server error")}):this.saveNoteSuccess(i)},t.prototype.saveNoteSuccess=function(t){this.nav.alert("Note saved :)"),this.account.note=(t||"").trim(),this.is_editnote=!this.account.note.length},t.prototype.onDelete=function(t){var e=this,i={file_id:t.id};this.dataProvider.deleteFile(i).subscribe(function(i){e.account.files=e.account.files.filter(function(e){return e!==t}),e.nav.alert("File "+t.name+" deleted!")},function(t){console.log(t||"Server error")})},t.prototype.openPage=function(t,e){var i=this;setTimeout(function(){return i.nav.push(i.pages[t],{is_empty:!e&&!i.is_ready,account_id:i.account.id||"-1",account_name:i.account.name})},this.is_ready?0:2e3)},t.prototype.getFileLink=function(t){return d.FileUrlHelper.getFileLink(t.url,t.name)},t.prototype.addFilesButton=function(){console.log("Function connect")},t.prototype.gotoTicket=function(t){var e=this;this.test=!1,this.clearSearch(),t&&setTimeout(function(){e.nav.push(p.TicketDetailsPage,t)},500)},t.prototype.searchItems=function(t){var e=this;this.search_results=[];var i=t.value;if(""!=i.trim()&&!this.busy&&i.length>1){var n=setTimeout(function(){e.busy=!0},500);this.searchItemsAPI(i,n)}},t.prototype.searchItemsAPI=function(t,e){var i=this;this.search_results=[];var n="tickets?query=all&account="+this.account.id,s={limit:3};this.apiData.getPaged(d.addp(n,"search",t+"*"),s).subscribe(function(t){e&&(clearTimeout(e),i.busy=!1),i.search_results=t},function(t){e&&(clearTimeout(e),i.busy=!1),console.log(t||"Server error")})},t.prototype.clearSearch=function(t){this.search_results=[],this.busy=!1,t&&(t.value="")},t.prototype.getSearch=function(t){this.test=!1,this.clearSearch();var e=t.target.value;e.length<4&&(e+="    ");var i={search:e,location:this.account};this.test=!1,this.nav.push(f.AjaxSearchPage,i)},t.prototype.toggle=function(){this.test=!this.test,this.test&&setTimeout(function(){var t=document.getElementsByClassName("searchbar-input");t=t[t.length-1],t&&t.focus()},500)},t=n([o.Page({template:'<ion-navbar *navbar><button menuToggle><ion-icon name="menu"></ion-icon></button><ion-title class="padding-right24">{{account.name}}</ion-title><ion-buttons end><button danger class="right transparent" (click)="toggle()"><ion-icon name="ios-search"></ion-icon></button></ion-buttons></ion-navbar><ion-content class="account-details"><ion-searchbar *ngIf="test" [focuser] debounce="700" (cancel)="test = !test" (input)="searchItems($event)" [(ngModel)]="term" placeholder="Enter to search {{config.current.names.ticket.p}}" (search)="getSearch($event)"></ion-searchbar><img *ngIf="busy" class="imglogo" src="img/loading2.gif"><ion-list class="ajax" [hidden]="!search_results"><a detail-none href="#" ion-item *ngFor="let item of search_results" (click)="gotoTicket(item)"><h2>{{item.status}} | #{{item.number}} - {{item.subject}} ({{item.user_firstname}} {{item.user_lastname}})</h2></a></ion-list><ion-segment [(ngModel)]="details_tab"><ion-segment-button value="Stat">{{config.current.names.account.a}} Stat</ion-segment-button><ion-segment-button value="Info">Info</ion-segment-button><ion-segment-button *ngIf="config.current.is_project_tracking" value="Projects">Projects</ion-segment-button><ion-segment-button value="Notes">Notes</ion-segment-button><ion-segment-button value="Files">Files</ion-segment-button></ion-segment><div [ngSwitch]="details_tab"><div [hidden]="details_tab != \'Stat\'"><ion-list class="list img-top" no-lines><div class="blue1 left width65 img-top"><a detail-none href="#tickets" ion-item class="textLogin">Open {{config.current.names.ticket.ap}}</a> <a *ngIf="config.current.is_invoice && config.current.is_time_tracking" detail-none href="#" ion-item (click)="openPage(0,account.account_statistics.contracts)" class="textLogin">Contracts</a> <a *ngIf="config.current.is_expenses" detail-none href="#" ion-item (click)="openPage(1, account.account_statistics.expenses)" class="textLogin">Expenses</a> <a *ngIf="config.current.is_time_tracking" detail-none href="#" ion-item (click)="openPage(2, account.account_statistics.hours)" class="textLogin">Hours</a></div><div class="right width35 img-top"><a detail-none href="#tickets" ion-item class="blue2">{{account.account_statistics.ticket_counts.open || 0}}</a> <a *ngIf="config.current.is_invoice && config.current.is_time_tracking" detail-none href="#" ion-item (click)="openPage(0,account.account_statistics.contracts)" class="blue2">{{account.account_statistics.contracts || 0}}</a> <a *ngIf="config.current.is_expenses" detail-none href="#" ion-item (click)="openPage(1, account.account_statistics.expenses)" class="blue2" [innerHTML]="account.account_statistics.expenses | More:[10000,\'<div class=item-inner><div class=input-wrapper><ion-label>VV$</ion-label></div></div><ion-button-effect></ion-button-effect>\']"></a> <a *ngIf="config.current.is_time_tracking" detail-none href="#" ion-item (click)="openPage(2, account.account_statistics.hours)" class="blue2" [innerHTML]="account.account_statistics.hours | More:[10000,\'<div class=item-inner><div class=input-wrapper><ion-label>VV</ion-label></div></div><ion-button-effect></ion-button-effect>\']"></a></div></ion-list><ion-item></ion-item><ion-item class="margin" id="tickets"><div class="list"><ion-segment [(ngModel)]="tabsTicket" class="height32"><ion-segment-button class="button-open" value="Open">Open {{config.current.names.ticket.ap}}</ion-segment-button><ion-segment-button class="button-open" value="Close">Closed {{config.current.names.ticket.ap}}</ion-segment-button></ion-segment></div></ion-item><br><tickets-list [hidden]="tabsTicket != \'Open\'" [mode]="[\'open\', account.id]"></tickets-list><tickets-list [hidden]="tabsTicket != \'Close\'" preload="1500" [mode]="[\'closed\', account.id]"></tickets-list></div><ion-list class="list margin-top21 info" no-lines *ngSwitchWhen="\'Info\'"><ion-item class="margin color infolist"><h3 class="left width35 text-left">&nbsp;&nbsp;BWD Acct#</h3><h3 class="right width65">&nbsp;{{account.bwd_number}}</h3></ion-item><ion-item class="margin color infolist"><h3 class="left width35 tet-detxt-left">&nbsp;&nbsp;Acc#</h3><h3 class="right width65 tkts-table">&nbsp;{{account.number}}</h3></ion-item><ion-item class="margin color infolist"><h3 class="left width35 text-left">&nbsp;&nbsp;Ref1#</h3><h3 class="right width65 tkts-table">&nbsp;{{account.ref1}}</h3></ion-item><ion-item class="margin color infolist"><h3 class="left width35 text-left">&nbsp;&nbsp;Ref2#</h3><h3 class="right width65 tkts-table">&nbsp;{{account.ref2}}</h3></ion-item><ion-item class="margin color infolist"><h3 class="left width35 text-left">&nbsp;&nbsp;Org/Indiv</h3><h3 class="right width65 tkts-table">&nbsp;{{account.is_organization ? "Organization" : "Individual"}}</h3></ion-item><ion-item class="margin color infolist"><h3 class="left width35 text-left">&nbsp;&nbsp;Acc Rep</h3><h3 class="right width65 tkts-table">&nbsp;{{account.representative_name}}</h3></ion-item><ion-item class="margin color infolist"><h3 class="left width35 text-left space-initial">&nbsp;&nbsp;Internal location</h3><h3 class="right width65 tkts-table">&nbsp;{{account.internal_location_name}}</h3></ion-item><ion-item class="margin color infolist"><h3 class="left width35 text-left">&nbsp;&nbsp;Email Suffix</h3><h3 class="right width65 tkts-table">&nbsp;{{account.email_suffix}}</h3></ion-item><ion-item class="margin color infolist"><h3 class="left width35 text-left">&nbsp;&nbsp;Address 1</h3><h3 class="right width65 tkts-table">&nbsp;{{account.address1}}</h3></ion-item><ion-item class="margin color infolist"><h3 class="left width35 text-left">&nbsp;&nbsp;Address 2</h3><h3 class="right width65 tkts-table">&nbsp;{{account.address2}}</h3></ion-item><ion-item class="margin color infolist"><h3 class="left width35 text-left">&nbsp;&nbsp;City</h3><h3 class="right width65 tkts-table">&nbsp;{{account.city}}</h3></ion-item><ion-item class="margin color infolist"><h3 class="left width35 text-left">&nbsp;&nbsp;Postal Code</h3><h3 class="right width65 tkts-table">&nbsp;{{account.zipcode}}</h3></ion-item><ion-item class="margin color infolist"><h3 class="left width35 text-left">&nbsp;&nbsp;Country</h3><h3 class="right width65 tkts-table">&nbsp;{{account.country}}</h3></ion-item><ion-item class="margin color infolist"><h3 class="left width35 text-left">&nbsp;&nbsp;Phone 1</h3><h3 class="right width65 tkts-table">&nbsp;{{account.phone1}}</h3></ion-item><ion-item class="margin color infolist"><h3 class="left width35 text-left">&nbsp;&nbsp;Phone 2</h3><h3 class="right width65 tkts-table">&nbsp;{{account.phone2}}</h3></ion-item><ion-item class="color infolist" *ngFor="let customfield of account.customfields"><h3 class="left width35 text-left">&nbsp;&nbsp;{{customfield.Key}}</h3><h3 class="right width65 tkts-table">&nbsp;{{customfield.Value || \'&nbsp;\'}}</h3></ion-item></ion-list><ion-list class="list margin-top21" *ngSwitchWhen="\'Projects\'"><div [hidden]="account.projects?.length" class="table grey2 menu-text">No Projects yet</div><ion-item *ngIf="account.projects?.length" no-lines class="margin color projecttitle"><p class="text width35 text-left left">&nbsp;&nbsp;Name</p><p class="width12 left table table_account">Open</p><p class="width17 left table table_account">Logged</p><p class="width17 left table table_account">Remain</p><p class="width19 right table table_account">Complete</p></ion-item><ion-item class="color margin projectlist" *ngFor="let project of account.projects"><h3 class="text color width35 left table_account text-left">&nbsp;{{project.name}}</h3><h3 class="width12 left table">{{project.open_tickets}}</h3><h3 class="width17 left table">{{project.logged_hours}}</h3><h3 class="width17 left table">{{project.remaining_hours}}</h3><h3 class="width19 right table">{{project.complete}}%</h3></ion-item></ion-list><ion-list class="list general-alignment max-width700" [hidden]="details_tab != \'Notes\'"><div [hidden]="is_editnote" class="width100 textLogin note-account commentText" [innerHTML]="account?.note" type="text" (click)="is_editnote = true"></div><button [hidden]="is_editnote" secondary class="button_reply img-top right" (click)="is_editnote = true">Edit Notes</button> <textarea autofocus [hidden]="!is_editnote" [ngModel]="account?.note" class="glow width100 textLogin commentText" #notetext type="text" placeholder="Notes:"></textarea> <button [hidden]="!is_editnote" secondary class="button_reply img-top right" (click)="saveNote(notetext)">{{account?.note?.length ? \'Save\' : \'Add\'}} Notes</button></ion-list><ion-list class="list margin-top21" no-lines *ngSwitchWhen="\'Files\'"><div [hidden]="account.files?.length" class="table grey2 menu-text">No Files yet</div><ion-item *ngFor="let file of account.files"><div class="left width59 tkts-table" [innerHTML]="getFileLink(file)"></div><div class="files-tkts"><span class="color right text-left space-initial flex1 font-size_span">{{file.name}}</span></div></ion-item></ion-list></div></ion-content><action-button [hidden]="details_tab != \'Stat\'" [data]="{\'account\': { id: account.id, name: account.name}}"></action-button>',directives:[u.TicketsListComponent,h.ActionButtonComponent],pipes:[m.MorePipe]}),s("design:paramtypes",[o.Nav,o.NavParams,a.ApiData,r.DataProvider,a.TicketProvider,o.Config,o.ViewController])],t)}();i.AccountDetailsPage=v},{"../../components/action-button/action-button":3,"../../components/tickets-list/tickets-list":14,"../../directives/helpers":19,"../../pipes/pipes":69,"../../providers/data-provider":72,"../../providers/providers":74,"../ajax-search/ajax-search":22,"../contracts/contracts":23,"../expenses/expenses":26,"../ticket-details/ticket-details":54,"../timelogs/timelogs":57,"ionic-angular":"ionic-angular"}],21:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),a=t("../../providers/data-provider"),r=t("../../components/components"),c=function(){function t(t,e,i){this.nav=t,this.config=e,this.dataProvider=i,this.term="",this.items=[],this.LIMIT=500}return t.prototype.onPageLoaded=function(){var t=this;this.pager={page:0,limit:this.LIMIT};var e=setTimeout(function(){t.busy=!0},500);this.getItems(null,e)},t.prototype.getItems=function(t,e){var i=this;this.dataProvider.getAccountList(!1,this.pager,!0,!0).subscribe(function(n){e?(clearTimeout(e),i.busy=!1,i.accounts=n):((s=i.accounts).push.apply(s,n),i.config.current.stat.accounts+=n.length),t&&(t.enable(n.length==i.LIMIT),t.complete()),i.count=n.length,i.searchItems({value:i.term});var s},function(t){e&&(clearTimeout(e),i.busy=!1),console.log(t||"Server error")})},t.prototype.searchItems=function(t){this.items=this.accounts;var e=t.value.toLowerCase();""==e.trim()||this.busy||this.accounts&&e.length>1&&(this.items=this.accounts.filter(function(t){return t.name.toLowerCase().indexOf(e)>-1}))},t.prototype.clearSearch=function(t){this.search_results=[],this.busy=!1,t&&(t.value="")},t.prototype.doInfinite=function(t){return this.count<this.LIMIT?(t.enable(!1),void t.complete()):(this.pager.page+=1,void this.getItems(t,null))},t.prototype.toggle=function(){this.test=!this.test,this.test&&setTimeout(function(){var t=document.getElementsByClassName("searchbar-input");t=t[t.length-1],t&&t.focus()},500)},t=n([o.Page({template:'<ion-navbar *navbar><button menuToggle><ion-icon name="menu"></ion-icon></button><ion-title>{{config.current.names.account.p}}</ion-title><ion-buttons end><button danger class="right transparent" (click)="toggle()"><ion-icon name="ios-search"></ion-icon></button></ion-buttons></ion-navbar><ion-content class="accounts"><ion-searchbar *ngIf="test" [focuser] debounce="700" (cancel)="test = !test" (input)="searchItems($event)" [(ngModel)]="term" placeholder="Type {{config.current.names.account.s}} name"></ion-searchbar><p class="general-alignment"></p><img *ngIf="busy" class="imglogo img-padding" src="img/loading2.gif"><accounts-list margin-top [simple]="true" [accounts]="items"></accounts-list><ion-infinite-scroll (infinite)="doInfinite($event)" threshold="30%"><ion-infinite-scroll-content loadingSpinner="circles" loadingText="Loading more data..."></ion-infinite-scroll-content></ion-infinite-scroll></ion-content><action-button></action-button>',directives:[r.AccountsListComponent,r.ActionButtonComponent]}),s("design:paramtypes",[o.Nav,o.Config,a.DataProvider])],t)}();i.AccountsPage=c},{"../../components/components":5,"../../providers/data-provider":72,"ionic-angular":"ionic-angular"}],22:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),a=t("../../providers/providers"),r=t("../../directives/helpers"),c=t("../ticket-details/ticket-details"),l=t("../../directives/directives"),d=function(){function t(t,e,i,n,s){this.nav=t,this.navParams=e,this.config=i,this.apiData=n,this.ticketProvider=s,this.location={},this.data=[],this.items=[],this.is_empty=!1}return t.prototype.ngOnInit=function(){var t=this;this.term=this.navParams.data.search||"",this.location=this.navParams.data.location,this.pager={limit:20};var e=this.term.toLowerCase();if(this.location||(this.ticketProvider._dataStore.all.length?this.data=this.ticketProvider._dataStore.all:this.ticketProvider._dataStore.tech.length?this.data=this.ticketProvider._dataStore.tech:this.ticketProvider._dataStore.user.length&&(this.data=this.ticketProvider._dataStore.user),this.data.length&&e.length<4&&(this.items=this.data.filter(function(i){return t.searchCriteria(i,e)}))),this.count=this.items.length,e.length>3){var i=setTimeout(function(){t.is_empty=!0,t.busy=!0},500);this.getItems(e,i)}else this.is_empty=!this.items.length},t.prototype.onPageDidEnter=function(){var t=document.getElementsByClassName("searchbar-input");t=t[t.length-1],t&&t.focus()},t.prototype.dismiss=function(t){this.nav.push(c.TicketDetailsPage,t)},t.prototype.searchCriteria=function(t,e){return t.number.toString().indexOf(e)>-1||t.subject.toLowerCase().indexOf(e)>-1||t.initial_post.toLowerCase().indexOf(e)>-1||t.user_firstname.toLowerCase().indexOf(e)>-1||t.user_lastname.toLowerCase().indexOf(e)>-1||t.location_name.toLowerCase().indexOf(e)>-1||t.class_name.toLowerCase().indexOf(e)>-1},t.prototype.searchItems=function(t){var e=this;this.items=this.data;var i=t.value;if(""==i.trim()||this.busy)return void(""==i.trim()&&(this.is_empty=!this.items.length));if(i.length<4)this.items=this.data.filter(function(t){return e.searchCriteria(t,i)}),this.is_empty=!this.items.length;else{var n=setTimeout(function(){e.busy=!0},500);this.getItems(i,n)}},t.prototype.getItems=function(t,e){var i=this;this.items=[],this.url="tickets?query=all&location="+((this.location||{}).id||""),this.apiData.getPaged(r.addp(this.url,"search",t+"*"),this.pager).subscribe(function(n){e&&(clearTimeout(e),i.busy=!1),i.is_empty=!n.length,t?i.items=n:i.items=i.data=n,i.count=n.length},function(t){e&&(clearTimeout(e),i.busy=!1),console.log(t||"Server error")})},t=n([o.Page({template:'<ion-navbar *navbar><button menuToggle><ion-icon name="menu"></ion-icon></button><ion-title class="padding-right24">Search {{config.current.names.ticket.p}}</ion-title></ion-navbar><ion-content><ion-searchbar [focuser] debounce="400" [(ngModel)]="term" (input)="searchItems($event)" placeholder="Search {{config.current.names.ticket.p}} (min 4 chars)" hideCancelButton="true"></ion-searchbar><img *ngIf="busy" class="imglogo img-padding" src="img/loading2.gif"><ion-list class="ajax"><a detail-none href="#" ion-item *ngFor="let item of items" (click)="dismiss(item)"><h2>#{{item.number}} ({{item.status}}) - {{item.subject}} ({{item.user_firstname}} {{item.user_lastname}})</h2></a></ion-list><div *ngIf="is_empty" class="table grey2 search-text">No {{config.current.names.ticket.p}} found yet</div></ion-content>',directives:[l.Focuser]}),s("design:paramtypes",[o.Nav,o.NavParams,o.Config,a.ApiData,a.TicketProvider])],t)}();i.AjaxSearchPage=d},{"../../directives/directives":17,"../../directives/helpers":19,"../../providers/providers":74,"../ticket-details/ticket-details":54,"ionic-angular":"ionic-angular"}],23:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;
if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),a=t("../../providers/data-provider"),r=t("../../directives/helpers"),c=t("../../pipes/pipes"),l=function(){function t(t,e,i,n,s){this.nav=t,this.dataProvider=e,this.config=i,this.navParams=n,this.view=s,this.LIMIT=15,this.is_empty_contracts=!1,this.is_empty_prepaid=!1}return t.prototype.onPageLoaded=function(){this.params=this.navParams.data||{},this.pager={page:0},this.params.account={id:this.params.account_id||-1,name:this.params.account_name||this.config.getCurrent("user").account_name}},t.prototype.onPageWillEnter=function(){var t=this;if(this.params.account_name&&this.view.setBackButtonText(""),this.params.is_empty&&(this.params.count=0),0!==this.params.count){var e=setTimeout(function(){t.busy=!0},500);this.getItems(null,e)}else this.is_empty_prepaid=!0;this.is_empty_contracts=!0},t.prototype.getItems=function(t,e){var i=this;this.dataProvider.getContracts(this.pager).subscribe(function(n){e?(i.is_empty_contracts=!n.length,clearTimeout(e),i.busy=!1,i.contracts=n):(s=i.contracts).push.apply(s,n),t&&(t.enable(n.length==i.LIMIT),t.complete()),i.count=n.length;var s},function(t){e&&(clearTimeout(e),i.busy=!1),console.log(t||"Server error")}),this.dataProvider.getPrepaid_packs(this.params.account.id,this.pager).subscribe(function(n){e?(i.is_empty_prepaid=!n.length,clearTimeout(e),i.busy=!1,i.prepaid_packs=n):(s=i.prepaid_packs).push.apply(s,n),t&&(t.enable(n.length==i.LIMIT),t.complete()),i.count=n.length;var s},function(t){e&&(clearTimeout(e),i.busy=!1),console.log(t||"Server error")})},t.prototype.setDate=function(t,e,i){if(t){var n=this.config.getCurrent("timezone_offset");return t=new Date(t.substring(0,23)+"Z"),t=new Date(t.setTime(t.getTime()+60*n*60*1e3)).toJSON(),r.getDateTime(t,e,i)}return null},t.prototype.doInfinite=function(t){return this.is_empty_contracts||this.count<this.LIMIT?(t.enable(!1),void t.complete()):(this.pager.page+=1,void this.getItems(t,null))},t.prototype.getCurrency=function(t){return r.getCurrency(t)},t=n([o.Page({template:'<ion-navbar *navbar><button menuToggle><ion-icon name="menu"></ion-icon></button><ion-title class="padding-right24">Contracts</ion-title></ion-navbar><ion-content><img *ngIf="busy" class="imglogo img-padding" src="img/loading2.gif"><ion-list class="list general-alignment2" no-lines><div [hidden]="!busy && !is_empty_contracts" class="table grey2 menu-text">No Contracts yet</div><h5 [hidden]="is_empty_contracts">Contracts:</h5><ion-item *ngFor="let contract of contracts" class="color margin Prepaidlist"><h3 class="text color width30 left table_account text-left">&nbsp;Name:</h3><h3 class="width70 left table">{{contract.name}}</h3><h3 class="width30 left table">&nbsp;Billing Method:</h3><h3 class="width70 left table">{{contract.billing_method}}</h3><h3 class="text color width30 left table_account text-left">&nbsp;Default:</h3><h3 class="width70 left table">{{contract.default}}</h3><h3 class="width30 left table">&nbsp;Date:</h3><h3 class="width70 left table">{{setDate(contract.start_date)}} - {{setDate(contract.start_date)}}</h3><h3 class="text color width30 left table_account text-left" style="height: 57px;">&nbsp;Billing Info:</h3><h3 class="width70 left table" style="height: 57px; white-space: normal;">${{contract.flat_fee}}<span [hidden]="contract.included_hours==0">&nbsp;({{contract.included_hours}}&nbsp;{{contract.flat_fee_mode}})</span>; Invoice every&nbsp;{{contract.invoice_frequency_val}}&nbsp;{{contract.flat_fee_mode}}; Overage:&nbsp;{{contract.overage}}; Next Invoice Date:&nbsp;{{setDate(contract.flat_fee_next_date)}}</h3><hr style="width: 100%; background-color: #ffffff; top: 4px; position: relative;"></ion-item><div [hidden]="!busy && !is_empty_prepaid" class="table grey2 menu-text">No PrePaid Packs yet</div><h5 [hidden]="is_empty_prepaid">PrePaid Packs:</h5><ion-item *ngFor="let prepaid_pack of prepaid_packs" class="color margin Prepaidlist"><h3 class="text color width50 left table_account text-left">&nbsp;Name:</h3><h3 class="width50 left table">{{prepaid_pack.prepaid_pack_name}}</h3><h3 class="width50 left table">&nbsp;Contract:</h3><h3 class="width50 left table">{{prepaid_pack.contract}}</h3><h3 class="text color width50 left table_account text-left">&nbsp;Included Hours:</h3><h3 class="width50 left table">{{prepaid_pack.included_hours}}</h3><h3 class="width50 left table">&nbsp;Logged Hours:</h3><h3 class="width50 left table">{{prepaid_pack.logged_hours}}</h3><h3 class="text color width50 left table_account text-left">&nbsp;Remaining Hours:</h3><h3 class="width50 left table">{{prepaid_pack.remaining_hours}}</h3><h3 class="width50 left table">&nbsp;Amount:</h3><h3 class="width50 left table">${{prepaid_pack.amount}}</h3><h3 class="text color width50 left table_account text-left">&nbsp;Invoice:</h3><h3 class="width50 left table">{{prepaid_pack.invoice}}</h3><h3 class="width50 left table">&nbsp;Date:</h3><h3 class="width50 left table">{{setDate(prepaid_pack.start_date)}} - {{setDate(prepaid_pack.end_date)}}</h3><h3 class="text color width50 left table_account text-left">&nbsp;Created By:</h3><h3 class="width50 left table">{{prepaid_pack.created_by}}</h3><h3 class="width50 left table">&nbsp;Created Date:</h3><h3 class="width50 left table">{{setDate(prepaid_pack.created_date)}}</h3><hr style="width: 100%; background-color: #ffffff; top: 4px; position: relative;"></ion-item></ion-list></ion-content>',pipes:[c.GravatarPipe,c.MorePipe,c.LinebreaksPipe]}),s("design:paramtypes",[o.Nav,a.DataProvider,o.Config,o.NavParams,o.ViewController])],t)}();i.ContractsPage=l},{"../../directives/helpers":19,"../../pipes/pipes":69,"../../providers/data-provider":72,"ionic-angular":"ionic-angular"}],24:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),a=t("../../providers/providers"),r=t("../../directives/directives"),c=t("../../components/components"),l=t("../tickets/tickets"),d=t("../account-details/account-details"),u=t("../ticket-details/ticket-details"),p=t("../ajax-search/ajax-search"),h=t("../../pipes/pipes"),m=t("../../directives/helpers"),g=function(){function t(t,e,i,n,s,o){var a=this;this.nav=t,this.config=e,this.apiData=i,this.dataProvider=n,this.ticketProvider=s,this.timeProvider=o,this.counts={open_as_tech:0},this.accounts=[],this.queues=[],this.term="",this.simple=!1;var r=e.getStat("tickets");-1==r&&e.current.is_online?this.downloadTimer=setInterval(function(){a.counts.open_as_tech=++a.counts.open_as_tech},800):(e.current.user.is_limit_assigned_tkts&&!e.current.user.is_admin&&(r.open_all=Math.max(r.open_as_user,r.open_as_tech)),this.counts=this.counts||r)}return t.prototype.onPageLoaded=function(){var t=this;if(this.simple=!this.config.current.is_time_tracking&&!this.config.current.is_expenses,this.ticketProvider.getTicketsCounts(),this.ticketProvider.tickets$["tickets/counts"].subscribe(function(e){t.config.current.user.is_limit_assigned_tkts&&!t.config.current.user.is_admin&&(e.open_all=Math.max(e.open_as_user,e.open_as_tech)),clearInterval(t.downloadTimer),t.counts=e,t.config.setStat("tickets",{all:e.open_all,tech:e.open_as_tech,alt:e.open_as_alttech,user:e.open_as_user}),setTimeout(function(){t.saveCache()},1e3)},function(e){clearInterval(t.downloadTimer),console.log(e||"Server error")}),this.config.current.is_unassigned_queue&&(this.queues=this.config.getCache("dashqueues"),this.dataProvider.getQueueList(3).subscribe(function(e){t.queues=e,t.config.setCache("dashqueues",e)},function(t){console.log(t||"Server error")})),this.config.current.is_account_manager){this.accounts=this.config.getCache("dashaccounts");var e=500,i={limit:~e?e:500};this.accounts&&0!=this.accounts.length||this.dataProvider.getAccountList(!0,i,!0,!0).subscribe(function(e){t.accounts=e,t.config.setStat("accounts",e.length),t.simple&&t.config.setCache("dashaccounts",e)},function(t){console.log(t||"Server error")}),this.simple||this.dataProvider.getAccountList(!0,i).subscribe(function(e){t.accounts=e,t.config.setCache("dashaccounts",e)},function(t){console.log(t||"Server error")})}this.ticketProvider._dataStore.tech.length||this.ticketProvider.getTicketsList("tech","","",{limit:6}),this.timer=setTimeout(function(){t.ticketProvider._dataStore.user.length||t.ticketProvider.getTicketsList("user","","",{limit:6}),t.config.current.is_time_tracking&&!(t.timeProvider._dataStore.time||{}).length&&t.timeProvider.getTimelogs("",{limit:25})},2500)},t.prototype.onPageDidEnter=function(){this.term=""},t.prototype.saveCache=function(){var t=document.elementFromPoint(window.innerWidth/2,window.innerHeight/2),e=t.closest("ion-nav");e&&(window.dash=e.innerHTML.replace(/\s\s+/g," "))},t.prototype.ngOnDestroy=function(){clearTimeout(this.timer)},t.prototype.searchItems=function(t){var e=this;this.search_results=[];var i=t.value;if(""!=i.trim()&&!this.busy&&i.length>1){var n=setTimeout(function(){e.busy=!0},500);this.getItems(i,n)}},t.prototype.getItems=function(t,e){var i=this;this.search_results=[];var n="tickets?query=all",s={limit:3},o=" "==t[t.length-1]||","==t[t.length-1];o?n="tickets/"+t.trim()+",":t+="*",this.apiData.getPaged(m.addp(n,"search",t),s).subscribe(function(t){e&&(clearTimeout(e),i.busy=!1),i.search_results=t},function(t){e&&(clearTimeout(e),i.busy=!1),console.log(t||"Server error")})},t.prototype.gotoTicket=function(t,e){this.test=!1,this.clearSearch(),this.nav.push(u.TicketDetailsPage,t)},t.prototype.clearSearch=function(t){this.search_results=[],this.busy=!1,t&&(t.value="")},t.prototype.getSearch=function(t){this.test=!1,this.clearSearch();var e=t.target.value;e.length<4&&(e+="    ");var i={search:e};this.test=!1,this.nav.push(p.AjaxSearchPage,i)},t.prototype.itemTappedTL=function(t){this.nav.setRoot(l.TicketsPage,t)},t.prototype.itemTappedAD=function(){this.nav.setRoot(d.AccountDetailsPage)},t=n([o.Page({template:'<ion-navbar *navbar><button menuToggle><ion-icon name="menu"></ion-icon></button><ion-searchbar class="searchbar-focused searchbar-left-aligned" debounce="700" [(ngModel)]="term" (input)="searchItems($event)" (search)="getSearch($event)" placeholder="Number or phrase (min 2 char)" hideCancelButton="true"></ion-searchbar></ion-navbar><ion-content class="dashboard"><img *ngIf="busy" class="imglogo" src="img/loading2.gif"><ion-list class="ajax" [hidden]="!search_results"><a detail-none href="#" ion-item *ngFor="let item of search_results" (click)="gotoTicket(item)"><h2>{{item.status}} | #{{item.number}} - {{item.subject}} ({{item.user_firstname}} {{item.user_lastname}})</h2></a></ion-list><ion-list class="list height" no-lines margin-top><div class="width50 left blue3 decoration_none"><a detail-none href="#" (click)="itemTappedTL({tab:\'tech\', count: counts.open_as_tech})" ion-item class="mainStat itemTech">{{counts.open_as_tech}}</a> <a detail-none href="#" (click)="itemTappedTL({tab:\'tech\', count: counts.open_as_tech})" ion-item class="itemTech">As {{config.current.names.tech.a}}</a></div><div class="width17 right blue3"><a detail-none href="#" ion-item (click)="itemTappedTL({tab:\'user\', count: counts.open_as_user})" class="itemTech" [innerHTML]="counts.open_as_user | More:[999,\'<div class=item-inner><div class=input-wrapper><ion-label>VV</ion-label></div></div><ion-button-effect></ion-button-effect>\']"></a> <a detail-none href="#" ion-item (click)="itemTappedTL({tab:\'alt\', count: counts.open_as_alttech})" class="itemTech" [innerHTML]="counts.open_as_alttech | More:[999,\'<div class=item-inner><div class=input-wrapper><ion-label>VV</ion-label></div></div><ion-button-effect></ion-button-effect>\']"></a> <a detail-none href="#" ion-item (click)="itemTappedTL({tab:\'all\', count: counts.open_all})" class="itemTech" [innerHTML]="counts.open_all | More:[999,\'<div class=item-inner><div class=input-wrapper><ion-label>VV</ion-label></div></div><ion-button-effect></ion-button-effect>\']"></a></div><div class="width33 right blue3 dashborder"><a detail-none href="#" ion-item (click)="itemTappedTL({tab:\'user\', count: counts.open_as_user})" class="itemTech dashboardRight dashboard font-size1 tkts-table">As {{config.current.names.user.a}}</a> <a detail-none href="#" ion-item (click)="itemTappedTL({tab:\'alt\', count: counts.open_as_alttech})" class="itemTech dashboardRight dashboard font-size1 tkts-table">Alt {{config.current.names.tech.a}}</a> <a detail-none href="#" ion-item (click)="itemTappedTL({tab:\'all\', count: counts.open_all})" class="itemTech dashboardRight dashboard font-size1 tkts-table">All Open</a></div><br></ion-list><br><todo-list margin-top *ngIf="config.current.is_todos" [simple]="true"></todo-list><queues-list margin-top class="container_list" *ngIf="config.current.is_unassigned_queue" [queues]="queues"></queues-list><accounts-list margin-top class="container_list" *ngIf="config.current.is_account_manager" [simple]="simple" [accounts]="accounts"></accounts-list><span class="span-block"></span></ion-content><action-button></action-button>',directives:[c.QueuesListComponent,c.AccountsListComponent,c.ActionButtonComponent,c.TodoListComponent,r.Focuser],pipes:[h.MorePipe]}),s("design:paramtypes",[o.Nav,o.Config,a.ApiData,a.DataProvider,a.TicketProvider,a.TimeProvider])],t)}();i.DashboardPage=g},{"../../components/components":5,"../../directives/directives":17,"../../directives/helpers":19,"../../pipes/pipes":69,"../../providers/providers":74,"../account-details/account-details":20,"../ajax-search/ajax-search":22,"../ticket-details/ticket-details":54,"../tickets/tickets":55,"ionic-angular":"ionic-angular"}],25:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),a=t("@angular/core"),r=t("../../directives/helpers"),c=t("../../providers/api-data"),l=t("../../components/class-list/class-list"),d=t("../../components/select-list/select-list"),u=function(){function t(t,e,i,n,s){this.nav=t,this.navParams=e,this.apiData=i,this.config=n,this.view=s,this.expense={}}return t.prototype.ngOnInit=function(){this.expense=this.navParams.data||{};var t=(this.expense.user_name+" "+this.expense.user_email).trim().split(" ")[0];this.expense.expense_id?(this.title="Expense by "+t+" on"+this.setDate(this.expense.date,!1,!0),this.expense.note=r.linebreaks(this.expense.note,!0),this.expense.note_internal=r.linebreaks(this.expense.note_internal,!0)):this.expense.number?this.title="Add Expense to#"+this.expense.number+" "+this.expense.subject:this.title="Create Expense",this.expense.amount&&(this.expense.amount=this.getFixed(this.expense.amount)),this.expense.units="undefined"==typeof this.expense.units||0===this.expense.units?1:this.expense.units,this.expense.markup_value="undefined"==typeof this.expense.markup_value||this.expense.markup_value<=0?"":this.getFixed(this.expense.markup_value),this.isbillable="undefined"==typeof this.expense.billable?!0:this.expense.billable,this.is_technician_payment="undefined"==typeof this.expense.is_technician_payment?!0:this.expense.is_technician_payment,this.he=this.config.getCurrent("user");var e={};this.expense.number||this.expense.expense_id||this.expense.account||(e=this.config.current.recent||{});var i=(this.expense.account||{}).id||this.expense.account_id||(e.account||{}).selected||this.he.account_id||-1,n=(this.expense.project||{}).id||this.expense.project_id||(e.project||{}).selected||0;(this.expense.contract||{}).id||this.expense.contract_id||(e.contract||{}).selected||0,(this.expense.category||{}).id||this.expense.category_id||(e.category||{}).selected||0;this.selects={account:{name:"Account",value:this.expense.account_name||(this.expense.account||{}).name||(e.account||{}).value||this.he.account_name,selected:i,url:"accounts?is_with_statistics=false",hidden:this.expense.is_fixed},ticket:{name:"Ticket",value:this.expense.ticket_number?"#"+this.expense.ticket_number+": "+this.expense.ticket_subject:"Choose (optional)",selected:this.expense.ticket_number||0,url:"tickets?status=open&account="+i+"&project="+n,hidden:this.expense.project_id||this.expense.is_fixed||!1,is_disabled:this.expense.ticket_id},project:{name:"Project",value:this.expense.project_name||(e.project||{}).value||"Default",selected:n,url:"projects?account="+i+"&is_with_statistics=false",hidden:this.expense.is_fixed||this.expense.ticket_id},contract:{name:"Contract",value:this.expense.contract_name||(e.contract||{}).value||"Choose",selected:this.expense.contract_id||this.config.getRecent("contract").selected||0,url:"contracts?account_id="+i,hidden:this.expense.is_fixed,is_disabled:!1},category:{name:"Category",value:this.expense.category_name||(e.category||{}).value||"Choose",selected:this.expense.category_id||this.config.getRecent("category").selected||null,url:"expenses/categories",is_disabled:!1}}},t.prototype.saveSelect=function(t){var e=t.type,i=this.selects.account.selected,n=this.selects.ticket.selected,s=this.selects.project.selected,o=this.selects.contract.selected;switch(e){case"account":if(this.selects.account.selected===t.id)break;this.selects.project.url="projects?account="+t.id+"&is_with_statistics=false",this.selects.project.value="Default",this.selects.project.selected=0,i=t.id,this.selects.project.hidden=!1,this.selects.contract.url="contracts?account_id="+t.id,this.selects.contract.value="Choose",this.selects.contract.selected=0,o=0;break;case"project":if(this.selects.project.selected===t.id)break;this.expense.ticket_id||(this.selects.ticket.url="tickets?status=open&account="+i+"&project="+t.id,this.selects.ticket.value="Choose (optional)",this.selects.ticket.selected=0),s=t.id;break;case"contract":if(this.selects.contract.selected===t.id)break;o=t.id;break;case"ticket":if(this.selects.ticket.selected===t.id)break;n=t.id,this.selects.ticket.value=t.name,this.selects.ticket.selected=t.id;break;default:this.selects[e].selected=t.id,this.selects[e].value=t.name}},t.prototype.onSubmit=function(t){var e=this;if(t.valid){if(this.expense.in_progress&&Date.now()-this.expense.in_progress<1500)return;this.expense.in_progress=Date.now();var i=isNaN(t.value.amount)?0:Number(t.value.amount);if(0==i)return void this.nav.alert("Not enough amount",!0);var n=isNaN(t.value.units)?0:Number(t.value.units);if(0>=n)return void this.nav.alert("Not enough units",!0);var s=!t.value.markup_value||isNaN(t.value.markup_value)?-1:Number(t.value.markup_value),o=(r.htmlEscape(this.expense.note.trim()).substr(0,5e3),{ticket_key:this.selects.ticket.selected||null,ticket_name:this.selects.ticket.value||null,account_id:this.selects.account.selected,contract_id:this.selects.contract.selected,category_id:this.selects.category.selected,project_id:this.expense.ticket_number?null:this.selects.project.selected,project_name:this.selects.project.value,tech_id:this.expense.expense_id?this.expense.user_id:this.he.user_id,user_name:r.getFullName(this.he.firstname,this.he.lastname,this.he.email),note:this.expense.note,note_internal:this.expense.note_internal,amount:i,is_billable:this.isbillable,is_technician_payment:this.is_technician_payment,vendor:this.expense.vendor,units:this.expense.units,markup_value:s,expense_id:this.expense.expense_id||""});this.apiData.get("expenses",o,"POST").subscribe(function(t){e.expense.number||e.expense.expense_id||e.expense.account||e.config.setRecent({account:e.selects.account,project:e.selects.project,ticket:e.selects.ticket,contract:e.selects.contract}),e.nav.alert("Expense was successfully added :)"),setTimeout(function(){return e.close(o)},500)},function(t){console.log(t||"Server error")})}},t.prototype.setDate=function(t,e,i){if(t){var n=this.config.getCurrent("timezone_offset");return t=new Date(t.substring(0,23)+"Z"),t=new Date(t.setTime(t.getTime()+60*n*60*1e3)).toJSON(),r.getDateTime(t,e,i)}return null},t.prototype.getFixed=function(t){return Number(t||"0").toFixed(2).toString()},t.prototype.close=function(t){this.view.dismiss(t)},t=n([o.Page({template:'<ion-toolbar><button (click)="close()" class="bar-button bar-button-default"><span *ngIf="title?.length < 15" primary>Cancel</span><ion-icon *ngIf="title?.length > 15" primary class="invoiceCircle" name="ios-arrow-back"></ion-icon></button><ion-title class="ellipsis padding-right24">{{title}}</ion-title></ion-toolbar><ion-content class="expense-create"><form #addForm="ngForm"><ion-list class="list max-width700 general-alignment" no-lines><ion-item no-lines class="labels color img-top">Units:</ion-item><input class="width100 blue3 subject-create commentText margin-bottom3" placeholder="Units" ngControl="units" type="number" [(ngModel)]="expense.units" required><ion-item no-lines class="labels color img-top">Cost:</ion-item><input class="width100 textLogin commentText subject-create" placeholder="Amount" required ngControl="amount" [ngModel]="expense.amount"><ion-item no-lines class="labels color img-top">Markup:</ion-item><input class="width100 blue3 subject-create commentText margin-bottom3" placeholder="Markup" ngControl="markup_value" type="number" step="0.01" [(ngModel)]="expense.markup_value"><div class="class-margin"><select-list *ngIf="!expense.number" [list]="selects.account" ajax="true" preload="true" (onChanged)="saveSelect($event)"></select-list><select-list *ngIf="!expense.number" [list]="selects.project" preload="true" (onChanged)="saveSelect($event)"></select-list><select-list *ngIf="!expense.number" [list]="selects.ticket" preload="true" (onChanged)="saveSelect($event)"></select-list><select-list [list]="selects.category" preload="true" (onChanged)="saveSelect($event)"></select-list><select-list [list]="selects.contract" preload="true" (onChanged)="saveSelect($event)"></select-list></div><div class="tooltips"><textarea required [(ngModel)]="expense.note" ngControl="note" #note="ngForm" class="width100 textLogin commentText" type="text" placeholder="Note" maxlength="4000"></textarea> <span [hidden]="note.valid || note.untouched">Note is required and less 4000 chars</span></div><br><textarea [(ngModel)]="expense.vendor" class="width100 textLogin commentText subject-create" type="text" placeholder="Vendor"></textarea> <textarea [(ngModel)]="expense.note_internal" class="width100 textLogin commentText subject-create" type="text" placeholder="Internal Notes"></textarea><ion-item no-lines class="left toggle-width"><ion-toggle class="toggle" style="padding-bottom: 7px !important;" [(ngModel)]="isbillable"></ion-toggle></ion-item><p class="left width80 text-toggle color">Billable</p><ion-item no-lines class="left toggle-width"><ion-toggle class="toggle" [(ngModel)]="is_technician_payment"></ion-toggle></ion-item><p class="left width75 text-toggle color">Technician Payment</p><div><button (click)="onSubmit(addForm)" secondary block type="submit" [disabled]="!addForm.valid" class="disable-hover button button-default button-block">{{expense.expense_id ? \'Update\' : \'Add\'}} Expense</button></div></ion-list></form></ion-content>',directives:[a.forwardRef(function(){return l.ClassListComponent}),a.forwardRef(function(){return d.SelectListComponent})]}),s("design:paramtypes",[o.Nav,o.NavParams,c.ApiData,o.Config,o.ViewController])],t)}();i.ExpenseCreatePage=u},{"../../components/class-list/class-list":4,"../../components/select-list/select-list":12,"../../directives/helpers":19,"../../providers/api-data":70,"@angular/core":"@angular/core","ionic-angular":"ionic-angular"}],26:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),a=t("../../providers/data-provider"),r=t("../../directives/helpers"),c=t("../expense-create/expense-create"),l=t("../../pipes/pipes"),d=function(){function t(t,e,i,n,s){this.nav=t,this.dataProvider=e,this.config=i,this.navParams=n,this.view=s,this.LIMIT=15,this.is_empty=!1}return t.prototype.onPageLoaded=function(){this.params=this.navParams.data||{},this.pager={page:0},this.params.account={id:this.params.account_id||-1,name:this.params.account_name||this.config.getCurrent("user").account_name}},t.prototype.onPageWillEnter=function(){var t=this;if(this.params.account_name&&this.view.setBackButtonText(""),this.params.is_empty&&(this.params.count=0),0!==this.params.count){var e=setTimeout(function(){t.busy=!0},500);this.getItems(null,e)}else this.is_empty=!0},t.prototype.getItems=function(t,e){var i=this;this.dataProvider.getExpenses(this.params.account.id,this.pager).subscribe(function(n){e?(i.is_empty=!n.length,clearTimeout(e),i.busy=!1,i.expenses=n):(s=i.expenses).push.apply(s,n),t&&(t.enable(n.length==i.LIMIT),t.complete()),i.count=n.length;var s},function(t){e&&(clearTimeout(e),i.busy=!1),console.log(t||"Server error")})},t.prototype.doInfinite=function(t){return this.is_empty||this.count<this.LIMIT?(t.enable(!1),void t.complete()):(this.pager.page+=1,void this.getItems(t,null))},t.prototype.itemTapped=function(t){t=t||{},t.account=t.account||this.params.account,this.nav.push(c.ExpenseCreatePage,t)},t.prototype.setDate=function(t,e,i){if(t){var n=this.config.getCurrent("timezone_offset");return t=new Date(t.substring(0,23)+"Z"),t=new Date(t.setTime(t.getTime()+60*n*60*1e3)).toJSON(),r.getDateTime(t,e,i)}return null},t.prototype.getCurrency=function(t){return r.getCurrency(t)},t=n([o.Page({template:'<ion-navbar *navbar><button menuToggle><ion-icon name="menu"></ion-icon></button><ion-title class="padding-right24">Expenses {{params.account_name ? "of&nbsp;" + params.account.name : ""}}</ion-title></ion-navbar><ion-content><div *ngIf="is_empty" class="table grey2 menu-text">No Expenses yet</div><ion-list class="list general-alignment2" no-lines><a detail-none href="#" ion-item *ngFor="let expense of expenses" (click)="itemTapped(expense)" class="expense-center margin-top0" style="border-bottom: 1px #808080 solid;"><ion-avatar item-left style="margin:7px 1px 7px -8px !important;"><img [alt]="expense.user_firstname" style="margin-left:14px" [src]="expense.user_email | Gravatar"><p style="width: 80px;">{{expense.user_name}}</p></ion-avatar><div class="expenses"><li class="text-left left"><h3 class="timelogs ellipsis color" *ngIf="expense.ticket_id">{{"#"+expense.ticket_number+": "+expense.ticket_subject}}</h3><h3 class="timelogs ellipsis" *ngIf="expense.billable"><b>Billable:&nbsp;</b>Yes</h3><h3 class="timelogs ellipsis" *ngIf="!expense.billable"><b>Billable:&nbsp;</b>No</h3><h3 class="timelogs ellipsis" *ngIf="expense.units"><b>Units:&nbsp;</b>{{expense.units}}</h3><h3 class="timelogs ellipsis" *ngIf="expense.category"><b>Category:&nbsp;</b>{{expense.category}}</h3><h3 class="timelogs ellipsis" *ngIf="expense.vendor"><b>Vendor:&nbsp;</b>{{expense.vendor}}</h3><h3 class="timelogs ellipsis" *ngIf="expense.is_technician_payment"><b>Technician Payment:&nbsp;</b>Yes</h3><h3 class="timelogs ellipsis" *ngIf="!expense.is_technician_payment"><b>Technician Payment:&nbsp;</b>No</h3><h3 class="timelogs ellipsis" *ngIf="expense.contract_name"><b>Contract:&nbsp;</b>{{expense.contract_name}}</h3><h3 class="timelogs ellipsis" *ngIf="expense.project_id"><b>Project:&nbsp;</b>{{expense.project_name}}</h3><h3 class="timelogs ellipsis color"><b>Note:&nbsp;</b><span [innerHTML]="expense.note | Linebreaks"></span></h3></li><li class="right margin font-time text-right"><span class="expense-hours color">{{getCurrency(expense.amount)}}</span><h3 class="expense-hours color">{{setDate(expense.date)}}</h3><h3 class="expense-hours color" style="margin-top: -2px;">{{setDate(expense.date, false, true).substr(8)}}</h3></li></div></a></ion-list></ion-content><button (click)="itemTapped()" secondary item-right fab fab-right fab-bottom style="z-index: 2"><ion-icon class="button_circle action-but" name="md-add"></ion-icon></button>',pipes:[l.GravatarPipe,l.MorePipe,l.LinebreaksPipe]}),s("design:paramtypes",[o.Nav,a.DataProvider,o.Config,o.NavParams,o.ViewController])],t)}();i.ExpensesPage=d},{"../../directives/helpers":19,"../../pipes/pipes":69,"../../providers/data-provider":72,"../expense-create/expense-create":25,"ionic-angular":"ionic-angular"}],27:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),a=t("@angular/core"),r=t("../../directives/helpers"),c=t("../../providers/time-provider"),l=t("../../providers/data-provider"),d=t("../../providers/api-data"),u=t("../../components/class-list/class-list"),p=t("../../components/select-list/select-list"),h=t("../invoice-details/invoice-details"),m=t("../../pages/expense-create/expense-create"),g=t("../../pipes/pipes"),f=t("../../pages/timelog/timelog"),v=function(){function t(t,e,i,n,s,o,a){this.nav=t,this.navParams=e,this.apiData=i,this.dataProvider=n,this.timeProvider=s,this.config=o,this.view=a,this.contract=[],this.timelogs=[],this.pager=[],this.expenses=[],this.recipients=[],this.localrecipients=[],this.data={},this.timee={},this.title="",this.selects={},this.UserDateOffset=-5}return t.prototype.ngOnInit=function(){this.UserDateOffset=this.config.getCurrent("timezone_offset"),this.data=this.navParams.data||{},this.pager={page:0},this.he=this.config.getCurrent("user");var t={};this.data.number||(this.data.account||{}).id||(t=this.config.current.recent||{});var e=(this.data.account||{}).id||this.data.account_id||(t.account||{}).selected||this.he.account_id||-1,i=(this.data.contract||{}).id||this.data.contract_id||(t.contract||{}).selected||0,n=(this.data.project||{}).id||this.data.project_id||(t.project||{}).selected||0;i&&this.getContractInfo(i),i&&0!=e&&this.getInvoice(e,i),this.selects={user:{name:"User",value:r.getFullName(this.he.firstname,this.he.lastname,this.he.email),selected:this.he.user_id,url:"users",hidden:!1},recipient_user:{name:"recipient_user",value:r.getFullName(this.he.firstname,this.he.lastname,this.he.email),selected:this.he.user_id,url:"users",hidden:!1},account:{name:"Account",value:(this.data.account||{}).name||this.data.account_name||(t.account||{}).value||this.he.account_name,selected:e,url:"accounts?is_with_statistics=false",hidden:!1,is_disabled:this.data.ticket_number},project:{name:"Project",value:this.data.project_name||(t.project||{}).value||"Default",
selected:n,url:"projects?account="+e+"&is_with_statistics=false",hidden:!1,is_disabled:this.data.ticket_number},ticket:{name:"Ticket",value:this.data.ticket_number?"#"+this.data.ticket_number+": "+this.data.ticket_subject:"Choose (optional)",selected:this.data.ticket_number||0,url:"tickets?status=open&account="+e+"&project="+n,hidden:this.data.is_project_log||!1,is_disabled:this.data.task_type_id},contract:{name:"Contract",value:this.data.contract_name||(t.contract||{}).value||"Choose",selected:this.data.contract_id||this.config.getRecent("contract").selected||0,url:"contracts?account_id="+e,hidden:!1,is_disabled:!1},prepaidpack:{name:"PrePaid Pack",value:this.data.prepaid_pack_name||(t.prepaidpack||{}).value||"Choose",selected:this.data.prepaid_pack_id||this.config.getRecent("prepaidpack").selected||0,url:"prepaid_packs?contract_id="+i,hidden:!1}}},t.prototype.saveSelect=function(t){console.log("event",t);var e=t.type,i=this.selects.account.selected,n=this.selects.ticket.selected,s=this.selects.project.selected,o=this.selects.contract.selected;this.selects.prepaidpack.selected;switch(e){case"account":if(this.selects.account.selected===t.id)break;this.selects.project.url="projects?account="+t.id+"&is_with_statistics=false",this.selects.project.value="Default",this.selects.project.selected=0,s=0,this.selects.contract.url="contracts?account_id="+t.id,this.selects.contract.value="Choose",this.selects.contract.selected=0,o=0,this.timelogs=[],this.expenses=[],this.recipients=[],this.total_hours=!1,this.exspense_total=!1,this.total_cost=!1,this.selects.prepaidpack.url="prepaid_packs?contract_id=0",this.selects.prepaidpack.value="Choose (optional)",this.selects.prepaidpack.selected=0,i=t.id,this.selects.ticket.hidden=this.data.is_project_log||this.data.task_type_id||!1,this.data.task_type_id||(this.selects.ticket.url="tickets?status=open&account="+i+"&project="+s,this.selects.ticket.value="Choose (optional)",this.selects.ticket.selected=0),this.selects.project.hidden=!this.config.current.is_project_tracking;break;case"project":if(this.selects.project.selected===t.id)break;this.data.task_type_id||(this.selects.ticket.hidden=this.data.is_project_log||this.data.task_type_id||!1,this.selects.ticket.url="tickets?status=open&account="+i+"&project="+t.id,this.selects.ticket.value="Choose (optional)",this.selects.ticket.selected=0),s=t.id;break;case"contract":if(!t.id)return void this.nav.alert("Cannot create any invoice. Please add or select Contract to "+this.selects.account.value,!0);if(this.selects.contract.selected===t.id)break;this.selects.prepaidpack.url="prepaid_packs?contract_id="+t.id,this.selects.prepaidpack.value="Choose (optional)",this.selects.prepaidpack.selected=0,o=t.id,o&&this.getInvoice(i,o);break;case"ticket":if(this.selects.ticket.selected===t.id)break;n=t.id;break;case"recipient_user":if(this.selects.recipient_user.selected===t.id)break;var a={id:t.id,email:t.email,fullname:t.name,is_accounting_contact:!0};this.localrecipients.push(a),this.recipients.push(a)}this.selects[e].selected=t.id,t.id>0&&(this.selects[e].value=t.name||"Default")},t.prototype.getContractInfo=function(t){var e=this;this.dataProvider.getContracts(this.pager,t).subscribe(function(t){e.contract=t,e.contract.date=(new Date).toJSON().substring(0,19)})},t.prototype.addTime=function(){var t=this;if(this.config.setRecent({account:this.selects.account,user:this.selects.user,project:this.selects.project,ticket:this.selects.ticket,contract:this.selects.contract,prepaidpack:this.selects.prepaidpack}),console.log("user",this.selects.user),!this.selects.contract.selected)return void this.nav.alert("Please choose Contract",!0);var e=o.Modal.create(f.TimelogPage,{is_fixed:!0});e.onDismiss(function(e){e&&t.getInvoice(t.selects.account.selected,t.selects.contract.selected)}),this.nav.present(e)},t.prototype.addExpense=function(){var t=this;if(this.config.setRecent({account:this.selects.account,user:this.selects.user,project:this.selects.project,ticket:this.selects.ticket,contract:this.selects.contract,prepaidpack:this.selects.prepaidpack}),!this.selects.contract.selected)return void this.nav.alert("Please choose Contract",!0);var e=o.Modal.create(m.ExpenseCreatePage,{is_fixed:!0});e.onDismiss(function(e){e&&t.getInvoice(t.selects.account.selected,t.selects.contract.selected)}),this.nav.present(e)},t.prototype.getInvoice=function(t,e){var i=this,n=(new Date).toJSON().substring(0,19),s=(new Date).toJSON().substring(0,19),a=o.Loading.create({content:"Refreshing...",duration:1e3,dismissOnPageChange:!0});this.nav.present(a),this.dataProvider.getInvoice(!1,t,e,n,s,!0).subscribe(function(t){a.dismiss(),1==t.length&&(t=t[0]),console.log(t,"dataInvoice"),t.recipients=t.recipients||[],t.recipients=t.recipients.sort(function(t,e){return t.is_accounting_contact<e.is_accounting_contact?1:-1}),i.recipients=[],(e=i.recipients).push.apply(e,i.localrecipients),console.log("this.localrecipients",i.localrecipients),console.log("this.recipients",i.recipients),(n=i.recipients).push.apply(n,t.recipients),i.invoice_start_date=(new Date).toJSON().substring(0,19),i.invoice_end_date=(new Date).toJSON().substring(0,19),i.total_cost=t.total_cost,i.total_hours=t.total_hours,i.exspense_total=t.misc_cost,i.timelogs=t.time_logs,i.expenses=t.expenses;var e,n},function(t){a.dismiss(),console.log(t||"Server error")})},t.prototype.onSubmit=function(){var t=this;if(!this.total_cost)return void this.nav.alert("Total cost is 0. Please add time or expenses!",!0);if(!this.recipients.filter(function(t){return t.is_accounting_contact}).length)return void this.nav.alert("No accounting contacts selected",!0);if(!(this.in_progress&&Date.now()-this.in_progress<1500)){this.in_progress=Date.now();var e="";this.recipients.forEach(function(t){t.is_accounting_contact&&(e+=t.email+",")}),this.config.setRecent({account:this.selects.account,user:this.selects.user,project:this.selects.project,ticket:this.selects.ticket,contract:this.selects.contract,prepaidpack:this.selects.prepaidpack});var i={};i.status="unbilled",i.account=this.selects.account.selected,i.contract_id=this.selects.contract.selected,i.start_date=(new Date).toJSON(),i.end_date=(new Date).toJSON(),i.recipients=e,this.apiData.get("invoices/",i,"POST").subscribe(function(e){t.nav.alert("Hurray! Invoice sent :)"),t.nav.pop()},function(e){t.nav.alert(e,!0),console.log(e||"Server error")})}},t.prototype.changeContact=function(t){t.is_accounting_contact=!t.is_accounting_contact},t.prototype.setDate=function(t,e,i){return t?r.getDateTime(t,e,i):null},t.prototype.getFixed=function(t){return Number(t||"0").toFixed(2).toString()},t.prototype.getCurrency=function(t){return r.getCurrency(t)},t.prototype.close=function(){this.view.dismiss()},t.prototype.viewInvoice=function(){var t={account_name:this.data.account_name,id:this.data.invoice_id,account_id:this.data.account_id,project_id:this.data.project_id};this.nav.push(h.InvoiceDetailsPage,t)},t=n([o.Page({template:'<ion-toolbar><button (click)="close()" class="bar-button bar-button-default"><span *ngIf="title?.length < 9" primary>Cancel</span><ion-icon *ngIf="title?.length > 9" primary class="invoiceCircle" name="ios-arrow-back"></ion-icon></button><ion-title class="ellipsis padding-right24">{{title}}</ion-title></ion-toolbar><ion-content class="timelog invoice_create"><div class="list max-width700"><div class="general-alignment2"><select-list *ngIf="!data.number" ajax="true" [list]="selects.user" (onChanged)="saveSelect($event)" preload="true"></select-list><select-list *ngIf="!data.number" [list]="selects.account" ajax="true" preload="true" (onChanged)="saveSelect($event)"></select-list><select-list *ngIf="!data.number" [list]="selects.project" preload="true" (onChanged)="saveSelect($event)"></select-list><select-list [list]="selects.contract" (onChanged)="saveSelect($event)"></select-list><select-list [list]="selects.prepaidpack" (onChanged)="saveSelect($event)"></select-list></div><div *ngIf="selects.contract.selected" class="flatfee"><h3 class="text color width35 left table_account text-left">&nbsp;&nbsp;Date Range:</h3><h3 class="width65 left table">{{setDate(invoice_start_date)}} - {{setDate(invoice_end_date)}}</h3></div><div style="border-bottom: 1px #fff solid"><ion-icon (click)="addTime()" name="add-circle" role="img" class="ion-ios-add-circle item-icon" aria-label="add circle" style="font-size: 2.5em; position: relative; top: 4px; color: #64be42"></ion-icon><h3 style="display: inline-block;">&nbsp;&nbsp;Timelogs</h3><h3 *ngIf="total_hours" style="float: right; width: 40%; text-align: right; font-size: 2.5rem">{{total_hours}} <span style="font-size: 2rem">hrs</span></h3></div><div *ngIf="is_empty" class="table grey2 menu-text">No Timelogs yet</div><ion-list class="list general-alignment2" style="width: 100%" no-lines><a detail-none href="#" ion-item *ngFor="let timelog of timelogs" class="margin-top0 timelogs-center" style="border-bottom: 1px #808080 solid; padding-bottom: 10px; margin-bottom: 10px;"><div class="expenses"><li class="text-left left"><span class="expense-hours color" style="font-size: 2rem; display: block;">{{getFixed(timelog.hours)}} hrs</span><p>{{timelog.name}}</p><h3 class="timelogs ellipsis" *ngIf="!timelog.tktsubject"><span *ngIf="timelog.ticket_project"><b>Project:</b> {{timelog.ticket_project}}</span></h3><h3 class="timelogs ellipsis" *ngIf="timelog.tktsubject"><span *ngIf="timelog.ticket_project"><b>Ticket #</b>{{timelog.ticket_project}}</span></h3><h3 class="timelogs ellipsis" *ngIf="timelog.tktsubject"><b>Ticket Subject:</b> {{timelog.tktsubject}}</h3><h3 class="timelogs ellipsis color" *ngIf="timelog.note"><b>Note:</b> {{timelog.note}}</h3></li><li class="right margin font-time text-right"><span class="expense-hours color">${{timelog.total}}</span><br><br><h3 class="expense-hours color">{{setDate(timelog.date, timelog.time_offset)}}</h3></li></div></a></ion-list><div style="border-bottom: 1px #fff solid"><ion-icon (click)="addExpense()" name="add-circle" role="img" class="ion-ios-add-circle item-icon" aria-label="add circle" style="font-size: 2.5em; position: relative; top: 4px; color: #64be42"></ion-icon><h3 style="display: inline-block;">&nbsp;&nbsp;Expenses</h3><h3 style="float: right; width: 40%; text-align: right; font-size: 2.5rem" *ngIf="exspense_total"><span style="font-size: 2rem">$</span>&nbsp;{{exspense_total}}</h3></div><div *ngIf="is_empty" class="table grey2 menu-text">No Expenses yet</div><ion-list class="list general-alignment2" style="width: 100%" no-lines><a detail-none href="#" ion-item *ngFor="let expense of expenses" class="margin-top0 timelogs-center" style="border-bottom: 1px #808080 solid; padding-bottom: 9px; margin-bottom: 10px;"><div class="expenses"><li class="text-left left"><h3 class="timelogs ellipsis color" *ngIf="expense.units"><b>Units:&nbsp;</b>{{expense.units}}</h3><p>{{expense.name}}</p><h3 class="timelogs ellipsis" *ngIf="!expense.tktsubject"><span *ngIf="expense.ticket_project != 0"><b>Project:</b> {{expense.ticket_project}}</span></h3><h3 class="timelogs ellipsis" *ngIf="expense.tktsubject"><span *ngIf="expense.ticket_project"><b>Ticket #</b>{{expense.ticket_project}}</span></h3><h3 class="timelogs ellipsis" *ngIf="expense.tktsubject"><b>Ticket Subject:</b> {{expense.tktsubject}}</h3><h3 class="timelogs ellipsis color" *ngIf="expense.note"><b>Note:&nbsp;</b>{{expense.note}}</h3></li><li class="right margin font-time text-right"><span class="expense-hours color">{{getCurrency(expense.amount)}}</span><br><br><h3 class="expense-hours color">{{setDate(expense.date)}}</h3></li></div></a></ion-list><div *ngIf="total_cost" class="total_invoice"><h3 style="display: inline-block; font-size: 2.5rem">Total Invoice:</h3><h3 style="float: right; width: 45%; text-align: right;"><span style="font-size: 2.5rem">$</span>{{total_cost}}</h3></div><div class="sticky"><button type="submit" (click)="onSubmit()" secondary class="disable-hover button button-default button-block img-top display">Create & Send</button><div class="stickyborder"></div></div><ion-item padding style="text-align: left; margin-top: -10px;"><select-list *ngIf="!data.number" ajax="true" [isbutton]="true" [list]="selects.recipient_user" (onChanged)="saveSelect($event)" preload="true" style="float: left"></select-list><h2 class="color" style="display: inline-block; font-size: 2.3rem; font-weight: 500; padding-left: 15px; margin-top:7px;">Recipients</h2></ion-item><ion-list class="list resipients_invoice"><div *ngIf="!recipients" class="table grey2 menu-text">No recipients yet</div><div *ngFor="let recipient of recipients"><div><ion-avatar class="ticketImg left recipient width23"><img class="avatarInvoice margin-top10 img_avatar" [alt]="recipient.fullname" [src]="recipient.email | Gravatar"></ion-avatar></div><ion-item class="blue3 width80 invoicelist right margin" no-lines><h3 class="recipient-calc left textLogin margin-top2 ellipsis">{{recipient.email}}</h3><button fab class="red buttonInvoice right topInvoice email-invoice button-fab" (click)="changeContact(recipient)"><ion-icon *ngIf="recipient.is_accounting_contact" class="invoiceCircle green" name="checkmark"></ion-icon><ion-icon *ngIf="!recipient.is_accounting_contact" class="invoiceCircle" name="close"></ion-icon></button></ion-item></div></ion-list></div><p style="position: absolute; bottom: 0px;">&nbsp;</p></ion-content>',directives:[u.ClassListComponent,a.forwardRef(function(){return p.SelectListComponent})],pipes:[g.GravatarPipe,g.MorePipe,g.LinebreaksPipe]}),s("design:paramtypes",[o.Nav,o.NavParams,d.ApiData,l.DataProvider,c.TimeProvider,o.Config,o.ViewController])],t)}();i.InvoiceCreatePage=v},{"../../components/class-list/class-list":4,"../../components/select-list/select-list":12,"../../directives/helpers":19,"../../pages/expense-create/expense-create":25,"../../pages/timelog/timelog":56,"../../pipes/pipes":69,"../../providers/api-data":70,"../../providers/data-provider":72,"../../providers/time-provider":76,"../invoice-details/invoice-details":28,"@angular/core":"@angular/core","ionic-angular":"ionic-angular"}],28:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),a=t("../../directives/helpers"),r=t("../../pipes/pipes"),c=t("../../providers/data-provider"),l=t("../../providers/api-data"),d=function(){function t(t,e,i,n,s,o){this.nav=t,this.navParams=e,this.dataProvider=i,this.apiData=n,this.config=s,this.view=o}return t.prototype.onPageLoaded=function(){var t=this;this.invoice=this.navParams.data||{},this.invoice.id?this.title="Send Invoice #"+this.invoice.id+" to"+this.invoice.account_name:this.title="Create Invoice on"+this.invoice.account_name,this.dataProvider.getInvoice(this.invoice.id,this.invoice.account_id,this.invoice.contract_id).subscribe(function(e){1==e.length&&(e=e[0]),e.recipients&&(e.recipients=e.recipients.sort(function(t,e){return t.is_accounting_contact<e.is_accounting_contact?1:-1})),t.invoice=e},function(t){console.log(t||"Server error")})},t.prototype.onPageWillEnter=function(){this.view.setBackButtonText("")},t.prototype.setDate=function(t,e,i){if(t){var n=this.config.getCurrent("timezone_offset");return t=new Date(t.substring(0,23)+"Z")||new Date,t=new Date(t.setTime(t.getTime()+60*n*60*1e3)).toJSON(),a.getDateTime(t,e,i)}return null},t.prototype.getCurrency=function(t){return a.getCurrency(t)},t.prototype.changeContact=function(t){t.is_accounting_contact=!t.is_accounting_contact},t.prototype.send=function(){var t=this;if(!this.invoice.recipients.filter(function(t){return t.is_accounting_contact}).length)return void this.nav.alert("No accounting contacts selected",!0);if(!(this.invoice.in_progress&&Date.now()-this.invoice.in_progress<1500)){this.invoice.in_progress=Date.now();var e="";this.invoice.recipients.forEach(function(t){t.is_accounting_contact&&(e+=t.email+",")});var i={};this.invoice.id?i.action="sendEmail":(i.status="unbilled",i.account=this.invoice.account_id,i.contract_id=this.invoice.contract_id,i.start_date=new Date(this.invoice.start_date||Date.now().toString()).toJSON(),i.end_date=new Date(this.invoice.end_date||Date.now().toString()).toJSON()),i.recipients=e,this.apiData.get("invoices/"+(this.invoice.id||""),i,this.invoice.id?"PUT":"POST").subscribe(function(e){t.nav.alert("Hurray! Invoice sent :)"),t.invoice.id?t.nav.pop():t.nav.popTo(t.nav.getByIndex(t.nav.length()-3))},function(e){t.nav.alert(e,!0),console.log(e||"Server error")})}},t=n([o.Page({template:'<ion-navbar *navbar><button menuToggle><ion-icon name="menu"></ion-icon></button><ion-title class="ellipsis padding-right24">{{title}}</ion-title></ion-navbar><ion-content padding class="invoice-details"><ion-item><h3 *ngIf="invoice.contract_name" class="left color width35">Contract: {{invoice.contract_name}}</h3><p item-right class="text_list color">{{setDate(invoice.start_date, true)}} - {{setDate(invoice.end_date, true)}}</p></ion-item><ion-item no-lines class="width65 left"><h2 class="color" item-left>Time</h2></ion-item><ion-item no-lines class="width35 left"><h2 item-right class="color">{{getCurrency(invoice.amount)}}</h2></ion-item><ion-item no-lines class="width65 left"><h2 item-left class="color">Travel</h2></ion-item><ion-item no-lines class="width35 left"><h2 item-right class="color">{{getCurrency(invoice.travel_cost)}}</h2></ion-item><ion-item no-lines class="width65 left"><h2 item-left class="color">Expenses</h2></ion-item><ion-item no-lines class="width35 left"><h2 item-right class="color">{{getCurrency(invoice.misc_cost)}}</h2></ion-item><ion-item no-lines class="width65 left"><h2 item-left class="color">Adjustments</h2></ion-item><ion-item no-lines class="width35 left"><h2 item-right class="color">{{getCurrency(invoice.adjustments)}}</h2></ion-item><ion-item class="width45 right basic-margin color"></ion-item><ion-item no-lines><h2 item-right class="font-invoice color">{{getCurrency(invoice.total_cost)}}</h2></ion-item><div class="sticky"><button (click)="send()" [disabled]="!invoice.recipients" secondary class="disable-hover button button-default button-block img-top display">{{!invoice.id ? "Create &" : ""}} Send</button><div class="stickyborder"></div></div><ion-item padding><h2 class="color">Recipients</h2></ion-item><ion-list class="list"><div *ngIf="!invoice.recipients" class="table grey2 menu-text">No recipients yet</div><div *ngFor="let recipient of invoice.recipients"><div><ion-avatar class="ticketImg left recipient width23"><img class="avatarInvoice margin-top10 img_avatar" [alt]="recipient.fullname" [src]="recipient.email | Gravatar"></ion-avatar></div><ion-item class="blue3 width80 invoicelist right margin" no-lines><h3 class="recipient-calc left textLogin margin-top2 ellipsis">{{recipient.email}}</h3><button fab class="{{recipient.is_accounting_contact ? \'green\' : \'red\'}} buttonInvoice right topInvoice email-invoice button-fab" (click)="changeContact(recipient)"><ion-icon *ngIf="recipient.is_accounting_contact" class="invoiceCircle" name="checkmark"></ion-icon><ion-icon *ngIf="!recipient.is_accounting_contact" class="invoiceCircle" name="close"></ion-icon></button></ion-item></div></ion-list></ion-content>',pipes:[r.GravatarPipe]}),s("design:paramtypes",[o.Nav,o.NavParams,c.DataProvider,l.ApiData,o.Config,o.ViewController])],t)}();i.InvoiceDetailsPage=d},{"../../directives/helpers":19,"../../pipes/pipes":69,"../../providers/api-data":70,"../../providers/data-provider":72,"ionic-angular":"ionic-angular"}],29:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),a=t("../../providers/data-provider"),r=t("../../pipes/pipes"),c=t("../invoice-details/invoice-details"),l=t("../invoice-create/invoice-create"),d=t("../../directives/helpers"),u=function(){function t(t,e,i,n,s){this.nav=t,this.dataProvider=e,this.config=i,this.navParams=n,this.view=s,this.LIMIT=100,this.uninvoices=[],this.initial_load=!0,this.is_empty=!1,this.unis_empty=!1,this.invoices=[],this.uninvoices=[]}return t.prototype.onPageLoaded=function(){var t=this;this.params=this.navParams.data||{},this.details_tab="Ready",this.pager={page:0,limit:this.LIMIT},this.params.account||(this.params.account={id:this.params.account_id||0,name:this.params.account_name||this.config.getCurrent("user").account_name});var e=setTimeout(function(){t.busy=!0,t.unbusy=!0},500);this.getItems(e),this.getItems(e,!0)},t.prototype.onPageWillEnter=function(){var t=this;if(this.params.account.name&&this.view.setBackButtonText(""),!this.initial_load){var e=setTimeout(function(){},500);setTimeout(function(){t.getItems(e),t.getItems(e,!0)},1e3)}this.initial_load=!1},t.prototype.getItems=function(t,e){var i=this;this.dataProvider.getInvoices(this.params.account.id,e||!1,this.pager).subscribe(function(n){e?(i.is_empty=!n.length,i.busy=!1,i.invoices=n):(i.unis_empty=!n.length,i.unbusy=!1,i.uninvoices=n),clearTimeout(t)},function(e){t&&(clearTimeout(t),i.busy=!1),console.log(e||"Server error")})},t.prototype.itemTapped=function(t){this.nav.push(c.InvoiceDetailsPage,t)},t.prototype.createInvoice=function(){this.nav.push(l.InvoiceCreatePage,this.params)},t.prototype.setDate=function(t,e,i){if(t){var n=this.config.getCurrent("timezone_offset");return t=new Date(t.substring(0,23)+"Z")||new Date,t=new Date(t.setTime(t.getTime()+60*n*60*1e3)).toJSON(),d.getDateTime(t,e,i)}return null},t.prototype.getCurrency=function(t){return d.getCurrency(t)},t=n([o.Page({template:'<ion-navbar *navbar><button menuToggle><ion-icon name="menu"></ion-icon></button><ion-title class="padding-right24">Invoices {{params.account.id ? "of&nbsp;" + params.account.name : ""}}</ion-title></ion-navbar><ion-content><ion-segment [(ngModel)]="details_tab"><ion-segment-button value="Ready">Ready To Invoice</ion-segment-button><ion-segment-button value="Invoiced">Invoiced</ion-segment-button></ion-segment><div [ngSwitch]="details_tab"><div [hidden]="details_tab != \'Ready\'"><img *ngIf="unbusy" class="imglogo img-padding" src="img/loading2.gif"><div *ngIf="unis_empty" class="table grey2 menu-text">No Invoices yet</div><div><ion-list class="general-alignment2 invoices" padding><a detail-none href="#" ion-item class="margin" (click)="itemTapped(invoice)" *ngFor="let invoice of uninvoices"><p class="tkts-table left invoices color padding-top6" style="width: 37%">{{setDate(invoice.end_date || invoice.date, true)}}&nbsp;</p><h3 class="color" style="font-size: 1.6rem; text-align: left">{{invoice.account_name || invoice.customer}}</h3><h3 *ngIf="invoice.contract_name" class="color" style="text-align: left;">Contract: {{invoice.contract_name}}</h3><p item-right class="text text-right color" style="width: 20%">{{getCurrency(invoice.total_cost)}}</p></a></ion-list></div></div><div [hidden]="details_tab != \'Invoiced\'"><img *ngIf="busy" class="imglogo img-padding" src="img/loading2.gif"><div *ngIf="is_empty" class="table grey2 menu-text">No Invoices yet</div><div><ion-list class="invoices" padding><a detail-none href="#" ion-item (click)="itemTapped(invoice)" *ngFor="let invoice of invoices"><p style="width: 37%">{{setDate(invoice.end_date || invoice.date, true)}}</p><h3 class="account_name">{{invoice.account_name || invoice.customer}}</h3><h3 *ngIf="invoice.contract_name">Contract: {{invoice.contract_name}}</h3><h4 item-right>{{getCurrency(invoice.total_cost)}}</h4></a></ion-list></div></div></div></ion-content><button (click)="createInvoice()" secondary item-right fab fab-right fab-bottom style="z-index: 2"><ion-icon class="button_circle action-but" name="md-add"></ion-icon></button>',pipes:[r.MorePipe]}),s("design:paramtypes",[o.Nav,a.DataProvider,o.Config,o.NavParams,o.ViewController])],t)}();i.InvoicesPage=u},{"../../directives/helpers":19,"../../pipes/pipes":69,"../../providers/data-provider":72,"../invoice-create/invoice-create":27,"../invoice-details/invoice-details":28,"ionic-angular":"ionic-angular"}],30:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),a=t("../../providers/data-provider"),r=t("../modals/modals"),c=t("../ticket-details/ticket-details"),l=t("../../components/tickets-list/tickets-list"),d=t("../../providers/providers"),u=t("../../directives/helpers"),p=t("../ajax-search/ajax-search"),h=function(){function t(t,e,i,n,s,o,a){this.nav=t,this.navParams=e,this.apiData=i,this.dataProvider=n,this.ticketProvider=s,this.config=o,this.view=a,this.is_ready=!1,this.term=""}return t.prototype.onPageLoaded=function(){this.location=this.navParams.data||{},this.tabsTicket="Open"},t.prototype.onPageWillEnter=function(){this.view.setBackButtonText("")},t.prototype.addTicket=function(){var t=this,e=o.Modal.create(r.TicketCreatePage,{account:{id:-1},location:this.location});e.onDismiss(function(e){t.ticketProvider.getTicketsList("open","-1",t.location.id,{limit:25}),t.gotoTicket(e)}),this.nav.present(e)},t.prototype.gotoTicket=function(t){var e=this;this.test=!1,this.clearSearch(),t&&setTimeout(function(){e.nav.push(c.TicketDetailsPage,t)},500)},t.prototype.searchItems=function(t){var e=this;this.search_results=[];var i=t.value;if(""!=i.trim()&&!this.busy&&i.length>1){var n=setTimeout(function(){e.busy=!0},500);this.searchItemsAPI(i,n)}},t.prototype.searchItemsAPI=function(t,e){var i=this;this.search_results=[];var n="tickets?query=all&location="+this.location.id,s={limit:3};this.apiData.getPaged(u.addp(n,"search",t+"*"),s).subscribe(function(t){e&&(clearTimeout(e),i.busy=!1),i.search_results=t},function(t){e&&(clearTimeout(e),i.busy=!1),console.log(t||"Server error")})},t.prototype.clearSearch=function(t){this.search_results=[],this.busy=!1,t&&(t.value="")},t.prototype.getSearch=function(t){this.test=!1,this.clearSearch();var e=t.target.value;e.length<4&&(e+="    ");var i={search:e,location:this.location};this.test=!1,this.nav.push(p.AjaxSearchPage,i)},t.prototype.toggle=function(){this.test=!this.test,this.test&&setTimeout(function(){var t=document.getElementsByClassName("searchbar-input");t=t[t.length-1],t&&t.focus()},500)},t=n([o.Page({template:'<ion-navbar *navbar><ion-buttons start><button menuToggle><ion-icon name="menu"></ion-icon></button></ion-buttons><ion-title class="names">{{location.name}}&nbsp;{{config.current.names.ticket.p}}</ion-title><ion-buttons end><button danger class="right transparent" (click)="toggle()"><ion-icon name="ios-search"></ion-icon></button></ion-buttons></ion-navbar><div class="tickets mycontent account-details"><ion-searchbar *ngIf="test" [focuser] debounce="700" (cancel)="test = !test" (input)="searchItems($event)" [(ngModel)]="term" placeholder="Enter to search {{config.current.names.ticket.p}}" (search)="getSearch($event)"></ion-searchbar><img *ngIf="busy" class="imglogo" src="img/loading2.gif"><ion-list class="ajax" [hidden]="!search_results"><a detail-none href="#" ion-item *ngFor="let item of search_results" (click)="gotoTicket(item)"><h2>{{item.status}} | #{{item.number}} - {{item.subject}} ({{item.user_firstname}} {{item.user_lastname}})</h2></a></ion-list><ion-item class="margin" id="tickets"><div class="list"><ion-segment [(ngModel)]="tabsTicket" class="height32"><ion-segment-button class="button-open" value="Open">Open {{config.current.names.ticket.ap}}</ion-segment-button><ion-segment-button class="button-open" value="Close">Closed {{config.current.names.ticket.ap}}</ion-segment-button></ion-segment></div></ion-item><br><tickets-list [hidden]="tabsTicket != \'Open\'" [mode]="[\'open\', \'-1\', location.id]"></tickets-list><tickets-list [hidden]="tabsTicket != \'Close\'" preload="1500" [mode]="[\'closed\', \'-1\', location.id]"></tickets-list></div><button (click)="addTicket()" secondary item-right fab fab-right fab-bottom style="z-index: 2"><ion-icon class="button_circle action-but" name="md-add"></ion-icon></button>',directives:[l.TicketsListComponent]}),s("design:paramtypes",[o.Nav,o.NavParams,d.ApiData,a.DataProvider,d.TicketProvider,o.Config,o.ViewController])],t)}();i.LocationDetailsPage=h},{"../../components/tickets-list/tickets-list":14,"../../directives/helpers":19,"../../providers/data-provider":72,"../../providers/providers":74,"../ajax-search/ajax-search":22,"../modals/modals":41,"../ticket-details/ticket-details":54,"ionic-angular":"ionic-angular"}],31:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),a=t("../../providers/data-provider"),r=t("../../components/components"),c=t("../../providers/providers"),l=t("../../directives/helpers"),d=t("../ticket-details/ticket-details"),u=function(){function t(t,e,i,n,s){this.nav=t,this.config=e,this.dataProvider=i,this.apiData=n,this.ticketProvider=s,this.items=[],this.LIMIT=25,this.term=""}return t.prototype.onPageLoaded=function(){var t=this;this.is_empty=!0,this.pager={page:0,limit:this.LIMIT};var e=setTimeout(function(){t.busy=!0},500);this.getItems("",null,e)},t.prototype.searchItems=function(t){this.items=this.data;var e=t.value.trim();""==e.trim()||this.busy||(this.date=Date.now(),this.data&&e.length>1&&(this.items=this.data.filter(function(t){return t.name.toLowerCase().indexOf(e)>-1})))},t.prototype.getItems=function(t,e,i){var n=this,s={page:this.pager.page,limit:this.pager.limit},o=t;t.length>2&&(s.page=0);var a="locations";this.apiData.getPaged(l.addp(a,"search",o),s).subscribe(function(s){i&&(n.is_empty=!s.length,clearTimeout(i),n.busy=!1),n.count=25,!t||t.length<3?(i?n.data=s:(o=n.data).push.apply(o,s),e&&e.enable(25==s.length),n.count=s.length,n.searchItems({value:t})):s.length?n.items=s:n.items=n.data,e&&e.complete();var o},function(t){i&&(clearTimeout(i),n.busy=!1),console.log(t||"Server error")})},t.prototype.doInfinite=function(t){return this.date&&Date.now()-this.date<1e3?void t.complete():this.is_empty||this.count<25?(t.complete(),void((this.is_empty&&!this.term||this.count<25)&&t.enable(!1))):(this.pager.page+=1,this.term="",void this.getItems("",t))},t.prototype.clearSearch=function(t){this.search_results=[],this.busy=!1,t&&(t.value="")},t.prototype.gotoTicket=function(t){var e=this;this.test=!1,this.clearSearch(),t&&(this.ticketProvider.getTicketsList("","","",{limit:25}),setTimeout(function(){e.nav.push(d.TicketDetailsPage,t)},500))},t.prototype.toggle=function(){this.test=!this.test,this.test&&setTimeout(function(){var t=document.getElementsByClassName("searchbar-input");
t=t[t.length-1],t&&t.focus()},500)},t=n([o.Page({template:'<ion-navbar *navbar><ion-buttons start><button menuToggle><ion-icon name="menu"></ion-icon></button></ion-buttons><ion-title class="names">{{config.current.names.location.p}}</ion-title><ion-buttons end><button danger class="right transparent" (click)="toggle()"><ion-icon name="ios-search"></ion-icon></button></ion-buttons></ion-navbar><ion-searchbar *ngIf="test" [focuser] debounce="700" (cancel)="test = !test" (input)="searchItems($event)" [(ngModel)]="term" placeholder="Enter to search (min 3 chars) {{config.current.names.location.p}}"></ion-searchbar><ion-content class="accounts"><p class="general-alignment"></p><img *ngIf="busy" class="imglogo img-padding" src="img/loading2.gif"><locations-list margin-top [simple]="true" [locations]="items"></locations-list><ion-infinite-scroll (infinite)="doInfinite($event)" threshold="30%"><ion-infinite-scroll-content loadingSpinner="circles" loadingText="Loading more data..."></ion-infinite-scroll-content></ion-infinite-scroll></ion-content><action-button></action-button>',directives:[r.LocationsListComponent,r.ActionButtonComponent]}),s("design:paramtypes",[o.Nav,o.Config,a.DataProvider,c.ApiData,c.TicketProvider])],t)}();i.LocationsPage=u},{"../../components/components":5,"../../directives/helpers":19,"../../providers/data-provider":72,"../../providers/providers":74,"../ticket-details/ticket-details":54,"ionic-angular":"ionic-angular"}],32:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),a=t("../../providers/config"),r=t("../../directives/helpers"),c=t("../../providers/data-provider"),l=t("../organizations/organizations"),d=t("../signup/signup"),u=function(){function t(t,e,i,n){this.nav=t,this.dataProvider=e,this.config=i,this.events=n,this.google_action="",this.busy=!1,this.is_sd=a.isSD,this.fileDest={ticket:"wonvhr"},this.skype=localStorage.getItem("skype")||"","true"!==localStorage.getItem("isPhonegap")&&(this.google_action=a.ApiSite+"auth/auth0"),"true"===localStorage.getItem("isExtension")&&window.top.postMessage("logout","*"),n.publish("app:logout")}return t.prototype.onPageLoaded=function(){document.title=a.AppTitle+"Mobile App",this.login={username:localStorage.getItem("username")||""}},t.prototype.onLogin=function(t){var e=this;this.busy=!0,t.valid?(localStorage.setItem("username",t.value.email||""),this.dataProvider.checkLogin(t.value.email,t.value.password).subscribe(function(t){e.config.setCurrent({key:t.api_token}),e.nav.setRoot(l.OrganizationsPage,null,{animation:"wp-transition"})},function(i){var n="There was a problem with your login.  Check your login and password.";t.value.email&&~t.value.email.indexOf("@gmail.com")&&(n="Wrong Password, maybe you used Google password"),e.nav.alert(n,!0),e.login.password="",e.busy=!1})):(this.nav.alert("Please enter email and password!",!0),this.busy=!1)},t.prototype.ngAfterViewInit=function(){},t.prototype.cancel_skype=function(){localStorage.setItem("skype",""),this.skype=""},t.prototype.support=function(){r.openURLsystem("https://support."+a.Site+"portal/")},t.prototype.onGoogleSignin=function(){var t=this;if("true"===localStorage.getItem("isExtension"))this.nav.alert("Please finish login with Google in new window (Google requirement)\n and start Extension again."),setTimeout(function(){window.ww=window.open(a.ApiSite+"auth/auth0","_blank",""),window.auth_google=!!window.ww,window.auth_google||t.nav.alert("Pop-up was blocked, please click again to login.")},window.auth_google?0:3e3);else if("true"===localStorage.getItem("isPhonegap")){var e=a.ApiSite+"auth/auth0?ios_action="+(localStorage.isIos||localStorage.isIosStatus||"");window.win=null,window.nameInterval=null,window.onExit=function(){clearInterval(window.nameInterval),window.win.close(),location.reload(!0)},window.win=window.open(e,"_blank","location=no"),window.win.addEventListener("loadstop",function(){window.nameInterval=setInterval(function(){window.win.executeScript({code:"localStorage.getItem('current')"},function(t){var e=t[0];if(e){localStorage.current=e;var i=JSON.parse(e||"null")||{};i.org&&i.instance&&i.key&&window.onExit()}})},1e3)}),window.win.addEventListener("exit",function(){window.onExit()})}else window.location.href=a.ApiSite+"auth/auth0"},t.prototype.onSignup=function(){this.nav.push(d.SignupPage,null,{animation:"wp-transition"})},t=n([o.Page({template:'<ion-content padding class="login"><div class="list max-width"><a title="Support Portal" (click)="support()"><img class="imglogo img-padding" src="img/logo.png"></a><div *ngIf="skype" style="margin: -15px 0 5px 0;"><center><span>Continue to authorize in</span><img src="img/skype_logo_blue.png" style="width: 120px;vertical-align:middle;"> OR <a style="color: red" (click)="cancel_skype()"><b>Cancel</b></a></center></div><form #loginForm="ngForm" novalidate><div class="tooltips"><input class="width100 blue3 subject-create commentText" type="email" [(ngModel)]="login.username" placeholder="email" ngControl="email" #username="ngForm" required pattern="^[^@\\s]+@[^@\\s]+(\\.[^@\\s]+)+$"> <span *ngIf="username.dirty && !username.valid">Valid Email is required</span></div><br><div class="tooltips"><input class="width100 blue3 subject-create commentText" [(ngModel)]="login.password" placeholder="password" ngControl="password" type="password" #password="ngForm" required> <span *ngIf="password.dirty && !password.valid">Password is required</span></div><br><button class="login-margin" [disabled]="busy" (click)="onLogin(loginForm)" type="submit" block secondary>Login</button></form><br><template [ngIf]="is_sd"><button class="login-margin text-google itemTech itemTech2 SingUp" style="height: 45px !important" (click)="onGoogleSignin()" block light><span class="SingUpimg"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAIAAAAlC+aJAAADgUlEQVR4Ae2ZA7QrORyH17Z1sPYeXNu2bT/btm3bfvfZtt+17XrcZDZrVFu3e5Lzq5ue75vOfzKTPMFbecMCWAALYAEsgAWwABb4tWEBLAA62qji/ZLZkwQFqT0JIV3Bbl2h7j1pUcL+uZKpY+jjh6Gg20IF6HMnRYMLu3ztO33s1AR9Qdgni7l8zoIE2Ds3BPkpCE6rCIvS2Xu3zC3AstIlc7TgVvg3iPUreAjNIwAlYmHvDMShZ8TjhphBAAoFgrwk/elRlbN3bppcgOOE/XKMT280AemCGRoKtFcGsXEVc+MKV1nGVZSiJ8TmNcK+2drTG0GAfXBXHXq/HK7koaq+6CP0BUV6EwpAIMiNU0UvW7NU8yEFyGWrFivSm0gAdh8h5r/fGWCrSI+wrOBUAjxK4k4/S297rTvmp7/To6qwhnMhTiQ/9yoSQGGLXxAWfvUbfXekD5TJrEAAtqxF6H+PdNInnX52xNZ11nE2Ckqy/yWAQm3+nKdINb1u1wKtcrcOGEtAfsNeUQA8iFLfy3uqTNtwwEgCFz9WFIC1Uwwu0CWBxhE4+4oSgebVBheobAPWLXCvHlj3LlTTAa27iIWECQ+j5RdsSY5S02vsblpVCtdSivR+0wlosoFs7eHv7HfGrCvdy+vUVpxhFAVSl5FGPJXg/qhj0ckXB+5zsd0Rg+K9L0PGEryWTQ745KWkosCiE4wRT+ao+7GIvuzE2xG7AhH6n5l+exWvZTt4h1NaADdq5EYUkLTtPlT8mcvOKAT9ryx6sPm//051BwieRSjSozdZuVFPpyFIPD4I4SrNkgdbIK+5Ah83gZgFSuhRUFUY/ZLyTmeJKgGU7NOjHnZXqOrbIG2demuFz7o13tPEivThcwkJZZKLerTHq3FAST85fNXjnVda75YJah50lx+tv7Dq8a6BF6fb74z77QsOG0Z4zWz+l8D2a6yJZiU4wKEtjTj0id2WbPd5t/+kH7SF4oAJJ7YEtFixGLRPnMvS3Yg+ayUpo00+tShmpBmnhuvtEJO4Z3W7CJpncpcF3Oy7a/WhR4WBNoSZp9dvtD9IPjFYW3S/A9k7Ko9YygIH5OGJhssFZ8fb7YzViB56uHBbxWFazljiElMb0bWv5tSkm0tTTgwJPpTvuicZJfxwEaqWoZdnba88Uidp/h8t8mEBLIAFsAAWwAJYAAtgASzwMwUO74BFVO0zAAAAAElFTkSuQmCC" alt="GoogleSignup"></span> <span class="SingUptext button-inner">Sign in with&nbsp;Google</span></button><br><button class="login-margin text-google itemTech itemTech2 SingUp" style="height: 45px !important; border-color: #2e752d !important" (click)="onSignup()" block light><span class="SingUpimg"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAtCAYAAAAk09IpAAANSElEQVR42u2Yd1BUebbH7zzGwVEBQZFBwAYEJCMZwQbJTY6NNFkQsBEQyUFoJGeJCoiMiSAShhwGlCgygAoSRGRAHOMYdx3X2ffku/dNla/qzcq4u7p/vfepunVv1f1Vn0+dc+r8+neJ/+dzYLCRsAw20/uuzN9rOclC8/tD6juECZKiYA8hEzWl7w/Y2CynWer2xsuwe/1bRfbIyUTbFXag4xkwDyB58AmMedY2ka82qQvydqfPv8UwgKU/ARaH82EjK1r2bxHRIYi1RpZOyH8FdJJXUu88dC08ocy5Dk662o/E1q/HHpo1mqfmUP8YOEDautm4I0SeWP/ZZZT4eWwECALawgIwkJeDHB8PVAV4UVFRDZBcH7kKQ2lx6O4Qhq+JPpIt9OHBxwERgjD8rCI+Hh7pB12d3sQEMLHP3g7+7m7IjApGeU4qqk6VoLe9ESOXuzDS24P6pjb0DwxhrL0OA3UVKIoIflB+4oT4ZxHxdHVyDQmLBCslA5HpBUiJjUZV8iFc/e4UHixO4d7NS3g714fHdydxuaUWuYEMtJ4vwdLLX/EGwJM/vcH5c+d+KkhJ2fRHcZSViTUflXH18Oj22u8LB1dPFIf74PxBM5S670GxvSZOxzABvALePcN0fyMq/GgYjDFHtqUYWo5Foqv7EppaOpBXVILknByH1WIw9uyI0ZTkmknz0oxZVSRPl2rk5OPzZwdPJlwtTNAZaAos96H91DGkuFqhwJqK6XMZ+PV2Ny7H0pHrTEVZfBh+mezCu55sjJYn4GhWMRIKjqMwLZG5WhwHquCYLVUQUc4aUx9ckCEubjAqJoY0fyZ0fANga8/ApVg34GYtagqTERdyAAsNxZg7FY0X7bl43pyD0pQYHNnPwJ8HK/C2JRXj3fWIbu1D0tE4PKQZoV9Hx/GDmdERuRFkJ4VYhob/B2WSJcUd6wkCnRLbsc/FDXGeDnjZlILHzZl4N3YBK2PVWCgPxavBM3jUloeFc9F4N1QMvJzG2/lB/NyWie6saJTZ2qNLegfucm5Eq5LSod/HCaCJsXsYSbyMc1FAtDOVn1iNXA3Vi2eo2ig/yETzQUs8rgrHg/ok/HQhHo9qE3Atcz8amCZojbDHdGkQZstiyGwV4knPKdyvDsOAvzn6vfejz0AflVSt4x+c6NKi29z0RRBKV7y2qkiInyflRH3daNPYNQzOLaGirATdwea4m78Pd8uDMVEQiOmTEZjIC8R8dSZmWqtQGczEaCQNywVumMneh7HhXtx6B1x/8AgDt2dP1tTUsP0+jq6ckKWHIYXsl90Bq8roqqkkJWeQTTh+HQODQ7gyMYOW7xpxISMOraH2WCjwQV9GALqyIjFUnIiB48m4le2Ku99lYWKwB1MzM5hZ/Ak3J6cwO38HrV2XUVqQa/P7OPoKQicjHeURRd/Nu/rEFaNohEVGo+dSHzo7u9DX14cRUqhvagnFJ0rRGGyNe6X+uF4YhKX2E/ip2AsLtRmYWH6OG4uPMXPnLqampzEzO4s7C4s4c6bizalT+Qp/Nzr0hN+m+lAvEB/D3tqadeZC3bvBK8O4OjKK4eFhTE5MYOr+CySGBaHGVR0/1x3FL71FmCuPxPjkLGYXH2Jhfg537tzB0vIy5hZ+xMj4TVRWVv5dGQwVKB6xzvKIdNXf9FEZdT4uYVU52VdxSWmouliHi42taO/pxcz8jxiYmEIYbRfq6Qb41koRnXWVWHr+BjcfPMSt+z9jdPIO+kenUXmhcSU7Mz2E+AAHLaVfhThopn5UhLp9q5CzwuY7JiLrVratZ4ekIAW6u6lwZjghITEZzd1Xcf5sHobqQtFGNnBn3ygaSNHSY1lIDj+E9Agmkg/QEW2rtOJrrCBM/A4zDXH/ULrsCxaL9R9/nBHeDX4mYtyLbmpCCDTcATdVfphJ8ECDfwPIQQBO8mI4eOBCUxOya51Q2VGK9qE52O9URDP5Ll10DcqjVXDaSxq98coYKg+ZG7s2UXDlyiWd9zHoqjzPEz13e/+hyG7RrUwT4XWgy22GnRwv7OT54KIshCAbSUQZSaJnDQcOE19ATk4SCeTG6eW3Bxda6hGfkoTArwncI7jRqK+EvGQaCh1F0XM2FT2Do+j8vg/9w9O4vXg3KD6IcchGhn36D0VUtm0RNaKsh73cJpjt4IGlFA/oCnxg7OSDiTQn0v33YynuGOpMFOCrzw87hhcCg31RVtGAdB8dnLDjxUk7O7Sk5CPDUwVMGw0UnmlCbdP3qKlrx4+3BrF4qxlu2luREWBycPWMiIhIaAtxtVvu4IS1DC/2kgK2cnygy26CoSQHzIU3o0ZEBll0GwT7qKHQTgiW2mrwDk3DyZyj+CFRHaejqDjCUEcDRRrBFG7QvdyRfqwIrIQsVB2PxtObObg5VISWM0fw8hE5M8bGPvy3QZV3Xa4hhQO2spthSvaHqzIf3BW5ocBB3BDi4TQ0ExH0PCEg+MJTlANMU3HkMyThpiOJAzE5qIixR1OQHAq81eFvKoZcCplNNvYbVg70vwRFJSHYzx0NOXb4oT4EPzQdwdPlFty7Xd8PrNK8agI8GloCXCdMtnPATnwt9ilsQIDONjgY67e9XyPAzpZhoyqMAD1xRJJlSjhgg4SEFDDVuRFnI40IUykwjeVgp7Z9QUdH50sTI5NEtwOhOOzLQHshA6PNsRjpSMN4RyKutmV//PSgxvVF235TLaQlsNDW3olLgyOobOisI0hEONaGWEltwX5tMTA1NuLIYd+VqCD/lb1SG+BnKA+mnjT8qaLY/hXR9T+D08rKj2ZA66pKZzy9P56FuZEiTA/mFxL/CMa7VAvCYpOQnl+M2rYBNHSNoLq64hVuFyS3pFvf3cm/EeZi3KByEdjnceA/LXZKrRjzEdDk48BeJREEWqniyD6jlxOX8354Ol8b9f53LbRkbMOdlHA8yqKIxaJ/9Q/JODm5XPRm+sE3IByZqUcx3pSMx9V0nA3WhrbIZuxVpSD1kClOZ4egOC9xpTDWHRnhzihOD8TJTCYyI+iYu3p8pb8+ruV0ghlmxy5G/1ZiNiJDcC3RTPwz7LU2lbJw3P9mnxMdLak0zBbpwtVKH4QSC1/Ku0FqDTt8NSloqYjHeGsUliZLkUcKZAeaIYgmDUuZreiujlgZGKjgriyKSJgbykJ14WHTYCPKHdNdihTin8XG1MYsyln91+Yju3E6VBcbrdLxjVclth9uAMXQD1zs26CsREUWywd7zfUhQxAw4yGgy0nAT5UDbTWxuNxz9rcSTQ9l42Q4DY4aEg7Ev4Kvmbo4i6H4ujPVEGdjzcFllwthr28hTE+CoMsxrKGfRWpiAFrznJGQxQKvTiBUVEgps0NQMD+Ilur4t9eHyloXJyt2vVg495eSeIeRf/3Qpqy8JtlbL/xKgeWC116L+4RWNDY5FmCDXT44DA6D0yoVKj7HkFmcDafks5AM7YBGbAesi6chnzGP6PhwPLt5vHxy8ETa/alSdLYU7iQ+BRdD+fUaFN4SQszjsZGFFUItpaBh4UrKhIHfwPe6ID21Zq11ySWKU8GCRtBp6MXUwzS+EZbFM9BjNb6e6WK1LY+k/3y1K5dFfA64CDZ9FWXz53nkXuTNR8BFgoC14/4j/2suOcWGbvcuBzX4PAyiLsL94n2YZw2d0xDaWJUbbJrySQIBNBp7hIlkZpiJ+OVDBtu9q5SFJ0LktpD70zfQ4v0axnJS1PdrWe6UteoW3hfZXGog4PEtNALKYVYyCz0zzxdcBPHp32d8tbaVxxkLIVJ7C0J0BGClwA8jiY1wUt0K8vQOVV7OxvdrQ3dztdrqKcIgogy0uHPYlTkGvdgGiHzF9iPxOUi1lpgn9xi47VFEpJUWDqhvgbc6P3ZvZgNDVxvK3FxwNtb8LTtGygrWLiq8z4JVOFGyZwtoiY0Qcsx5LEAQCp9FJsdZvYK8gRlyFGaWdBjvIqXMFcHUk8U7AFeGhlFbXX0PgBxBwkkQp2S/JMCQYEezvhqqdmjWE58LR9n1fAmRkR1ZKSm3nO1sF2sbmkdNzG1eJ6WkY5k8jD198Qo9/Vfw9u1fX7fV1PBuJIhiDX4uGMrzI3f7N2gwknl4LsK47GLw7pRD1upSnyyE10/4WX5+G/Ly8thZkYfF0jKzH45en0JrWyfGx2+gpa0Ds/eeoa+mMMxR9Isrol+vgxovDxzIcjKofLAT50DQHkHEmFDeuujIyxKfA1MqVZNGM7l9+lwFZm7dRt/A4G/np8u9/RieWviv7rPHfulhyiLFUgaKW7ihLsAFS7LZ/bWEwNQQQKw2N2KMhD6tbNcnr9Ozs7KvOrt5/NXUygaHw8IxSPbKleGrGCCFhsjnvv4hTC49QUNaIMK0eMGyUoCLCgUJtspIcDeFr4szvK1pKPIxLPgkmbKSEk9lFfVXPNzcvWvY2AokhIXDO9vaHK9du2Z1uX/IfGBgwGZ4qCdy6d49l8LCPOf/3uwDDWRNqz0VdA862Znv8wt3iAsP9U7KzlcDQXzxSTJ0us4G8maxjjxrkQ+SxP9V/gaiwZcQpDUlrwAAAABJRU5ErkJggg==" alt="SherpaSignup"></span> <span class="SingUptext button-inner" style="background-color: #2e752d !important">Create New Account</span></button></template></div></ion-content>'}),s("design:paramtypes",[o.Nav,c.DataProvider,o.Config,o.Events])],t)}();i.LoginPage=u},{"../../directives/helpers":19,"../../providers/config":71,"../../providers/data-provider":72,"../organizations/organizations":46,"../signup/signup":50,"ionic-angular":"ionic-angular"}],33:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),a=t("../../../providers/data-provider"),r=function(){function t(t,e,i,n,s){this.nav=t,this.navParams=e,this.dataProvider=i,this.config=n,this.viewCtrl=s,this.firstname_m="",t.swipeBackEnabled=!1}return t.prototype.ngOnInit=function(){this.ispassword=!0,this.data=(this.navParams.data||{}).type||{},this.firstname_m=(this.navParams.data||{}).name||" "},t.prototype.ngAfterViewInit=function(){setTimeout(function(){var t=document.getElementsByTagName("ion-page")[0];t.style.display="none",t.offsetHeight,t.style.display=""},200),this.firstname_m=this.firstname_m.trim()},t.prototype.dismissPage=function(t){this.viewCtrl.dismiss(t)},t.prototype.onSubmit=function(t){var e=this;t.valid&&this.dataProvider.addUser(t.value.email,t.value.firstname,t.value.lastname,this.data.type).subscribe(function(t){e.nav.alert(e.data.charAt(0).toUpperCase()+e.data.slice(1)+" was created :)"),setTimeout(function(){e.dismissPage(t)},1e3)},function(i){e.nav.alert(t.value.email+" already exists! Please try again",!0),console.log(i||"Server error")})},t=n([o.Page({template:'<ion-toolbar><ion-buttons start class="searchbar"><button (click)="dismissPage()"><span primary>Cancel</span></button></ion-buttons><ion-title>Add {{data != "tech" ? config.current.names.user.a : config.current.names.tech.a}}</ion-title></ion-toolbar><ion-content><ion-list class="list"><p class="general-alignment"></p><form #addForm="ngForm"><div class="tooltips"><upload-button #u (filesUploaded)="uploadedFile($event)" (filesSelected)="selectedFile($event)" btnStyle="add-circle" [allowMultiple]="true" [fileDest]="fileDest" [filesExist]="attachments" [logCallback]></upload-button></div><div class="img-top"><button [disabled]="!addForm.valid" secondary block (click)="onSubmit(addForm)" type="submit" class="disable-hover button button-default button-block">Add New {{data != "tech" ? "User" : "Tech"}}</button><br><button *ngIf="config.current.is_time_tracking" (click)="dismissPage()" block type="submit" class="blue2 disable-hover button button-default button-block class-margin">Cancel</button></div></form></ion-list></ion-content>'}),s("design:paramtypes",[o.Nav,o.NavParams,a.DataProvider,o.Config,o.ViewController])],t)}();i.AddFilesModal=r},{"../../../providers/data-provider":72,"ionic-angular":"ionic-angular"}],34:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),a=t("../../../providers/data-provider"),r=function(){function t(t,e,i,n,s){this.nav=t,this.navParams=e,this.dataProvider=i,this.config=n,this.viewCtrl=s,this.firstname_m="",t.swipeBackEnabled=!1}return t.prototype.ngOnInit=function(){this.ispassword=!0,this.data=(this.navParams.data||{}).type||{},this.firstname_m=(this.navParams.data||{}).name||" "},t.prototype.ngAfterViewInit=function(){setTimeout(function(){var t=document.getElementsByTagName("ion-page")[0];t.style.display="none",t.offsetHeight,t.style.display=""},200),this.firstname_m=this.firstname_m.trim()},t.prototype.dismissPage=function(t){this.viewCtrl.dismiss(t)},t.prototype.onSubmit=function(t){var e=this;t.valid&&this.dataProvider.addUser(t.value.email,t.value.firstname,t.value.lastname,this.data.type).subscribe(function(t){setTimeout(function(){e.dismissPage(t)},1e3)},function(i){e.nav.alert(t.value.email+" already exists! Please try again",!0),console.log(i||"Server error")})},t=n([o.Page({template:'<ion-toolbar><ion-buttons start class="searchbar"><button (click)="dismissPage()"><span primary>Cancel</span></button></ion-buttons><ion-title>Add {{data != "tech" ? config.current.names.user.a : config.current.names.tech.a}}</ion-title></ion-toolbar><ion-content><ion-list class="list"><p class="general-alignment"></p><form #addForm="ngForm"><div class="tooltips"><input class="add-user-input" autofocus tabindex="1" type="email" [ngModel]="email_m" placeholder="Valid Email" ngControl="email" #username="ngForm" required pattern="^[^@\\s]+@[^@\\s]+(\\.[^@\\s]+)+$"> <span *ngIf="username.dirty && !username.valid">Valid Email is required</span></div><div class="tooltips"><input class="add-user-input" type="text" [ngModel]="firstname_m" placeholder="Firstname" ngControl="firstname" #firstname="ngForm" required> <span *ngIf="firstname.dirty && !firstname.valid">Firstname cannot be empty</span></div><div class="tooltips"><input class="add-user-input" type="text" [ngModel]="lastname_m" placeholder="Lastname" ngControl="lastname" #lastname="ngForm" required> <span *ngIf="lastname.dirty && !lastname.valid">Lastname cannot be empty</span></div><div class="img-top"><button [disabled]="!addForm.valid" secondary block (click)="onSubmit(addForm)" type="submit" class="disable-hover button button-default button-block">Add New {{data != "tech" ? "User" : "Tech"}}</button><br><button *ngIf="config.current.is_time_tracking" (click)="dismissPage()" block type="submit" class="blue2 disable-hover button button-default button-block class-margin">Cancel</button></div></form></ion-list></ion-content>'}),s("design:paramtypes",[o.Nav,o.NavParams,a.DataProvider,o.Config,o.ViewController])],t)}();i.AddUserModal=r},{"../../../providers/data-provider":72,"ionic-angular":"ionic-angular"}],35:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),a=t("../../../providers/api-data"),r=t("../../../providers/config"),c=t("../modals"),l=t("../../../directives/helpers"),d=function(){function t(t,e,i,n,s){this.nav=t,this.navParams=e,this.config=i,this.apiData=n,this.viewCtrl=s,this.isdefault_enabled=!1,this.isnew_enabled=!1,t.swipeBackEnabled=!1}return t.prototype.ngOnInit=function(){var t=this;if(this.term="",this.name=this.navParams.data.name||"List",this.isdefault_enabled=!~["user","account","tech","task type"].indexOf(this.name.toLowerCase()),this.isnew_enabled=this.config.current.is_add_new_user_link&&!!~["user","tech"].indexOf(this.name.toLowerCase()),this.url=this.navParams.data.url||"",this.data=this.navParams.data.items||{},this.pager={limit:20},this.items=this.data,this.count=this.items.length,this.is_empty=!1,0===this.items.length){var e=setTimeout(function(){t.busy=!0},500);this.getItems(null,e)}},t.prototype.onPageDidEnter=function(){var t=document.getElementsByClassName("searchbar-input");t=t[t.length-1],t&&t.focus()},t.prototype.dismiss=function(t){t=t||{},this.viewCtrl.dismiss(t)},t.prototype.invite=function(){var t=this,e=o.Modal.create(c.AddUserModal,{type:this.name.toLowerCase(),name:this.term});e.onDismiss(function(e){e&&(e.name=l.getFullName(e.firstname,e.lastname,e.email),t.dismiss(e))}),this.nav.present(e)},t.prototype.searchItems=function(t){var e=this;this.items=this.data;var i=t.value.trim();if(""==i.trim()||this.busy)return void(""==i.trim()&&(this.is_empty=!this.items.length));if(i.length<3)this.items=this.items.filter(function(t){return t.name.toLowerCase().indexOf(i.toLowerCase())>-1}),this.is_empty=!this.items.length;else{var n=setTimeout(function(){e.busy=!0},500);this.getItems(i,n)}},t.prototype.getItems=function(t,e){var i=this;this.items=[],r.isSD&&~["location","account"].indexOf(this.name.toLowerCase())&&(t+="*"),this.apiData.getPaged(l.addp(this.url,"search",t),this.pager).subscribe(function(n){if(n.length&&!n[0].name){var s=[];n.forEach(function(t){var e;t.email&&(e=l.getFullName(t.firstname,t.lastname,t.email," ")),s.push({id:t.id,name:e,email:t.email})}),n=s}e&&(clearTimeout(e),i.busy=!1),i.is_empty=!n.length,t?i.items=n:i.items=i.data=n,i.count=n.length},function(t){e&&(clearTimeout(e),i.busy=!1),console.log(t||"Server error")})},t=n([o.Page({template:'<ion-toolbar><ion-buttons style="flex: 1;" start><button (click)="dismiss()"><span>Cancel</span></button></ion-buttons><ion-searchbar debounce="400" [(ngModel)]="term" (input)="searchItems($event)" placeholder="{{name}} (min 3 chars)" hideCancelButton="true"></ion-searchbar></ion-toolbar><ion-content><img *ngIf="busy" src="img/loading2.gif" class="imglogo img-padding"><ion-list class="ajax"><a *ngIf="isdefault_enabled" detail-none href="#" ion-item (click)="dismiss({name: \'Default\', id: 0})"><h2>Default (no selection)</h2></a> <a *ngIf="isnew_enabled" detail-none href="#" ion-item (click)="invite()"><h2 class="color"><ion-icon name="add-circle"></ion-icon>&nbsp;&nbsp;&nbsp;Invite new {{name}} {{is_empty ? \'"\'+term+\'"\' : ""}}</h2></a> <a detail-none href="#" ion-item *ngFor="let item of items" (click)="dismiss(item)"><h2>{{item.name}}</h2></a></ion-list><div *ngIf="is_empty && !isdefault_enabled && !isnew_enabled" class="table grey2 menu-text">No {{name}} found yet</div></ion-content>'}),s("design:paramtypes",[o.Nav,o.NavParams,o.Config,a.ApiData,o.ViewController])],t)}();i.AjaxSelectModal=d},{"../../../directives/helpers":19,"../../../providers/api-data":70,"../../../providers/config":71,"../modals":41,"ionic-angular":"ionic-angular"}],36:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),a=t("../modals"),r=t("../../../directives/helpers"),c=function(){function t(t,e,i,n){this.nav=t,this.params=e,this.viewCtrl=i,this.config=n,this.searchQuery="",this.is_empty=!1,this.isdefault_enabled=!1,this.isnew_enabled=!1,this.name=this.params.data.name,this.isdefault_enabled=!~["user","account","tech","task type"].indexOf(this.name.toLowerCase()),this.isnew_enabled=this.config.current.is_add_new_user_link&&!!~["user","tech"].indexOf(this.name.toLowerCase()),this.data=this.params.data.items,this.items=this.data}return t.prototype.onPageDidEnter=function(){var t=document.getElementsByClassName("searchbar-input");t=t[t.length-1],t&&t.focus()},t.prototype.dismiss=function(t){t=t||{},this.viewCtrl.dismiss(t)},t.prototype.onPageDidEnter=function(){var t=document.getElementsByClassName("searchbar-input");t=t[t.length-1],t&&t.focus()},t.prototype.invite=function(){var t=this,e=o.Modal.create(a.AddUserModal,{type:this.name.toLowerCase(),name:this.searchQuery});e.onDismiss(function(e){e&&(e.name=r.getFullName(e.firstname,e.lastname,e.email),t.dismiss(e))}),this.nav.present(e)},t.prototype.getItems=function(t){this.items=this.data;var e=t.value;""!=e.trim()&&(this.items=this.items.filter(function(t){return t.name.toLowerCase().indexOf(e.toLowerCase())>-1}),this.is_empty=!this.items.length)},t=n([o.Page({template:'<ion-toolbar><ion-buttons style="flex: 1;" start><button (click)="dismiss()"><span>Cancel</span></button></ion-buttons><ion-searchbar [ngModel]="searchQuery" (input)="getItems($event)" [placeholder]="name" hideCancelButton="true"></ion-searchbar></ion-toolbar><ion-content><ion-list class="basic-list"><a *ngIf="isdefault_enabled" detail-none href="#" ion-item (click)="dismiss({name: \'Default\', id: 0})"><h2>Default (no selection)</h2></a> <a *ngIf="isnew_enabled" detail-none href="#" ion-item (click)="invite()"><h2 class="color"><ion-icon name="add-circle"></ion-icon>&nbsp;&nbsp;&nbsp;Invite new {{name}} {{is_empty ? \'"\'+searchQuery+\'"\' : ""}}</h2></a> <a detail-none href="#" ion-item *ngFor="let item of items" (click)="dismiss(item)"><h2>{{item.name}}</h2></a></ion-list><div *ngIf="is_empty && !isdefault_enabled && !isnew_enabled" class="table grey2 menu-text">No {{name}} found yet</div></ion-content>'}),s("design:paramtypes",[o.Nav,o.NavParams,o.ViewController,o.Config])],t)}();i.BasicSelectModal=c},{"../../../directives/helpers":19,"../modals":41,"ionic-angular":"ionic-angular"}],37:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),a=t("@angular/core"),r=t("../../../providers/ticket-provider"),c=t("../../../directives/helpers"),l=t("../../../components/select-list/select-list"),d=function(){function t(t,e,i,n,s){this.nav=t,this.navParams=e,this.ticketProvider=i,this.config=n,this.viewCtrl=s,t.swipeBackEnabled=!1,this.config=n}return t.prototype.ngOnInit=function(){this.ticket=this.navParams.data||0,this.selects={user:{name:"user",value:"Choose",selected:0,hidden:!1,url:"users"}}},t.prototype.dismiss=function(t){this.viewCtrl.dismiss(t)},t.prototype.saveSelect=function(t){t.type;this.selects.selected=t.id,this.selects.value=t.name},t.prototype.onSubmit=function(t){var e=this;if(t.valid){var i=c.htmlEscape((this.ticketnote||"").trim()).substr(0,5e3),n={note_text:i,name:this.selects.value,user_id:this.selects.selected,action:"transfer"};this.ticketProvider.transferUserTech(this.ticket.key,n).subscribe(function(t){e.nav.alert(e.config.current.names.ticket.s+" has been transferred :)"),e.dismiss(n)},function(t){e.nav.alert(t,!0),console.log(t||"Server error")})}},t=n([o.Page({template:'<ion-toolbar><ion-buttons start class="searchbar"><button (click)="dismiss()"><span primary>Cancel</span></button></ion-buttons><ion-title class="ellipsis padding-right24 padding-left87">Change {{config.current.names.user.s}} #{{ticket.number}} {{ticket.subject}}</ion-title></ion-toolbar><ion-content class="has-header"><div class="list max-width700 general-alignment"><select-list preload="true" [list]="selects.user" (onChanged)="saveSelect($event)"></select-list><form #addForm="ngForm" class="response-ticket"><div class="tooltips"><textarea class="width100 textLogin commentText" style="margin-left:2px" [(ngModel)]="ticketnote" type="text" placeholder="Add Transfer Note" ngControl="note" #note="ngForm" maxlength="4000"></textarea> <span [hidden]="note.valid || note.untouched">Note should be less 5000 chars</span></div><button secondary class="button_reply img-top right" [disabled]="!addForm.valid" (click)="onSubmit(addForm)" type="submit">Change {{config.current.names.user.s}}</button></form></div></ion-content>',directives:[a.forwardRef(function(){return l.SelectListComponent})]}),s("design:paramtypes",[o.Nav,o.NavParams,r.TicketProvider,o.Config,o.ViewController])],t)}();i.ChangeUserModal=d},{"../../../components/select-list/select-list":12,"../../../directives/helpers":19,"../../../providers/ticket-provider":75,"@angular/core":"@angular/core","ionic-angular":"ionic-angular"}],38:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),a=t("@angular/core"),r=t("../../../providers/ticket-provider"),c=t("../../../providers/api-data"),l=t("../../../components/class-list/class-list"),d=t("../../../directives/helpers"),u=t("../../../components/select-list/select-list"),p=function(){function t(t,e,i,n,s,o){this.nav=t,this.navParams=e,this.apiData=i,this.ticketProvider=n,this.config=s,this.viewCtrl=o,this.users=[],t.swipeBackEnabled=!1,this.config=s}return t.prototype.ngOnInit=function(){var t=this;this.isconfirm=!0,this.ticket=this.navParams.data||0,console.log(this.config.current,"this.config.current"),this.categories=[],this.he=this.config.getCurrent("user"),this.selects={resolution:{name:"Resolution",value:"Resolved",selected:1,hidden:!1,items:[{name:"Resolved",id:1},{name:"UnResolved",id:0}]},cc:{name:"CC",value:"Choose "+this.config.current.names.user.s,selected:0,url:"users",hidden:!1},"class":{name:"Class",value:this.ticket.class_name,selected:this.ticket.class_id,url:"classes",hidden:!0},category:{name:"Category",value:"Choose",selected:0,hidden:!1,items:[]}},this.config.current.is_resolution_tracking&&this.apiData.get("resolution_categories").subscribe(function(e){t.categories=e,t.selects.category.items=e.filter(function(t){return t.is_resolved}),t.selects.category.hidden=!t.selects.category.items.length},function(t){console.log(t||"Server error")})},t.prototype.dismiss=function(t){this.viewCtrl.dismiss(t||0)},t.prototype.saveSelect=function(t){var e=t.type;if("resolution"==e)this.selects[e].selected=t.id,this.selects[e].value=t.name,this.selects.category.value="Choose",this.selects.category.selected=0,this.selects.category.items=this.selects.resolution.selected?this.categories.filter(function(t){return t.is_resolved}):this.categories.filter(function(t){return!t.is_resolved}),this.selects.category.hidden=!this.selects.category.items.length;else if("category"==e)this.selects[e].selected=t.id,this.selects[e].value=t.name;else if("class"==e)this.selects[e].selected=t.id,this.selects[e].value=t.name;else if("cc"==e){this.selects[e].selected=0,this.selects[e].value="Choose "+this.config.current.names.user.s;var i={id:t.email,name:t.name};0==this.users.filter(function(t){return t.id==i.id}).length&&this.users.push(i)}},t.prototype.deleteUser=function(t){for(var e,i=0;i<this.users.length;i++)this.users[i].id==t&&(e=i);
this.users.splice(e,1)},t.prototype.onSubmit=function(t){var e=this;if(t.valid){var i=d.htmlEscape((this.ticketnote||"").trim()).substr(0,5e3);if(this.selects["class"].selected)return void this.nav.alert("A class must be entered before ticket may be closed!",!0);if(this.config.current.is_ticket_require_closure_note&&!i.length)return void this.nav.alert("Note is required!",!0);var n=this.users.map(function(t){return t.id}).join(", "),s={status:"closed",note_text:i,is_send_notifications:!0,resolved:1==this.selects.resolution.selected,resolution_id:this.selects.category.selected,class_id:this.selects["class"].selected,confirmed:this.isconfirm,confirm_note:"",cc:n};this.ticketProvider.closeOpenTicket(this.ticket.key,s).subscribe(function(t){e.nav.alert("Ticket has been closed :)"),e.dismiss(1)},function(t){console.log(t||"Server error")})}},t=n([o.Page({template:'<ion-toolbar><ion-buttons start class="searchbar"><button (click)="dismiss()"><span primary>Cancel</span></button></ion-buttons><ion-title class="ellipsis padding-right24 padding-left87">Close {{config.current.names.ticket.s}} #{{ticket.number}} {{ticket.subject}}</ion-title></ion-toolbar><ion-content class="has-header"><div class="list max-width700 general-alignment"><select-list [list]="selects.resolution" preload="true" (onChanged)="saveSelect($event)"></select-list><select-list [list]="selects.category" preload="true" (onChanged)="saveSelect($event)"></select-list><class-list preload="true" [list]="selects.class" (onChanged)="saveSelect($event)"></class-list><select-list [list]="selects.cc" preload="true" (onChanged)="saveSelect($event)"></select-list><div class="width100"><div *ngFor="let user of users" style="padding-left: 7px;"><p class="left text-toggle color width90" style="margin-top: 5px;margin-bottom: 0px;">{{user.name}}</p><button style="background-color: unset; height: 17px; width: 1.6em;" class="width10" (click)="deleteUser(user.id)"><ion-icon class="invoiceCircle right" style="padding:0px !important" name="close"></ion-icon></button></div></div><form #addForm="ngForm" class="response-ticket width100" style="display: block;"><template [ngIf]="config.current.is_confirmation_tracking"><ion-item no-lines class="left toggle-width"><ion-toggle class="toggle" [(ngModel)]="isconfirm" disabled="false"></ion-toggle></ion-item><p class="left width35 text-toggle color">Confirm Now?</p></template><div class="tooltips"><textarea class="width100 textLogin commentText" [(ngModel)]="ticketnote" type="text" placeholder="Add closing comments" ngControl="note" #note="ngForm" maxlength="4000"></textarea> <span [hidden]="note.valid || note.untouched">Note should be less 5000 chars</span></div><button secondary class="button_reply img-top right" [disabled]="!addForm.valid" (click)="onSubmit(addForm)" type="submit">Close {{config.current.names.ticket.s}}</button></form></div></ion-content>',directives:[a.forwardRef(function(){return u.SelectListComponent}),a.forwardRef(function(){return l.ClassListComponent})]}),s("design:paramtypes",[o.Nav,o.NavParams,c.ApiData,r.TicketProvider,o.Config,o.ViewController])],t)}();i.CloseTicketModal=p},{"../../../components/class-list/class-list":4,"../../../components/select-list/select-list":12,"../../../directives/helpers":19,"../../../providers/api-data":70,"../../../providers/ticket-provider":75,"@angular/core":"@angular/core","ionic-angular":"ionic-angular"}],39:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),a=t("../../../providers/api-data"),r=t("../../../providers/config"),c=t("../../../directives/helpers"),l=t("../modals"),d=function(){function t(t,e,i,n,s){this.nav=t,this.navParams=e,this.config=i,this.apiData=n,this.viewCtrl=s,this.isnew_enabled=!1,t.swipeBackEnabled=!1}return t.prototype.ngOnInit=function(){var t=this;if(this.term="",this.name=this.navParams.data.name||"List",this.isnew_enabled=this.config.current.is_add_new_user_link&&!!~["user","tech"].indexOf(this.name.toLowerCase()),this.url=this.navParams.data.url||"",this.data=this.navParams.data.items||{},this.items=this.data,this.items.forEach(function(t){t.is_selected=!1}),this.count=this.items.length,this.isbutton=this.navParams.data.isbutton,this.is_empty=!1,this.pager={page:this.count%25==0?Math.max(this.count/25-1,0):0,limit:25},0===this.items.length){var e=setTimeout(function(){t.busy=!0},500);this.getItems("",null,e)}},t.prototype.dismiss=function(t){return t?(this.selected_items=t.filter(function(t){return t.is_selected}),void this.viewCtrl.dismiss(this.selected_items)):void this.viewCtrl.dismiss(t)},t.prototype.invite=function(){var t=this,e=o.Modal.create(l.AddUserModal,{type:this.name.toLowerCase(),name:this.term});e.onDismiss(function(e){e&&(e.name=c.getFullName(e.firstname,e.lastname,e.email),t.dismiss(e))}),this.nav.present(e)},t.prototype.searchItems=function(t){var e=this;this.items=this.data;var i=t.value.trim();if(""==i.trim()||this.busy)return void(""==i.trim()&&(this.is_empty=!this.items.length,this.count=25));if(this.date=Date.now(),i.length<3)this.items=this.items.filter(function(t){return t.name.toLowerCase().indexOf(i.toLowerCase())>-1}),this.is_empty=!this.items.length,this.count=25;else{var n=setTimeout(function(){e.busy=!0},500);this.getItems(i,null,n)}},t.prototype.getItems=function(t,e,i){var n=this,s={page:this.pager.page,limit:this.pager.limit},o=t;e||(this.pager.page=0,s.page=0,this.items=[]),r.isSD&&~["location","account"].indexOf(this.name.toLowerCase())&&(o=t+"*"),this.apiData.getPaged(c.addp(this.url,"search",o),s).subscribe(function(s){if(s.length&&!s[0].name){var o=[];s.forEach(function(t){var e;t.email?e=c.getFullName(t.firstname,t.lastname,t.email,n.isbutton?"":" "):t.number&&(e="#"+t.number+": "+t.subject),o.push({id:t.id,name:e,email:t.email})}),s=o}i&&(n.is_empty=!s.length,clearTimeout(i),n.busy=!1),n.count=25,!t||t.length<3?(i?n.data=s:(a=n.data).push.apply(a,s),n.count=s.length,n.searchItems({value:t})):s.length?(n.count=s.length,(r=n.items).push.apply(r,s)):n.items=n.data,e&&e.complete();var a,r},function(t){i&&(clearTimeout(i),n.busy=!1),console.log(t||"Server error")})},t.prototype.doInfinite=function(t){return this.date&&Date.now()-this.date<1e3?void t.complete():this.is_empty||this.count<25?void t.complete():(this.pager.page+=1,void this.getItems(this.term,t))},t=n([o.Page({template:'<ion-toolbar><ion-buttons style="flex: 0;" start><button (click)="dismiss()"><span>Cancel</span></button></ion-buttons><ion-searchbar debounce="400" [(ngModel)]="term" (input)="searchItems($event)" placeholder="{{name}} (min 3 chars)" hideCancelButton="true"></ion-searchbar><ion-buttons style="flex: 0;" end><button (click)="dismiss(items)"><span>Done</span></button></ion-buttons></ion-toolbar><ion-content class="has-header"><img *ngIf="busy" class="imglogo img-padding" src="img/loading2.gif"><ion-list class="list basic-list"><a *ngIf="isnew_enabled" detail-none href="#" ion-item (click)="invite()" class="basic-margin text-left"><ion-icon name="add-circle" style="padding-left: 12px;font-size: 38px; float:left;"></ion-icon><h2 class="color" style="margin-top:8px">&nbsp;&nbsp;&nbsp;Invite new {{name}} {{is_empty ? \'"\'+term+\'"\' : ""}}</h2></a><div><a detail-none href="#" ion-item class="basic-margin text-left" *ngFor="let item of items" (click)="item.is_selected = !item.is_selected"><ion-icon [ngClass]="{\'ion-ios-checkmark-circle secondary\' : item.is_selected, \'ion-ios-radio-button-on grey2\' : !item.is_selected}" class="font18 todos-padding margin-top3" style="float:left;"></ion-icon><h2 class="color">{{item.name}}</h2><h5 style="color: #cccaca;">{{item.email}}</h5></a></div></ion-list><div *ngIf="is_empty && !isdefault_enabled && !isnew_enabled" class="table grey2 menu-text">No {{name}} found yet</div><ion-infinite-scroll (infinite)="doInfinite($event)" threshold="30%"><ion-infinite-scroll-content loadingSpinner="circles" loadingText="Loading more data..."></ion-infinite-scroll-content></ion-infinite-scroll></ion-content>'}),s("design:paramtypes",[o.Nav,o.NavParams,o.Config,a.ApiData,o.ViewController])],t)}();i.InfinityMultiSelectModal=d},{"../../../directives/helpers":19,"../../../providers/api-data":70,"../../../providers/config":71,"../modals":41,"ionic-angular":"ionic-angular"}],40:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),a=t("../../../providers/api-data"),r=t("../../../providers/config"),c=t("../../../directives/helpers"),l=t("../modals"),d=function(){function t(t,e,i,n,s){this.nav=t,this.navParams=e,this.config=i,this.apiData=n,this.viewCtrl=s,this.isdefault_enabled=!1,this.isnew_enabled=!1,t.swipeBackEnabled=!1}return t.prototype.ngOnInit=function(){var t=this;if(this.term="",this.name=this.navParams.data.name||"List",this.isdefault_enabled=!~["user","account","tech","task type"].indexOf(this.name.toLowerCase()),this.isnew_enabled=this.config.current.is_add_new_user_link&&!!~["user","tech"].indexOf(this.name.toLowerCase()),this.url=this.navParams.data.url||"",this.data=this.navParams.data.items||{},this.items=this.data,this.count=this.items.length,this.isbutton=this.navParams.data.isbutton,this.is_empty=!1,this.pager={page:this.count%25==0?Math.max(this.count/25-1,0):0,limit:25},0===this.items.length){var e=setTimeout(function(){t.busy=!0},500);this.getItems("",null,e)}},t.prototype.onPageDidEnter=function(){var t=document.getElementsByClassName("searchbar-input");t=t[t.length-1],t&&t.focus()},t.prototype.dismiss=function(t){t=t||{},this.viewCtrl.dismiss(t)},t.prototype.invite=function(){var t=this,e=o.Modal.create(l.AddUserModal,{type:this.name.toLowerCase(),name:this.term});e.onDismiss(function(e){e&&(e.name=c.getFullName(e.firstname,e.lastname,e.email),t.dismiss(e))}),this.nav.present(e)},t.prototype.searchItems=function(t){var e=this;this.items=this.data;var i=t.value.trim();if(""==i.trim()||this.busy)return void(""==i.trim()&&(this.is_empty=!this.items.length,this.count=25));if(this.date=Date.now(),i.length<3)this.items=this.items.filter(function(t){return t.name.toLowerCase().indexOf(i.toLowerCase())>-1}),this.is_empty=!this.items.length,this.count=25;else{var n=setTimeout(function(){e.busy=!0},500);this.getItems(i,null,n)}},t.prototype.getItems=function(t,e,i){var n=this,s={page:this.pager.page,limit:this.pager.limit},o=t;e||(this.pager.page=0,s.page=0,this.items=[]),r.isSD&&~["location","account"].indexOf(this.name.toLowerCase())&&(o=t+"*"),this.apiData.getPaged(c.addp(this.url,"search",o),s).subscribe(function(s){if(s.length&&!s[0].name){var o=[];s.forEach(function(t){var e;t.email?e=c.getFullName(t.firstname,t.lastname,t.email,n.isbutton?"":" "):t.number&&(e="#"+t.number+": "+t.subject),o.push({id:t.id,name:e,email:t.email})}),s=o}i&&(n.is_empty=!s.length,clearTimeout(i),n.busy=!1),n.count=25,!t||t.length<3?(i?n.data=s:(a=n.data).push.apply(a,s),n.count=s.length,n.searchItems({value:t})):s.length?(n.count=s.length,(r=n.items).push.apply(r,s)):n.items=n.data,e&&e.complete();var a,r},function(t){i&&(clearTimeout(i),n.busy=!1),console.log(t||"Server error")})},t.prototype.doInfinite=function(t){return this.date&&Date.now()-this.date<1e3?void t.complete():this.is_empty||this.count<25?void t.complete():(this.pager.page+=1,void this.getItems(this.term,t))},t=n([o.Page({template:'<ion-toolbar><ion-buttons style="flex: 0;" start><button (click)="dismiss()"><span>Cancel</span></button></ion-buttons><ion-searchbar debounce="400" [(ngModel)]="term" (input)="searchItems($event)" placeholder="{{name}} (min 3 chars)" hideCancelButton="true"></ion-searchbar><ion-buttons style="flex: 0;" end><button (click)="dismiss()"><span>Done</span></button></ion-buttons></ion-toolbar><ion-content class="has-header"><img *ngIf="busy" class="imglogo img-padding" src="img/loading2.gif"><ion-list class="list basic-list"><a *ngIf="isdefault_enabled" detail-none href="#" ion-item class="basic-margin text-left" (click)="dismiss({name: \'Default (no selection)\', id: 0})"><h2 class="color">Default (no selection)</h2></a> <a *ngIf="isnew_enabled && config.current.is_add_new_user_link" detail-none href="#" ion-item (click)="invite()" class="basic-margin text-left"><ion-icon name="add-circle" style="padding-left: 12px;font-size: 38px; float:left;"></ion-icon><h2 class="color" style="margin-top:8px">&nbsp;&nbsp;&nbsp;Invite new {{name}} {{is_empty ? \'"\'+term+\'"\' : ""}}</h2></a> <a detail-none href="#" ion-item class="basic-margin text-left" *ngFor="let item of items" (click)="dismiss(item)"><h2 class="color">{{item.name}}</h2></a></ion-list><div *ngIf="is_empty && !isdefault_enabled && !isnew_enabled" class="table grey2 menu-text">No {{name}} found yet</div><ion-infinite-scroll (infinite)="doInfinite($event)" threshold="30%"><ion-infinite-scroll-content loadingSpinner="circles" loadingText="Loading more data..."></ion-infinite-scroll-content></ion-infinite-scroll></ion-content>'}),s("design:paramtypes",[o.Nav,o.NavParams,o.Config,a.ApiData,o.ViewController])],t)}();i.InfinitySelectModal=d},{"../../../directives/helpers":19,"../../../providers/api-data":70,"../../../providers/config":71,"../modals":41,"ionic-angular":"ionic-angular"}],41:[function(t,e,i){"use strict";function n(t){for(var e in t)i.hasOwnProperty(e)||(i[e]=t[e])}n(t("./basic-select/basic-select")),n(t("./ajax-select/ajax-select")),n(t("./infinity-select/infinity-select")),n(t("./infinity-multi-select/infinity-multi-select")),n(t("./close-ticket/close-ticket")),n(t("./tree-modal/tree-modal")),n(t("./ticket-create/ticket-create")),n(t("./add-user/add-user")),n(t("./add-files/add-files")),n(t("./transfer-ticket/transfer-ticket")),n(t("./change-user/change-user")),n(t("./privacy/privacy"))},{"./add-files/add-files":33,"./add-user/add-user":34,"./ajax-select/ajax-select":35,"./basic-select/basic-select":36,"./change-user/change-user":37,"./close-ticket/close-ticket":38,"./infinity-multi-select/infinity-multi-select":39,"./infinity-select/infinity-select":40,"./privacy/privacy":42,"./ticket-create/ticket-create":43,"./transfer-ticket/transfer-ticket":44,"./tree-modal/tree-modal":45}],42:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),a=function(){function t(t,e){this.nav=t,this.viewCtrl=e,t.swipeBackEnabled=!1}return t.prototype.dismiss=function(t){this.viewCtrl.dismiss()},t=n([o.Page({template:'<ion-toolbar><ion-buttons start><button nav-pop><span primary>Cancel</span></button></ion-buttons></ion-toolbar><ion-content padding><div class="list max-width"><img class="imglogo img-padding" src="img/logo.png"><div><p class="margin-top0">When you register for a SherpaDesk trial you can be certain that we have implemented comprehensive security practices to ensure that only you and those people you provide authorized access to can see your help desk. We respect your right to privacy and feel it is important for you to know how we handle the information we receive from you via our website at http:www.sherpadesk.com (the Site) and through our on-demand support platform, tools and services offered on the Site (the Service).</p><h4>Information you Provide</h4><p class="margin-top0">When you register for the Service, we ask for information such as your name, e-mail address, company name and address. bigWebApps uses a third-party intermediary to manage credit card processing. This intermediary is not permitted to store, retain, or use your billing information except for the sole purpose of credit card processing on bigWebApps behalf.</p><p class="margin-top0">bigWebApps practice is not to use such personal information for marketing purposes. bigWebApps may use the collected personal information and other information bigWebApps collects about your use of the Service to operate and make the Service available to you, for billing, identification and authentication, to contact you about your use of the Service, research purposes and to generally improve the content and functionality of the Service and Site.</p><p>bigWebApps may also transmit or share your personal information with its third party vendors and hosting partners to provide the necessary hardware, software, networking, storage, and other technology and services required to operate and maintain the Service, which may require that your personal information be transferred from your current location to the offices and servers of bigWebApps and the authorized third parties referred to here. Although bigWebApps owns the software, code, databases, all rights to the SherpaDesk application, you retain all rights to your data.</p><h4>Cookies</h4><p class="margin-top0">When you visit the Site or use the Service, we use session cookies  a piece of information stored on your computer  to allow the Site or Service to uniquely identify your browser while you are logged in and to enable bigWebApps to process your online transactions. Session cookies also help us confirm your identity and are required in order to use the Service. SherpaDesk uses persistent cookies that only SherpaDesk can read and use, to identify you as a SherpaDesk customer and make it easier for you to log in to the Service. Users who disable their web browsers ability to accept cookies will be able to browse our Site, but will not be able to access or take advantage of the Service.</p><h4>Information Sharing</h4><p class="margin-top0">Except as described in this policy, bigWebApps will not give, sell, rent, or loan any identifiable personal information to any third party. We may disclose such information to respond to subpoenas, court orders, or legal process, or to establish or exercise our legal rights or defend against legal claims. We may also share such information if we believe it is necessary in order to investigate, prevent, or take action regarding illegal activities, suspected fraud, situations involving potential threats to the physical safety of any person, violations of our Terms of Service, or as otherwise required by law. bigWebApps may also provide non-personal, summary or group statistics about our customers, sales, traffic patterns, and related Site information to reputable third-party vendors, but these statistics will include no personally identifying information.</p><h4>Childrens Personal Information</h4><p class="margin-top0">The Service and Site are not intended for, nor does bigWebApps knowingly collect any personally identifiable information from children under the age of 13.</p><h4>Protection of Information</h4><p class="margin-top0">bigWebApps maintains reasonable security measures to protect your information from loss, destruction, misuse, unauthorized access or disclosure. These technologies help ensure that your data is safe, secure, and only available to you and to those you provided authorized access. However, no data transmission over the Internet or information storage technology can be guaranteed to be 100% secure.</p><h4>Changes to Privacy Policy</h4><p class="margin-top0">bigWebApps may update this policy from time to time. You can review the most current version of this privacy policy at any time at http://www.sherpadesk.com/privacy. Your continued use of the Site or Service constitutes your agreement to be bound by such changes to the privacy policy. Your only remedy, if you do not accept the terms of this privacy policy, is to discontinue use of the Site and Service.</p><h4>Business Transactions</h4><p class="margin-top0">bigWebApps may assign or transfer this privacy policy, and your user account and related information and data, to any person or entity that acquires or is merged with SherpaDesk.</p><h4>Terms of Service</h4><p class="margin-top0">When you access and use the Service, you are subject to the SherpaDesk Terms of Service.</p><h4>Contact Us</h4><p class="margin-top0">If you have questions regarding this privacy policy or about the security practices of bigWebApps, please contact us by email at corporate@bigwebapps.com.</p></div></div></ion-content>'}),s("design:paramtypes",[o.Nav,o.ViewController])],t)}();i.PrivacyModal=a},{"ionic-angular":"ionic-angular"}],43:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),a=t("@angular/core"),r=t("../../../providers/providers"),c=t("../../../directives/helpers"),l=t("../../../components/class-list/class-list"),d=t("../../../components/location-list/location-list"),u=t("../../../components/select-list/select-list"),p=t("../../../pages/ticket-details/ticket-details"),h=t("../../../components/custom-field/custom-field"),m=function(){function t(t,e,i,n,s){this.nav=t,this.navParams=e,this.ticketProvider=i,this.config=n,this.viewCtrl=s,this.fileDest={ticket:"11"},this.files=[],this.customfields=[],t.swipeBackEnabled=!1}return t.prototype.ngOnInit=function(){this.he=this.config.getCurrent("user"),this.data=this.navParams.data||{};var t={};console.log(this.config.current),this.data.account||(t=this.config.current.recent||{});var e=(this.data.account||{}).id||(t.account||{}).selected||this.he.account_id||-1,i=(this.data.location||{}).id||(t.location||{}).selected||0,n=t.default_contract_id||0;this.selects={user:{name:"User",value:c.getFullName(this.he.firstname,this.he.lastname,this.he.email),selected:this.he.user_id,url:"users",hidden:!1},location:{name:"Location",value:(this.data.location||{}).name||(t.location||{}).value||"Default",selected:i,url:"locations?account="+e+"&limit=500",hidden:!1},project:{name:"Project",value:(t.project||{}).value||"Default",selected:(t.project||{}).selected||0,url:"projects?account="+e+"&is_with_statistics=false",hidden:!1},contract:{name:"Contract",value:t.default_contract_name||"Choose",selected:t.default_contract_id||this.config.getRecent("contract").selected||0,url:"contracts?account_id="+e,hidden:!1},"class":{name:"Class",value:(t["class"]||{}).value||"Default",selected:(t["class"]||{}).selected||0,url:"classes",hidden:!1},priority:{name:"Priority",value:(t.priority||{}).value||"Default",selected:(t.priority||{}).selected||0,url:"priorities",hidden:!1},level:{name:"Level",value:"Default",selected:0,url:"levels",hidden:!this.config.current.is_tech_choose_levels&&!this.config.current.user.is_admin}},this.selects["class"].selected>0&&this.getCustomfield(t["class"].selected),this.selects.tech={name:"Tech",value:(this.data.tech||{}).name||"Default",selected:(this.data.tech||{}).id||0,url:"technicians",hidden:!1},this.selects.account={name:"Account",value:(this.data.account||{}).name||(t.account||{}).value||this.he.account_name,selected:e,url:"accounts?is_with_statistics=false",hidden:!1},this.ticket={subject:"",initial_post:"",class_id:null,account_id:e,location_id:i,user_id:this.he.user_id,tech_id:0,default_contract_id:n,priority_id:0,estimated_time:0},this.ticket.estimated_time=this.getFixed(this.ticket.estimated_time),this.getCustomfield(n)},t.prototype.dismissPage=function(t){t&&this.nav.alert(this.config.current.names.ticket.s+" was Succesfully Created :)"),this.viewCtrl.dismiss(t)},t.prototype.saveSelect=function(t){var e=t.type,i=this.selects.contract.selected;switch(this.selects[e].selected=t.id,this.selects[e].value=t.name,e){case"account":this.selects.project.url="projects?account="+t.id+"&is_with_statistics=false",this.selects.project.value="Default",this.selects.project.selected=0,this.selects.contract.url="contracts?account_id="+t.id,this.selects.contract.value="Default",this.selects.contract.selected=0,i=0,this.selects.location.url="locations?account="+t.id+"&limit=500",this.selects.location.value="Default",this.selects.location.selected=0;break;case"class":if(this.ticket.class_id==t.id)break;this.getCustomfield(t.id)}},t.prototype.saveCustomfield=function(t){this.customfields.filter(function(e){return e.id==t.id})[0].value=t.value},t.prototype.getXML=function(){for(var t="",e=0;e<this.customfields.length;e++){if(this.customfields[e].required&&""==this.customfields[e].value||"0001-01-01T00:00:00.0000000"==this.customfields[e].value)return this.nav.alert("Please add value to custom field: "+this.customfields[e].name,!0),t="";t+='<field id="'+this.customfields[e].id+'"><caption>'+this.customfields[e].name+"</caption><value>"+this.customfields[e].value+"</value></field>"}return"<root>"+t+"</root>"},t.prototype.uploadedFile=function(t){this.dismissPage(this.ticket)},t.prototype.selectedFile=function(t){this.files=t,this.ticket.initial_post=this.ticket.initial_post.trim(),t.length&&!this.ticket.initial_post&&(this.ticket.initial_post="  ")},t.prototype.getCustomfield=function(t){var e=this;return 0==t?this.customfields=[]:void this.ticketProvider.getCustomfields(t,this.pager).subscribe(function(t){e.customfields=t},function(t){console.log(t||"Server error")})},t.prototype.onSubmit=function(t){var e=this;if(t.valid){if(this.ticket.in_progress&&Date.now()-this.ticket.in_progress<1500)return;if(this.ticket.in_progress=Date.now(),this.config.current.is_budget_time&&(this.ticket.estimated_time=isNaN(t.value.budgeted_time)?0:Number(t.value.budgeted_time)),this.ticket.subject=c.htmlEscape(this.ticket.subject.trim()),this.ticket.initial_post=c.htmlEscape(this.ticket.initial_post.trim()).substr(0,4500),this.config.current.is_require_ticket_initial_post&&!this.ticket.initial_post.length)return void this.nav.alert("Note is required!",!0);this.files.length&&(this.ticket.initial_post+="\n\nFollowing file"+(this.files.length>1?"s were":" was")+" uploaded: "+this.files.join(", ")+".");var i=this.getXML();if(""==i)return;this.ticket.class_id=this.selects["class"].selected,this.ticket.account_id=this.selects.account.selected,this.ticket.location_id=this.selects.location.selected,this.ticket.user_id=this.he.is_techoradmin?this.selects.user.selected:this.he.user_id,this.ticket.tech_id=this.selects.tech.selected,this.ticket.priority_id=this.selects.priority.selected,this.ticket.level=this.selects.level.selected,this.ticket.customfields_xml=i,this.ticket.default_contract_id=this.selects.contract.selected,this.ticket.default_contract_name=this.selects.contract.value,console.log(this.ticket,"this.ticket"),this.ticketProvider.addTicket(this.ticket).subscribe(function(t){e.data.account||e.config.setRecent({account:e.selects.account,location:e.selects.location,project:e.selects.project,"class":e.selects["class"],default_contract_id:e.selects.contract.selected,default_contract_name:e.selects.contract.value,priority:e.selects.priority}),e.files.length?(e.ticket=t,e.fileDest.ticket=t.key,e.uploadComponent.onUpload()):e.dismissPage(t)},function(t){e.nav.alert(e.he.is_techoradmin?"Please select "+e.config.current.names.tech.s:t,!0),console.log(t||"Server error")})}},t.prototype.getFixed=function(t){return Number(t||"0").toFixed(2)},n([a.ViewChild(p.UploadButtonComponent),s("design:type",p.UploadButtonComponent)],t.prototype,"uploadComponent",void 0),t=n([o.Page({template:'<ion-toolbar><ion-buttons start class="searchbar"><button (click)="dismissPage()"><span primary>Cancel</span></button></ion-buttons><ion-title>New {{config.current.names.ticket.s}}</ion-title></ion-toolbar><ion-content><div class="list max-width700 margin-top-5"><template [ngIf]="config.current.user.is_techoradmin"><select-list ajax="true" [list]="selects.user" (onChanged)="saveSelect($event)" preload="true"></select-list></template><select-list [list]="selects.account" [preload]="config.current.user.is_techoradmin" [is_enabled]="config.current.user.is_techoradmin" ajax="true" (onChanged)="saveSelect($event)"></select-list><location-list preload="true" [list]="selects.location" (onChanged)="saveSelect($event)"></location-list><template [ngIf]="config.current.user.is_techoradmin"><select-list [list]="selects.project" preload="true" (onChanged)="saveSelect($event)"></select-list></template><select-list [list]="selects.priority" preload="true" (onChanged)="saveSelect($event)"></select-list><class-list preload="true" [list]="selects.class" (onChanged)="saveSelect($event)"></class-list><template [ngIf]="config.current.user.is_techoradmin"><select-list is_me="true" [list]="selects.tech" ajax="true" preload="true" (onChanged)="saveSelect($event)"></select-list><select-list [list]="selects.level" preload="true" (onChanged)="saveSelect($event)"></select-list></template><select-list [list]="selects.contract" preload="true" (onChanged)="saveSelect($event)"></select-list><hr class="color-bg" *ngIf="customfields.length"><div *ngFor="let customfield of customfields"><custom-field [type]="customfield.type" [id]="customfield.id" [name]="customfield.name" [value]="customfield.value" [choices]="customfield.choices" [required]="customfield.required" (onChanged)="saveCustomfield($event)"></custom-field></div></div><form margin-top class="container_list" #addForm="ngForm"><div class="list max-width700"><template [ngIf]="config.current.is_budget_time && config.current.is_time_tracking"><ion-item no-lines class="labels color" style="margin-top:-10px !important;">Budgeted time:</ion-item><input class="width100 textLogin blue3 commentText subject-create" style="margin-bottom: 20px;" placeholder="Budgeted Time" required ngControl="budgeted_time" [ngModel]="ticket.estimated_time"></template><div class="tooltips"><input class="width100 blue3 subject-create commentText margin-bottom3" [(ngModel)]="ticket.subject" placeholder="Subject" ngControl="subject" #subject="ngForm" required maxlength="100"> <span [hidden]="subject.valid || subject.untouched">Subject is required and less 100 chars</span></div><br><textarea class="width100 textLogin commentText margin-bottom1" type="text" [(ngModel)]="ticket.initial_post" ngControl="text" #note="ngForm" placeholder="Details..."></textarea><br><upload-button #u (filesUploaded)="uploadedFile($event)" (filesSelected)="selectedFile($event)" [fileDest]="fileDest"></upload-button><button [disabled]="!addForm.valid" secondary block (click)="onSubmit(addForm)" type="submit" class="disable-hover button button-default button-block">Add Ticket</button> <span class="span-block"></span></div></form></ion-content>',directives:[a.forwardRef(function(){return l.ClassListComponent}),a.forwardRef(function(){return d.LocationListComponent}),a.forwardRef(function(){return h.CustomFieldComponent}),a.forwardRef(function(){return u.SelectListComponent}),p.UploadButtonComponent]
}),s("design:paramtypes",[o.Nav,o.NavParams,r.TicketProvider,o.Config,o.ViewController])],t)}();i.TicketCreatePage=m},{"../../../components/class-list/class-list":4,"../../../components/custom-field/custom-field":6,"../../../components/location-list/location-list":7,"../../../components/select-list/select-list":12,"../../../directives/helpers":19,"../../../pages/ticket-details/ticket-details":54,"../../../providers/providers":74,"@angular/core":"@angular/core","ionic-angular":"ionic-angular"}],44:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),a=t("@angular/core"),r=t("../../../providers/ticket-provider"),c=t("../../../directives/helpers"),l=t("../../../components/select-list/select-list"),d=function(){function t(t,e,i,n,s){this.nav=t,this.navParams=e,this.ticketProvider=i,this.config=n,this.viewCtrl=s,t.swipeBackEnabled=!1,this.config=n}return t.prototype.ngOnInit=function(){this.keep_attached=!1,this.ticket=this.navParams.data||0,this.selects={tech:{name:"tech",value:"Choose",selected:0,hidden:!1,url:"technicians"}}},t.prototype.dismiss=function(t){this.viewCtrl.dismiss(t)},t.prototype.saveSelect=function(t){t.type;this.selects.selected=t.id,this.selects.value=t.name},t.prototype.onSubmit=function(t){var e=this;if(t.valid){var i=c.htmlEscape((this.ticketnote||"").trim()).substr(0,5e3),n={note_text:i,name:this.selects.value,tech_id:this.selects.selected,keep_attached:this.keep_attached,action:"transfer"};this.ticketProvider.transferUserTech(this.ticket.key,n).subscribe(function(t){e.nav.alert(e.config.current.names.ticket.s+" has been transferred :)"),e.dismiss(n)},function(t){e.nav.alert(t,!0),console.log(t||"Server error")})}},t=n([o.Page({template:'<ion-toolbar><ion-buttons start class="searchbar"><button (click)="dismiss()"><span primary>Cancel</span></button></ion-buttons><ion-title class="ellipsis padding-right24 padding-left87">Transfer {{config.current.names.ticket.s}} #{{ticket.number}} {{ticket.subject}}</ion-title></ion-toolbar><ion-content class="has-header"><div class="list max-width700 general-alignment"><select-list preload="true" [list]="selects.tech" (onChanged)="saveSelect($event)"></select-list><form #addForm="ngForm" class="response-ticket"><ion-item no-lines class="left toggle-width"><ion-toggle class="toggle" [(ngModel)]="keep_attached" disabled="false"></ion-toggle></ion-item><p style="width: 80%" class="left text-toggle color">Keep {{ticket.tech_firstname}} {{ticket.tech_lastname}} attached to this {{config.current.names.ticket.s}}</p><div class="tooltips"><textarea class="width100 textLogin commentText" [(ngModel)]="ticketnote" type="text" placeholder="Add Transfer Note" ngControl="note" #note="ngForm" maxlength="4000"></textarea> <span [hidden]="note.valid || note.untouched">Note should be less 5000 chars</span></div><button secondary class="button_reply img-top right" [disabled]="!addForm.valid" (click)="onSubmit(addForm)" type="submit">Transfer {{config.current.names.ticket.s}}</button></form></div></ion-content>',directives:[a.forwardRef(function(){return l.SelectListComponent})]}),s("design:paramtypes",[o.Nav,o.NavParams,r.TicketProvider,o.Config,o.ViewController])],t)}();i.TransferTicketModal=d},{"../../../components/select-list/select-list":12,"../../../directives/helpers":19,"../../../providers/ticket-provider":75,"@angular/core":"@angular/core","ionic-angular":"ionic-angular"}],45:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),a=t("../../../components/tree-view/tree-view"),r=function(){function t(t,e){this.params=t,this.viewCtrl=e,this.name=this.params.data.name,this.Nodes=this.params.data.items}return t.prototype.onSelectNode=function(t){this.selectedNode=t},t.prototype.onRequest=function(t){},t.prototype.dismiss=function(t){var e={};this.selectedNode&&!t&&(e={id:this.selectedNode.id,name:this.selectedNode.name}),this.viewCtrl.dismiss(e)},t=n([o.Page({template:'<ion-toolbar><ion-buttons start><button (click)="dismiss(\'1\')"><span primary>Cancel</span></button></ion-buttons><ion-buttons end style="flex: 1;"><button (click)="dismiss()"><span primary>Select</span></button></ion-buttons></ion-toolbar><ion-content class="has-header"><div class="basic-margin class-list list"><tree-view [Nodes]="Nodes" [SelectedNode]="selectedNode" (onSelectedChanged)="onSelectNode($event)"></tree-view></div></ion-content>',directives:[a.TreeViewComponent]}),s("design:paramtypes",[o.NavParams,o.ViewController])],t)}();i.TreeModal=r},{"../../../components/tree-view/tree-view":16,"ionic-angular":"ionic-angular"}],46:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),a=t("../../providers/data-provider"),r=t("../../providers/ticket-provider"),c=t("../../providers/time-provider"),l=t("../../providers/config"),d=t("../../directives/helpers"),u=t("../login/login"),p=function(){function t(t,e,i,n,s,o){var a=this;this.nav=t,this.dataProvider=e,this.config=i,this.events=n,this.ticketProvider=s,this.timeProvider=o,this.list=[];var r=this.config.getCurrent("key");n.publish("app:logout",r),this.ticketProvider._dataStore={all:[],alt:[],tech:[],user:[]},this.dataProvider._dataStore=this.timeProvider._dataStore={},"true"===localStorage.getItem("isExtension")&&window.top.postMessage("logout","*"),this.dataProvider.getOrganizations(r).subscribe(function(t){var e=localStorage.getItem("loadOrgKey")||"";e&&localStorage.setItem("loadOrgKey","");var i=e?t.filter(function(t){return t.key==e}):null;if(i&&(t=i),1==t.length){if(1==t[0].instances.length)return a.config.setCurrent({is_multiple_org:!1}),void a.onSelectInst({org:t[0].key,inst:t[0].instances[0].key});a.list=t,a.toggle(t[0],0)}else a.list=t;a.config.setCurrent({is_multiple_org:!0})},function(t){a.nav.alert("Cannot get list of Organizations",!0),a.config.clearCurrent(),a.nav.setRoot(u.LoginPage,null,{animation:"wp-transition"})})}return t.prototype.onPageLoaded=function(){},t.prototype.toggle=function(t,e){return 1==t.instances.length?void this.onSelectInst({org:t.key,inst:t.instances[0].key}):(this.list.forEach(function(t,e){return t.expanded=!1}),void(this.list[e].expanded=!this.list[e].expanded))},t.prototype.support=function(){d.openURLsystem("https://support."+l.Site+"portal/")},t.prototype.alertOrg=function(t){this.nav.alert(t+" has expired or inactivated. Contact SherpaDesk for assistance. Email: support@sherpadesk.com Phone: +1 (866) 996-1200, then press 2",!0)},t.prototype.onSelectInst=function(t){var e=o.Loading.create({content:"Loading configuration...",duration:3e3,dismissOnPageChange:!0});this.nav.present(e),this.config.setCurrent({org:t.org,instance:t.inst}),this.events.publish("config:get",!0)},t=n([o.Page({template:'<ion-content padding class="organizations"><ion-list class="list max-width" no-lines><a title="Support Portal" (click)="support()"><img class="imglogo img-padding" src="img/logo.png"></a><div *ngFor="let org of list; let i = index"><a detail-none href="#" ion-item [hidden]="!org.is_expired && org.instances.length" class="blue1 org expired" (click)="alertOrg(org.name)">{{org.name}} (Expired)</a> <a detail-none href="#" ion-item [hidden]="org.is_expired || !org.instances.length" class="blue1 org" (click)="toggle(org, i)"><ion-label class="padding-left8">{{org.name}} {{org.instances.length == 1 ? org.instances[0].name : \'\' }}</ion-label></a><div *ngIf="org.expanded && org.instances.length > 1"><a detail-none href="#" ion-item *ngFor="let inst of org.instances" (click)="onSelectInst({org: org.key, inst: inst.key})" class="inst org2"><ion-label class="padding-left8">{{inst.name}}</ion-label></a></div></div></ion-list></ion-content>'}),s("design:paramtypes",[o.Nav,a.DataProvider,o.Config,o.Events,r.TicketProvider,c.TimeProvider])],t)}();i.OrganizationsPage=p},{"../../directives/helpers":19,"../../providers/config":71,"../../providers/data-provider":72,"../../providers/ticket-provider":75,"../../providers/time-provider":76,"../login/login":32,"ionic-angular":"ionic-angular"}],47:[function(t,e,i){"use strict";function n(t){for(var e in t)i.hasOwnProperty(e)||(i[e]=t[e])}n(t("./account-details/account-details")),n(t("./accounts/accounts")),n(t("./technicians/technicians")),n(t("./locations/locations")),n(t("./ajax-search/ajax-search")),n(t("./dashboard/dashboard")),n(t("./expense-create/expense-create")),n(t("./expenses/expenses")),n(t("./invoice-details/invoice-details")),n(t("./invoices/invoices")),n(t("./login/login")),n(t("./organizations/organizations")),n(t("./queue-tickets/queue-tickets")),n(t("./tech-tickets/tech-tickets")),n(t("./queues/queues")),n(t("./contracts/contracts")),n(t("./signup/signup")),n(t("./ticket-details/ticket-details")),n(t("./tickets/tickets")),n(t("./timelog/timelog")),n(t("./timelogs/timelogs")),n(t("./invoice-create/invoice-create")),n(t("./uninvoices/uninvoices")),n(t("./todos/todos")),n(t("./todo-create/todo-create")),n(t("./skype/skype"))},{"./account-details/account-details":20,"./accounts/accounts":21,"./ajax-search/ajax-search":22,"./contracts/contracts":23,"./dashboard/dashboard":24,"./expense-create/expense-create":25,"./expenses/expenses":26,"./invoice-create/invoice-create":27,"./invoice-details/invoice-details":28,"./invoices/invoices":29,"./locations/locations":31,"./login/login":32,"./organizations/organizations":46,"./queue-tickets/queue-tickets":48,"./queues/queues":49,"./signup/signup":50,"./skype/skype":51,"./tech-tickets/tech-tickets":52,"./technicians/technicians":53,"./ticket-details/ticket-details":54,"./tickets/tickets":55,"./timelog/timelog":56,"./timelogs/timelogs":57,"./todo-create/todo-create":58,"./todos/todos":59,"./uninvoices/uninvoices":60}],48:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),a=t("../modals/modals"),r=t("../ticket-details/ticket-details"),c=t("../../components/tickets-list/tickets-list"),l=function(){function t(t,e,i,n){this.nav=t,this.navParams=e,this.view=i,this.config=n,this.queue=this.navParams.data}return t.prototype.onPageWillEnter=function(){this.view.setBackButtonText("")},t.prototype.addTicket=function(){var t=this,e=o.Modal.create(a.TicketCreatePage,{tech:{id:this.queue.id,name:"Queue "+this.queue.fullname}});e.onDismiss(function(e){e&&setTimeout(function(){t.queue.tickets_count+=1,t.nav.push(r.TicketDetailsPage,e)},500)}),this.nav.present(e)},t=n([o.Page({template:'<ion-navbar *navbar><button menuToggle><ion-icon name="menu"></ion-icon></button><ion-title class="padding-right24">{{config.current.names.ticket.p}} of&nbsp;{{queue.fullname}} Queue</ion-title></ion-navbar><div class="queues mycontent"><tickets-list [mode]="[\'queue\', queue.id]" [count]="queue.tickets_count"></tickets-list></div><button (click)="addTicket()" secondary item-right fab fab-right fab-bottom style="z-index: 2"><ion-icon class="button_circle action-but" name="md-add"></ion-icon></button>',directives:[c.TicketsListComponent]}),s("design:paramtypes",[o.Nav,o.NavParams,o.ViewController,o.Config])],t)}();i.QueueTicketsPage=l},{"../../components/tickets-list/tickets-list":14,"../modals/modals":41,"../ticket-details/ticket-details":54,"ionic-angular":"ionic-angular"}],49:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),a=t("../../providers/data-provider"),r=t("../../components/components"),c=function(){function t(t,e,i){this.nav=t,this.config=e,this.dataProvider=i,this.term="",this.items=[]}return t.prototype.onPageLoaded=function(){var t=this;this.dataProvider.getQueueList().subscribe(function(e){t.queues=e,t.searchItems({value:t.term})},function(t){console.log(t||"Server error")})},t.prototype.searchItems=function(t){this.items=this.queues;var e=t.value.toLowerCase();""!=e.trim()&&this.queues&&e.length>1&&(this.items=this.queues.filter(function(t){return t.fullname.toLowerCase().indexOf(e)>-1}))},t.prototype.clearSearch=function(t){this.search_results=[],t&&(t.value="")},t.prototype.toggle=function(){this.test=!this.test,this.test&&setTimeout(function(){var t=document.getElementsByClassName("searchbar-input");t=t[t.length-1],t&&t.focus()},500)},t=n([o.Page({template:'<ion-navbar *navbar><button menuToggle><ion-icon name="menu"></ion-icon></button><ion-title>Queues</ion-title><ion-buttons end><button danger class="right transparent" (click)="toggle()"><ion-icon name="ios-search"></ion-icon></button></ion-buttons></ion-navbar><ion-content class="queues"><ion-searchbar *ngIf="test" [focuser] debounce="700" (cancel)="test = !test" (input)="searchItems($event)" [(ngModel)]="term" placeholder="Type Queues name"></ion-searchbar><p class="general-alignment"></p><queues-list margin-top [queues]="items" [simple]="true"></queues-list><span class="span-block"></span></ion-content><action-button></action-button>',directives:[r.QueuesListComponent,r.ActionButtonComponent]}),s("design:paramtypes",[o.Nav,o.Config,a.DataProvider])],t)}();i.QueuesPage=c},{"../../components/components":5,"../../providers/data-provider":72,"ionic-angular":"ionic-angular"}],50:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),a=t("../../directives/helpers"),r=t("../../providers/data-provider"),c=t("../login/login"),l=t("../organizations/organizations"),d=t("../modals/modals"),u=function(){function t(t,e,i,n){this.nav=t,this.dataProvider=e,this.config=i,this.events=n,this.login={},this.is_force_registration=!1}return t.prototype.onPageLoaded=function(){this.is_force_registration=!1},t.prototype.getUrl=function(t){this.login.name=t.value||"",this.login.url=t.value?t.value.toLowerCase().replace(/[^a-zA-Z0-9-]/g,""):""},t.prototype.onSignup=function(t){var e=this;if(t.valid){var i={name:t.value.name,email:t.value.email,url:t.value.url,is_force_registration:this.is_force_registration,is_force_redirect:!1,firstname:t.value.firstname,lastname:t.value.lastname,password:t.value.password,password_confirm:t.value.password_confirm,how:t.value.how,note:"true"===localStorage.getItem("isPhonegap")?"registered by iPhone app":"registered from m.sherpadesk.com"};this.dataProvider.registerOrganization(i).subscribe(function(i){return i.api_token?i.organization&&i.instance?(e.config.setCurrent({key:i.api_token,org:i.organization,instance:i.instance}),a.spicePixelTrackConversion(),a.getappTrackConversion(t.value.url),e.nav.alert("Thanks for registration! You are redirected to new org now ..."),void setTimeout(function(){return e.events.publish("config:get",!0)},3e3)):void e.nav.setRoot(l.OrganizationsPage,null,{animation:"wp-transition"}):void e.nav.setRoot(c.LoginPage,null,{animation:"wp-transition"})},function(t){~t.toString().indexOf("409")?e.presentConfirm():e.nav.alert(t,!0)})}else this.nav.alert("Please fill the form!",!0)},t.prototype.presentConfirm=function(){var t=this,e=o.Alert.create({title:"Wait. Haven't I seen you?",subTitle:"This email is already in use.",message:"Would you like to",cssClass:"hello",buttons:[{text:"Login",role:"cancel",handler:function(){return localStorage.setItem("username",t.login.email||""),e.dismiss().then(function(){t.nav.setRoot(c.LoginPage,null,{animation:"wp-transition"})}),!1}},{text:"Create New Org",handler:function(){var i=e.dismiss();return t.is_force_registration=!0,i.then(function(){var e={valid:!0,value:t.login};t.onSignup(e)}),!1}}]});this.nav.present(e)},t.prototype.gotoPrivacy=function(){this.nav.present(o.Modal.create(d.PrivacyModal))},t=n([o.Page({template:'<ion-content padding class="signup"><div class="list max-width"><img class="imglogo img-padding" src="img/logo.png"><form #loginForm="ngForm" novalidate><div class="tooltips"><input autofocus class="width100 blue3 subject-create commentText" [ngModel]="login.name" (ngModelChange)="getUrl(name)" ngControl="name" #name="ngForm" required minlength="3" placeholder="Company name (required)"> <span *ngIf="name.dirty && !name.valid">Name is required</span></div><div class="tooltips"><input class="width100 blue3 subject-create commentText" type="email" [(ngModel)]="login.email" ngControl="email" #username="ngForm" required pattern="^[^@\\s]+@[^@\\s]+(\\.[^@\\s]+)+$" placeholder="Email (required)"> <span *ngIf="username.dirty && !username.valid">Valid Email is required</span></div><div class="tooltips"><div class="width21 left signup-font">https://</div><input class="width30 blue3 subject-create commentText left padding5" [(ngModel)]="login.url" ngControl="url" placeholder="Company url (optional)"><div class="text-right right width48 signup-font ellipsis">.sherpadesk.com</div></div><div class="tooltips"><input class="width100 blue3 subject-create commentText" [(ngModel)]="login.firstname" ngControl="firstname" #firstname="ngForm" required minlength="3" placeholder="First Name (required)"> <span *ngIf="firstname.dirty && !firstname.valid">First Name is required</span></div><div class="tooltips"><input class="width100 blue3 subject-create commentText" [(ngModel)]="login.lastname" ngControl="lastname" #lastname="ngForm" required minlength="3" placeholder="Last Name (required)"> <span *ngIf="lastname.dirty && !lastname.valid">Valid Email is required</span></div><div class="tooltips"><input class="width100 blue3 subject-create commentText" [(ngModel)]="login.password" ngControl="password" type="password" #password="ngForm" placeholder="Password (optional)"></div><div class="tooltips"><input class="width100 blue3 subject-create commentText" [(ngModel)]="login.password_confirm" ngControl="password_confirm" #password_confirm="ngForm" type="password" placeholder="Confirm Pass (optional)"> <span *ngIf="password_confirm.dirty && password.dirty && (password_confirm.value != password.value)">Passwords should match</span></div><div class="tooltips"><input class="width100 blue3 subject-create commentText" [(ngModel)]="login.how" ngControl="how" placeholder="How\'d You Hear About Us"></div><br><button [disabled]="!loginForm.valid" class="login-margin" block secondary (click)="onSignup(loginForm)">Create My Account</button><br><button class="login-margin grey3" block nav-pop>Back to Login Page</button><br>By clicking the button above I agree to <a href="#" (click)="gotoPrivacy()">Terms of Use and Privacy Policy</a></form></div></ion-content><script>\n          var SWPX = SWPX || {};\n          SWPX.cmd = SWPX.cmd || [];\n          SWPX.cmd.push(function() {\n              SWPX.pixel.setPixel(\'mvc7\');\n              // Uncomment the following line to place an identifer\n              SWPX.pixel.setIdentifier(\'121806\');\n              SWPX.pixel.fire();\n          });\n      </script><script src="//px.spiceworks.com/px.js" async></script><noscript><img src="//px.spiceworks.com/px/mvc7" height="1" width="1"></noscript>'}),s("design:paramtypes",[o.Nav,r.DataProvider,o.Config,o.Events])],t)}();i.SignupPage=u},{"../../directives/helpers":19,"../../providers/data-provider":72,"../login/login":32,"../modals/modals":41,"../organizations/organizations":46,"ionic-angular":"ionic-angular"}],51:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),a=t("../../providers/data-provider"),r=t("../login/login"),c=function(){function t(t,e){this.nav=t,this.dataProvider=e,this.is_skype_done=!1}return t.prototype.onPageLoaded=function(){this.onLoginSkype()},t.prototype.onLoginSkype=function(){var t=this,e=localStorage.getItem("skype")||"";try{var i=JSON.parse(e);i&&"object"==typeof i&&this.dataProvider.loginSkype(i).subscribe(function(e){localStorage.setItem("skype",""),t.is_skype_done=!0,t.nav.alert("Done! You can continue to chat in Skype ...")},function(e){localStorage.setItem("skype",""),t.nav.alert(e,!0),console.log("error",e)})}catch(n){this.nav.alert("Cannot continue! Incorrect skype data",!0)}},t.prototype.cancel_skype=function(){localStorage.setItem("skype",""),this.nav.setRoot(r.LoginPage,null,{animation:"wp-transition"})},t=n([o.Page({template:'<ion-content padding class="signup"><div class="list max-width"><img class="imglogo img-padding" src="img/logo.png"><div style="margin: 0px 0 5px 0;"><center><span>Finishing authorization in</span><br><br><img src="img/skype_logo_blue.png" style="width: 220px;" alt="Google Images" title="Google Images"><br><br><span *ngIf="!is_skype_done">Please wait a second ...</span> <span *ngIf="is_skype_done">Thanks! You can continue to chat in Skype ...</span></center></div><br><br><br><br><br><button *ngIf="is_skype_done" class="login-margin" block secondary onclick="location.reload()">Done. Back to App</button><br><button *ngIf="!is_skype_done" class="login-margin grey3" block (click)="cancel_skype()">Cancel and Back to Login Page</button></div></ion-content>'}),s("design:paramtypes",[o.Nav,a.DataProvider])],t)}();i.SkypePage=c},{"../../providers/data-provider":72,"../login/login":32,"ionic-angular":"ionic-angular"}],52:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),a=t("../modals/modals"),r=t("../ticket-details/ticket-details"),c=t("../../components/tickets-list/tickets-list"),l=function(){function t(t,e,i,n){this.nav=t,this.navParams=e,this.view=i,this.config=n,this.technician=this.navParams.data,console.log(this.technician)}return t.prototype.onPageWillEnter=function(){this.view.setBackButtonText("")},t.prototype.addTicket=function(){var t=this,e=o.Modal.create(a.TicketCreatePage,{tech:{id:this.technician.id,name:this.technician.lastname+" "+this.technician.firstname}});e.onDismiss(function(e){e&&setTimeout(function(){t.technician.tickets_count+=1,t.nav.push(r.TicketDetailsPage,e)},500)}),this.nav.present(e)},t=n([o.Page({template:'<ion-navbar *navbar><button menuToggle><ion-icon name="menu"></ion-icon></button><ion-title class="padding-right24">{{config.current.names.ticket.p}} for {{technician.firstname}} {{technician.lastname}}</ion-title></ion-navbar><div class="queues mycontent"><tickets-list [mode]="[\'queue\', technician.id]" [count]="technician.count"></tickets-list></div><button (click)="addTicket()" secondary item-right fab fab-right fab-bottom style="z-index: 2"><ion-icon class="button_circle action-but" name="md-add"></ion-icon></button>',directives:[c.TicketsListComponent]}),s("design:paramtypes",[o.Nav,o.NavParams,o.ViewController,o.Config])],t)}();i.TechTicketsPage=l},{"../../components/tickets-list/tickets-list":14,"../modals/modals":41,"../ticket-details/ticket-details":54,"ionic-angular":"ionic-angular"}],53:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),a=t("../../providers/data-provider"),r=t("../../components/components"),c=function(){function t(t,e,i){this.nav=t,this.config=e,this.dataProvider=i,this.term="",this.items=[],this.LIMIT=500}return t.prototype.onPageLoaded=function(){var t=this;this.pager={page:0,limit:this.LIMIT};var e=setTimeout(function(){t.busy=!0},500);this.getItems(null,e)},t.prototype.getItems=function(t,e){var i=this;this.dataProvider.getTechniciansList(this.pager,!0,!0).subscribe(function(n){e?(clearTimeout(e),i.busy=!1,i.technicians=n):((s=i.technicians).push.apply(s,n),i.config.current.stat.technicians+=n.length),t&&(t.enable(n.length==i.LIMIT),t.complete()),i.count=n.length,i.searchItems({value:i.term});var s},function(t){e&&(clearTimeout(e),i.busy=!1),console.log(t||"Server error")})},t.prototype.searchItems=function(t){this.items=this.technicians;var e=t.value.toLowerCase();""==e.trim()||this.busy||this.technicians&&e.length>1&&(this.items=this.technicians.filter(function(t){return t.FullName.toLowerCase().indexOf(e)>-1}))},t.prototype.clearSearch=function(t){this.search_results=[],this.busy=!1,t&&(t.value="")},t.prototype.doInfinite=function(t){return this.count<this.LIMIT?(t.enable(!1),void t.complete()):(this.pager.page+=1,void this.getItems(t,null))},t.prototype.toggle=function(){this.test=!this.test,this.test&&setTimeout(function(){var t=document.getElementsByClassName("searchbar-input");t=t[t.length-1],t&&t.focus()},500)},t=n([o.Page({template:'<ion-navbar *navbar><button menuToggle><ion-icon name="menu"></ion-icon></button><ion-title>{{config.current.names.tech.p}}</ion-title><ion-buttons end><button danger class="right transparent" (click)="toggle()"><ion-icon name="ios-search"></ion-icon></button></ion-buttons></ion-navbar><ion-content class="accounts"><ion-searchbar *ngIf="test" [focuser] debounce="700" (cancel)="test = !test" (input)="searchItems($event)" [(ngModel)]="term" placeholder="Type {{config.current.names.tech.s}} name"></ion-searchbar><p class="general-alignment"></p><img *ngIf="busy" class="imglogo img-padding" src="img/loading2.gif"><techs-list margin-top [simple]="true" [technicians]="items"></techs-list><ion-infinite-scroll (infinite)="doInfinite($event)" threshold="30%"><ion-infinite-scroll-content loadingSpinner="circles" loadingText="Loading more data..."></ion-infinite-scroll-content></ion-infinite-scroll></ion-content><action-button></action-button>',directives:[r.TechniciansListComponent,r.ActionButtonComponent]}),s("design:paramtypes",[o.Nav,o.Config,a.DataProvider])],t)}();i.TechniciansPage=c},{"../../components/components":5,"../../providers/data-provider":72,"ionic-angular":"ionic-angular"}],54:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),a=t("../../providers/config"),r=t("../../providers/data-provider"),c=t("../../providers/ticket-provider"),l=t("../../directives/helpers"),d=t("../../components/posts-list/posts-list"),u=t("../../components/select-list/select-list"),p=t("../../components/multi-select/multi-select"),h=t("../../components/class-list/class-list"),m=t("../../components/location-list/location-list"),g=t("../../pages/modals/modals"),f=t("../../pages/timelog/timelog"),v=t("../../pages/expense-create/expense-create"),b=t("../../pipes/pipes"),_=t("../../pages/modals/add-files/add-files"),y=t("../../components/todo-list/todo-list"),k=t("@angular/core"),w=t("ionic-angular"),x=t("../../providers/config"),P=t("../../components/custom-field/custom-field"),C=function(){function t(t,e,i){this.nav=t,this.renderer=e,this.config=i,this.filesSelected=new k.EventEmitter(!1),this.filesUploaded=new k.EventEmitter(!1),this.allowMultiple=!0,this.multi="multiple",this.error="",this.files=[],this.MAX_SIZE=104857600,this.allowMultiple===!1&&(this.multi="")}return t.prototype.ngOnInit=function(){},t.prototype.upload=function(t,e){var i=this;return new Promise(function(n,s){var o=new XMLHttpRequest;o.onreadystatechange=function(){4===o.readyState&&(200===o.status?n(o.response):s(o.response))};var a=i.config.getCurrent("key"),r=i.config.getCurrent("org"),c=i.config.getCurrent("instance");o.open("POST",t+"files/",!0),o.setRequestHeader("Authorization","Basic "+btoa(r+"-"+c+":"+a));var l=new FormData;for(var d in i.fileDest)l.append(d,i.fileDest[d]);for(var u=0;u<e.length;u++)l.append("uploads[]",e[u],e[u].upload_name);o.send(l)})},t.prototype.onUpload=function(t){var e=this;if(!this.files.length)return void this.filesUploaded.next("ok no files "+(t?" on close":""));if(!(this.in_progress&&Date.now()-this.in_progress<1500)){this.in_progress=Date.now();var i=null;(this.files.length>=2||this.files[0].size>2e4)&&(i=w.Loading.create({content:"Uploading file(s)...",dismissOnPageChange:!0}),this.nav.present(i)),this.upload(x.ApiSite,this.files).then(function(n){e.reset(),i&&i.dismiss(),e.filesUploaded.next("ok "+n+(t?" on close":""))})["catch"](function(t){i&&setTimeout(function(){return i.dismiss()},1e3),console.error("Error uploading files",t),e.filesUploaded.next("error "+t),e.nav.alert("Error uploading files! Cannot add files! Please try again later ... or try to upload one file or check your internet connection",!0);
})}},t.prototype.reset=function(t){t&&(this.files=this.files.filter(function(e){return e!==t}),this.filesSelected.next(this.files.map(function(t){return t.upload_name}))),t&&this.files.length||(this.error="",this.files=[],this.nativeInputBtn.nativeElement.value="")},t.prototype.callback=function(t){this.log("UploadButton: Callback executed triggerig click event",this.nativeInputBtn.nativeElement);var e=new MouseEvent("click",{bubbles:!0});this.renderer.invokeElementMethod(this.nativeInputBtn.nativeElement,"dispatchEvent",[e])},t.prototype.filesAdded=function(t){this.log("UploadButton: Added files",this.nativeInputBtn.nativeElement.files);var e=this.nativeInputBtn.nativeElement.files.length,i=[];if(this.error="",e){var n={},s={};if(this.filesExist)for(var o=0;o<this.filesExist.length;o++)s[this.filesExist[o].name.trim()]=this.filesExist[o].size;for(var a=0;e>a;a++){var r=this.nativeInputBtn.nativeElement.files[a];if(this.isFile(r))if(r.size>this.MAX_SIZE)this.error+="File "+r.name+" will be skipped. It is more 100 MB<br>";else if(0===r.size)this.error+="File "+r.name+" will be skipped. It has zero size <br>";else if(r.name.trim()){var c=r.name.trim();r.size!=(s[c.trim()]||r.size)&&(c=this.add_tag(c,r.size)),r.size!=(n[c]||r.size)&&(c=this.add_tag(c,r.size)),r.upload_name=c,i.push(r),n[c]=r.size}else this.error+="File #"+a+" will be skipped. It has empty name<br>";else this.error+="File #"+a+" will be skipped. It is empty<br>"}}this.files=i,this.filesSelected.next(this.files.map(function(t){return t.upload_name}))},t.prototype.add_tag=function(t,e){var i=t.lastIndexOf("."),n=t.length;return t.substr(0,i)+"_"+e+t.substr(i,n)},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];this.logCallback&&console.log(t)},t.prototype.humanizeBytes=function(t){if(0===t)return"0 Byte";var e=1024,i=["Bytes","KB","MB","GB","TB","PB"],n=Math.floor(Math.log(t)/Math.log(e));return parseFloat((t/Math.pow(e,n)).toFixed(2))+" "+i[n]},t.prototype.isImage=function(t){return t&&null!==t.trim().match(/(jpeg|jpg|gif|png|ico)$/i)?"md-image":"md-document"},t.prototype.isFile=function(t){return null!==t&&t instanceof Blob},n([k.ViewChild("input"),s("design:type",k.ElementRef)],t.prototype,"nativeInputBtn",void 0),n([k.Output(),s("design:type",k.EventEmitter)],t.prototype,"filesSelected",void 0),n([k.Output(),s("design:type",k.EventEmitter)],t.prototype,"filesUploaded",void 0),n([k.Input(),s("design:type",String)],t.prototype,"fileDest",void 0),n([k.Input(),s("design:type",Array)],t.prototype,"filesExist",void 0),n([k.Input(),s("design:type",String)],t.prototype,"btnStyle",void 0),n([k.Input(),s("design:type",Boolean)],t.prototype,"allowMultiple",void 0),n([k.Input(),s("design:type",Function)],t.prototype,"logCallback",void 0),t=n([k.Component({selector:"upload-button",directives:[w.IONIC_DIRECTIVES],template:'<div><div><div><button type="button" (click)="callback($event)" left class="button-attach attach color"><ion-icon class="button-font action-but color" name="md-attach"></ion-icon>Add Files</button></div></div><span *ngIf="error" class="error-button" [innerHTML]="error"></span> <input type="file" (change)="filesAdded($event)" style="display: none" [multiple]="multi" #input><div *ngFor="let file of files"><p class="comment_image_link files-tkts width100"><ion-icon name="{{isImage(file.name)}}" role="img" dark class="button_circle ion-{{isImage(file.name)}}"></ion-icon>&nbsp;<span class="decoration width100 flex1 color">{{file.upload_name}}&nbsp;({{humanizeBytes(file.size)}})</span> <button block (click)="reset(file)" fab class="red buttonInvoice email-invoice button-fab position-initial"><ion-icon class="invoiceCircle" name="close"></ion-icon></button></p></div><button type="button" *ngIf="!fileDest?.ticket" [disabled]="!files.length" block secondary (click)="onUpload()">Upload</button> <span class="span-block2"></span></div>'}),s("design:paramtypes",[o.Nav,k.Renderer,o.Config])],t)}();i.UploadButtonComponent=C;var T=function(){function t(t,e,i,n,s){this.nav=t,this.navParams=e,this.ticketProvider=i,this.dataProvider=n,this.config=s,this.ticket={},this.customfields=[],this.technicians=[],this.users=[],this.waiting_response=!1,this.is_editworkpad=!0,this.disable=!1,this.cachename="",this.closed_index=0,this.fileDest={ticket:""},this.files=[],this.is_showlogs=!1,this.posts=[{id:0,ticket_key:"",user_id:0,user_email:" ",user_firstname:" ",user_lastname:" ",record_date:"2016-01-01T00:00:00.0000000",log_type:"Initial Post",note:" ",workpad:" ",ticket_time_id:0,sent_to:" ",is_waiting:!1,sla_used:0}]}return t.prototype.onPageLoaded=function(){this.ticket.customfields=[],this.active=!0,this.he=this.config.getCurrent("user"),this.details_tab="Reply";var t=this.navParams.data||{};this.cachename=t.cachename,this.posts[0].record_date=t.updated_time||this.posts[0].record_date,this.is_showlogs=!1,this.ticketnote="",this.fileDest={ticket:t.key},this.getPosts(t.key),this.processDetails(t,!0)},t.prototype.initSelects=function(t){var e=t.account_id||-1;this.username=l.getFullName(t.user_firstname,t.user_lastname,t.user_email),this.techname=l.getFullName(t.technician_firstname||t.tech_firstname,t.technician_lastname||t.tech_lastname,t.technician_email||t.tech_email);var i=t.default_contract_id||0,n=t.default_contract_name;this.select_button={tech:{name:"Tech",value:"Transfer "+this.config.current.names.ticket.s,selected:t.tech_id,url:"technicians",hidden:!1}},this.selects={altusers:{name:"Alt Users",value:this.username,selected:t.user_id,url:"users",hidden:!1},location:{name:"Location",value:t.location_name||"( Not Set )",selected:t.location_id||0,url:"locations?account="+e+"&limit=500",hidden:!1},alttechs:{name:"Alt Techs",value:this.techname,selected:t.tech_id,url:"technicians",hidden:!1},project:{name:"Project",value:t.project_name||"( Not Set )",selected:t.project_id||0,url:"projects?account="+e+"&is_with_statistics=false",hidden:!1},contract:{name:"Contract",value:n||"Choose",selected:i||this.config.getRecent("contract").selected||0,url:"contracts?account_id="+e,hidden:!1},level:{name:"Level",value:t.level_name?t.level+" - "+t.level_name:"( Not Set )",selected:t.level||0,url:"levels",hidden:!1},priority:{name:"Priority",value:t.priority_name?t.priority+" - "+t.priority_name:"( Not Set )",selected:t.priority_id||0,url:"priorities",hidden:!1},"class":{name:"Class",value:t.class_name||"( Not Set )",selected:t.class_id||0,url:"classes",hidden:!1}},this.selects.account={name:"Account",value:(t.account||{}).name||t.account_name||this.he.account_name,selected:e,url:"accounts?is_with_statistics=false",hidden:!1}},t.prototype.uploadedFile=function(t){0==t.indexOf("ok")&&this.onSubmit(!this.config.current.user.is_techoradmin&&"Closed"!=this.ticket.status&&~t.indexOf("close"))},t.prototype.selectedFile=function(t){this.files=t,this.ticketnote=this.ticketnote.trim(),t.length&&!this.ticketnote&&(this.ticketnote="  ")},t.prototype.getPosts=function(t){var e=this;this.ticketProvider.getTicketDetails(t).subscribe(function(t){e.processDetails(t)},function(t){console.log(t||"Server error"),e.redirectOnEmpty()})},t.prototype.getProfile=function(t){var e=this;this.ticketProvider.getUserProfile(t).subscribe(function(t){e.userphone=t.mobile_phone||t.phone},function(t){console.log(t||"Server error")})},t.prototype.getCustomfield=function(t){var e=this;return 0==t?this.customfields=[]:void this.ticketProvider.getCustomfields(t,this.pager).subscribe(function(t){if(0==t.length)return void(e.customfields=t);if(e.ticket.customfields.length!=t.length)return void(e.customfields=t);for(var i=0;i<e.ticket.customfields.length;i++)t.filter(function(t){return t.id.toString()==e.ticket.customfields[i].id.toString()})[0].value=e.ticket.customfields[i].value;e.customfields=t},function(t){console.log(t||"Server error")})},t.prototype.processDetails=function(t,e){if(!(e||t&&t.ticketlogs&&0!=t.ticketlogs))return void this.redirectOnEmpty();if(this.ticket=t,this.is_editworkpad=!(this.ticket.workpad||"").length,this.ticket.customfields=[],this.technicians=t.technicians,this.users=t.users,0!=this.ticket.budget_hours&&(this.percentage_budget=this.ticket.total_hours/this.ticket.budget_hours*100,this.percentage_budget=this.getFixed(this.percentage_budget)),this.ticket.mailto="r."+this.config.current.org+"."+this.config.current.instance+"."+t.key+"@app.sherpadesk.com",this.initSelects(t),t.ticketlogs&&t.ticketlogs.length>0&&(this.posts=t.ticketlogs),!e){this.attachments=(t.attachments||[]).slice().reverse();var i=l.parseXml(this.ticket.customfields_xml);if(i){for(var n=[],s=i.documentElement.firstChild;s;s=s.nextSibling)n.push({id:s.attributes[0].nodeValue,name:s.firstChild.innerHTML.replace("&amp;amp;","&amp;"),value:(s.firstChild.nextSibling.innerHTML||"").replace("&amp;amp;","&amp;")});this.ticket.customfields=n,this.getCustomfield(t.class_id)}}t.user_id&&this.getProfile(t.user_id)},t.prototype.redirectOnEmpty=function(){var t=this;this.nav.alert("Incorrect ticket. Going back...",!0),setTimeout(function(){t.nav.pop()},1e3)},t.prototype.saveSelect=function(t){var e=t.type;this.selects[e].selected=t.id,this.selects[e].value=t.name;var i=this.selects.contract.selected;switch(e){case"account":if(this.ticket.account_id==t.id)break;this.selects.project.url="projects?account="+t.id+"&is_with_statistics=false",this.selects.project.value="Default",this.selects.project.selected=0,this.selects.contract.url="contracts?account_id="+t.id,this.selects.contract.value="Default",this.selects.contract.selected=0,i=0,this.selects.location.url="locations?account="+t.id+"&limit=500",this.selects.location.value="Default",this.selects.location.selected=0;break;case"class":if(this.ticket.class_id==t.id)break;this.getCustomfield(t.id)}},t.prototype.saveCustomfield=function(t){this.customfields.filter(function(e){return e.id==t.id})[0].value=t.value},t.prototype.onSubmit=function(t){var e=this;if(!(this.ticket.in_progress&&Date.now()-this.ticket.in_progress<1500)){this.ticket.in_progress=Date.now();var i=l.htmlEscape(this.ticketnote.trim()).substr(0,5e3);(t&&this.files.length||!t)&&this.ticketProvider.addTicketPost(this.ticket.id,i,this.files,this.waiting_response).subscribe(function(i){t||(e.nav.alert("New post added :)"),e.ticketnote="",e.active=!1,setTimeout(function(){return e.active=!0},0),e.getPosts(e.ticket.key)),e.files=[]},function(t){e.nav.alert(t,!0),console.log(t||"Server error")}),t&&this.onClose(!0)}},t.prototype.saveNote=function(t){var e=this,i=l.htmlEscape((t.value||"").trim()).substr(0,5e3);i!=(this.ticket.note||"").trim()?this.ticketProvider.addTicketNote(this.ticket.id,i).subscribe(function(t){return e.saveNoteSuccess(i)},function(t){e.nav.alert(t,!0),console.log(t||"Server error")}):this.saveNoteSuccess(i)},t.prototype.getFixed=function(t){return Number(t||"0").toFixed(0).toString()},t.prototype.saveWorkpad=function(t){var e=this,i=(t.value||"").trim().replace(/\n/g,"<p>");i!=(this.ticket.workpad||"").trim()?this.ticketProvider.addTicketWorkpad(this.ticket.id,i).subscribe(function(t){return e.saveWorkpadSuccess(i)},function(t){e.nav.alert(t,!0),console.log(t||"Server error")}):this.saveWorkpadSuccess(i)},t.prototype.openAlert=function(t,e){if(e&&!(e.length<22)){var i=o.Alert.create({title:t,subTitle:e,buttons:[{text:"Ok",role:"cancel"}]});this.nav.present(i)}},t.prototype.saveWorkpadSuccess=function(t){this.nav.alert("Workpad saved :)"),this.ticket.workpad=(t||"").trim(),this.is_editworkpad=!this.ticket.workpad.length},t.prototype.saveNoteSuccess=function(t){this.nav.alert("Note saved :)"),this.ticket.note=(t||"").trim()},t.prototype.onClose=function(t){var e=this;if(!(!t&&this.ticket.in_progress&&Date.now()-this.ticket.in_progress<1500)){this.ticket.in_progress=Date.now();var i=l.htmlEscape(this.ticketnote.trim()).substr(0,5e3),n={status:"closed",note_text:i,is_send_notifications:!0,resolved:!0,resolution_id:0,confirmed:!0,confirm_note:""};this.ticketProvider.closeOpenTicket(this.ticket.key,n).subscribe(function(t){e.update_tlist_logic(!0),e.nav.alert(e.config.current.names.ticket.s+" has been closed :)"),e.ticket.status="Closed",i.length&&(e.ticketnote="",e.active=!1,setTimeout(function(){return e.active=!0},0),e.files=[],e.getPosts(e.ticket.key))},function(t){e.nav.alert(t,!0),console.log(t||"Server error")})}},t.prototype.onHold=function(){var t=this;if("OnHold"==this.ticket.status)return void this.reopenTicket();var e=o.Alert.create({title:"Place On Hold #"+this.ticket.number,inputs:[{name:"note",placeholder:"Note"}],buttons:[{text:"Cancel",handler:function(t){console.log("Cancel clicked")}},{text:"Place On Hold",handler:function(e){var i=l.htmlEscape(e.note.trim()).substr(0,4e3),n={status:"onhold",note_text:i};t.ticketProvider.closeOpenTicket(t.ticket.key,n).subscribe(function(e){t.ticket.status="OnHold",t.update_tlist_logic(!1),t.nav.alert(t.config.current.names.ticket.s+" placed On Hold :)")},function(e){t.nav.alert(e,!0),console.log(e||"Server error")})}}]});this.nav.present(e)},t.prototype.getXML=function(){for(var t="",e=0;e<this.customfields.length;e++){if(this.customfields[e].required&&""==this.customfields[e].value||"0001-01-01T00:00:00.0000000"==this.customfields[e].value)return this.nav.alert("Please add value to custom field: "+this.customfields[e].name,!0),t="";t+='<field id="'+this.customfields[e].id+'"><caption>'+this.customfields[e].name+"</caption><value>"+this.customfields[e].value+"</value></field>"}return"<root>"+t+"</root>"},t.prototype.onUpdate=function(){var t=this;if(!(this.ticket.in_progress&&Date.now()-this.ticket.in_progress<1500)){this.ticket.in_progress=Date.now();var e=this.getXML();if(""!=e){var i={class_id:this.selects["class"].selected,level_id:this.selects.level.selected,priority_id:this.selects.priority.selected,project_id:this.selects.project.selected,location_id:this.selects.location.selected,account_id:this.selects.account.selected,tech_id:this.selects.alttechs.selected,user_id:this.selects.altusers.selected,customfields_xml:e,default_contract_id:this.selects.contract.selected,default_contract_name:this.selects.contract.value};this.ticketProvider.closeOpenTicket(this.ticket.key,i).subscribe(function(e){t.nav.alert(t.config.current.names.ticket.s+" was successfully updated :)"),t.getPosts(t.ticket.key)},function(t){console.log(t||"Server error")})}}},t.prototype.pickUp=function(){var t=this,e={action:"pickup",note_text:""};this.ticket.in_progress&&Date.now()-this.ticket.in_progress<1500||(this.ticket.in_progress=Date.now(),this.ticketProvider.closeOpenTicket(this.ticket.key,e).subscribe(function(e){t.nav.alert(t.config.current.names.ticket.s+" pickup was Succesfull!"),t.techname=t.ticket.tech_firstname=l.getFullName(t.he.firstname,t.he.lastname,t.he.email),t.ticket.tech_lastname=t.ticket.tech_email="",t.getPosts(t.ticket.key)},function(e){t.nav.alert(e,!0),console.log(e||"Server error")}))},t.prototype.onDelete=function(t){var e=this,i={ticket:this.ticket.key,file_id:t.id};this.dataProvider.deleteFile(i).subscribe(function(i){e.attachments=e.attachments.filter(function(e){return e!==t}),e.getPosts(e.ticket.key),e.nav.alert("File "+t.name+" deleted!")},function(t){e.nav.alert(t,!0),console.log(t||"Server error")})},t.prototype.reopenTicket=function(){var t=this,e={status:"open",note_text:""};this.ticketProvider.closeOpenTicket(this.ticket.key,e).subscribe(function(e){t.update_tlist_logic(!1),t.nav.alert(t.config.current.names.ticket.s+" has been Reopened!"),t.ticket.status="Open"},function(e){t.nav.alert(e,!0),console.log(e||"Server error")})},t.prototype.update_tlist_logic=function(t){var e=this;if(this.cachename)if(~this.cachename.indexOf("closed")&&(t=!t,this.closed_index=0),t)this.closed_index=this.ticketProvider._dataStore[this.cachename].findIndex(function(t){return t.key===e.ticket.key}),this.ticketProvider._dataStore[this.cachename].splice(this.closed_index,1),~this.cachename.indexOf("closed")&&this.ticketProvider._dataStore[this.cachename.replace("closed","open")].splice(0,0,this.ticket);else{this.ticketProvider.getTicketsList(this.cachename,"","",{limit:25}),this.ticketProvider._dataStore[this.cachename].splice(this.closed_index,0,this.ticket);this.ticketProvider._dataStore[this.cachename].findIndex(function(t){return t.key===e.ticket.key});~this.cachename.indexOf("closed")&&this.ticketProvider._dataStore[this.cachename.replace("open","closed")].splice(this.ticketProvider._dataStore[this.cachename.replace("open","closed")].findIndex(function(t){return t.key===e.ticket.key}),1)}},t.prototype.closeTicket=function(t){var e=this;if("Closed"==this.ticket.status)return void this.reopenTicket();if(this.config.current.is_force_time_on_closing_tickets&&!t)return void this.addTime(!0);var i=o.Modal.create(g.CloseTicketModal,{number:this.ticket.number,key:this.ticket.key,subject:this.ticket.subject});i.onDismiss(function(t){t&&(e.ticket.status="Closed",e.update_tlist_logic(!0))}),this.nav.present(i)},t.prototype.cheakAllowsToReopen=function(){if(0==this.config.current.is_allows_tech_to_reopen)return!1;var t=this.dayOld(this.posts[0].record_date);return!(this.config.current.days_allowed_to_reopen<=t)},t.prototype.dayOld=function(t){t=t||0,isNaN(t)&&(t=Math.round(((new Date).getTime()-+new Date(t+"Z"))/6e4));var e=t/60,i="";return i=!t||2>t?"0":parseInt((e/24).toString())+""},t.prototype.transferTicket=function(){var t=this,e=o.Modal.create(g.TransferTicketModal,{number:this.ticket.number,key:this.ticket.key,subject:this.ticket.subject,tech_firstname:this.ticket.tech_firstname,tech_lastname:this.ticket.tech_lastname});e.onDismiss(function(e){e&&(t.techname=t.ticket.tech_firstname=e.name,t.ticket.tech_lastname=t.ticket.tech_email="",t.getPosts(t.ticket.key))}),this.nav.present(e)},t.prototype.changeUser=function(){var t=this,e=o.Modal.create(g.ChangeUserModal,{number:this.ticket.number,key:this.ticket.key,subject:this.ticket.subject,user_firstname:this.ticket.user_firstname,user_lastname:this.ticket.user_lastname});e.onDismiss(function(e){e&&(t.username=t.ticket.user_firstname=e.name,t.ticket.user_lastname=t.ticket.user_email="",t.getPosts(t.ticket.key))}),this.nav.present(e)},t.prototype.changeSubject=function(t){this.subject=t.viewModel},t.prototype.changeNextStep=function(t){this.next_step=t.viewModel},t.prototype.ChangeSubject=function(){var t=this;this.subject&&""!=this.subject||(this.subject=this.ticket.subject),this.next_step&&""!=this.next_step||(this.next_step=this.ticket.next_step),this.next_step_date=(new Date).toJSON(),this.ticketProvider.addTicketSubject(this.ticket.key,this.subject,this.next_step).subscribe(function(e){t.nav.alert("Subject on the "+t.config.current.names.ticket.s+" has been changed :)"),t.ticket.subject=t.subject,t.ticket.next_step!=t.next_step&&(t.ticket.next_step_date=t.next_step_date),t.ticket.next_step=t.next_step,t.showSubjChange=!t.showSubjChange,t.ticketProvider.getTicketsList(t.cachename,"","",{limit:25})},function(e){t.nav.alert(e,!0),console.log(e||"Server error")})},t.prototype.cancelSubject=function(){this.changeSubject(this.ticket.subject),this.changeNextStep(this.ticket.next_step),this.showSubjChange=!this.showSubjChange},t.prototype.addTime=function(t){var e=this,i=o.Modal.create(f.TimelogPage,{number:this.ticket.number,ticket_number:this.ticket.key,subject:this.ticket.subject,account_id:this.ticket.account_id,is_force_time_on_closing_tickets:this.config.current.is_force_time_on_closing_tickets&&t});i.onDismiss(function(t){t&&e.closeTicket(!0)}),this.nav.present(i)},t.prototype.addExpense=function(){var t=o.Modal.create(v.ExpenseCreatePage,{number:this.ticket.number,ticket_number:this.ticket.key,subject:this.ticket.subject,account_id:this.ticket.account_id});this.nav.present(t)},t.prototype.addFilesButton=function(){console.log("Function connect");var t=o.Modal.create(_.AddFilesModal);t.onDismiss(function(t){}),this.nav.present(t)},t.prototype.Escalate=function(t){var e=this;t=t||!1,this.ticket.in_progress&&Date.now()-this.ticket.in_progress<1500||(this.ticket.in_progress=Date.now(),this.ticketProvider.escalateTicket(this.ticket.key,t).subscribe(function(i){e.processDetails(i),e.nav.alert(e.config.current.names.ticket.s+" was "+(t?"escalated":"de-escalated")+" succesfully!")},function(t){e.nav.alert(t||"Error! Try again later ...",!0),console.log(t||"Server error")}))},t.prototype.getFullapplink=function(t){var e=this.config.getCurrent();l.fullapplink(a.AppSite,t,e.instance,e.org)},t.prototype.getMailTolink=function(t){var e=this.config.getCurrent();l.mailtolink(t,e.instance,e.org)},t.prototype.getFullName=function(t,e,i,n){return l.getFullName(t,e,i,n)},t.prototype.getCurrency=function(t){return l.getCurrency(t)},t.prototype.getFileLink=function(t){return l.FileUrlHelper.getFileLink(t.url,t.name)},t.prototype.setDate=function(t,e,i){return t?(t=new Date(t.substring(0,23)+"Z"),l.getDateTime(t,e,i)):null},t=n([o.Page({template:'<ion-navbar *navbar><button menuToggle><ion-icon name="menu"></ion-icon></button><ion-title class="padding-right24">{{ticket.status}} | <a href="#" (click)="getFullapplink(ticket.key)" class="text-decor">{{ticket.number}}&nbsp;<ion-icon class="outline" name="ios-open-outline"></ion-icon></a></ion-title></ion-navbar><ion-content><ion-toolbar class="blue3 display_flex"><div (click)="showSubjChange = !showSubjChange"><h4 class="width90" style="width: 85% !important;">{{ticket.subject | Htmlsafe}}</h4><ion-icon name="md-create" style="font-size:1.8em; margin-top:9px"></ion-icon><h5 *ngIf="ticket.next_step != \'\'" class="width90 span-left grey3_color" style="margin-top: -5px; margin-bottom: 5px; padding: 0px !important;">Next step: <span class="text-color">{{ticket.next_step}} -</span> {{ticket.next_step_date | Daysago}}</h5></div><div *ngIf="showSubjChange" class="span-left"><ion-item no-lines class="labels" style="font-size: 1.5rem; background-color: transparent;">Subject:</ion-item><input class="width90 blue3 subject-create commentText margin-bottom3" style="background-color: rgba(255,255,255,0.1) !important;" placeholder="change Subject" required maxlength="200" (ngModelChange)="changeSubject(name1)" #name1="ngForm" [ngModel]="ticket.subject"><ion-item no-lines class="labels" style="font-size: 1.5rem; background-color: transparent;">Next step:</ion-item><input class="width90 blue3 subject-create commentText margin-bottom10" style="background-color: rgba(255,255,255,0.1) !important;" placeholder="add Next step" required maxlength="200" (ngModelChange)="changeNextStep(name2)" #name2="ngForm" [ngModel]="ticket.next_step"> <button secondary class="left indent-bottom width30 cancelSubject" (click)="cancelSubject()" type="submit">Cancel</button> <button secondary class="button_reply right indent-bottom width30 ChangeSubject" (click)="ChangeSubject()" type="submit">Save</button></div><span no-lines class="span-left"><p *ngIf="config.current.is_class_tracking && ticket.class_name"><u>Class</u>:&nbsp;{{ticket.class_name}}</p><p><u>{{config.current.names.tech.a}}</u>: {{techname}}</p><p><u>{{config.current.names.user.a}}</u>: {{username}}</p><p *ngIf="config.current.is_account_manager && ticket.account_name"><u>{{config.current.names.account.a}}</u>:&nbsp;{{ticket.account_name}}</p><p *ngIf="config.current.is_location_tracking && ticket.location_name"><u>{{config.current.names.location.a}}</u>:&nbsp;{{ticket.location_name}}</p></span> <span class="span-right"><p><u>{{ticket.days_old_in_minutes | Daysold}}</u></p><br><template [ngIf]="config.current.is_time_tracking && ticket.total_hours > 0"><p><u>{{ticket.total_hours}}</u>&nbsp;Hours</p><br></template><template [ngIf]="ticket.sla_complete_date != null"><p><u>SLA</u>: {{setDate(ticket.sla_complete_date, false, true)}}</p><br></template><template [ngIf]="config.current.is_expenses && ticket.misc_cost > 0"><p><u>Expenses</u>: {{getCurrency(ticket.misc_cost)}}</p><br></template></span></ion-toolbar><div *ngIf="ticket?.percentage_complete" class="lineblock"><p class="dioitem">Complete:</p><div class="dioline"><p class="complete" [style.width]="ticket?.percentage_complete + \'%\'">{{ticket?.percentage_complete}}%</p></div></div><div class="lineblock" *ngIf="ticket?.budget_hours"><p class="dioitem" style="margin-top: 2px;">Budget:</p><div class="dioline" style="margin-top: 2px; margin-bottom: 2px;"><p class="complete" style="max-width: 100%" [style.width]="percentage_budget + \'%\'">{{percentage_budget}}%</p></div></div><ion-segment [(ngModel)]="details_tab" *ngIf="config.current.user.is_techoradmin"><ion-segment-button value="Reply">Reply</ion-segment-button><ion-segment-button value="Info">Info</ion-segment-button><ion-segment-button value="Assign">Assign</ion-segment-button><ion-segment-button value="Notes">Notes</ion-segment-button><ion-segment-button value="Files">Files</ion-segment-button><ion-segment-button value="Options">Options</ion-segment-button></ion-segment><div [ngSwitch]="details_tab"><div class="list" [hidden]="details_tab != \'Reply\'"><ion-item no-lines class="margin-bottom10"><ion-label class="font-size17 text-right">Logs</ion-label><ion-toggle [(ngModel)]="is_showlogs" style="margin-left: -16px !important;"></ion-toggle></ion-item><posts-list [posts]="posts" [is_first]="true" [attachments]="attachments" [is_showlogs]="is_showlogs"></posts-list><form *ngIf="active" #addForm="ngForm"><div class="tooltips" style="position: inherit;"><textarea class="width100 textLogin commentText" [(ngModel)]="ticketnote" type="text" placeholder="Add Response" ngControl="note" #note="ngForm" required maxlength="4000"></textarea> <span [hidden]="note.valid || note.untouched">Response is required (max 5000 chars)</span></div><button secondary class="button_reply right indent-bottom margin-left10" [disabled]="!addForm.valid && !files?.length" (click)="u.onUpload()" type="submit">Reply</button> <button *ngIf="!config.current.user.is_techoradmin && ticket.status != \'Closed\'" secondary class="button_reply right indent-bottom margin-left10" (click)="u.onUpload(true)" [disabled]="!addForm.valid && !files?.length">Reply & Close</button><upload-button #u (filesUploaded)="uploadedFile($event)" (filesSelected)="selectedFile($event)" btnStyle="add-circle" [allowMultiple]="true" [fileDest]="fileDest" [filesExist]="attachments" [logCallback]></upload-button></form><div *ngIf="config.current.is_waiting_on_response" (click)="waiting_response = !waiting_response;" style="padding-bottom: 13px; margin-top: -10px !important; display:inline-flex;"><ion-icon [ngClass]="{\'ion-ios-checkmark-circle secondary\' : waiting_response, \'ion-ios-radio-button-on grey2\' : !waiting_response }" class="fontResp todos-padding margin-top3"></ion-icon><h5 style="margin-top: 11px;">Waiting on Response</h5></div><ion-label class="text-left" style="font-size: 12px; white-space: normal; margin-top: 0px !important; padding-bottom: 20px !important;"><a href="#" (click)="getMailTolink(ticket.key)" class="text-decor"><span style="font-weight: 900;">Ticket Email Address:</span><br>{{ticket.mailto}}&nbsp;</a></ion-label><div class="NoMarginTop"><todo-list *ngIf="config.current.is_todos" [ticket]="ticket.key" user="all"></todo-list></div><posts-list [posts]="posts" [attachments]="attachments" class="general-alignment" [is_showlogs]="is_showlogs"></posts-list><span class="span-block"></span></div><div *ngSwitchWhen="\'Info\'" class="list max-width700 general-alignment"><select-list [list]="selects.account" preload="true" ajax="true" (onChanged)="saveSelect($event)"></select-list><class-list preload="true" [list]="selects.class" (onChanged)="saveSelect($event)"></class-list><select-list preload="true" [list]="selects.level" (onChanged)="saveSelect($event)"></select-list><select-list preload="true" [list]="selects.priority" (onChanged)="saveSelect($event)"></select-list><location-list preload="true" [list]="selects.location" (onChanged)="saveSelect($event)"></location-list><select-list preload="true" [list]="selects.project" (onChanged)="saveSelect($event)"></select-list><select-list [list]="selects.contract" preload="true" (onChanged)="saveSelect($event)"></select-list><hr class="color-bg" *ngIf="customfields.length"><div *ngFor="let customfield of customfields"><custom-field [type]="customfield.type" [id]="customfield.id" [name]="customfield.name" [value]="customfield.value" [choices]="customfield.choices" [required]="customfield.required" (onChanged)="saveCustomfield($event)"></custom-field></div><div>&nbsp;&nbsp;</div><button secondary block (click)="onUpdate()" type="submit" class="disable-hover button button-default button-block">Update</button><ion-label class="text-left" style="font-size: 12px; white-space: normal;"><a href="#" (click)="getMailTolink(ticket.key)" class="text-decor"><span style="font-weight: 900; line-height: 20px;">Ticket Email Address:</span><br>{{ticket.mailto}}&nbsp;</a></ion-label><span class="span-block"></span></div><div *ngSwitchWhen="\'Assign\'" class="list max-width700 general-alignment"><multi-select preload="true" [list]="selects.alttechs" (onChanged)="saveSelect($event)"></multi-select><div *ngFor="let tech of technicians" class="alts"><p class="left color fullname" style="width: 50%">{{tech.user_fullname2.slice(0, 23)}}</p><p *ngIf="!tech.is_primary" class="left color no-primary" style="width: 17%;">-</p><p *ngIf="tech.is_primary" class="left color primary" style="width: 17%">Primary</p><p class="left color date" style="width: 33%;">{{tech.start_date.slice(0, 10)}} {{tech.start_date.slice(12, 16)}}</p></div><div>&nbsp;<br>&nbsp;</div><multi-select ajax="true" [list]="selects.altusers" (onChanged)="saveSelect($event)" preload="true"></multi-select><div *ngFor="let user of users" class="alts"><p class="left color fullname" style="width: 50%">{{user.user_fullname2.slice(0, 23)}}</p><p *ngIf="!user.is_primary" class="left color no-primary" style="width: 17%;">-</p><p *ngIf="user.is_primary" class="left color primary" style="width: 17%">Primary</p><p class="left color date" style="width: 33%;">{{user.start_date.slice(0, 10)}} {{user.start_date.slice(12, 16)}}</p></div><div>&nbsp;&nbsp;</div><button secondary block (click)="onUpdate()" type="submit" class="disable-hover button button-default button-block">Update</button> <span class="span-block"></span></div><ion-list class="list general-alignment max-width700" [hidden]="details_tab != \'Notes\'"><textarea [ngModel]="ticket?.note | Htmlsafe" class="glow width100 textLogin commentText" style="resize: vertical;max-height: 300px;min-height: 110px;" #notetext type="text" placeholder="Notes:"></textarea> <button secondary class="button_reply img-top right" (click)="saveNote(notetext)">{{ticket?.note?.length ? \'Save\' : \'Add\'}} Notes</button> <span class="span-block2"></span><div [hidden]="is_editworkpad" class="width100 textLogin note-account commentText2" [innerHTML]="ticket?.workpad" type="text" (click)="is_editworkpad = true"></div><button [hidden]="is_editworkpad" secondary class="button_reply img-top right" (click)="is_editworkpad = true">Edit Workpad</button> <textarea [hidden]="!is_editworkpad" [ngModel]="(ticket?.workpad || \'\').split(\'<p>\').join(\'\\n\')" class="glow width100 textLogin commentText" #workpadtext type="text" placeholder="Workpad:"></textarea> <button [hidden]="!is_editworkpad" secondary class="button_reply img-top right" (click)="saveWorkpad(workpadtext)">{{ticket?.workpad?.length ? \'Save\' : \'Add\'}} Workpad</button> <span class="span-block"></span></ion-list><ion-list class="list img-top" no-lines *ngSwitchWhen="\'Files\'"><div [hidden]="attachments?.length" class="table grey2 menu-text">No Files yet</div><ion-item *ngFor="let file of attachments"><div class="left width59 tkts-table" [innerHTML]="getFileLink(file)"></div><div class="files-tkts"><span class="color right text-left space-initial flex1 font-size_span subject-ticket">{{file.name}}</span> <button (click)="onDelete(file)" block fab class="red buttonInvoice email-invoice button-fab position-initial button-files margin-left5"><ion-icon class="invoiceCircle" name="close"></ion-icon></button></div></ion-item><span class="span-block"></span> <button (click)="callback($event)" secondary item-right fab fab-right fab-bottom style="z-index: 2"><ion-icon class="button_circle action-but" name="md-add"></ion-icon></button><div><button type="button" (click)="uploadedFile()" left class="button-attach attach color"><ion-icon class="button-font action-but color" name="md-attach"></ion-icon>Add Files</button></div></ion-list><div *ngSwitchWhen="\'Options\'" class="list max-width700 general-alignment"><button *ngIf="config.current.is_time_tracking" (click)="addTime()" block type="submit" class="blue2 disable-hover button button-default button-block class-margin">Add Time</button> <button *ngIf="config.current.is_onhold_status" (click)="onHold()" block type="submit" class="blue2 disable-hover button button-default button-block class-margin">{{ ticket.status == "OnHold" ? ("ReOpen " + config.current.names.ticket.s) : "Place On Hold" }}</button> <button *ngIf="config.current.is_expenses" (click)="addExpense()" block type="submit" class="blue2 disable-hover button button-default button-block class-margin">Add Expense</button> <button (click)="changeUser()" *ngIf="config.current.is_transfer_ticket_to_another_user" block type="submit" class="blue2 class-margin">Change {{config.current.names.user.s}}</button> <button (click)="transferTicket()" block type="submit" class="blue2 class-margin">Transfer {{config.current.names.ticket.s}}</button> <button *ngIf="(ticket.technician_email || ticket.tech_email) != he.email" (click)="pickUp()" block type="submit" class="blue2 class-margin">Pick Up {{config.current.names.ticket.s}}</button> <button *ngIf="ticket.level_escalate" (click)="Escalate(true)" block type="submit" class="blue2 class-margin">&#8679; Escalate to Level {{ticket.level_escalate}}</button> <button *ngIf="ticket.level_deescalate" (click)="Escalate(false)" block type="submit" class="blue2 class-margin">De-Escalate to Level {{ticket.level_deescalate}} &#8681;</button> <button (click)="closeTicket()" *ngIf="ticket.status == \'Closed\' && cheakAllowsToReopen()" secondary block type="submit" class="class-margin">ReOpen&nbsp;{{config.current.names.ticket.s}}</button> <button (click)="closeTicket()" *ngIf="ticket.status == \'Open\'" secondary block type="submit" class="class-margin">Close&nbsp;{{config.current.names.ticket.s}}</button> <a *ngIf="userphone" href="tel://{{userphone}}" style="text-decoration: unset;"><div block secondary type="submit" class="callNow button button-secondary"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="width: 26px; margin-top:-5px;"><path fill="#fff" d="M436.9 364.8c-14.7-14.7-50-36.8-67.4-45.1-20.2-9.7-27.6-9.5-41.9.8-11.9 8.6-19.6 16.6-33.3 13.6-13.7-2.9-40.7-23.4-66.9-49.5-26.2-26.2-46.6-53.2-49.5-66.9-2.9-13.8 5.1-21.4 13.6-33.3 10.3-14.3 10.6-21.7.8-41.9C184 125 162 89.8 147.2 75.1c-14.7-14.7-18-11.5-26.1-8.6 0 0-12 4.8-23.9 12.7-14.7 9.8-22.9 18-28.7 30.3-5.7 12.3-12.3 35.2 21.3 95 27.1 48.3 53.7 84.9 93.2 124.3l.1.1.1.1c39.5 39.5 76 66.1 124.3 93.2 59.8 33.6 82.7 27 95 21.3 12.3-5.7 20.5-13.9 30.3-28.7 7.9-11.9 12.7-23.9 12.7-23.9 2.9-8.1 6.2-11.4-8.6-26.1z"></path></svg><span style="top: -7px; position: relative;">&nbsp;CALL NOW</span></div></a> <span class="span-block"></span></div></div></ion-content>',
directives:[y.TodoListComponent,P.CustomFieldComponent,d.PostsListComponent,k.forwardRef(function(){return u.SelectListComponent}),k.forwardRef(function(){return p.MultiSelectComponent}),k.forwardRef(function(){return h.ClassListComponent}),k.forwardRef(function(){return m.LocationListComponent}),C],pipes:[b.GravatarPipe,b.LinebreaksPipe,b.DaysoldPipe,b.DaysagoPipe,b.HtmlsafePipe]}),s("design:paramtypes",[o.Nav,o.NavParams,c.TicketProvider,r.DataProvider,o.Config])],t)}();i.TicketDetailsPage=T},{"../../components/class-list/class-list":4,"../../components/custom-field/custom-field":6,"../../components/location-list/location-list":7,"../../components/multi-select/multi-select":9,"../../components/posts-list/posts-list":10,"../../components/select-list/select-list":12,"../../components/todo-list/todo-list":15,"../../directives/helpers":19,"../../pages/expense-create/expense-create":25,"../../pages/modals/add-files/add-files":33,"../../pages/modals/modals":41,"../../pages/timelog/timelog":56,"../../pipes/pipes":69,"../../providers/config":71,"../../providers/data-provider":72,"../../providers/ticket-provider":75,"@angular/core":"@angular/core","ionic-angular":"ionic-angular"}],55:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),a=t("../../providers/providers"),r=t("../modals/modals"),c=t("../ticket-details/ticket-details"),l=t("../ajax-search/ajax-search"),d=t("../../components/components"),u=t("../../directives/directives"),p=t("../../directives/helpers"),h=function(){function t(t,e,i,n,s){this.nav=t,this.navParams=e,this.config=i,this.apiData=n,this.ticketProvider=s,this.term="",this.user_id="",this.counts={}}return t.prototype.onPageLoaded=function(){this.user_id=this.config.getCurrent("user").user_id,this.is_tech=this.config.getCurrent("user").is_techoradmin;var t=this.navParams.data||{};t.count&&(this.counts[t.tab]=t.count),this.is_tech?this.ticket_tab=t.tab?t.tab:"tech":this.ticket_tab="user",this.nav.tickets_tab=null,t.key&&this.gotoTicket(t)},t.prototype.onPageDidEnter=function(){this.term=""},t.prototype.addTicket=function(){var t=this,e=o.Modal.create(r.TicketCreatePage);e.onDismiss(function(e){t.gotoTicket(e)}),this.nav.present(e)},t.prototype.gotoTicket=function(t){var e=this;this.test=!1,this.clearSearch(),t&&(this.ticketProvider.getTicketsList(this.ticket_tab,"","",{limit:25}),setTimeout(function(){e.nav.push(c.TicketDetailsPage,t)},500))},t.prototype.searchItems=function(t){var e=this;this.search_results=[];var i=t.value;if(""!=i.trim()&&!this.busy&&i.length>1){var n=setTimeout(function(){e.busy=!0},500);this.getItems(i,n)}},t.prototype.getItems=function(t,e){var i=this;this.search_results=[];var n="tickets?query=all",s={limit:3},o=" "==t[t.length-1]||","==t[t.length-1];o?n="tickets/"+t.trim()+",":t+="*",this.apiData.getPaged(p.addp(n,"search",t),s).subscribe(function(t){e&&(clearTimeout(e),i.busy=!1),i.search_results=t},function(t){e&&(clearTimeout(e),i.busy=!1),console.log(t||"Server error")})},t.prototype.clearSearch=function(t){this.search_results=[],this.busy=!1,t&&(t.value="")},t.prototype.getSearch=function(t){this.test=!1,this.clearSearch();var e=t.target.value;e.length<4&&(e+="    ");var i={search:e};this.test=!1,this.nav.push(l.AjaxSearchPage,i)},t=n([o.Page({template:'<ion-navbar *navbar><ion-buttons start style="margin: 0"><button menuToggle><ion-icon name="menu"></ion-icon></button></ion-buttons><ion-title class="names">{{config.current.names.ticket.p}}</ion-title><ion-buttons end><button danger class="right transparent" (click)="test = !test"><ion-icon name="ios-search"></ion-icon></button></ion-buttons></ion-navbar><div class="tickets mycontent"><ion-searchbar *ngIf="test" [focuser] debounce="700" (cancel)="test = !test" (input)="searchItems($event)" [(ngModel)]="term" placeholder="{{config.current.names.ticket.s}} number (2 chars) or Enter to search" (search)="getSearch($event)"></ion-searchbar><img *ngIf="busy" class="imglogo" src="img/loading2.gif"><ion-list class="ajax" [hidden]="!search_results"><a detail-none href="#" ion-item *ngFor="let item of search_results" (click)="gotoTicket(item)"><h2>{{item.status}} | #{{item.number}} - {{item.subject}} ({{item.user_firstname}} {{item.user_lastname}})</h2></a></ion-list><div *ngIf="is_tech" class="tabsTicket"><ion-segment [(ngModel)]="ticket_tab"><ion-segment-button value="user">{{config.current.names.user.a}}</ion-segment-button><ion-segment-button value="tech">{{config.current.names.tech.a}}</ion-segment-button><ion-segment-button value="closed">Closed</ion-segment-button><ion-segment-button value="alt">Alt</ion-segment-button><ion-segment-button value="all">All Open</ion-segment-button></ion-segment></div><tickets-list [hidden]="ticket_tab != \'user\' && is_tech" [preload]="ticket_tab == \'user\' ? 0 : 1500" [mode]="[\'user\']" [count]="counts.user"></tickets-list><tickets-list *ngIf="is_tech" [hidden]="ticket_tab != \'tech\'" [preload]="ticket_tab == \'tech\' ? 0 : 1500" [mode]="[\'tech\']" [count]="counts.tech"></tickets-list><tickets-list *ngIf="is_tech" [hidden]="ticket_tab != \'closed\'" [preload]="ticket_tab == \'closed\' ? 0 : 1500" [mode]="[\'closed-tech\', user_id]" [count]="counts.closed"></tickets-list><tickets-list *ngIf="is_tech" [hidden]="ticket_tab != \'alt\'" [preload]="ticket_tab == \'alt\' ? 0 : 1500" [mode]="[\'alt\']" [count]="counts.alt"></tickets-list><tickets-list *ngIf="is_tech" [hidden]="ticket_tab != \'all\'" [preload]="ticket_tab == \'all\' ? 0 : 1500" [mode]="[\'all\']" [count]="counts.all"></tickets-list></div><button (click)="addTicket()" secondary item-right fab fab-right fab-bottom style="z-index: 2"><ion-icon class="button_circle action-but" name="md-add"></ion-icon></button>',directives:[d.TicketsListComponent,u.Focuser]}),s("design:paramtypes",[o.Nav,o.NavParams,o.Config,a.ApiData,a.TicketProvider])],t)}();i.TicketsPage=h},{"../../components/components":5,"../../directives/directives":17,"../../directives/helpers":19,"../../providers/providers":74,"../ajax-search/ajax-search":22,"../modals/modals":41,"../ticket-details/ticket-details":54,"ionic-angular":"ionic-angular"}],56:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),a=t("@angular/core"),r=t("../../directives/helpers"),c=t("../../providers/time-provider"),l=t("../../components/class-list/class-list"),d=t("../../components/select-list/select-list"),u=t("../invoice-details/invoice-details"),p=function(){function t(t,e,i,n,s){this.nav=t,this.navParams=e,this.timeProvider=i,this.config=n,this.view=s,this.istaxable=!0,this.time={},this.title="",this.selects={},this.minuteValues=[0,15,30,45,0],this.start_time="",this.stop_time="",this.UserDateOffset=-5}return t.prototype.decrement=function(){this.timecount=Math.max(Number(this.timecount)-this.inc,0).toFixed(2)},t.prototype.increment=function(){this.timecount=(Number(this.timecount)+this.inc).toFixed(2)},t.prototype.decrement_nonwork=function(){this.timecount_nonwork=Math.max(Number(this.timecount_nonwork)-this.inc,0).toFixed(2)},t.prototype.increment_nonwork=function(){this.timecount_nonwork=(Number(this.timecount_nonwork)+this.inc).toFixed(2)},t.prototype.ngAfterViewInit=function(){},t.prototype.AddHours=function(t,e){return t?(t=new Date(t.substring(0,19)+"Z"),t=new Date(t.setTime(t.getTime()+60*e*60*1e3)).toJSON()):t},t.prototype.GetLocalDate=function(){var t=new Date;return new Date(t.getTime()-6e4*t.getTimezoneOffset()).toJSON()},t.prototype.ngOnInit=function(){this.UserDateOffset=this.config.getCurrent("timezone_offset"),this.time=this.navParams.data||{};var t=(this.time.user_name+" "+this.time.user_email).trim().split(" ")[0];if(this.time.time_id?(this.title="Timelog #"+this.time.time_id+" by"+t+" on"+this.setDate(this.time.created_time,!1,!0),this.start_time=this.AddHours(this.time.start_time,this.time.time_offset),this.stop_time=this.AddHours(this.time.stop_time,this.time.time_offset)):this.time.number?this.title="#"+this.time.number+" "+this.time.subject:this.title="Add Time",this.time.invoice_id>0&&(this.title="Invoiced #"+this.time.invoice_id+" on"+this.setDate(this.AddHours(this.time.date,this.time.time_offset),!1,!0)),this.inc=this.config.getCurrent("time_hour_increment")>0?this.config.getCurrent("time_hour_increment"):.25,this.mintime=this.config.getCurrent("time_minimum_time")||this.inc,this.mintime=this.mintime>0?this.mintime:this.inc,this.isno_invoice=this.time.no_invoice,this.istaxable=this.time.is_taxable,this.displayFormat=r.getPickerDateTimeFormat(!1,!0),this.inc>=1)this.minuteValues=[0];else if(.25!=this.inc){this.minuteValues=[];var e=0;do this.minuteValues.push(e),e+=5;while(60>e);this.minuteValues.push(0)}this.timecount=(this.time.hours||this.mintime).toFixed(2),this.timecount_nonwork=(this.time.non_working_hours||0).toFixed(2),this.timecount_nonwork<0&&(this.timecount_nonwork=0),this.timenote=r.linebreaks(this.time.note||"",!0),this.he=this.config.getCurrent("user");var i={};this.time.number||this.time.time_id||(this.time.account||{}).id||(i=this.config.current.recent||{});var n=(this.time.account||{}).id||this.time.account_id||(i.account||{}).selected||this.he.account_id||-1,s=(this.time.contract||{}).id||this.time.contract_id||(i.contract||{}).selected||0,o=(this.time.project||{}).id||this.time.project_id||(i.project||{}).selected||0;this.selects={account:{name:"Account",value:(this.time.account||{}).name||this.time.account_name||(i.account||{}).value||this.he.account_name,selected:n,url:"accounts?is_with_statistics=false",hidden:this.time.is_fixed,is_disabled:this.time.ticket_number},project:{name:"Project",value:this.time.project_name||(i.project||{}).value||"Default",selected:o,url:"projects?account="+n+"&is_with_statistics=false",hidden:this.time.is_fixed,is_disabled:this.time.ticket_number},ticket:{name:"Ticket",value:this.time.ticket_number?"#"+this.time.ticket_number+": "+this.time.ticket_subject:"Choose (optional)",selected:this.time.ticket_number||0,url:"tickets?status=open&account="+n+"&project="+o,hidden:this.time.is_project_log||!1,is_disabled:this.time.task_type_id},tasktype:{name:"Task Type",value:this.time.task_type||(i.tasktype||{}).value||"Choose",selected:this.time.task_type_id||this.config.getRecent("tasktype").selected||0,url:this.time.ticket_number?"task_types?ticket="+this.time.ticket_number:"task_types?account="+n},contract:{name:"Contract",value:this.time.contract_name||(i.contract||{}).value||"Choose",selected:this.time.contract_id||this.config.getRecent("contract").selected||0,url:"contracts?account_id="+n,hidden:this.time.is_fixed},prepaidpack:{name:"PrePaid Pack",value:this.time.prepaid_pack_name||(i.prepaidpack||{}).value||"Choose",selected:this.time.prepaid_pack_id||this.config.getRecent("prepaidpack").selected||0,url:"prepaid_packs?contract_id="+s,hidden:this.time.is_fixed}}},t.prototype.saveSelect=function(t){var e=t.type,i=this.selects.account.selected,n=this.selects.ticket.selected,s=this.selects.project.selected,o=this.selects.contract.selected;this.selects.prepaidpack.selected;switch(e){case"account":if(this.selects.account.selected===t.id)break;this.selects.project.url="projects?account="+t.id+"&is_with_statistics=false",this.selects.project.value="Default",this.selects.project.selected=0,s=0,this.selects.contract.url="contracts?account_id="+t.id,this.selects.contract.value="Default",this.selects.contract.selected=0,o=0,this.selects.prepaidpack.url="prepaid_packs?contract_id=0",this.selects.prepaidpack.value="Choose (optional)",this.selects.prepaidpack.selected=0,i=t.id,this.selects.ticket.hidden=this.time.is_project_log||this.time.task_type_id||!1,this.time.task_type_id||(this.selects.ticket.url="tickets?status=open&account="+i+"&project="+s,this.selects.ticket.value="Choose (optional)",this.selects.ticket.selected=0),this.selects.project.hidden=!this.config.current.is_project_tracking;break;case"project":if(this.selects.project.selected===t.id)break;this.time.task_type_id||(this.selects.ticket.hidden=this.time.is_project_log||this.time.task_type_id||!1,this.selects.ticket.url="tickets?status=open&account="+i+"&project="+t.id,this.selects.ticket.value="Choose (optional)",this.selects.ticket.selected=0),s=t.id;break;case"contract":if(this.selects.contract.selected===t.id)break;this.selects.prepaidpack.url="prepaid_packs?contract_id="+t.id,this.selects.prepaidpack.value="Choose (optional)",this.selects.prepaidpack.selected=0,o=t.id;break;case"ticket":if(this.selects.ticket.selected===t.id)break;n=t.id}this.selects.tasktype.url="task_types?ticket="+n+"&account="+i+"&project="+s+"&contract="+o,this.selects.tasktype.value="Choose",this.selects.tasktype.selected=0,this.selects[e].selected=t.id,this.selects[e].value=t.name||"Default"},t.prototype.onSubmit=function(t){var e=this;if(this.time.invoice_id)return void this.viewInvoice();var i=Number(this.timecount),n=Number(this.timecount_nonwork);if(i+this.timecount_nonwork<this.mintime)return void this.nav.alert("Not enough time",!0);if(this.start_time&&this.stop_time&&i>this.getInterval())return void this.nav.alert("Hours value should be less or equal to Start/Stop range.",!0);if(this.config.current.is_invoice&&!this.selects.contract.selected)return void this.nav.alert("Please, select Contract from the list.",!0);if(!this.selects.tasktype.selected)return void this.nav.alert("Please, select Task Type from the list.",!0);if(t.valid){if(this.time.in_progress&&Date.now()-this.time.in_progress<1500)return;this.time.in_progress=Date.now();var s=r.htmlEscape(this.timenote.trim()).substr(0,5e3),o=!!this.time.time_id,a=this.start_time;this.endsWith(this.start_time,"Z")&&(a=a.substring(0,19));var c=this.stop_time;this.endsWith(this.stop_time,"Z")&&(c=c.substring(0,19));var l=this.time.date||this.GetLocalDate();a&&(l=a);var d={tech_id:o?this.time.user_id:this.he.user_id,project_id:this.selects.project.selected,is_project_log:!this.selects.ticket.selected,ticket_key:this.selects.ticket.selected,account_id:this.selects.account.selected,note_text:s,task_type_id:this.selects.tasktype.selected,prepaid_pack_id:this.selects.prepaidpack.selected,hours:i,no_invoice:this.isno_invoice,is_taxable:this.istaxable,date:l||"",start_date:a||"",stop_date:c||"",non_working_hours:n,contract_id:this.selects.contract.selected,is_local_time:!0};this.timeProvider.addTime(this.time.time_id,d,o?"PUT":"POST").subscribe(function(t){if(e.time.number||e.time.time_id||(e.time.account||{}).id||e.config.setRecent({account:e.selects.account,project:e.selects.project,tasktype:e.selects.tasktype,contract:e.selects.contract,prepaidpack:e.selects.prepaidpack}),o)e.time.start_time=e.AddHours(d.start_date,-1*e.UserDateOffset),e.time.stop_time=e.AddHours(d.stop_date,-1*e.UserDateOffset),e.time.hours=d.hours,e.time.non_working_hours=d.non_working_hours,e.time.no_invoice=d.no_invoice,e.time.is_taxable=d.is_taxable;else{var i=d.date||e.GetLocalDate(),n={time_id:0,account_id:d.account_id,account_name:e.selects.account.value,no_invoice:d.no_invoice,is_taxable:d.is_taxable,date:i,hours:d.hours,non_working_hours:d.non_working_hours,is_project_log:d.is_project_log,note:d.note_text,project_id:d.project_id,project_name:e.selects.project.value,start_time:e.AddHours(d.start_date,-1*e.UserDateOffset),stop_time:e.AddHours(d.stop_date,-1*e.UserDateOffset),time_offset:e.UserDateOffset,task_type:e.selects.tasktype.value,task_type_id:d.task_type_id,contract_name:e.selects.contract.value,contract_id:d.contract_id,prepaid_pack:e.selects.prepaidpack.value,prepaid_pack_id:d.prepaid_pack_id,ticket_number:d.ticket_key,ticket_subject:e.selects.ticket.value,user_email:e.he.email,user_id:e.he.user_id,user_name:e.he.firstname+" "+e.he.lastname};(e.timeProvider._dataStore[e.time.cachename]||[]).splice(0,0,n)}e.nav.alert("Time was successfully "+(o?"updated":"added")+" :)"),e.close(n)},function(t){console.log(t||"Server error")})}},t.prototype.setDate=function(t,e,i){return t?r.getDateTime(t,e,i):null},t.prototype.setMinTime=function(t){return t||this.time.date||this.GetLocalDate().substring(0,4)},t.prototype.setMaxTime=function(t){return t||this.time.date||this.GetLocalDate().substring(0,4)},t.prototype.getStartDate=function(t){return t||this.time.date||this.GetLocalDate()},t.prototype.setStartDate=function(t){t&&(this.start_time=t.substring(0,19),this.stop_time&&this.updateHours())},t.prototype.setStopDate=function(t){t&&(this.stop_time=t.substring(0,19),this.start_time&&this.updateHours())},t.prototype.updateHours=function(){var t=this.getInterval();this.timecount=t.toFixed(2)},t.prototype.endsWith=function(t,e){t=t||"";var i=t.length;return t.substring(i-e.length,i)===e},t.prototype.getInterval=function(){var t=this.start_time.substring(0,16)+"Z",e=this.stop_time.substring(0,16)+"Z",i=Number(Math.round((+new Date(e)-+new Date(t))/6e4)/60);return i>0&&i<this.inc&&(i=this.inc),i},t.prototype.getFixed=function(t){return Number(t||"0").toFixed(2).toString()},t.prototype.close=function(t){this.view.dismiss(t)},t.prototype.viewInvoice=function(){var t={account_name:this.time.account_name,id:this.time.invoice_id,account_id:this.time.account_id,project_id:this.time.project_id};this.nav.push(u.InvoiceDetailsPage,t)},t=n([o.Page({template:'<ion-toolbar><button (click)="close()" class="bar-button bar-button-default"><span *ngIf="title?.length < 9" primary>Cancel</span><ion-icon *ngIf="title?.length > 9" primary class="invoiceCircle" name="ios-arrow-back"></ion-icon></button><ion-title class="ellipsis padding-right24">{{title}}</ion-title></ion-toolbar><ion-content class="timelog"><div class="list max-width700"><p *ngIf="time.is_force_time_on_closing_tickets" class="is-force-time">Your administrator is requiring time entries before a {{config.current.names.ticket.s}} can be closed.</p><div class="img-top"><a detail-none href="#" (click)="decrement()" class="left width30 button-timelog"><ion-item no-lines class="width100 blue4"><ion-icon name="remove" class="padding-left8"></ion-icon></ion-item></a><ion-item no-lines class="blue3 left width30 button-timelog line-height5 height51"><ion-input class="timelog-input width100 right margin padding-1px" [(ngModel)]="timecount"></ion-input></ion-item><a detail-none href="#" (click)="increment()" class="right width30 button-timelog dashboardRight"><ion-item no-lines class="width100 blue4"><ion-icon name="add" class="padding-left8"></ion-icon></ion-item></a></div><ion-item no-lines class="start-end top0">Start Time</ion-item><ion-item no-lines class="blue3 top0 bottom5"><ion-label class="start-end2">Start Time</ion-label><ion-datetime [ngClass]="{\'nocolor\': !start_time, \'text-color\': start_time}" #starttime [displayFormat]="displayFormat" [min]="setMinTime(start_time)" [max]="setMaxTime(stop_time)" [minuteValues]="minuteValues" (ngModelChange)="setStartDate($event)" [ngModel]="getStartDate(start_time)"></ion-datetime></ion-item><div class="general-alignment2"><ion-item no-lines class="start-end">End Time</ion-item><ion-item no-lines class="blue3 top0 bottom5"><ion-label class="start-end2">End Time</ion-label><ion-datetime [ngClass]="{\'nocolor\': !stop_time, \'text-color\': stop_time}" #stoptime [displayFormat]="displayFormat" [min]="setMinTime(start_time)" [max]="setMaxTime(stop_time)" [minuteValues]="minuteValues" (ngModelChange)="setStopDate($event)" [ngModel]="getStartDate(stop_time)"></ion-datetime></ion-item></div><div class="img-top"><ion-item no-lines class="labels color img-top">Non-Working hours</ion-item><a detail-none href="#" (click)="decrement_nonwork()" class="left width30 button-timelog"><ion-item no-lines class="width100 blue4"><ion-icon name="remove" class="padding-left8"></ion-icon></ion-item></a><ion-item no-lines class="blue3 left width30 button-timelog line-height5 height51"><ion-input class="timelog-input width100 right margin padding-1px" [(ngModel)]="timecount_nonwork"></ion-input></ion-item><a detail-none href="#" (click)="increment_nonwork()" class="right width30 button-timelog dashboardRight"><ion-item no-lines class="width100 blue4"><ion-icon name="add" class="padding-left8"></ion-icon></ion-item></a></div><div class="general-alignment2"><select-list *ngIf="!time.number" [list]="selects.account" ajax="true" preload="true" (onChanged)="saveSelect($event)"></select-list><select-list *ngIf="!time.number" [list]="selects.project" preload="true" (onChanged)="saveSelect($event)"></select-list><select-list *ngIf="!time.number" [list]="selects.ticket" preload="true" (onChanged)="saveSelect($event)"></select-list><select-list [list]="selects.contract" preload="true" (onChanged)="saveSelect($event)"></select-list><select-list [list]="selects.prepaidpack" preload="true" (onChanged)="saveSelect($event)"></select-list><select-list [list]="selects.tasktype" preload="true" (onChanged)="saveSelect($event)"></select-list></div><form #addForm="ngForm"><ion-item no-lines class="left toggle-width"><ion-toggle class="toggle" [(ngModel)]="isno_invoice"></ion-toggle></ion-item><p class="left width30 text-toggle color">Do Not Invoice</p><ion-item no-lines class="left toggle-width"><ion-toggle class="toggle" [(ngModel)]="istaxable"></ion-toggle></ion-item><p class="left width20 text-toggle color">Taxable</p><textarea class="width100 textLogin commentText" type="text" placeholder="I completed..." [(ngModel)]="timenote" ngControl="note" #note="ngForm" maxlength="4000">{{time.note}}</textarea><div class="img-top"><button secondary block type="submit" class="disable-hover button button-default button-block" [disabled]="!addForm.valid" (click)="onSubmit(addForm)">{{time.invoice_id > 0 ? (\'View Invoice #\'+time.invoice_id) : (time.time_id ? \'Update Time\' : \'Add Time\')}}</button> <span class="span-block"></span></div></form></div></ion-content>',directives:[l.ClassListComponent,a.forwardRef(function(){return d.SelectListComponent})]}),s("design:paramtypes",[o.Nav,o.NavParams,c.TimeProvider,o.Config,o.ViewController])],t)}();i.TimelogPage=p},{"../../components/class-list/class-list":4,"../../components/select-list/select-list":12,"../../directives/helpers":19,"../../providers/time-provider":76,"../invoice-details/invoice-details":28,"@angular/core":"@angular/core","ionic-angular":"ionic-angular"}],57:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),a=t("../../providers/time-provider"),r=t("../../directives/helpers"),c=t("../timelog/timelog"),l=t("../../components/action-button/action-button"),d=t("../../directives/helpers"),u=t("../../pipes/pipes"),p=function(){function t(t,e,i,n,s){this.nav=t,this.timeProvider=e,this.config=i,this.navParams=n,this.view=s,this.LIMIT=25,this.is_empty=!1,this.initial_load=!0,this.pager={page:0,limit:this.LIMIT}}return t.prototype.onPageLoaded=function(){this.params=this.navParams.data||{},this.pager={page:0},this.params.account={id:this.params.account_id||"",name:this.params.account_name||""},this.cachename=r.addp("time","account",this.params.account.id),this.cachelen=(this.timeProvider._dataStore[this.cachename]||{}).length,this.params.is_empty&&(this.params.count=0),0!==this.params.count?this.getTimeLogs():this.is_empty=!0},t.prototype.getTimeLogs=function(){var t=this;if(this.timeProvider.getTimelogs(this.params.account.id,this.pager),this.timelogs=this.timeProvider.times$[this.cachename],!this.cachelen){var e=setTimeout(function(){t.busy=!0},500);setTimeout(function(){t.busy=!1},1e4),this.timelogs.subscribe(function(i){clearTimeout(e),t.busy=!1,t.is_empty=!i.length})}},t.prototype.onPageWillEnter=function(){var t=this;this.params.account_name&&this.view.setBackButtonText(""),this.initial_load||setTimeout(function(){t.getTimeLogs()},4e3),this.initial_load=!1},t.prototype.doInfinite=function(t){var e=this;if(this.is_empty||this.cachelen>0&&(this.cachelen>=this.params.count||this.cachelen<this.LIMIT)||this.params.count>0&&this.params.count<this.LIMIT)return t.enable(!1),void t.complete();this.pager.page+=1;var i=(this.timeProvider._dataStore[this.cachename]||{}).length;this.timeProvider.getTimelogs(this.params.account.id,this.pager),this.timelogs.subscribe(function(n){t.complete();var s=n.length;t.enable(!(i==s||s%e.LIMIT)),e.cachelen=s})},t.prototype.itemTapped=function(t){t=t||{},t.account=t.account||this.params.account,t.cachename=this.cachename,this.nav.push(c.TimelogPage,t)},t.prototype.setDate=function(t,e,i,n){return t?d.getDateTime(t,i,n):null},t.prototype.getFixed=function(t){return Number(t||"0").toFixed(2).toString()},t=n([o.Page({template:'<ion-navbar *navbar><button menuToggle><ion-icon name="menu"></ion-icon></button><ion-title class="padding-right24">Timelogs {{params.account_name ? "of&nbsp;" + params.account.name : ""}}</ion-title></ion-navbar><ion-content><ion-list class="list general-alignment2" no-lines><img *ngIf="busy" class="imglogo img-padding" src="img/loading2.gif"><ion-item-sliding class="timelog-item" *ngFor="let time of timelogs | async" #slidingItem><a detail-none href="#" ion-item (click)="itemTapped(time)"><ion-avatar padding item-left><li><img class="img_avatar" [alt]="time.user_firstname" [src]="time.user_email | Gravatar"><p>{{time.user_name}} {{time.user_lastname}}</p></li></ion-avatar><div><li class="font-hours"><ion-icon name="time">&nbsp;</ion-icon><h2>{{getFixed(time.hours)}}</h2><p>{{setDate(time.date, time.time_offset)}}</p><h2 *ngIf="time.non_working_hours > 0" style="margin-bottom: 0px" class="outline_white">{{time.non_working_hours}}</h2><p *ngIf="time.non_working_hours > 0" style="margin-top: 0px">non-work</p></li><span class="timelog-span"><h3 *ngIf="time.invoice_id > 0" class="marginNO"><b>INVOICED:</b> #{{time.invoice_id}}</h3><h3 [innerHTML]="\'<b>\' + ((time.ticket_number ? (\'#\'+time.ticket_number+\': \'+time.ticket_subject + (time.note ? \' - \' : \'\')) : (time.account_name + \': \')) + \'</b>\' + time.note) | Linebreaks"></h3><h3 *ngIf="time.contract_name" class="marginNO"><b>Contract:</b> {{time.contract_name}}</h3><h3 *ngIf="time.prepaid_pack_id > 0" class="marginNO"><b>Pre-Paid Pack:</b> {{time.prepaid_pack_name}}</h3></span></div></a></ion-item-sliding></ion-list><div *ngIf="is_empty" class="table grey2 menu-text">No Timelogs yet</div><ion-infinite-scroll (infinite)="doInfinite($event)" threshold="30%"><ion-infinite-scroll-content loadingSpinner="circles" loadingText="Loading more data..."></ion-infinite-scroll-content></ion-infinite-scroll></ion-content><button (click)="itemTapped()" secondary item-right fab fab-right fab-bottom style="z-index: 2"><ion-icon class="button_circle action-but" name="md-add"></ion-icon></button>',directives:[l.ActionButtonComponent],pipes:[u.GravatarPipe,u.MorePipe,u.LinebreaksPipe]}),s("design:paramtypes",[o.Nav,a.TimeProvider,o.Config,o.NavParams,o.ViewController])],t)}();i.TimelogsPage=p},{"../../components/action-button/action-button":3,"../../directives/helpers":19,"../../pipes/pipes":69,"../../providers/time-provider":76,"../timelog/timelog":56,"ionic-angular":"ionic-angular"}],58:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),a=t("../../directives/helpers"),r=t("../../providers/todo-provider"),c=function(){function t(t,e,i,n,s){this.nav=t,this.navParams=e,this.todoProvider=i,this.config=n,this.view=s,this.UserDateOffset=-5,this.he=n.current.user}return t.prototype.ngOnInit=function(){this.todo=this.navParams.data||{},this.UserDateOffset=this.config.getCurrent("timezone_offset"),this.displayFormat=a.getPickerDateTimeFormat(!1,!1),this.todo.due_date=this.todo.due_date?this.AddHours(this.todo.due_date,this.UserDateOffset):""},t.prototype.AddHours=function(t,e){if(t){19==t.length&&(t=t.slice(0,-3));var i=new Date(t);return new Date(i.setTime(i.getTime()+60*e*60*1e3+-1*i.getTimezoneOffset()*60*1e3)).toJSON()}return t},t.prototype.onSubmit=function(t){var e=this,i=this.todo.estimated_remain||"";if(t.valid){if(i)if(~i.indexOf(".")){var n=i.split(".");i=Number(n[0])+Number(n[1])/60}else if(~i.indexOf(":")){var n=i.split(":");i=Number(n[0])+Number(n[1])/60}else Number(i)&&(i=Number(i));else i=0;if(this.todo.in_progress&&Date.now()-this.todo.in_progress<2500)return;this.todo.in_progress=Date.now();var s={task_id:null,title:this.todo.title,text:this.todo.note,assigned_id:this.he.user_id,estimated_remain:i,due_date:this.AddHours(this.todo.due_date,-1*this.UserDateOffset)||"",notify:!1,list_id:this.todo.list_id,ticket_key:null,project_id:0};this.todoProvider.addTodo(s).subscribe(function(t){e.nav.alert("Todo was successfully added :)"),e.todoProvider.getTodos(e.he.user_id,"",{page:0,limit:5e3}),setTimeout(function(){return e.close()},500)},function(t){console.log(t||"Server error")})}},t.prototype.setMinTime=function(t){return(t||this.todo.due_date||this.AddHours(new Date,this.UserDateOffset)).substring(0,4)},t.prototype.getStartDate=function(t){return(t||this.todo.due_date||this.AddHours(new Date,this.UserDateOffset)).substring(0,19)},t.prototype.setStartDate=function(t){t&&(this.todo.due_date=t.substring(0,19))},t.prototype.close=function(){this.view.dismiss()},t=n([o.Page({template:'<ion-toolbar><button (click)="close()" class="bar-button bar-button-default"><span *ngIf="title?.length < 15" primary>Cancel</span><ion-icon *ngIf="title?.length > 15" primary class="invoiceCircle" name="ios-arrow-back"></ion-icon></button><ion-title class="ellipsis padding-right24">Add ToDo</ion-title></ion-toolbar><ion-content class="expense-create"><form #addForm="ngForm"><ion-list class="list max-width700 general-alignment" no-lines><div class="tooltips"><input [(ngModel)]="todo.title" class="width100 blue3 subject-create commentText margin-bottom3" placeholder="Title" ngControl="title" required maxlength="100"></div><br><textarea [(ngModel)]="todo.note" ngControl="note" #note="ngForm" class="width100 textLogin commentText margin" type="text" placeholder="Note" maxlength="4000"></textarea><br><div class="general-alignment2"><ion-item no-lines class="start-end">Due Date</ion-item><ion-item no-lines class="blue3 top0 bottom5"><ion-label class="start-end2">Due Date</ion-label><ion-datetime [ngClass]="{\'nocolor\': !todo.due_date, \'text-color\': todo.due_date}" #due_date [displayFormat]="displayFormat" [min]="setMinTime(todo.due_date)" (ngModelChange)="setStartDate($event)" [ngModel]="getStartDate(todo.due_date)"></ion-datetime></ion-item></div><br><textarea [(ngModel)]="todo.estimated_remain" class="width100 textLogin commentText subject-create" type="text" placeholder="Est. Time hh:mm"></textarea><br><div><button (click)="onSubmit(addForm)" secondary block type="submit" [disabled]="!addForm.valid" class="disable-hover button button-default button-block">Add ToDo</button></div></ion-list></form></ion-content>'
}),s("design:paramtypes",[o.Nav,o.NavParams,r.TodoProvider,o.Config,o.ViewController])],t)}();i.TodoCreatePage=c},{"../../directives/helpers":19,"../../providers/todo-provider":77,"ionic-angular":"ionic-angular"}],59:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),a=t("../todo-create/todo-create"),r=t("../../components/components"),c=function(){function t(t,e,i){this.nav=t,this.config=e,this.navParams=i,this.is_empty=!1}return t.prototype.onPageLoaded=function(){this.params=this.navParams.data||{},this.params.user={id:this.params.user_id||this.config.current.user.user_id,name:this.params.user_name||""}},t.prototype.AddTodo=function(){var t=o.Modal.create(a.TodoCreatePage,{list_id:""});this.nav.present(t)},t=n([o.Page({template:'<ion-navbar *navbar><button menuToggle><ion-icon name="menu"></ion-icon></button><ion-title class="padding-right24">ToDo\'s</ion-title></ion-navbar><ion-content><todo-list></todo-list></ion-content><button (click)="AddTodo()" secondary item-right fab fab-right fab-bottom style="z-index: 2"><ion-icon class="button_circle action-but" name="md-add"></ion-icon></button>',directives:[r.TodoListComponent]}),s("design:paramtypes",[o.Nav,o.Config,o.NavParams])],t)}();i.TodosPage=c},{"../../components/components":5,"../todo-create/todo-create":58,"ionic-angular":"ionic-angular"}],60:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),a=t("../../providers/data-provider"),r=t("../../pipes/pipes"),c=t("../invoice-details/invoice-details"),l=t("../../directives/helpers"),d=function(){function t(t,e,i,n,s){this.nav=t,this.dataProvider=e,this.config=i,this.navParams=n,this.view=s,this.LIMIT=15,this.is_empty=!1,this.invoices=[],t.swipeBackEnabled=!1}return t.prototype.onPageLoaded=function(){var t=this;if(this.params=this.navParams.data||{},this.pager={page:0,limit:this.LIMIT},this.params.account={id:this.params.account_id||0,name:this.params.account_name||this.config.getCurrent("user").account_name},this.params.is_empty&&(this.params.count=0),0!==this.params.count){var e=setTimeout(function(){t.busy=!0},500);this.getItems(null,e)}else this.is_empty=!0},t.prototype.onPageWillEnter=function(){this.params.account_name&&this.view.setBackButtonText("")},t.prototype.getItems=function(t,e){var i=this;this.dataProvider.getInvoices(this.params.account.id,!1,this.pager).subscribe(function(n){e?(i.is_empty=!n.length,clearTimeout(e),i.busy=!1,i.invoices=n):(s=i.invoices).push.apply(s,n),t&&(t.enable(n.length==i.LIMIT),t.complete()),i.count=n.length;var s},function(t){e&&(clearTimeout(e),i.busy=!1),console.log(t||"Server error")})},t.prototype.doInfinite=function(t){return this.is_empty||this.count<this.LIMIT?(t.enable(!1),void t.complete()):(this.pager.page+=1,void this.getItems(t,null))},t.prototype.itemTapped=function(t){this.nav.push(c.InvoiceDetailsPage,t)},t.prototype.setDate=function(t,e,i){if(t){var n=this.config.getCurrent("timezone_offset");return t=new Date(t.substring(0,23)+"Z")||new Date,t=new Date(t.setTime(t.getTime()+60*n*60*1e3)).toJSON(),l.getDateTime(t,e,i)}return null},t.prototype.getCurrency=function(t){return l.getCurrency(t)},t=n([o.Page({template:'<ion-navbar *navbar><button menuToggle><ion-icon name="menu"></ion-icon></button><ion-title class="padding-right24">Create Invoices {{params.account_name ? "on&nbsp;" + params.account.name : ""}}</ion-title></ion-navbar><ion-content padding><img *ngIf="busy" class="imglogo img-padding" src="img/loading2.gif"><div *ngIf="is_empty" class="table grey2 menu-text">No Invoices yet</div><div><ion-list class="general-alignment2"><a detail-none href="#" ion-item class="margin" (click)="itemTapped(invoice)" *ngFor="let invoice of invoices"><p class="tkts-table left invoices color padding-top6" style="width: 37%">{{setDate(invoice.end_date || invoice.date, true)}}&nbsp;</p><h3 class="color" style="font-size: 1.6rem; text-align: left">{{invoice.account_name || invoice.customer}}</h3><h3 *ngIf="invoice.contract_name" class="color" style="text-align: left;">Contract: {{invoice.contract_name}}</h3><p item-right class="text text-right color" style="width: 20%">{{getCurrency(invoice.total_cost)}}</p></a></ion-list><ion-infinite-scroll (infinite)="doInfinite($event)" threshold="30%"><ion-infinite-scroll-content loadingSpinner="circles" loadingText="Loading more data..."></ion-infinite-scroll-content></ion-infinite-scroll></div></ion-content>',pipes:[r.MorePipe]}),s("design:paramtypes",[o.Nav,a.DataProvider,o.Config,o.NavParams,o.ViewController])],t)}();i.UnInvoicesPage=d},{"../../directives/helpers":19,"../../pipes/pipes":69,"../../providers/data-provider":72,"../invoice-details/invoice-details":28,"ionic-angular":"ionic-angular"}],61:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("@angular/core"),a=function(){function t(){}return t.prototype.transform=function(t,e){return t?t.charAt(0).toUpperCase()+t.slice(1):t},t=n([o.Pipe({name:"Capitalize"}),s("design:paramtypes",[])],t)}();i.CapitalizePipe=a},{"@angular/core":"@angular/core"}],62:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("@angular/core"),a=function(){function t(){}return t.prototype.transform=function(t){t=t||0,isNaN(t)&&(t=Math.round(((new Date).getTime()-+new Date(t+"Z"))/6e4));var e=t/60,i="";return i=!t||2>t?"0 days ago":parseInt((e/24).toString())+" days ago"},t=n([o.Pipe({name:"Daysago"}),s("design:paramtypes",[])],t)}();i.DaysagoPipe=a},{"@angular/core":"@angular/core"}],63:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("@angular/core"),a=function(){function t(){}return t.prototype.transform=function(t){t=t||0,isNaN(t)&&(t=Math.round(((new Date).getTime()-+new Date(t+"Z"))/6e4));var e=t/60,i="";return i=!t||2>t?"a minute ago":60>t?"a "+t+" minutes ago":120>t?"one hour ago":e>24?parseInt((e/24).toString())+" days ago":parseInt(e.toString())+" hours ago"},t=n([o.Pipe({name:"Daysold"}),s("design:paramtypes",[])],t)}();i.DaysoldPipe=a},{"@angular/core":"@angular/core"}],64:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("@angular/core"),a=t("../directives/helpers"),r=function(){function t(){}return t.prototype.transform=function(t,e){"true"===localStorage.getItem("isPhonegap");t=t||"";var i=e||[];return t&&i&&0!=i.length&&(~t.indexOf("cid:")||~t.indexOf("ollowing file"))?(i.sort(function(t,e){return e.name.length-t.name.length}),t=a.FileUrlHelper.addUrls(t,i)):t},t=n([o.Pipe({name:"Files"}),s("design:paramtypes",[])],t)}();i.FilesPipe=r},{"../directives/helpers":19,"@angular/core":"@angular/core"}],65:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("@angular/core"),a=t("md5-hex"),r=function(){function t(){}return t.prototype.transform=function(t,e){var i="";return t?(i=a(t),"https://secure.gravatar.com/avatar/"+i+"?s=80&d=mm"):"img/def_ava.png"},t=n([o.Pipe({name:"Gravatar"}),s("design:paramtypes",[])],t)}();i.GravatarPipe=r},{"@angular/core":"@angular/core","md5-hex":"md5-hex"}],66:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("@angular/core"),a=function(){function t(){}return t.prototype.transform=function(t,e){if(t=(t||"").trim(),t.length){var i=document.createElement("div"),n=/&(?:#x[a-f0-9]+|#[0-9]+|[a-z0-9]+);?/gi;t=t.replace(n,function(t){return i.innerHTML=t,i.textContent}),i.textContent=""}return t},t=n([o.Pipe({name:"Htmlsafe"}),s("design:paramtypes",[])],t)}();i.HtmlsafePipe=a},{"@angular/core":"@angular/core"}],67:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("@angular/core"),a=t("../directives/helpers"),r=function(){function t(){}return t.prototype.transform=function(t,e){return t=t.replace(/^<p>(<br>)?(\r)?/,"").replace(/^<p>(<br>)?(\n)?/,""),a.linebreaks(t,e)},t=n([o.Pipe({name:"Linebreaks"}),s("design:paramtypes",[])],t)}();i.LinebreaksPipe=r},{"../directives/helpers":19,"@angular/core":"@angular/core"}],68:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("@angular/core"),a=function(){function t(){}return t.prototype.transform=function(t,e){e=e||[100,"VV"],t=t||0;var i=e[0],n=e[1]||"VV";if(999==i&&t>i)t="99<sup>+</sup>";else if(t>=i)t=i-1+"<sup>+</sup>";else{var s=t.toString();(~n.indexOf("$")||~s.indexOf("."))&&(t=t.toFixed(t>99&&~s.indexOf(".00")?0:2))}return~n.indexOf("$")&&(n=n.replace("$",localStorage.getItem("currency"))),t=n.replace("VV",t)},t=n([o.Pipe({name:"More"}),s("design:paramtypes",[])],t)}();i.MorePipe=a},{"@angular/core":"@angular/core"}],69:[function(t,e,i){"use strict";function n(t){for(var e in t)i.hasOwnProperty(e)||(i[e]=t[e])}n(t("./more")),n(t("./capitalize")),n(t("./linebreaks")),n(t("./htmlsafe")),n(t("./gravatar")),n(t("./daysold")),n(t("./daysago")),n(t("./files"))},{"./capitalize":61,"./daysago":62,"./daysold":63,"./files":64,"./gravatar":65,"./htmlsafe":66,"./linebreaks":67,"./more":68}],70:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("@angular/core"),a=t("ionic-angular"),r=t("@angular/http"),c=t("rxjs"),l=t("./config"),d=t("../directives/helpers"),u=t("./mocks");t("rxjs");var p=function(){function t(t,e,i){this.http=t,this.config=e,this.events=i}return t.prototype.request=function(t,e,i,n){var s=this;if(l.dontClearCache)return this.mock_get(t);var o=new r.Request({method:i||"GET",url:l.ApiSite+t,headers:n,body:JSON.stringify(e)});return this.http.request(o).map(function(t){return t.json()})["catch"](function(t){return s.handleError(t)})},t.prototype.mock_get=function(t){var e=null,i=t.indexOf("?");return-1!=i&&(t=t.substring(0,i)),e=u.MOCKS[t],c.Observable.create(function(t){t.next(e),t.complete()})},t.prototype.get=function(t,e,i){var n=this.config.getCurrent("key"),s=this.config.getCurrent("org"),o=this.config.getCurrent("instance");if(!n||!s||!o||32!=n.length)return this.handleError("403: Invalid organization!");var a=new r.Headers({Accept:"application/json","Content-Type":"application/json",Authorization:"Basic "+btoa(s+"-"+o+":"+n)});return this.request(t,e,i,a)},t.prototype.processData=function(t){return t},t.prototype.getPager=function(t,e){return e&&(e.limit&&(t=d.addp(t,"limit",e.limit)),e.page&&(t=d.addp(t,"page",e.page))),t},t.prototype.getPaged=function(t,e){return t=this.getPager(t,e),this.get(t)},t.prototype.handleError=function(t){var e="";try{var i=JSON.parse(t._body);e="string"==typeof i?i:((i||{}).ResponseStatus||{}).Message}catch(i){e=t._body,"[object ProgressEvent]"==e&&(e="Cannot connect to API server")}e=e||"Error. Please contact Administrator";var n=t.url||"",s=(t.status||{}).toString();return e+=" ("+s+") ",("403"==s&&!~n.indexOf("organizations")||~n.indexOf("config")||~e.indexOf("User with token"))&&this.events.publish("login:failed"),this.events.publish("connection:error",(e||"Error occured")+" Please contact Administator!"),c.Observable["throw"](new Error(e))},t=n([o.Injectable(),s("design:paramtypes",[r.Http,a.Config,a.Events])],t)}();i.ApiData=p},{"../directives/helpers":19,"./config":71,"./mocks":73,"@angular/core":"@angular/core","@angular/http":"@angular/http","ionic-angular":"ionic-angular",rxjs:"rxjs"}],71:[function(t,e,i){"use strict";i.isPhonegap=!1,i.dontClearCache=!1,i.isSD=!0,i.Site=i.isSD?"sherpadesk.com/":"bigwebapps.com/",i.MobileSite="https://m."+i.Site,i.AppSite="https://app."+i.Site,i.ApiSite="https://api."+i.Site,i.year="2019",i.appVersion="75",i.AppTitle=i.isSD?"SherpaDesk ":"HelpDesk "},{}],72:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("@angular/core"),a=t("@angular/http"),r=t("./api-data"),c=t("../directives/helpers");t("rxjs");var l=function(){function t(t){this.apiData=t,this.data$={},this._dataObserver={},this._dataStore={}}return t.prototype.checkLogin=function(t,e){if(!t||!e)return this.apiData.handleError("Please enter login and password!");var i="login",n=new a.Headers({"Content-Type":"text/plain;charset=UTF-8",Accept:"application/json, text/javascript, */*",Authorization:"Basic "+btoa(t+":"+e)});return this.apiData.request(i,"","POST",n)},t.prototype.getOrganizations=function(t){if(!t||32!=t.length)return this.apiData.handleError("Invalid token!");var e="organizations",i=new a.Headers({Accept:"application/json","Content-Type":"application/json",Authorization:"Basic "+btoa("x:"+t)});return this.apiData.request(e," ","",i)},t.prototype.registerOrganization=function(t){var e="organizations",i=new a.Headers({Accept:"application/json","Content-Type":"application/json"});return this.apiData.request(e,t,"POST",i)},t.prototype.deleteFile=function(t){var e="files/"+t.file_id;return this.apiData.get(e,t,"DELETE")},t.prototype.getConfig=function(){var t="config";return this.apiData.get(t)},t.prototype.updateBadge=function(){window.cordova&&((cordova.plugins||{}).notification||{}).badge&&(localStorage.badge>0?cordova.plugins.notification.badge.set(localStorage.badge):cordova.plugins.notification.badge.clear())},t.prototype.getQueueList=function(t){var e=this,i=c.addp("queues","sort_by","tickets_count");return this.apiData.get(i).map(function(i){var n=i.filter(function(t){return 0==t.fullname.toLowerCase().indexOf("new ticket")}),s=0;return n&&n.length>0&&(s=n[0].tickets_count),localStorage.badge=s,e.updateBadge(),i&&t&&(i=i.filter(function(t){return t.tickets_count>0}).slice(0,t)),i})},t.prototype.getInvoices=function(t,e,i){var n=c.addp("invoices","account",t);return e===!1&&(n=c.addp(n,"status","unbilled")),this.apiData.getPaged(n,i)},t.prototype.getInvoice=function(t,e,i,n,s,o){var a="invoices",r={};return t?(a+="/"+t,a=c.addp(a,"action","sendEmail")):(a=c.addp(a,"status","unbilled"),a=c.addp(a,"account",e),a=c.addp(a,"contract_id",i),a=c.addp(a,"start_date",n),a=c.addp(a,"end_date",s),a=c.addp(a,"is_detailed",o)),this.apiData.get(a,r)},t.prototype.getExpenses=function(t,e){var i=c.addp("expenses","account",t);return this.apiData.getPaged(i,e)},t.prototype.getContracts=function(t,e){var i="contracts";return e&&(i="contracts/"+e),this.apiData.getPaged(i,t)},t.prototype.getPrepaid_packs=function(t,e){var i=c.addp("prepaid_packs","account_id",t);return this.apiData.getPaged(i,e)},t.prototype.getPriorities=function(){return this.apiData.get("priorities")},t.prototype.getLocationList=function(t,e){var i="locations";return e&&(i=c.addp(i,"is_open_tickets","true")),this.apiData.getPaged(i,t)},t.prototype.getAccountList=function(t,e,i,n){var s="accounts";return i&&(s=c.addp(s,"is_with_statistics","false")),n&&(s=c.addp(s,"is_open_tickets","true")),this.apiData.getPaged(s,e).map(function(e){return t&&e&&(e=e.filter(function(t){return t.account_statistics.ticket_counts.open>0})),e})},t.prototype.getTechniciansList=function(t,e,i){var n="technicians";return e&&(n=c.addp(n,"is_with_statistics","true")),i&&(n=c.addp(n,"is_open_tickets","true")),this.apiData.getPaged(n,t)},t.prototype.getAccountDetails=function(t,e){var i="accounts/"+t;return e&&(i=c.addp(i,"is_with_statistics","false")),this.apiData.get(i)},t.prototype.getLocationDetails=function(t,e){var i="locations/"+t;return e&&(i=c.addp(i,"is_with_statistics","false")),this.apiData.get(i)},t.prototype.addAccountNote=function(t,e){var i="accounts/"+t,n={note:e};return this.apiData.get(i,n,"PUT")},t.prototype.addUser=function(t,e,i,n){var s="users",o={Lastname:i,Firstname:e,email:t,role:n};return this.apiData.get(s,o,"POST")},t.prototype.loginSkype=function(t){var e="skype/login";return this.apiData.get(e,t,"POST")},t=n([o.Injectable(),s("design:paramtypes",[r.ApiData])],t)}();i.DataProvider=l},{"../directives/helpers":19,"./api-data":70,"@angular/core":"@angular/core","@angular/http":"@angular/http",rxjs:"rxjs"}],73:[function(t,e,i){"use strict";i.MOCKS={"tickets/counts":{new_messages:1,open_all:284,open_as_tech:10,open_as_alttech:2,open_as_user:1001,onhold:3,reminder:0,parts_on_order:0,unconfirmed:45,waiting:2},todos:[{list_id:"d71f45cd260b4ae48761fa20e92af85d",id:null,name:"test2",text:"",title:"",order_list:1,order_item:-1,assigned_id:null,assigned_name:"",type:1,ticket_id:0,project_id:0,account_id:0,due_date:null,updated_at:null,is_completed:!1,estimated_remain:null,ticket_number:null,time_hours:null,time_is_billable:!0,time_task_type_id:null,time_task_type_name:"",time_payment_id:null,time_invoice_id:null,time_start_time:null,time_stop_time:null,sub:[{list_id:"d71f45cd260b4ae48761fa20e92af85d",id:"0b3d804f15cb4687afc3305aa0156f94",name:"test2",text:"test2-1-1",title:"test2-1",order_list:1,order_item:1,assigned_id:1325,assigned_name:"Tech/Admin Eugene",type:2,ticket_id:0,project_id:0,account_id:0,due_date:"2016-12-13T00:00:00.0000000",updated_at:"2016-12-08T15:53:27.3700000",is_completed:!1,estimated_remain:10,ticket_number:null,time_hours:null,time_is_billable:!0,time_task_type_id:null,time_task_type_name:"",time_payment_id:null,time_invoice_id:null,time_start_time:null,time_stop_time:null,sub:null},{list_id:"d71f45cd260b4ae48761fa20e92af85d",id:"6fbcdb59d8c740c89e5fdea55f98d757",name:"test2",text:"test2-2-2",title:"test2-2",order_list:1,order_item:2,assigned_id:1325,assigned_name:"Tech/Admin Eugene",type:2,ticket_id:0,project_id:0,account_id:0,due_date:"2016-12-07T00:00:00.0000000",updated_at:"2016-12-08T15:53:41.2130000",is_completed:!1,estimated_remain:11,ticket_number:null,time_hours:null,time_is_billable:!0,time_task_type_id:null,time_task_type_name:"",time_payment_id:null,time_invoice_id:null,time_start_time:null,time_stop_time:null,sub:null}]},{list_id:"2e6e6a93dc254993abc4b072059d1468",id:null,name:"My ToDo's",text:"",title:"",order_list:5,order_item:-1,assigned_id:null,assigned_name:"",type:1,ticket_id:0,project_id:0,account_id:0,due_date:null,updated_at:null,is_completed:!1,estimated_remain:null,ticket_number:null,time_hours:null,time_is_billable:!0,time_task_type_id:null,time_task_type_name:"",time_payment_id:null,time_invoice_id:null,time_start_time:null,time_stop_time:null,sub:[{list_id:"2e6e6a93dc254993abc4b072059d1468",id:"1863275673334b468fbd6f1eb2356ea3",name:"My ToDo's",text:"",title:"my-1",order_list:5,order_item:1,assigned_id:1325,assigned_name:"Tech/Admin Eugene",type:2,ticket_id:0,project_id:0,account_id:0,due_date:null,updated_at:"2016-12-08T15:53:59.2470000",is_completed:!1,estimated_remain:null,ticket_number:null,time_hours:null,time_is_billable:!0,time_task_type_id:null,time_task_type_name:"",time_payment_id:null,time_invoice_id:null,time_start_time:null,time_stop_time:null,sub:null}]}],login:{api_token:"re36rym3mjqxm8ej2cscfajmxpsew33m"},organizations:[{key:"u0diuk",name:"bigWebApps",is_expired:!1,is_trial:!1,instances:[{key:"b95s6o",name:"Support",is_expired:!1,is_trial:!1}]}],config:{stat:{},key:"2mzer2k5k0srgncebsizvfmip0isp2ii",org:"u0diuk",instance:"b95s6o",is_onhold_status:!1,is_time_tracking:!0,is_freshbooks:!1,freshbooks_url:"https://micajah3.freshbooks.com",is_parts_tracking:!1,is_project_tracking:!0,is_unassigned_queue:!0,is_location_tracking:!0,is_waiting_on_response:!0,is_invoice:!0,is_payments:!0,is_expenses:!0,is_class_tracking:!0,is_travel_costs:!0,is_priorities_general:!0,is_confirmation_tracking:!0,is_resolution_tracking:!0,is_ticket_levels:!0,is_account_manager:!0,is_require_ticket_initial_post:!0,is_ticket_require_closure_note:!0,is_asset_tracking:!0,assets:{unique1_caption:"",unique2_caption:"",unique3_caption:"",unique4_caption:"",unique5_caption:"",unique6_caption:"",unique7_caption:""},time_hour_increment:-1,time_minimum_time:-1,timezone_offset:-5,timezone_name:"Eastern Standard Time",currency:"$",businessday_length:540,logo:"/mafsf.axd?d=aW5zdGFuY2UtbG9nby9jOTMzMWE1OWNiNzY0YjQyYmM2M2JhZDRhNTAwZTE4My9zaGVycGFkZXNrXzMxMHg5NS5wbmd8MzAwfDQ1fDB8YzkzMzFhNTljYjc2NGI0MmJjNjNiYWQ0YTUwMGUxODNw0",user:{account_name:"bigWebApps Support",login_id:"51b348ac5ef34ecea7d043f0d2688634",user_id:1325,email:"jtrue@mail.ru",firstname:"Tech/Admin",lastname:"Eugene",is_techoradmin:!0,is_admin:!0,is_limit_assigned_tkts:!1,is_useworkdaystimer:!1,account_id:0,time_format:1,date_format:0}}}},{}],74:[function(t,e,i){"use strict";function n(t){for(var e in t)i.hasOwnProperty(e)||(i[e]=t[e])}n(t("./api-data")),n(t("./data-provider")),n(t("./ticket-provider")),n(t("./time-provider")),n(t("./todo-provider"))},{"./api-data":70,"./data-provider":72,"./ticket-provider":75,"./time-provider":76,"./todo-provider":77}],75:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("@angular/core"),a=t("ionic-angular"),r=t("./config"),c=t("rxjs"),l=t("./api-data"),d=t("./mocks"),u=t("../directives/helpers");t("rxjs");var p=function(){function t(t,e,i){this.apiData=t,this.config=e,this.events=i,this.URL="tickets",this.tickets$={},this._ticketsObserver={},this._dataStore={all:[],alt:[],tech:[],user:[]}}return t.prototype.getTicketsList=function(t,e,i,n){var s=this;e=e||"",i=i||"";var o="";switch(t.toString()){case"tech":o=this.URL+"?status=open,onhold&role=tech";break;case"all":o=this.URL+"?status=allopen&query=all";break;case"alt":o=this.URL+"?status=open,onhold&role=alt_tech";break;case"open":o=this.URL+"?status=open,onhold&account="+e+"&location="+i;break;case"closed":o=this.URL+"?status=closed&account="+e+"&location="+i;break;case"closed-tech":o=this.URL+"?status=closed&tech="+e+"&role=tech";break;case"queue":o="queues/"+e;break;default:o=this.URL+"?status=open,onhold&role=user"}n.limit=n.limit||25,n.page=n.page||0,t+=e||"",t+=i||"",this._dataStore[t]=this._dataStore[t]||[],r.dontClearCache&&(this.tickets$[t]=new c.Observable(function(e){return s._ticketsObserver[t]=e}).share(),this._dataStore[t]=d.MOCKS.tickets);var a=this._dataStore[t].length;return 0==n.page&&(a?setTimeout(function(){s._ticketsObserver[t]&&s._ticketsObserver[t].next(s._dataStore[t]||[])},0):this.tickets$[t]=new c.Observable(function(e){return s._ticketsObserver[t]=e}).share()),this.apiData.getPaged(o,n).subscribe(function(e){n.page>0&&a>0?(i=s._dataStore[t]).push.apply(i,e):s._dataStore[t]=e,s._ticketsObserver[t]&&s._ticketsObserver[t].next(s._dataStore[t]);var i},function(t){return s.apiData.handleError("Could not load tickets.")}),a},t.prototype.getTicketDetails=function(t){var e=this.URL+"/"+t;return this.apiData.get(e)},t.prototype.getUserProfile=function(t){var e="profile/"+t;return this.apiData.get(e)},t.prototype.getTicketsCounts=function(){var t=this,e=this.URL+"/counts";this._dataStore[e]?this._dataStore[e].open_all>=0&&setTimeout(function(){t._ticketsObserver[e].next(t._dataStore[e]||[])},0):(this._dataStore[e]=[],this.tickets$[e]=new c.Observable(function(i){t._ticketsObserver[e]=i}).share()),this.apiData.get(e).subscribe(function(i){t._dataStore[e]=i,t._ticketsObserver[e].next(t._dataStore[e])},function(t){return console.log("Could not load tickets.")})},t.prototype.addTicket=function(t){return t.status="open",this.apiData.get(this.URL,t,"POST")},t.prototype.closeOpenTicket=function(t,e){var i=this.URL+"/"+t;return this.apiData.get(i,e,"PUT")},t.prototype.escalateTicket=function(t,e){var i=this.URL+"/"+t,n={action:e?"escalate":"deescalate"};return this.apiData.get(i,n,"PUT")},t.prototype.addTicketPost=function(t,e,i,n){var s=this.URL+"/"+t,o={action:"response",note_text:e,files:i||[],is_waiting_on_response:n};return this.apiData.get(s,o,"POST")},t.prototype.addTicketWorkpad=function(t,e){var i=this.URL+"/"+t,n={action:"workpad",workpad:e};return this.apiData.get(i,n,"POST")},t.prototype.addTicketSubject=function(t,e,i){var n=this.URL+"/"+t,s={action:"subject",subject:e,next_step:i};return this.apiData.get(n,s,"POST")},t.prototype.transferUserTech=function(t,e){var i=this.URL+"/"+t;return this.apiData.get(i,e,"POST")},t.prototype.getCustomfields=function(t,e){var i=u.addp("customfields","class_id",t);return this.apiData.getPaged(i,e)},t.prototype.addTicketNote=function(t,e){var i=this.URL+"/"+t,n={action:"note",note:e};return this.apiData.get(i,n,"POST")},t=n([o.Injectable(),s("design:paramtypes",[l.ApiData,a.Config,a.Events])],t)}();i.TicketProvider=p},{"../directives/helpers":19,"./api-data":70,"./config":71,"./mocks":73,"@angular/core":"@angular/core","ionic-angular":"ionic-angular",rxjs:"rxjs"}],76:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("@angular/core"),a=t("ionic-angular"),r=t("./config"),c=t("rxjs"),l=t("./api-data"),d=t("../directives/helpers");t("rxjs");var u=t("./mocks"),p=function(){function t(t,e,i){this.apiData=t,this.config=e,this.events=i,this.URL="time",this.times$={},this._timesObserver={},this._dataStore={}}return t.prototype.getTimelogs=function(t,e){var i=this,n=d.addp(this.URL,"account",t);e.limit=e.limit||25,e.page=e.page||0,this._dataStore[n]=this._dataStore[n]||[],r.dontClearCache&&(this.times$[n]=new c.Observable(function(t){return i._timesObserver[n]=t}).share(),this._dataStore[n]=u.MOCKS.time);var s=this._dataStore[n].length;return 0==e.page&&(e.limit=s||e.limit,s?setTimeout(function(){i._timesObserver[n]&&i._timesObserver[n].next(i._dataStore[n]||[])},0):this.times$[n]=new c.Observable(function(t){return i._timesObserver[n]=t}).share()),this.apiData.getPaged(n,e).subscribe(function(t){e.page>0&&s>0?(o=i._dataStore[n]).push.apply(o,t):i._dataStore[n]=t,i._timesObserver[n]&&i._timesObserver[n].next(i._dataStore[n]);var o},function(t){return console.log("Could not load timelogs.")}),s},t.prototype.addTime=function(t,e,i){var n=this.URL+(t?"/"+t:"");return this.apiData.get(n,e,i)},t=n([o.Injectable(),s("design:paramtypes",[l.ApiData,a.Config,a.Events])],t)}();i.TimeProvider=p},{"../directives/helpers":19,"./api-data":70,"./config":71,"./mocks":73,"@angular/core":"@angular/core","ionic-angular":"ionic-angular",rxjs:"rxjs"}],77:[function(t,e,i){"use strict";var n=this&&this.__decorate||function(t,e,i,n){var s,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(3>o?s(a):o>3?s(e,i,a):s(e,i))||a);
return o>3&&a&&Object.defineProperty(e,i,a),a},s=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("@angular/core"),a=t("ionic-angular"),r=t("./config"),c=t("rxjs"),l=t("./api-data"),d=t("../directives/helpers");t("rxjs");var u=t("./mocks"),p=function(){function t(t,e,i){this.apiData=t,this.config=e,this.events=i,this.URL="todos",this.todos$={},this._todosObserver={},this._dataStore={}}return t.prototype.getTodos=function(t,e,i){var n=this,s=this.URL;t&&(s=d.addp(this.URL,"assigned_id",t)),e&&(s=d.addp(s,"ticket",e||"")),i.limit=i.limit||25,i.page=i.page||0,this._dataStore[s]=this._dataStore[s]||[],r.dontClearCache&&(this.todos$[s]=new c.Observable(function(t){return n._todosObserver[s]=t}).share(),this._dataStore[s]=u.MOCKS.todo);var o=this._dataStore[s].length;0==i.page&&(o?setTimeout(function(){n._todosObserver[s]&&n._todosObserver[s].next(n._dataStore[s]||[])},0):this.todos$[s]=new c.Observable(function(t){return n._todosObserver[s]=t}).share());var a=t||e?s:s+"?1=1";return this.apiData.getPaged(a+"&all_item_types=true&is_completed=false&is_sub_view=true",i).subscribe(function(t){i.page>0&&o>0?(e=n._dataStore[s]).push.apply(e,t):n._dataStore[s]=t,n._todosObserver[s]&&n._todosObserver[s].next(n._dataStore[s]);var e},function(t){return console.log("Could not load todologs.")}),o},t.prototype.addTodo=function(t){return this.apiData.get(this.URL,t,"POST")},t.prototype.setCompletedTodo=function(t,e){var i=this.URL+"/"+t,n=this.apiData.get(i,{is_completed:e},"PUT").publishLast();return n.connect(),n},t=n([o.Injectable(),s("design:paramtypes",[l.ApiData,a.Config,a.Events])],t)}();i.TodoProvider=p},{"../directives/helpers":19,"./api-data":70,"./config":71,"./mocks":73,"@angular/core":"@angular/core","ionic-angular":"ionic-angular",rxjs:"rxjs"}],78:[function(t,e,i){},{}]},{},[1,78]);