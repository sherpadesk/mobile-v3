var test1={1:[function(t,e,n){"use strict";var i=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(3>o?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},r=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("@angular/core"),s=t("ionic-angular"),a=t("ionic-native"),c=t("./providers/providers"),u=t("./providers/config"),l=t("./providers/mocks"),p=t("./directives/helpers"),h=t("./pages/pages"),d=t("./pages/modals/modals");(function(){function t(t,e,n,i,r,o,s){var a=this;if(this.app=t,this.platform=e,this.config=n,this.events=i,this.menu=r,this.ticketProvider=o,this.dataProvider=s,this.is_offline=!1,this.is_phonegap=!1,this.img=new Image,!this.isStorage())return void console.log("Please enable coockies!");this.is_phonegap="true"===localStorage.getItem("isPhonegap"),this.initializeApp(),this.ExtendConfig(),setTimeout(function(){return a.ExtendNavAlert()},0),(document.getElementsByTagName("ion-loading")[0]||{}).outerHTML="";var c=document.getElementsByTagName("ion-app1");c&&c[0]&&(c[0].classList.add("loaded"),setTimeout(function(){document.getElementsByTagName("ion-app1")[0].outerHTML=""},1500)),setTimeout(function(){window.dash&&localStorage.setItem("dash_cache",window.dash||"")},15e3);var d=(localStorage.getItem("ios_action")||"",p.getParameterByName("t")),f=p.getParameterByName("e"),v=p.getParameterByName("ionicPlatform");if(d)return n.clearCurrent(d),localStorage.setItem("isGoogle","true"),localStorage.setItem("username",(f||"").replace("#","")),n.saveCurrent(),this.rootPage=h.OrganizationsPage,void p.cleanQuerystring("ionicPlatform",v);var m=p.getParameterByName("f");if(m&&setTimeout(function(){return a.nav.alert(m,!0)},3e3),localStorage.setItem("isGoogle",""),p.cleanQuerystring("ionicPlatform",v),u.dontClearCache)n.setCurrent(l.MOCKS.config);else if(!n.getCurrent("is_logged"))return void(this.rootPage=h.LoginPage);return n.getCurrent("is_chosen")?void setTimeout(function(){return a.redirect(!0)},u.dontClearCache?1e3:0):void(this.rootPage=h.OrganizationsPage)}return t.prototype.redirect=function(t){var e=this;this.dataProvider.getConfig().subscribe(function(n){e.onLine(!0),clearInterval(e.interval),e.interval=setInterval(function(){return e.redirect()},3e5),e.redirect_logic(t,n)},function(n){clearInterval(e.interval),e.nav.alert(n||"Server error",!0),e.is_offline&&e.config.getCurrent("user").firstname?e.redirect_logic(t,e.config.getCurrent()):e.config.setCurrent({org:""})})},t.prototype.ok=function(t){},t.prototype.fail=function(t){alert(t)},t.prototype.initOrgPreferences=function(t){if(window.cordova){var e=(window.plugins||{}).appPreferences;if(e){var n=e.iosSuite("group.io.sherpadesk.mobile");n.store(this.ok,this.fail,"org",t)}}},t.prototype.redirect_logic=function(t,e){if(this.config.setCurrent(e),this.config.current.user.is_techoradmin?this.pages=[{title:"Dashboard",component:h.DashboardPage,icon:"speedometer",is_active:!0},{title:e.names.ticket.p,component:h.TicketsPage,icon:"create",is_active:!0},{title:"Timelogs",component:h.TimelogsPage,icon:"md-time",is_active:this.config.current.is_time_tracking},{title:e.names.account.p,component:h.AccountsPage,icon:"people",is_active:this.config.current.is_account_manager},{title:"Invoices",component:h.InvoicesPage,icon:"card",is_active:this.config.current.is_time_tracking&&this.config.current.is_invoice},{title:"Queues",component:h.QueuesPage,icon:"md-list-box",is_active:this.config.current.is_unassigned_queue&&(!this.config.current.user.is_limit_assigned_tkts||this.config.current.user.is_admin)},{title:"ToDos",component:h.TodosPage,icon:"list-box",is_active:this.config.current.is_todos},{title:"Switch Org",component:h.OrganizationsPage,icon:"md-swap",is_active:this.config.current.is_multiple_org},{title:"Signout",component:h.LoginPage,icon:"md-log-in",is_active:!0},{title:"Full App",component:null,icon:"md-share-alt",is_active:!1}]:this.pages=[{title:e.names.ticket.p,component:h.TicketsPage,icon:"create",is_active:!0},{title:"Switch Org",component:h.OrganizationsPage,icon:"md-swap",is_active:this.config.current.is_multiple_org},{title:"Signout",component:h.LoginPage,icon:"md-log-in",is_active:!0},{title:"Full App",component:null,icon:"md-share-alt",is_active:!1}],"true"===localStorage.getItem("isPhonegap")&&this.initOrgPreferences(this.config.current.org+"-"+this.config.current.instance+":"+this.config.current.key),t&&"true"===localStorage.getItem("isExtension")){var n="login?t="+this.config.current.key+"&o="+this.config.current.org+"&i="+this.config.current.instance;window.top.postMessage(n,"*")}var i=localStorage.getItem("version");i!==e.mobile_ver&&Number(e.mobile_ver)>Number(i)?this.presentConfirm(e.mobile_ver,t):this.force_redirect(t)},t.prototype.force_redirect=function(t){if(t){var e=null,n=localStorage.getItem("loadTicketNumber")||"";n&&(localStorage.setItem("loadTicketNumber",""),localStorage.setItem("loadOrgKey",""),e={key:n});var i=this.config.current.user.is_techoradmin&&!n?h.DashboardPage:h.TicketsPage;this.nav.setRoot(i,e,{animation:"wp-transition"})}},t.prototype.presentConfirm=function(t,e){var n=this;localStorage.setItem("version",t),this.config.saveCurrent();var i=s.Alert.create({title:"There is a new update available!",message:"Page will reload in 2 seconds",cssClass:"hello",buttons:[{text:"Yes, do it now",role:"cancel",handler:function(){window.location.reload(!0)}},{text:"No, I'll do it later",handler:function(){return i.dismiss().then(function(){n.force_redirect(e)}),!1}}]});"true"===localStorage.getItem("isPhonegap")?this.nav.alert("There is a new update available! Please kill app and start again to update"):this.nav.present(i)},t.prototype.isStorage=function(){var t="modernizr";try{return localStorage.setItem(t,t),localStorage.removeItem(t),!0}catch(e){var n=s.Toast.create({message:"Please enable Cookies to work with site!",enableBackdropDismiss:!1,showCloseButton:!0,cssClass:"toast-error"});return this.nav.present(n),!1}},t.prototype.initializeApp=function(){var t=this;this.platform.ready().then(function(){"true"===localStorage.getItem("isPhonegap")&&(console.log("cordova ready"),a.StatusBar.styleDefault(),t.disconnectSubscription=a.Network.onDisconnect().subscribe(function(){t.onLine(!1)}),t.connectSubscription=a.Network.onConnect().subscribe(function(){t.onLine(!0)})),window.addEventListener("online",function(){return t.onLine(!0)}),window.addEventListener("offline",function(){return t.onLine(!1)}),document.addEventListener("handle",function(e){return t.handle(e)},!1)})},t.prototype.handle=function(t){var e,n=t.detail,i=Object.keys(n)[0],r={},o=!1;switch(i){case"ticket":this.config.getCurrent("is_logged")?(e=h.TicketsPage,r={key:n[i]}):localStorage.setItem("loadTicketNumber",n[i]);break;case"add_time":o=!0,e=h.TimelogPage;break;case"add_tkt":o=!0,e=d.TicketCreatePage;break;case"list":o=!0,e=h.TicketsPage,r={tab:n[i]}}e&&(o?this.nav.push(e,r,{animation:"wp-transition"}):this.nav.setRoot(e,r,{animation:"wp-transition"}))},t.prototype.checkConnection=function(){var t=this;navigator.onLine?"true"!==localStorage.getItem("isPhonegap")&&(this.img.onload=function(){return t.onLine(!0)},this.img.onerror=function(){return t.onLine(!1)},this.img.src=u.MobileSite+"img/select_arrow.png?rand="+Math.random()):this.onLine(!1)},t.prototype.onLine=function(t){var e=this;this.is_offline!=!t&&(this.nav.alert(t?"Hey! You online now! Try again your action":"Sorry! You are offline now. Please check your internet connection!",!t),"true"!==localStorage.getItem("isPhonegap")&&(t?clearInterval(this.offlineTimer):(clearInterval(this.offlineTimer),this.offlineTimer=setInterval(function(){return e.checkConnection()},1e4)))),this.is_offline=!t},t.prototype.openPage=function(t,e){if(this.menu.close(),!t.component){var n=this.config.getCurrent();return void p.fullapplink(u.AppSite,"",n.instance,n.org)}!this.interval||t.component!=h.LoginPage&&t.component!=h.OrganizationsPage||clearInterval(this.interval),t.index?this.nav.setRoot(t.component||t,{tabIndex:t.index}):this.nav.setRoot(t.component||t)},t.prototype.ngOnInit=function(){this.subscribeToEvents()},t.prototype.ngOnDestroy=function(){this.unsubscribeToEvents(),clearInterval(this.offlineTimer),clearInterval(this.interval),"true"===localStorage.getItem("isPhonegap")&&(this.disconnectSubscription.unsubscribe(),this.connectSubscription.unsubscribe())},t.prototype.logout=function(t){this.config.clearCurrent(t),"true"===localStorage.getItem("isPhonegap")&&this.initOrgPreferences("")},t.prototype.subscribeToEvents=function(){var t=this;this.events.subscribe("login:failed",function(){t.logout(),t.openPage({component:h.LoginPage})}),this.events.subscribe("app:logout",function(e){t.logout(e&&e[0])}),this.events.subscribe("connection:error",function(e){t.checkConnection()}),this.events.subscribe("config:get",function(e){t.redirect(e)})},t.prototype.unsubscribeToEvents=function(){this.events.unsubscribe("login:failed",null),this.events.unsubscribe("connection:error",null),this.events.unsubscribe("config:get",null),this.events.unsubscribe("app:logout",null)},t.prototype.ExtendConfig=function(){localStorage.setItem("isExtension",window.self!==window.top?"true":""),localStorage.setItem("version",u.appVersion),this.config.getCurrent=function(t){var e=this.current||JSON.parse(localStorage.getItem("current")||"null")||{};e.is_logged=!!e.key,e.is_chosen=!!e.instance&&!!e.org&&!!e.key,e.is_online=!this.is_offline;var n=localStorage.getItem("version");return e.is_updated=!(n!==e.mobile_ver&&Number(e.mobile_ver)>Number(n)),e.stat||(e.stat={}),e.user||(e.user={}),e.recent||(e.recent={}),e.cache||(e.cache={}),t?e[t]||"":e},this.config.current=this.config.getCurrent(),this.config.saveCurrent=function(){var t=this.getCurrent();localStorage.setItem("current",JSON.stringify(t)),localStorage.setItem("dateformat",t.user.date_format||0),localStorage.setItem("timeformat",t.user.time_format||0),localStorage.setItem("currency",t.currency||"$")},this.config.setCurrent=function(t,e){this.current=Object.assign({},this.current||{},t||{}),e||this.saveCurrent()},this.config.clearCurrent=function(t){localStorage.removeItem("dash_cache"),localStorage.removeItem("current"),this.setCurrent({key:t||"",org:"",instance:"",user:{},stat:{},recent:{},cache:{}})},this.config.getStat=function(t){var e=this.getCurrent("stat")[t];return"undefined"==typeof e?-1:e||{}},this.config.setStat=function(t,e){this.current.stat[t]=e},this.config.getRecent=function(t){var e=this.getCurrent("recent")[t];return e||{}},this.config.setRecent=function(t,e){e?this.current.recent[t]=e:this.current.recent=Object.assign({},this.current.recent||{},t||{})},this.config.getCache=function(t){var e=this.getCurrent("cache")[t];return"undefined"==typeof e?[]:e||{}},this.config.setCache=function(t,e){this.current.cache[t]=e}},t.prototype.ExtendNavAlert=function(){this.nav.alert=function(t,e){var n=s.Toast.create({message:t,duration:e?7e3:3e3,cssClass:e?"toast-error":"toast-ok",showCloseButton:!0,closeButtonText:"X"});this.present(n)}},i([o.ViewChild(s.Nav),r("design:type",s.Nav)],t.prototype,"nav",void 0),t=i([s.App({template:'<ion-menu id="leftMenu" [content]="content"><ion-content class="menu-bg"><ion-list no-lines><div *ngFor="let p of pages" (click)="openPage(p)"><button detail-none *ngIf="p.is_active" ion-item><i><ion-icon name="{{p.icon}}"></ion-icon></i><h3>{{p.title}}</h3></button></div></ion-list></ion-content></ion-menu><div *ngIf="is_offline" class="offline_status {{ is_phonegap ? \'ios7style\' : \'\'}}">OFFLINE</div><ion-nav id="nav" [root]="rootPage" #content swipe-back-enabled="false"></ion-nav>',providers:[c.ApiData,c.DataProvider,c.TicketProvider,c.TimeProvider,c.TodoProvider],prodMode:!0,config:{tabbarPlacement:"top",pageTransitionDelay:0,prodMode:!0,activator:"ripple",ios:{activator:"ripple"}}}),r("design:paramtypes",[s.IonicApp,s.Platform,s.Config,s.Events,s.MenuController,c.TicketProvider,c.DataProvider])],t)})()},{"./directives/helpers":14,"./pages/modals/modals":29,"./pages/pages":34,"./providers/config":54,"./providers/mocks":56,"./providers/providers":57,"@angular/core":193,"ionic-angular":431,"ionic-native":454}],2:[function(t,e,n){"use strict";var i=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(3>o?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},r=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),s=t("@angular/core"),a=t("../../pages/account-details/account-details"),c=t("../../pipes/pipes"),u=function(){function t(t,e){this.nav=t,this.config=e,this.is_empty=!1}return t.prototype.itemTapped=function(t,e){e.account_statistics.ticket_counts.closed=null,this.nav.push(a.AccountDetailsPage,e)},t.prototype.ngOnChanges=function(t){if(this.simple&&"accounts"in t){if(t.accounts.isFirstChange()&&null!==t.accounts.currentValue)return;this.is_empty=!t.accounts.currentValue||0==t.accounts.currentValue.length}},i([s.Input(),r("design:type",Array)],t.prototype,"accounts",void 0),i([s.Input(),r("design:type",Boolean)],t.prototype,"simple",void 0),t=i([s.Component({selector:"accounts-list",template:'<ion-list class="list" no-lines><div *ngIf="!simple && accounts?.length" class="flexed color"><div detail-none><span>&nbsp;&nbsp;&nbsp;</span> <span [hidden]="!config.current.is_time_tracking">Hours</span> <span [hidden]="!config.current.is_expenses">Expenses</span> <span>{{config.current.names.ticket.ap}}</span></div></div><div class="accountlist flexed"><div detail-none href="#" *ngFor="let account of accounts" (click)="itemTapped($event, account)"><span>{{account.name}}</span> <span [hidden]="simple || !config.current.is_time_tracking" [innerHTML]="account.account_statistics.hours | More:[1000]"></span> <span [hidden]="simple || !config.current.is_expenses" [innerHTML]="account.account_statistics.expenses | More:[1000,\'$VV\']"></span> <span [innerHTML]="account.account_statistics.ticket_counts.open | More:[1000]"></span></div></div></ion-list><div *ngIf="is_empty && !simple" class="table grey2 menu-text">No Accounts</div>',directives:[o.IONIC_DIRECTIVES],pipes:[c.MorePipe]}),r("design:paramtypes",[o.Nav,o.Config])],t)}();n.AccountsListComponent=u},{"../../pages/account-details/account-details":15,"../../pipes/pipes":52,"@angular/core":193,"ionic-angular":431}],3:[function(t,e,n){"use strict";var i=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(3>o?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},r=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),s=t("@angular/core"),a=t("../../pages/modals/modals"),c=t("../../pages/timelog/timelog"),u=t("../../pages/ticket-details/ticket-details"),l=t("../../pages/expense-create/expense-create"),p=t("../../pages/todo-create/todo-create"),h=t("../../pages/uninvoices/uninvoices"),d=function(){function t(t,e,n){this.navParams=t,this.nav=e,this.config=n,this.data={}}return t.prototype.ngOnInit=function(){},t.prototype.openModal=function(t){var e=this,n=o.Modal.create(t,this.data);n.onDismiss(function(t){!t||e.data.tech||e.data.account||e.nav.push(u.TicketDetailsPage,t)}),this.nav.present(n)},t.prototype.presentActionSheet=function(){var t=this;if(!this.config.current.user.is_techoradmin)return void this.openModal(a.TicketCreatePage);var e=[{icon:"create",text:"Add "+this.config.current.names.ticket.s,role:"",handler:function(){return t.actionSheet.dismiss().then(function(){return t.openModal(a.TicketCreatePage)}),!1}}];this.config.current.is_time_tracking&&(e.push({icon:"md-time",text:"Add Time",role:"",handler:function(){return t.actionSheet.dismiss().then(function(){return t.openModal(c.TimelogPage)}),!1}}),this.config.current.is_invoice&&e.push({icon:"card",text:"Add Invoice",role:"",handler:function(){return t.actionSheet.dismiss().then(function(){return t.nav.push(h.UnInvoicesPage)}),!1}}),this.config.current.is_todos&&e.push({icon:"ios-list-box-outline",text:"Add ToDo",role:"",handler:function(){return t.actionSheet.dismiss().then(function(){return t.nav.push(p.TodoCreatePage)}),!1}})),this.config.current.is_expenses&&e.push({icon:"md-list-box",text:"Add Expense",role:"",handler:function(){return t.actionSheet.dismiss().then(function(){return t.openModal(l.ExpenseCreatePage)}),!1}}),e.push({icon:"",text:"Cancel",role:"cancel",handler:function(){return console.log("Cancel clicked"),!0}}),this.actionSheet=o.ActionSheet.create({title:"",buttons:e}),this.nav.present(this.actionSheet)},i([s.Input(),r("design:type",Object)],t.prototype,"data",void 0),t=i([s.Component({selector:"action-button",template:'<button (click)="presentActionSheet()" secondary item-right fab fab-right fab-bottom style="z-index: 2"><ion-icon class="button_circle action-but" name="md-add"></ion-icon></button>',directives:[o.IONIC_DIRECTIVES]}),r("design:paramtypes",[o.NavParams,o.Nav,o.Config])],t)}();n.ActionButtonComponent=d},{"../../pages/expense-create/expense-create":19,"../../pages/modals/modals":29,"../../pages/ticket-details/ticket-details":38,"../../pages/timelog/timelog":40,"../../pages/todo-create/todo-create":42,"../../pages/uninvoices/uninvoices":44,"@angular/core":193,"ionic-angular":431}],4:[function(t,e,n){"use strict";var i=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(3>o?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},r=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),s=t("../../providers/api-data"),a=t("@angular/core"),c=t("../../pages/modals/modals");t("rxjs/add/operator/share");var u=function(){function t(t,e,n){this.nav=t,this.apiData=e,this.config=n,this.list={},this.onChanged=new a.EventEmitter(!1),this.init=!0,this.selected={}}return t.prototype.ngOnInit=function(){return this.config.current.is_class_tracking?void(this.list.url&&(this.url=this.list.url,this.preload&&this.loadData(!1))):void(this.list.hidden=!0)},t.prototype.open=function(){this.loadData(!0)},t.prototype.loadData=function(t){var e=this;this.url==this.list.url&&this.list.items&&0!=this.list.items.length?this.proceed_list(t):this.list.url?this.apiData.get(this.list.url).subscribe(function(n){e.list.items=n,e.proceed_list(t),e.url=e.list.url},function(t){e.error("Cannot get "+e.list.name+" list! Error: "+t),console.log(t||"Server error")}):this.error(this.list.name+" list is empty!")},t.prototype.error=function(t){this.nav.alert(t,!0)},t.prototype.proceed_list=function(t){return this.config.getCurrent("is_tech")||(this.list.items=this.list.items.filter(function(t){return!t.is_restrict_to_techs})),this.list.items=this.list.items.filter(function(t){return t.is_active}),this.list.items&&0!=this.list.items.length?void(t&&("Default (no selection)"!=this.list.items[0].name&&this.list.items.splice(0,0,{hierarchy_level:0,id:0,is_active:!0,is_lastchild:!0,name:"Default (no selection)"}),this.openModal())):void(this.list.value="Default (nothing to select)")},t.prototype.emit_changed=function(t){t.name=this.findPath(" ",this.list.items,t.id),t.type="class",this.onChanged.emit(t)},t.prototype.findPath=function(t,e,n){if("undefined"!=typeof e&&e)for(var i=0;i<e.length;i++){if(e[i].id==n)return e[i].name;var t=this.findPath(t,e[i].sub,n);if(null!=t)return e[i].name+" / "+t}return null},t.prototype.openRadio=function(){var t=this,e=this.list.name,n=o.Alert.create({title:"Choose "+e,buttons:[{text:"Cancel",role:"cancel",handler:function(){console.log("Cancel clicked")}},{text:"OK",handler:function(e){e&&(t.selected=e,t.emit_changed(e))}}]});this.list.items.forEach(function(t){n.addInput({type:"radio",label:t.name,value:t})}),this.nav.present(n)},t.prototype.openModal=function(){var t=this,e=o.Modal.create(c.TreeModal,this.list);e.onDismiss(function(e){e.name&&(t.selected=e,t.emit_changed(e))}),this.nav.present(e)},i([a.Input(),r("design:type",Object)],t.prototype,"list",void 0),i([a.Input(),r("design:type",Boolean)],t.prototype,"preload",void 0),i([a.Output(),r("design:type",a.EventEmitter)],t.prototype,"onChanged",void 0),t=i([a.Component({selector:"class-list",template:'<div *ngIf="!list.hidden"><ion-item no-lines class="labels color">Class:&nbsp;</ion-item></div><button *ngIf="!list.hidden" (click)="open()" class="blue4 width100 disable-hover button button-default button-select"><ion-label class="tkts-table">{{list.value}}</ion-label><ion-icon name="arrow-down"></ion-icon></button>',directives:[o.IONIC_DIRECTIVES]}),r("design:paramtypes",[o.Nav,s.ApiData,o.Config])],t)}();n.ClassListComponent=u},{"../../pages/modals/modals":29,"../../providers/api-data":53,"@angular/core":193,"ionic-angular":431,"rxjs/add/operator/share":565}],5:[function(t,e,n){"use strict";function i(t){for(var e in t)n.hasOwnProperty(e)||(n[e]=t[e])}i(t("./queues-list/queues-list")),i(t("./accounts-list/accounts-list")),i(t("./todo-list/todo-list")),i(t("./tickets-list/tickets-list")),i(t("./posts-list/posts-list")),i(t("./select-list/select-list")),i(t("./class-list/class-list")),i(t("./action-button/action-button"))},{"./accounts-list/accounts-list":2,"./action-button/action-button":3,"./class-list/class-list":4,"./posts-list/posts-list":6,"./queues-list/queues-list":7,"./select-list/select-list":8,"./tickets-list/tickets-list":9,"./todo-list/todo-list":10}],6:[function(t,e,n){"use strict";var i=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(3>o?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},r=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),s=t("@angular/core"),a=t("../../pipes/pipes"),c=function(){function t(){this.posts=[],this._posts=[],this.attachments=[]}return t.prototype.filter=function(){var t=[];t=this.is_showlogs?this.posts:this.posts.filter(function(t){return!!~["Initial Post","Response","Closed","ReOpened"].indexOf(t.log_type)}),this._posts=this.is_first?[t[0]]:t.slice(1)},t.prototype.ngOnInit=function(){this.filter()},t.prototype.ngOnChanges=function(t){if("is_showlogs"in t)return void this.filter();if("posts"in t){if("posts"in t&&(t.posts.isFirstChange()||(t.posts.currentValue[0]||{}).id==(t.posts.previousValue[0]||{}).id))return;this.filter()}},i([s.Input(),r("design:type",Array)],t.prototype,"posts",void 0),i([s.Input(),r("design:type",Array)],t.prototype,"attachments",void 0),i([s.Input(),r("design:type",Boolean)],t.prototype,"is_showlogs",void 0),i([s.Input(),r("design:type",Boolean)],t.prototype,"is_first",void 0),t=i([s.Component({selector:"posts-list",template:'<div><ion-card-content class="card-content" *ngFor="let post of _posts"><div></div><ion-avatar><img [alt]="post.user_firstname" [src]="post.user_email | Gravatar"><p>{{post.user_firstname || post.user_email}}</p></ion-avatar><span class="postlist"><p>{{post.record_date | Daysold}}</p><p>{{post.log_type}}</p></span><p class="post-note" [innerHTML]="post.note | Linebreaks | Files : attachments"></p><ion-item no-lines></ion-item></ion-card-content></div>',directives:[o.IONIC_DIRECTIVES],pipes:[a.LinebreaksPipe,a.GravatarPipe,a.DaysoldPipe,a.FilesPipe]}),r("design:paramtypes",[])],t)}();n.PostsListComponent=c},{"../../pipes/pipes":52,"@angular/core":193,"ionic-angular":431}],7:[function(t,e,n){"use strict";var i=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(3>o?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},r=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),s=t("@angular/core"),a=t("../../pages/queue-tickets/queue-tickets"),c=t("../../pipes/pipes"),u=function(){function t(t){this.nav=t,this.is_empty=!1}return t.prototype.ngOnChanges=function(t){if(this.simple&&"queues"in t){if(t.queues.isFirstChange()&&null!==t.queues.currentValue)return;this.is_empty=!t.queues.currentValue||0==t.queues.currentValue.length}},t.prototype.goToQueueTicketsPage=function(t){this.nav.push(a.QueueTicketsPage,t)},i([s.Input(),r("design:type",Object)],t.prototype,"queues",void 0),i([s.Input(),r("design:type",Boolean)],t.prototype,"simple",void 0),t=i([s.Component({selector:"queues-list",template:'<ion-list class="queues-list list" no-lines><a detail-none href="#" *ngFor="let queue of queues" class="queues" (click)="goToQueueTicketsPage(queue)"><span>{{queue.fullname}}</span> <span [innerHTML]="queue.tickets_count | More:[10000]"></span></a></ion-list><div *ngIf="is_empty" class="table grey2 menu-text">No Queues</div>',directives:[o.IONIC_DIRECTIVES],pipes:[c.MorePipe]}),r("design:paramtypes",[o.Nav])],t)}();n.QueuesListComponent=u},{"../../pages/queue-tickets/queue-tickets":35,"../../pipes/pipes":52,"@angular/core":193,"ionic-angular":431}],8:[function(t,e,n){"use strict";var i=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(3>o?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},r=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),s=t("../../providers/api-data"),a=t("../../directives/helpers"),c=t("@angular/core"),u=t("../../pages/modals/modals"),l=function(){function t(t,e,n){this.nav=t,this.apiData=e,this.config=n,this.onChanged=new c.EventEmitter(!1),this.selected={},this.init=!0,this.name="",this.list={}}return t.prototype.ngOnInit=function(){var t=this.list.name.toLowerCase();("project"==t&&!this.config.current.is_project_tracking||"location"==t&&!this.config.current.is_location_tracking||"priority"==t&&!this.config.current.is_priorities_general||"account"==t&&!this.config.current.is_account_manager||"level"==t&&!this.config.current.is_ticket_levels||("resolution"==t||"category"==t)&&!this.config.current.is_resolution_tracking)&&(this.list.hidden=!0),this.list.hidden||("tech"==t||"user"==t?this.name=(this.config.current.names[t]||{}).a:this.name=(this.config.current.names[t]||{}).s||this.list.name,this.list.url&&(this.url=this.list.url,this.preload&&this.loadData(!1)))},t.prototype.me=function(){var t=this.config.getCurrent("user"),e={id:t.user_id,name:a.getFullName(t.firstname,t.lastname,t.email)};this.emit_changed(e)},t.prototype.open=function(){this.loadData(!0)},t.prototype.loadData=function(t){var e=this;if(this.url==this.list.url&&this.list.items&&0!=this.list.items.length)this.proceed_list(t);else if(this.list.url){var n=null;t&&(n=o.Loading.create({content:"Please wait...",dismissOnPageChange:!0}),this.nav.present(n)),this.apiData.get(this.list.url).subscribe(function(i){e.list.items=i,t&&n.dismiss(),e.proceed_list(t),e.url=e.list.url},function(i){t&&n.dismiss(),e.error("Cannot get "+e.name+" list! Error: "+i),console.log(i||"Server error")})}else this.list.hidden=!0,this.error(this.name+" list is empty!")},t.prototype.error=function(t){this.nav.alert(t,!0)},t.prototype.proceed_list=function(t){var e=this;if(!this.list.items||0==this.list.items.length)return void(this.list.value="Default (nothing to select)");if(t){if(!this.list.items[0].name){var n=[];this.list.items.forEach(function(t){var i;t.email?i=a.getFullName(t.firstname,t.lastname,t.email,e.isbutton?"":" "):t.number&&(i="#"+t.number+": "+t.subject),n.push({id:t.id,name:i})}),this.list.items=n}this.openModal()}},t.prototype.emit_changed=function(t){this.list.value=t.name,t.type=this.list.name.split(" ").join("").toLowerCase(),this.onChanged.emit(t)},t.prototype.openRadio=function(){var t=this,e=this.name,n=o.Alert.create({title:"Choose "+e,buttons:[{text:"Cancel",role:"cancel",handler:function(){console.log("Cancel clicked")}},{text:"OK",handler:function(e){e&&(t.selected=e,t.emit_changed(e))}}]});this.list.items.forEach(function(t){n.addInput({type:"radio",label:t.name,value:t})}),this.nav.present(n)},t.prototype.openModal=function(){var t=this;this.list.isbutton=this.isbutton;var e=25===this.list.items.length?u.InfinitySelectModal:u.BasicSelectModal,n=o.Modal.create(e,this.list);n.onDismiss(function(e){e.name&&(t.selected=e,t.emit_changed(e))}),this.nav.present(n)},i([c.Input(),r("design:type",Object)],t.prototype,"list",void 0),i([c.Input(),r("design:type",Boolean)],t.prototype,"isbutton",void 0),i([c.Input(),r("design:type",Boolean)],t.prototype,"is_me",void 0),i([c.Input(),r("design:type",Boolean)],t.prototype,"preload",void 0),i([c.Input(),r("design:type",Boolean)],t.prototype,"ajax",void 0),i([c.Output(),r("design:type",c.EventEmitter)],t.prototype,"onChanged",void 0),t=i([c.Component({selector:"select-list",template:'<div *ngIf="!list.hidden && !isbutton"><ion-item no-lines class="labels color">{{name}}:&nbsp;</ion-item></div><button *ngIf="!list.hidden" (click)="open()" class="{{ isbutton? \'blue2 button-block\' : \'blue4\'}} {{ is_me ? \'left button-calc\' : \'width100\'}} disable-hover button button-default button-select"><ion-label class="{{isbutton ? \'center\' : \'tkts-table\'}}">{{list.value}}</ion-label><ion-icon [hidden]="isbutton" name="arrow-down"></ion-icon></button> <button *ngIf="is_me" class="buttonTicket button-ticket attach right color" (click)="me()"><u>Me</u></button>',directives:[o.IONIC_DIRECTIVES]}),r("design:paramtypes",[o.Nav,s.ApiData,o.Config])],t)}();n.SelectListComponent=l},{"../../directives/helpers":14,"../../pages/modals/modals":29,"../../providers/api-data":53,"@angular/core":193,"ionic-angular":431}],9:[function(t,e,n){"use strict";var i=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(3>o?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},r=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),s=t("@angular/core"),a=t("../../providers/ticket-provider"),c=t("../../pages/ticket-details/ticket-details"),u=t("../../pages/modals/modals"),l=t("../../directives/helpers"),p=t("../../pipes/pipes"),h=function(){
function t(t,e,n,i){this.nav=t,this.navParams=e,this.config=n,this.ticketProvider=i,this.LIMIT=6,this.is_empty=!1,this.pager={page:0,limit:this.LIMIT}}return t.prototype.ngOnChanges=function(t){if("count"in t){if(t.count.isFirstChange())return;this.count=t.count.currentValue,this.count<1?this.is_empty=!0:(this.pager.limit=this.count,this.onLoad(),this.is_empty=!1)}},t.prototype.ngOnInit=function(){var t=this;this.he=this.config.getCurrent("user"),this.cachename=this.mode[0]+(this.mode[1]||""),this.cachelen=(this.ticketProvider._dataStore[this.cachename]||{}).length,"all"==this.mode[0]&&(this.pager.limit=this.LIMIT=15),this.preload&&!this.cachelen?setTimeout(function(){t.onLoad()},this.preload):this.onLoad()},t.prototype.onLoad=function(){var t=this;if(this.mode){var e=this.config.getStat("tickets")[this.mode[0]];if(this.count=e?e:this.count,0!==this.count){if(this.ticketProvider.getTicketsList(this.mode[0],this.mode[1],this.pager),this.tickets=this.ticketProvider.tickets$[this.cachename],!this.ticketProvider._dataStore[this.cachename].length){var n=setTimeout(function(){t.busy=!0},500);this.tickets.subscribe(function(e){clearTimeout(n),t.busy=!1,t.is_empty=!e.length})}}else this.is_empty=!0}},t.prototype.itemTapped=function(t,e,n){"ION-ITEM-SLIDING"!=t.srcElement.tagName.toUpperCase()&&(n.close(),e.clicked=!0,e.cachename=this.cachename,e.technician_email==this.he.email&&(e.is_new_tech_post=!1),e.technician_email==this.he.email&&(e.is_new_user_post=!1),this.nav.push(c.TicketDetailsPage,e))},t.prototype.addPost=function(t,e){var n=this;e.close();var i=o.Alert.create({title:"Add Response to #"+t.number,inputs:[{name:"note",placeholder:"Note"}],buttons:[{text:"Cancel",handler:function(t){console.log("Cancel clicked")}},{text:"Post",handler:function(e){if(e.note.trim()){var i=l.htmlEscape(e.note.trim()).substr(0,5e3);n.ticketProvider.addTicketPost(t.id,i).subscribe(function(t){n.nav.alert("Note added :)")},function(t){console.log(t||"Server error")})}}}]});this.nav.present(i)},t.prototype.closeTicket=function(t,e){var n=this;if(e.close(),"Closed"==t.status)return void this.reopenTicket(t);var i=o.Modal.create(u.CloseTicketModal,t);i.onDismiss(function(e){e&&(n.count-=e,n.ticketProvider._dataStore[n.cachename].splice(n.ticketProvider._dataStore[n.cachename].indexOf(t),1),n.count<1?n.is_empty=!0:(n.pager.limit=n.count,n.onLoad(),n.is_empty=!1))}),this.nav.present(i)},t.prototype.reopenTicket=function(t){var e=this,n={status:"open",note_text:""};this.ticketProvider.closeOpenTicket(t.key,n).subscribe(function(n){e.nav.alert("Ticket has been Reopened!"),t.status="Open"},function(t){console.log(t||"Server error")})},t.prototype.doInfinite=function(t){var e=this;if(this.is_empty||this.count>0&&this.count<this.LIMIT||this.cachelen>0&&(this.cachelen>=this.count||this.cachelen<this.LIMIT))return t.enable(!1),void t.complete();this.pager.page+=1;var n=(this.ticketProvider._dataStore[this.cachename]||{}).length;this.ticketProvider.getTicketsList(this.mode[0],this.mode[1],this.pager),this.tickets.subscribe(function(i){t.complete();var r=i.length;t.enable(!(n==r||r%e.LIMIT)),e.cachelen=r})},i([s.Input(),r("design:type",Array)],t.prototype,"mode",void 0),i([s.Input(),r("design:type",Number)],t.prototype,"count",void 0),i([s.Input(),r("design:type",Number)],t.prototype,"preload",void 0),i([s.Input(),r("design:type",String)],t.prototype,"filter",void 0),t=i([s.Component({selector:"tickets-list",template:'<ion-content style="height: 90vh;"><ion-list class="list indent-bottom general-alignment2" no-lines><img *ngIf="busy" class="imglogo img-padding" src="img/loading2.gif"><ion-item-sliding class="border" *ngFor="let ticket of tickets | async" #slidingItem><a detail-none href="#" ion-item (click)="itemTapped($event, ticket, slidingItem)" class="item margin" [class.only-click]="!ticket.clicked" [class.activated]="ticket.clicked"><ion-avatar padding item-left><li><span item-left>#{{ticket.number}}</span> <img class="img_avatar" [alt]="ticket.user_firstname" [src]="ticket.user_email | Gravatar"><p>{{ticket.user_firstname}} {{ticket.user_lastname}}</p></li></ion-avatar><div class="alignment"><li><h2><ion-icon *ngIf="(ticket.is_new_tech_post && ticket.technician_email != he.email) || (ticket.is_new_user_post && ticket.user_email != he.email)" dark name="mail"></ion-icon>&nbsp;{{ticket.subject | Htmlsafe}}</h2><h3 [innerHTML]="ticket.initial_post | Linebreaks"></h3><p>{{ticket.class_name}}&nbsp;</p></li></div></a><ion-item-options><button (click)="addPost(ticket, slidingItem)" class="grey3 disable-hover button button-default"><ion-icon></ion-icon>Add Response</button> <button (click)="closeTicket(ticket, slidingItem)" class="disable-hover button button-default close-ticket"><ion-icon></ion-icon><p class="close-ticket2">{{ticket.status != \'Closed\' ? "Close" : "ReOpen"}} {{config.current.names.ticket.a}}</p></button></ion-item-options></ion-item-sliding></ion-list><div *ngIf="is_empty" class="table grey2 menu-text">No {{mode[0] | Capitalize}} {{config.current.names.ticket.p}} yet</div><ion-infinite-scroll threshold="30%" (infinite)="doInfinite($event)"><ion-infinite-scroll-content loadingSpinner="circles" loadingText="Loading more data..."></ion-infinite-scroll-content></ion-infinite-scroll></ion-content>',directives:[o.IONIC_DIRECTIVES],pipes:[p.GravatarPipe,p.LinebreaksPipe,p.CapitalizePipe,p.HtmlsafePipe]}),r("design:paramtypes",[o.Nav,o.NavParams,o.Config,a.TicketProvider])],t)}();n.TicketsListComponent=h},{"../../directives/helpers":14,"../../pages/modals/modals":29,"../../pages/ticket-details/ticket-details":38,"../../pipes/pipes":52,"../../providers/ticket-provider":58,"@angular/core":193,"ionic-angular":431}],10:[function(t,e,n){"use strict";var i=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(3>o?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},r=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),s=t("@angular/core"),a=t("../../providers/todo-provider"),c=t("../../pages/todo-create/todo-create"),u=t("../../directives/helpers"),l=function(){function t(t,e,n,i){this.nav=t,this.todoProvider=e,this.config=n,this.navParams=i,this.LIMIT=5e3,this.is_empty=!1,this.is_empty_list=!0,this.undone=0,this.initial_load=!0,this.is_empty=!1,this.pager={page:0,limit:this.LIMIT}}return t.prototype.ngOnInit=function(){this.hidden=this.simple,this.is_empty_list=this.simple,this.params=this.navParams.data||{},this.params.user={id:this.params.user_id||this.config.current.user.user_id,name:this.params.user_name||""},this.cachename=u.addp("todos","assigned_id",this.params.user.id),this.cachelen=(this.todoProvider._dataStore[this.cachename]||{}).length,this.params.is_empty&&(this.params.count=0),this.getTodos()},t.prototype.getTodos=function(){var t=this;this.todoProvider.getTodos(this.params.user.id,this.pager),this.todoLists=this.todoProvider.todos$[this.cachename];var e=setTimeout(function(){t.busy=!0},500);setTimeout(function(){t.busy=!1},3e3),this.todoLists.subscribe(function(n){clearTimeout(e),t.busy=!1,t.is_empty=!n.length;var i=0,r=0;for(var o in n)for(var s in n[o].sub)r++,n[o].sub[s].is_completed||i++;t.undone=i,t.is_empty_list=t.simple&&!r})},t.prototype.AddTodo=function(t){var e=o.Modal.create(c.TodoCreatePage,{list_id:t||""});this.nav.present(e)},t.prototype.setDone=function(t){this.undone=Math.max(t.is_completed?--this.undone:++this.undone,0),this.todoProvider.setCompletedTodo(t.id,t.is_completed)},t.prototype.setDate=function(t,e,n){return t?u.getDateTime(t,e,n):null},t.prototype.getFixed=function(t){return t=(t||"0").toString(),~t.indexOf(".")?Number(t).toFixed(2).toString():t},i([s.Input(),r("design:type",Boolean)],t.prototype,"simple",void 0),t=i([s.Component({selector:"todo-list",template:'<div class="todos list general-alignment" [hidden]="is_empty_list"><img *ngIf="busy && !simple" class="imglogo img-padding" src="img/loading2.gif"><div *ngIf="is_empty && !simple" class="table grey2 menu-text">No ToDo\'s yet</div><div *ngIf="simple" class="blue4 alignment-bottom" style="height: 50px;" (click)="hidden = !hidden"><span><ion-icon [ngClass]="{\'ion-ios-arrow-down font18 margin-top3 margin-right10\':!hidden, \'pr8 button-arrow ion-ios-arrow-forward padding-top5\':hidden}" class="left todos-arrow padding-left15 left" role="img"></ion-icon><h5 style="color:white; padding-top: 3px;">ToDo\'s</h5></span> <button fab class="right buttonInvoice email-invoice position-initial margin-right10 general-alignment2">{{undone}}</button></div><block [hidden]="hidden"><template ngFor let-todoList [ngForOf]="todoLists | async" let-even="even" let-odd="odd"><div [ngClass]="{\'grad\': todoList.sub?.length}" (click)="todoList.hidden = !todoList.sub?.length || !todoList.hidden"><ion-icon [style.visibility]="!todoList.sub?.length ?\'hidden\':\'inherit\'" role="img" [ngClass]="{\'ion-ios-arrow-down font18 margin-right10\':!todoList.hidden, \'pr8 button-arrow ion-ios-arrow-forward left\':todoList.hidden}" class="todos-arrow padding-left15"></ion-icon><h5>{{todoList.name}}</h5><ion-icon (click)="AddTodo(todoList.list_id)" name="md-add" role="img" style="padding-right: 10px;" class="ion-md-add padding-left15 todos-arrow right" aria-label="arrow down"></ion-icon></div><template [ngIf]="!todoList?.hidden"><template ngFor let-todo [ngForOf]="todoList?.sub" let-last="last" let-even="seven" let-odd="sodd"><div (click)="todo.is_completed = !todo.is_completed;setDone(todo)"><ion-icon [ngClass]="{\'ion-ios-checkmark-circle secondary\' : todo.is_completed, \'ion-ios-radio-button-on grey2\' : !todo.is_completed}" class="font18 todos-padding margin-top3"></ion-icon><h5 [ngClass]="{\'decoration_line grey3_color\' : todo.is_completed, \'\' : !todo.is_completed}">{{todo.title}} <i *ngIf="todo.text">{{" - " + todo.text}}</i></h5></div><div class="todos-flex right"><h6></h6><h6 *ngIf="todo.assigned_name">{{todo.assigned_name}}</h6><h6 *ngIf="todo.due_date">Due&nbsp;{{setDate(todo.due_date)}}</h6><h6 *ngIf="todo.estimated_remain">{{getFixed(todo.estimated_remain)}}&nbsp;hrs</h6></div><hr *ngIf="!last" class="width_calc100-40"></template></template><hr class="width100"></template></block></div>',directives:[o.IONIC_DIRECTIVES]}),r("design:paramtypes",[o.Nav,a.TodoProvider,o.Config,o.NavParams])],t)}();n.TodoListComponent=l},{"../../directives/helpers":14,"../../pages/todo-create/todo-create":42,"../../providers/todo-provider":60,"@angular/core":193,"ionic-angular":431}],11:[function(t,e,n){"use strict";var i=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(3>o?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},r=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),s=t("@angular/core"),a=function(){function t(){this.onSelectedChanged=new s.EventEmitter}return t.prototype.onSelectNode=function(t){this.onSelectedChanged.emit(t)},t.prototype.onExpand=function(t){t.sub&&(t.isExpanded=!t.isExpanded)},t.prototype.onRequest=function(t){console.log("inner request")},i([s.Input(),r("design:type",Array)],t.prototype,"Nodes",void 0),i([s.Input(),r("design:type",Object)],t.prototype,"SelectedNode",void 0),i([s.Output(),r("design:type",s.EventEmitter)],t.prototype,"onSelectedChanged",void 0),t=i([s.Component({selector:"tree-view",template:'<ul class="inner"><li *ngFor="let node of Nodes" class="list-tree"><a detail-none href="#" (click)="onSelectNode(node); onExpand(node)"><span><li class="left icon-class"><ion-icon [hidden]="node != SelectedNode" class="button-arrow margin-top-2" name="checkmark" role="img" aria-label="checkmark"></ion-icon></li>{{node.name}}</span><ion-icon [hidden]="!node.sub" name="ios-arrow-{{node.isExpanded ? \'down\' : \'forward\'}}" role="img" class="button-arrow right" aria-label="arrow"></ion-icon></a><tree-view [Nodes]="node.sub" [SelectedNode]="SelectedNode" (onSelectedChanged)="onSelectNode($event)" *ngIf="node.isExpanded"></tree-view></li></ul>',directives:[t,o.IONIC_DIRECTIVES]}),r("design:paramtypes",[])],t)}();n.TreeViewComponent=a},{"@angular/core":193,"ionic-angular":431}],12:[function(t,e,n){"use strict";function i(t){for(var e in t)n.hasOwnProperty(e)||(n[e]=t[e])}i(t("./focuser"))},{"./focuser":13}],13:[function(t,e,n){"use strict";var i=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(3>o?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},r=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("@angular/core"),s=function(){function t(t,e){this.renderer=t,this.elementRef=e}return t.prototype.ngOnInit=function(){var t=this,e=this.elementRef.nativeElement.querySelector("input");setTimeout(function(){t.renderer.invokeElementMethod(e,"setSelectionRange",[0,999])},500),setTimeout(function(){t.renderer.invokeElementMethod(e,"focus",[])},300)},t=i([o.Directive({selector:"[focuser]"}),r("design:paramtypes",[o.Renderer,o.ElementRef])],t)}();n.Focuser=s},{"@angular/core":193}],14:[function(t,e,n){"use strict";function i(t,e){localStorage.setItem(t,JSON.stringify(e||{}))}function r(t){return JSON.parse(localStorage.getItem(t))}function o(t){var e=RegExp("[?&]"+t+"=([^&]*)").exec(window.location.href);return e&&decodeURIComponent(e[1].replace(/\+/g," "))}function s(t,e){var n=u(location.origin+location.pathname,t,e);try{window.history.replaceState({},"",n)}catch(i){}}function a(t){var e=!1;if(!e&&!confirm("Do you want to stay logged in Google account?")){"https://www.google.com/accounts/Logout?continue=https://appengine.google.com/_ah/logout?continue="+S.MobileSite}}function c(t){if(!t||t.length<9)return null;if("undefined"!=typeof window.DOMParser)return(new window.DOMParser).parseFromString(t,"text/xml");if("undefined"!=typeof window.ActiveXObject&&new window.ActiveXObject("Microsoft.XMLDOM")){var e=new window.ActiveXObject("Microsoft.XMLDOM");return e.async="false",e.loadXML(t),e}return console.log("No XML parser found"),null}function u(t,e,n){if(!t||!n||!e)return t;var i=t.indexOf(e+"=");if(-1!=i)return t.slice(0,i+e.length)+"="+n;var r=t.indexOf("?")>0?"&":"?";return t+r+e+"="+n}function l(t,e,n,i){var r=S.AppSite;e&&(r=u(r,"tkt",e)),r=u(r,"dept",n),r=u(r,"org",i),window.open(r,"_system")}function p(t){return String(t).replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function h(t,e){t=(t||"").trim();var n=e;return t.length&&(t=t.replace(/&lt;br&gt;/gi,"\n").replace(/<br\s*[\/]?>/gi,"\n").replace(/\r/g,"").replace(/\n\n/g,n?"\n":"<br>")),t}function d(t){return window.open(t,"_blank","location=no,EnableViewPortScale=yes")}function f(t){return window.open(t,"_system")}function v(t){return String(t).replace(/&lt;br&gt;/gi,"\n").replace(/<br\s*[\/]?>/gi,"\n").replace(/\n/g,"<p></p>")}function m(t,e){var n="";return n=t?"1"!==localStorage.getItem("dateformat")?"MMM DD / YYYY":"DD MMM YYYY":"1"!==localStorage.getItem("dateformat")?"MM/DD/YYYY":"DD/MM/YYYY",n+(e?"1"!==localStorage.getItem("timeformat")?" hh:mm A":" HH:mm":"")}function g(t,e){var n="";return n=t?"1"!==localStorage.getItem("dateformat")?"mmm d / yyyy":"d mmm yyyy":"1"!==localStorage.getItem("dateformat")?"m/d/yy":"d/m/yy",n+(e?"1"!==localStorage.getItem("timeformat")?" hh:MM TT":" HH:MM":"")}function y(t,e,n){return E(t,g(e,n))}function b(t){return localStorage.getItem("currency")+Number(t||"0").toFixed(2).toString()}function _(t,e,n,i){var r="";return i&&(r=i+" "),e&&(r+=e+" "),t&&(r+=t+" "),n&&n.indexOf("@")>0&&(r.trim()?i&&(r+=" ("+n+")"):r=n),r||"NoName"}function w(t){return t.replace(/\w\S*/g,function(t){return t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()})}function C(t){var e=document.referrer,n=window.location.href,i="1",r=t||"",o="102459",s=document.createElement("script");s.type="text/javascript",s.async=!0,s.src="https://www.getapp.com/conversion/"+encodeURIComponent(o)+"/r.js?p="+encodeURIComponent(i)+"&h="+encodeURIComponent(n)+"&r="+encodeURIComponent(e)+"&e="+encodeURIComponent(r);var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(s,a)}function P(){var t=new Image,e=document.getElementsByTagName("body")[0];t.onload=function(){e.appendChild(t)},t.src="http://px.spiceworks.com/px/8oxz";var n=n||{};n.cmd=n.cmd||[],n.cmd.push(function(){n.pixel.setPixel("8oxz"),n.pixel.setIdentifier("121806"),n.pixel.fire()})}var S=t("../providers/config");n.saveCache=i,n.loadCache=r,n.getParameterByName=o,n.cleanQuerystring=s,n.GooglelogOut=a,n.parseXml=c,n.addp=u,n.fullapplink=l,n.htmlEscape=p,n.linebreaks=h,n.FileUrlHelper={isPhonegap:function(){return"true"===localStorage.getItem("isPhonegap")},ReplaceAll:function(t,e,n){return t.split(e).join(n)},checkURL:function(t){return t?null!==t.trim().match(/(jpeg|jpg|gif|png|ico)$/i):!1},matchKey:function(t,e){for(var n in e)if(-1!=n.indexOf(t))return n;return""},addUrls:function(t,e){var i=e.length,r={};if(i){for(var o=t.match(/\[cid:[^\[\]]*]/g),s=0;i>s;s++){var a=e[s].name;t=n.FileUrlHelper.ReplaceAll(t," "+a,e[s].is_deleted?"":n.FileUrlHelper.getFileLink(e[s].url,a)),r['"'+a.substring(0,a.lastIndexOf("."))+'"']=e[s].url}if(o)for(var c=0;c<o.length;c++){var u=o[c].slice(5,-1);u.indexOf("_link_")>=0?u=u.replace("_link_",""):(u=n.FileUrlHelper.matchKey(u.slice(0,-3),r),u=u&&"undefined"!=typeof r[u]?r[u]:""),u.length&&(t=n.FileUrlHelper.ReplaceAll(t,o[c],n.FileUrlHelper.getFileLink(u,o[c].slice(5,-1))))}i>1&&(t=n.FileUrlHelper.ReplaceAll(t,"a>,","a>")),t=n.FileUrlHelper.ReplaceAll(t,"a>.","a>")}return t},getFileLink:function(t,e){var i="";return i=n.FileUrlHelper.checkURL(t)||n.FileUrlHelper.checkURL(e)?'<img class="attachment" src="'+t+'">':'<ion-icon name="md-document" role=img dark class="button_circle ion-md-document" aria-label="md-document"></ion-icon>&nbsp;<span class="decoration width100 color">'+(e||decodeURIComponent(t.split("/").slice(-1)))+"</span><p></p>",'<p/><a class="comment_image_link files-tkts color margin-right_10"'+(n.FileUrlHelper.isPhonegap()?" href=# onclick='window.open(\""+t+'", "_blank", "location=no,EnableViewPortScale=yes")\'>'+i+"</a>":' target="_blank" href="'+t+'">'+i+"</a>")}},n.openURL=d,n.openURLsystem=f,n.symbolEscape=v,n.getPickerDateTimeFormat=m,n.getDateTime=y,n.getCurrency=b,n.getFullName=_,n.toTitleCase=w,n.getappTrackConversion=C,n.spicePixelTrackConversion=P;var E=function(t,e,n){var i=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,r=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,o=/[^-+\dA-Z]/g,s=function(t,e){for(t=String(t),e=e||2;t.length<e;)t="0"+t;return t};return function(t,e,n){var a=E;if(1!=arguments.length||"[object String]"!=Object.prototype.toString.call(t)||/\d/.test(t)||(e=t,t=void 0),t=t?new Date(t):new Date,isNaN(t))throw SyntaxError("invalid date");e=String(a.masks[e]||e||a.masks["default"]),"UTC:"==e.slice(0,4)&&(e=e.slice(4),n=!0);var c=n?"getUTC":"get",u=t[c+"Date"](),l=t[c+"Day"](),p=t[c+"Month"](),h=t[c+"FullYear"](),d=t[c+"Hours"](),f=t[c+"Minutes"](),v=t[c+"Seconds"](),m=t[c+"Milliseconds"](),g=n?0:t.getTimezoneOffset(),y={d:u,dd:s(u),ddd:a.i18n.dayNames[l],dddd:a.i18n.dayNames[l+7],m:p+1,mm:s(p+1),mmm:a.i18n.monthNames[p],mmmm:a.i18n.monthNames[p+12],yy:String(h).slice(2),yyyy:h,h:d%12||12,hh:s(d%12||12),H:d,HH:s(d),M:f,MM:s(f),s:v,ss:s(v),l:s(m,3),L:s(m>99?Math.round(m/10):m),t:12>d?"a":"p",tt:12>d?"am":"pm",T:12>d?"A":"P",TT:12>d?"AM":"PM",Z:n?"UTC":(String(t).match(r)||[""]).pop().replace(o,""),o:(g>0?"-":"+")+s(100*Math.floor(Math.abs(g)/60)+Math.abs(g)%60,4),S:["th","st","nd","rd"][u%10>3?0:Number(u%100-u%10!=10)*u%10]};return e.replace(i,function(t){return t in y?y[t]:t.slice(1,t.length-1)})}}();E.masks={"default":"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"},E.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]}},{"../providers/config":54}],15:[function(t,e,n){"use strict";var i=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(3>o?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},r=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),s=t("../../providers/data-provider"),a=t("../invoices/invoices"),c=t("../timelogs/timelogs"),u=t("../expenses/expenses"),l=t("../../directives/helpers"),p=t("../../components/tickets-list/tickets-list"),h=t("../../components/action-button/action-button"),d=t("../../pipes/pipes"),f=function(){function t(t,e,n,i,r){this.nav=t,this.navParams=e,this.dataProvider=n,this.config=i,this.view=r,this.is_editnote=!0,this.is_ready=!1,this.details_tab="Stat",this.pages=[a.InvoicesPage,u.ExpensesPage,c.TimelogsPage]}return t.prototype.onPageLoaded=function(){this.account=this.navParams.data||{},this.details_tab="Stat",this.tabsTicket="Open"},t.prototype.onPageWillEnter=function(){var t=this;this.view.setBackButtonText(""),this.dataProvider.getAccountDetails(this.account.id).subscribe(function(e){t.account=e,t.is_editnote=!(t.account.note||"").length,t.is_ready=!0},function(t){console.log(t||"Server error")})},t.prototype.saveNote=function(t){var e=this,n=(t.value||"").trim();n!=(this.account.note||"").trim()?this.dataProvider.addAccountNote(this.account.id,n).subscribe(function(t){return e.saveNoteSuccess(n)},function(t){console.log(t||"Server error")}):this.saveNoteSuccess(n)},t.prototype.saveNoteSuccess=function(t){this.nav.alert("Note saved :)"),this.account.note=(t||"").trim(),this.is_editnote=!this.account.note.length},t.prototype.onDelete=function(t){var e=this,n={file_id:t.id};this.dataProvider.deleteFile(n).subscribe(function(n){e.account.files=e.account.files.filter(function(e){return e!==t}),e.nav.alert("File "+t.name+" deleted!")},function(t){console.log(t||"Server error")})},t.prototype.openPage=function(t,e){var n=this;setTimeout(function(){return n.nav.push(n.pages[t],{is_empty:!e,account_id:n.account.id||"-1",account_name:n.account.name})},this.is_ready?0:2e3)},t.prototype.getFileLink=function(t){return l.FileUrlHelper.getFileLink(t.url,t.name)},t=i([o.Page({template:'<ion-navbar *navbar><button menuToggle><ion-icon name="menu"></ion-icon></button><ion-title class="padding-right24">{{account.name}}</ion-title></ion-navbar><ion-content class="account-details"><ion-segment [(ngModel)]="details_tab"><ion-segment-button value="Stat">{{config.current.names.account.a}} Stat</ion-segment-button><ion-segment-button value="Info">Info</ion-segment-button><ion-segment-button *ngIf="config.current.is_project_tracking" value="Projects">Projects</ion-segment-button><ion-segment-button value="Notes">Notes</ion-segment-button><ion-segment-button value="Files">Files</ion-segment-button></ion-segment><div [ngSwitch]="details_tab"><div [hidden]="details_tab != \'Stat\'"><ion-list class="list img-top" no-lines><div class="blue1 left width65 img-top"><a detail-none href="#tickets" ion-item class="textLogin">Open {{config.current.names.ticket.ap}}</a> <a *ngIf="config.current.is_invoice && config.current.is_time_tracking" detail-none href="#" ion-item (click)="openPage(0,account.account_statistics.invoices)" class="textLogin">Invoices</a> <a *ngIf="config.current.is_expenses" detail-none href="#" ion-item (click)="openPage(1, account.account_statistics.expenses)" class="textLogin">Expenses</a> <a *ngIf="config.current.is_time_tracking" detail-none href="#" ion-item (click)="openPage(2, account.account_statistics.hours)" class="textLogin">Hours</a></div><div class="right width35 img-top"><a detail-none href="#tickets" ion-item class="blue2">{{account.account_statistics.ticket_counts.open || 0}}</a> <a *ngIf="config.current.is_invoice && config.current.is_time_tracking" detail-none href="#" ion-item (click)="openPage(0,account.account_statistics.invoices)" class="blue2">{{account.account_statistics.invoices || 0}}</a> <a *ngIf="config.current.is_expenses" detail-none href="#" ion-item (click)="openPage(1, account.account_statistics.expenses)" class="blue2" [innerHTML]="account.account_statistics.expenses | More:[10000,\'<div class=item-inner><div class=input-wrapper><ion-label>$VV</ion-label></div></div><ion-button-effect></ion-button-effect>\']"></a> <a *ngIf="config.current.is_time_tracking" detail-none href="#" ion-item (click)="openPage(2, account.account_statistics.hours)" class="blue2" [innerHTML]="account.account_statistics.hours | More:[10000,\'<div class=item-inner><div class=input-wrapper><ion-label>VV</ion-label></div></div><ion-button-effect></ion-button-effect>\']"></a></div></ion-list><ion-item></ion-item><ion-item class="margin" id="tickets"><div class="list"><ion-segment [(ngModel)]="tabsTicket" class="height32"><ion-segment-button class="button-open" value="Open">Open {{config.current.names.ticket.ap}}</ion-segment-button><ion-segment-button class="button-open" value="Close">Closed {{config.current.names.ticket.ap}}</ion-segment-button></ion-segment></div></ion-item><br><tickets-list [hidden]="tabsTicket != \'Open\'" [mode]="[\'open\', account.id]" [count]="account.account_statistics.ticket_counts.open"></tickets-list><tickets-list [hidden]="tabsTicket != \'Close\'" preload="1500" [mode]="[\'closed\', account.id]" [count]="account.account_statistics.ticket_counts.closed"></tickets-list></div><ion-list class="list margin-top21" no-lines *ngSwitchWhen="\'Info\'"><ion-item class="margin color"><h3 class="left width35 text-left">BWD Acct#</h3><h3 class="right width50 tkts-table">{{account.bwd_number}}</h3></ion-item><ion-item class="margin color"><h3 class="left width35 text-left">Acc#</h3><h3 class="right width50 tkts-table">{{account.number}}</h3></ion-item><ion-item class="margin color"><h3 class="left width35 text-left">Ref1#</h3><h3 class="right width50 tkts-table">{{account.ref1}}</h3></ion-item><ion-item class="margin color"><h3 class="left width35 text-left">Ref2#</h3><h3 class="right width50 tkts-table">{{account.ref2}}</h3></ion-item><ion-item class="margin color"><h3 class="left width35 text-left">Org/Indiv</h3><h3 class="right width50 tkts-table">{{account.is_organization ? "Organization" : "Individual"}}</h3></ion-item><ion-item class="margin color"><h3 class="left width35 text-left">Acc Rep</h3><h3 class="right width50 tkts-table">{{account.representative_name}}</h3></ion-item><ion-item class="margin color"><h3 class="left width35 text-left space-initial">Internal location</h3><h3 class="right width50 tkts-table">{{account.internal_location_name}}</h3></ion-item><ion-item class="margin color"><h3 class="left width35 text-left">Email Suffix</h3><h3 class="right width50 tkts-table">{{account.email_suffix}}</h3></ion-item><ion-item class="margin color"><h3 class="left width35 text-left">Address 1</h3><h3 class="right width50 tkts-table">{{account.address1}}</h3></ion-item><ion-item class="margin color"><h3 class="left width35 text-left">Address 2</h3><h3 class="right width50 tkts-table">{{account.address2}}</h3></ion-item><ion-item class="margin color"><h3 class="left width35 text-left">City</h3><h3 class="right width50 tkts-table">{{account.city}}</h3></ion-item><ion-item class="margin color"><h3 class="left width35 text-left">Postal Code</h3><h3 class="right width50 tkts-table">{{account.zipcode}}</h3></ion-item><ion-item class="margin color"><h3 class="left width35 text-left">Country</h3><h3 class="right width50 tkts-table">{{account.country}}</h3></ion-item><ion-item class="margin color"><h3 class="left width35 text-left">Phone 1</h3><h3 class="right width50 tkts-table">{{account.phone1}}</h3></ion-item><ion-item class="margin color"><h3 class="left width35 text-left">Phone 2</h3><h3 class="right width50 tkts-table">{{account.phone2}}</h3></ion-item><ion-item class="color" *ngFor="let customfield of account.customfields"><h3 class="left width35 text-left">{{customfield.Key}}</h3><h3 class="right width50 tkts-table">{{customfield.Value || \'&nbsp;\'}}</h3></ion-item></ion-list><ion-list class="list margin-top21" *ngSwitchWhen="\'Projects\'"><div [hidden]="account.projects?.length" class="table grey2 menu-text">No Projects yet</div><ion-item *ngIf="account.projects?.length" no-lines class="margin color"><p class="text width30 text-left left"></p><p class="width17 right table table_account">Open</p><p class="width17 right table table_account">Logged</p><p class="width17 right table table_account">Remain</p><p class="width19 right table table_account">Complete</p></ion-item><ion-item class="color margin" *ngFor="let project of account.projects"><p class="text color width30 left table_account text-left">{{project.name}}</p><h3 class="width17 left table">{{project.open_tickets}}</h3><h3 class="width17 left table">{{project.logged_hours}}</h3><h3 class="width17 left table">{{project.remaining_hours}}</h3><h3 class="width19 right table">{{project.complete}}%</h3></ion-item></ion-list><ion-list class="list general-alignment max-width700" [hidden]="details_tab != \'Notes\'"><div [hidden]="is_editnote" class="width100 textLogin note-account commentText" [innerHTML]="account?.note" type="text" (click)="is_editnote = true"></div><button [hidden]="is_editnote" secondary class="button_reply img-top right" (click)="is_editnote = true">Edit Notes</button> <textarea autofocus [hidden]="!is_editnote" [ngModel]="account?.note" class="glow width100 textLogin commentText" #notetext type="text" placeholder="Notes:"></textarea> <button [hidden]="!is_editnote" secondary class="button_reply img-top right" (click)="saveNote(notetext)">{{account?.note?.length ? \'Save\' : \'Add\'}} Notes</button></ion-list><ion-list class="list margin-top21" no-lines *ngSwitchWhen="\'Files\'"><div [hidden]="account.files?.length" class="table grey2 menu-text">No Files yet</div><ion-item *ngFor="let file of account.files"><div class="left width59 tkts-table" [innerHTML]="getFileLink(file)"></div><div class="files-tkts"><span class="color right text-left space-initial flex1 font-size_span">{{file.name}}</span></div></ion-item></ion-list></div></ion-content><action-button [hidden]="details_tab != \'Stat\'" [data]="{\'account\': { id: account.id, name: account.name}}"></action-button>',directives:[p.TicketsListComponent,h.ActionButtonComponent],pipes:[d.MorePipe]}),r("design:paramtypes",[o.Nav,o.NavParams,s.DataProvider,o.Config,o.ViewController])],t)}();n.AccountDetailsPage=f},{"../../components/action-button/action-button":3,"../../components/tickets-list/tickets-list":9,"../../directives/helpers":14,"../../pipes/pipes":52,"../../providers/data-provider":55,
"../expenses/expenses":20,"../invoices/invoices":22,"../timelogs/timelogs":41,"ionic-angular":431}],16:[function(t,e,n){"use strict";var i=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(3>o?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},r=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),s=t("../../providers/data-provider"),a=t("../../components/components"),c=function(){function t(t,e,n){this.nav=t,this.config=e,this.dataProvider=n,this.LIMIT=500}return t.prototype.onPageLoaded=function(){var t=this;this.pager={page:0,limit:this.LIMIT};var e=setTimeout(function(){t.busy=!0},500);this.getItems(null,e)},t.prototype.getItems=function(t,e){var n=this;this.dataProvider.getAccountList(!1,this.pager,!0,!0).subscribe(function(i){e?(clearTimeout(e),n.busy=!1,n.accounts=i):((r=n.accounts).push.apply(r,i),n.config.current.stat.accounts+=i.length),t&&(t.enable(i.length==n.LIMIT),t.complete()),n.count=i.length;var r},function(t){e&&(clearTimeout(e),n.busy=!1),console.log(t||"Server error")})},t.prototype.doInfinite=function(t){return this.count<this.LIMIT?(t.enable(!1),void t.complete()):(this.pager.page+=1,void this.getItems(t,null))},t=i([o.Page({template:'<ion-navbar *navbar><button menuToggle><ion-icon name="menu"></ion-icon></button><ion-title>{{config.current.names.account.p}}</ion-title></ion-navbar><ion-content class="accounts"><p class="general-alignment"></p><img *ngIf="busy" class="imglogo img-padding" src="img/loading2.gif"><accounts-list margin-top [simple]="true" [accounts]="accounts"></accounts-list><ion-infinite-scroll (infinite)="doInfinite($event)" threshold="30%"><ion-infinite-scroll-content loadingSpinner="circles" loadingText="Loading more data..."></ion-infinite-scroll-content></ion-infinite-scroll></ion-content><action-button></action-button>',directives:[a.AccountsListComponent,a.ActionButtonComponent]}),r("design:paramtypes",[o.Nav,o.Config,s.DataProvider])],t)}();n.AccountsPage=c},{"../../components/components":5,"../../providers/data-provider":55,"ionic-angular":431}],17:[function(t,e,n){"use strict";var i=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(3>o?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},r=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),s=t("../../providers/providers"),a=t("../../directives/helpers"),c=t("../ticket-details/ticket-details"),u=t("../../directives/directives"),l=function(){function t(t,e,n,i,r){this.nav=t,this.navParams=e,this.config=n,this.apiData=i,this.ticketProvider=r,this.data=[],this.items=[],this.is_empty=!1}return t.prototype.ngOnInit=function(){var t=this;this.term=this.navParams.data.search||"",this.pager={limit:20},this.ticketProvider._dataStore.all.length?this.data=this.ticketProvider._dataStore.all:this.ticketProvider._dataStore.tech.length?this.data=this.ticketProvider._dataStore.tech:this.ticketProvider._dataStore.user.length&&(this.data=this.ticketProvider._dataStore.user);var e=this.term.toLowerCase();if(this.data.length&&e.length<4&&(this.items=this.data.filter(function(n){return t.searchCriteria(n,e)})),this.count=this.items.length,e.length>3){var n=setTimeout(function(){t.is_empty=!0,t.busy=!0},500);this.getItems(e,n)}else this.is_empty=!this.items.length},t.prototype.dismiss=function(t){this.nav.push(c.TicketDetailsPage,t)},t.prototype.searchCriteria=function(t,e){return t.number.toString().indexOf(e)>-1||t.subject.toLowerCase().indexOf(e)>-1||t.initial_post.toLowerCase().indexOf(e)>-1||t.user_firstname.toLowerCase().indexOf(e)>-1||t.user_lastname.toLowerCase().indexOf(e)>-1||t.location_name.toLowerCase().indexOf(e)>-1||t.class_name.toLowerCase().indexOf(e)>-1},t.prototype.searchItems=function(t){var e=this;this.items=this.data;var n=t.value;if(""==n.trim()||this.busy)return void(""==n.trim()&&(this.is_empty=!this.items.length));if(n.length<4)this.items=this.data.filter(function(t){return e.searchCriteria(t,n)}),this.is_empty=!this.items.length;else{var i=setTimeout(function(){e.busy=!0},500);this.getItems(n,i)}},t.prototype.getItems=function(t,e){var n=this;this.items=[],this.url="tickets?query=all",this.apiData.getPaged(a.addp(this.url,"search",t+"*"),this.pager).subscribe(function(i){e&&(clearTimeout(e),n.busy=!1),n.is_empty=!i.length,t?n.items=i:n.items=n.data=i,n.count=i.length},function(t){e&&(clearTimeout(e),n.busy=!1),console.log(t||"Server error")})},t=i([o.Page({template:'<ion-navbar *navbar><button menuToggle><ion-icon name="menu"></ion-icon></button><ion-title class="padding-right24">Search {{config.current.names.ticket.p}}</ion-title></ion-navbar><ion-content><ion-searchbar [focuser] debounce="400" [(ngModel)]="term" (input)="searchItems($event)" placeholder="Search {{config.current.names.ticket.p}} (min 4 chars)" hideCancelButton="true"></ion-searchbar><img *ngIf="busy" class="imglogo img-padding" src="img/loading2.gif"><ion-list class="ajax"><a detail-none href="#" ion-item *ngFor="let item of items" (click)="dismiss(item)"><h2>#{{item.number}} - {{item.subject}} ({{item.user_firstname}} {{item.user_lastname}})</h2></a></ion-list><div *ngIf="is_empty" class="table grey2 search-text">No {{config.current.names.ticket.p}} found yet</div></ion-content>',directives:[u.Focuser]}),r("design:paramtypes",[o.Nav,o.NavParams,o.Config,s.ApiData,s.TicketProvider])],t)}();n.AjaxSearchPage=l},{"../../directives/directives":12,"../../directives/helpers":14,"../../providers/providers":57,"../ticket-details/ticket-details":38,"ionic-angular":431}],18:[function(t,e,n){"use strict";var i=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(3>o?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},r=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),s=t("../../providers/providers"),a=t("../../directives/directives"),c=t("../../components/components"),u=t("../tickets/tickets"),l=t("../account-details/account-details"),p=t("../ticket-details/ticket-details"),h=t("../ajax-search/ajax-search"),d=t("../../pipes/pipes"),f=t("../../directives/helpers"),v=function(){function t(t,e,n,i,r,o){var s=this;this.nav=t,this.config=e,this.apiData=n,this.dataProvider=i,this.ticketProvider=r,this.timeProvider=o,this.counts={open_as_tech:0},this.accounts=[],this.queues=[],this.term="",this.simple=!1;var a=e.getStat("tickets");-1==a&&e.current.is_online?this.downloadTimer=setInterval(function(){s.counts.open_as_tech=++s.counts.open_as_tech},800):(e.current.user.is_limit_assigned_tkts&&!e.current.user.is_admin&&(a.open_all=Math.max(a.open_as_user,a.open_as_tech)),this.counts=this.counts||a)}return t.prototype.onPageLoaded=function(){var t=this;if(this.simple=!this.config.current.is_time_tracking&&!this.config.current.is_expenses,this.ticketProvider.getTicketsCounts(),this.ticketProvider.tickets$["tickets/counts"].subscribe(function(e){t.config.current.user.is_limit_assigned_tkts&&!t.config.current.user.is_admin&&(e.open_all=Math.max(e.open_as_user,e.open_as_tech)),clearInterval(t.downloadTimer),t.counts=e,t.config.setStat("tickets",{all:e.open_all,tech:e.open_as_tech,alt:e.open_as_alttech,user:e.open_as_user}),setTimeout(function(){t.saveCache()},1500)},function(e){clearInterval(t.downloadTimer),console.log(e||"Server error")}),this.config.current.is_unassigned_queue&&(this.queues=this.config.getCache("dashqueues"),this.dataProvider.getQueueList(3).subscribe(function(e){t.queues=e,t.config.setCache("dashqueues",e)},function(t){console.log(t||"Server error")})),this.config.current.is_account_manager){this.accounts=this.config.getCache("dashaccounts");var e=500,n={limit:~e?e:500};this.accounts&&0!=this.accounts.length||this.dataProvider.getAccountList(!0,n,!0,!0).subscribe(function(e){t.accounts=e,t.config.setStat("accounts",e.length),t.simple&&t.config.setCache("dashaccounts",e)},function(t){console.log(t||"Server error")}),this.simple||this.dataProvider.getAccountList(!0,n).subscribe(function(e){t.accounts=e,t.config.setCache("dashaccounts",e)},function(t){console.log(t||"Server error")})}this.ticketProvider._dataStore.tech.length||this.ticketProvider.getTicketsList("tech","",{limit:6}),this.timer=setTimeout(function(){t.ticketProvider._dataStore.user.length||t.ticketProvider.getTicketsList("user","",{limit:6}),t.config.current.is_time_tracking&&!(t.timeProvider._dataStore.time||{}).length&&t.timeProvider.getTimelogs("",{limit:25})},2500)},t.prototype.onPageDidEnter=function(){this.term=""},t.prototype.saveCache=function(){var t=document.elementFromPoint(window.innerWidth/2,window.innerHeight/2),e=t.closest("ion-nav");e&&(window.dash=e.innerHTML.replace(/\s\s+/g," "))},t.prototype.ngOnDestroy=function(){clearTimeout(this.timer)},t.prototype.searchItems=function(t){var e=this;this.search_results=[];var n=t.value;if(""!=n.trim()&&!this.busy&&n.length>1){var i=setTimeout(function(){e.busy=!0},500);this.getItems(n,i)}},t.prototype.getItems=function(t,e){var n=this;this.search_results=[];var i="tickets?query=all",r={limit:3},o=" "==t[t.length-1]||","==t[t.length-1];o?i="tickets/"+t.trim()+",":t+="*",this.apiData.getPaged(f.addp(i,"search",t),r).subscribe(function(t){e&&(clearTimeout(e),n.busy=!1),n.search_results=t},function(t){e&&(clearTimeout(e),n.busy=!1),console.log(t||"Server error")})},t.prototype.gotoTicket=function(t,e){this.test=!1,this.clearSearch(),this.nav.push(p.TicketDetailsPage,t)},t.prototype.clearSearch=function(t){this.search_results=[],this.busy=!1,t&&(t.value="")},t.prototype.getSearch=function(t){this.test=!1,this.clearSearch();var e=t.target.value;e.length<4&&(e+="    ");var n={search:e};this.test=!1,this.nav.push(h.AjaxSearchPage,n)},t.prototype.itemTappedTL=function(t){this.config.current.user.is_limit_assigned_tkts&&"all"==t.tab&&this.nav.alert("Please contact Administator to obtain permission to view All Tickets",!0),this.nav.setRoot(u.TicketsPage,t)},t.prototype.itemTappedAD=function(){this.nav.setRoot(l.AccountDetailsPage)},t=i([o.Page({template:'<ion-navbar *navbar><ion-buttons start><button menuToggle><ion-icon name="menu"></ion-icon></button></ion-buttons><ion-title>Dashboard</ion-title><ion-buttons end><button danger class="right transparent" (click)="test = !test"><ion-icon name="ios-search"></ion-icon></button></ion-buttons></ion-navbar><ion-content class="dashboard"><ion-searchbar *ngIf="test" [focuser] debounce="700" (cancel)="test = !test" (input)="searchItems($event)" [(ngModel)]="term" placeholder="{{config.current.names.ticket.s}} number (2 chars) or Enter to search" (search)="getSearch($event)"></ion-searchbar><img *ngIf="busy" class="imglogo" src="img/loading2.gif"><ion-list class="ajax" [hidden]="!search_results"><a detail-none href="#" ion-item *ngFor="let item of search_results" (click)="gotoTicket(item)"><h2>{{item.status}} | #{{item.number}} - {{item.subject}} ({{item.user_firstname}} {{item.user_lastname}})</h2></a></ion-list><ion-list class="list height" no-lines margin-top><div class="width50 left blue3 decoration_none"><a detail-none href="#" (click)="itemTappedTL({tab:\'tech\', count: counts.open_as_tech})" ion-item class="mainStat itemTech">{{counts.open_as_tech}}</a> <a detail-none href="#" (click)="itemTappedTL({tab:\'tech\', count: counts.open_as_tech})" ion-item class="itemTech">As {{config.current.names.tech.a}}</a></div><div class="width17 right blue3"><a detail-none href="#" ion-item (click)="itemTappedTL({tab:\'user\', count: counts.open_as_user})" class="itemTech" [innerHTML]="counts.open_as_user | More:[100,\'<div class=item-inner><div class=input-wrapper><ion-label>VV</ion-label></div></div><ion-button-effect></ion-button-effect>\']"></a> <a detail-none href="#" ion-item (click)="itemTappedTL({tab:\'alt\', count: counts.open_as_alttech})" class="itemTech" [innerHTML]="counts.open_as_alttech | More:[100,\'<div class=item-inner><div class=input-wrapper><ion-label>VV</ion-label></div></div><ion-button-effect></ion-button-effect>\']"></a> <a detail-none href="#" ion-item (click)="itemTappedTL({tab:\'all\', count: counts.open_all})" class="itemTech" [innerHTML]="counts.open_all | More:[100,\'<div class=item-inner><div class=input-wrapper><ion-label>VV</ion-label></div></div><ion-button-effect></ion-button-effect>\']"></a></div><div class="width33 right blue3 dashborder"><a detail-none href="#" ion-item (click)="itemTappedTL({tab:\'user\', count: counts.open_as_user})" class="itemTech dashboardRight dashboard font-size1 tkts-table">As {{config.current.names.user.a}}</a> <a detail-none href="#" ion-item (click)="itemTappedTL({tab:\'alt\', count: counts.open_as_alttech})" class="itemTech dashboardRight dashboard font-size1 tkts-table">Alt {{config.current.names.tech.a}}</a> <a detail-none href="#" ion-item (click)="itemTappedTL({tab:\'all\', count: counts.open_all})" class="itemTech dashboardRight dashboard font-size1 tkts-table">All Open</a></div><br></ion-list><br><todo-list margin-top *ngIf="config.current.is_todos" [simple]="true"></todo-list><queues-list margin-top class="container_list" *ngIf="config.current.is_unassigned_queue" [queues]="queues"></queues-list><accounts-list margin-top class="container_list" *ngIf="config.current.is_account_manager" [simple]="simple" [accounts]="accounts"></accounts-list><span class="span-block"></span></ion-content><action-button></action-button>',directives:[c.QueuesListComponent,c.AccountsListComponent,c.ActionButtonComponent,c.TodoListComponent,a.Focuser],pipes:[d.MorePipe]}),r("design:paramtypes",[o.Nav,o.Config,s.ApiData,s.DataProvider,s.TicketProvider,s.TimeProvider])],t)}();n.DashboardPage=v},{"../../components/components":5,"../../directives/directives":12,"../../directives/helpers":14,"../../pipes/pipes":52,"../../providers/providers":57,"../account-details/account-details":15,"../ajax-search/ajax-search":17,"../ticket-details/ticket-details":38,"../tickets/tickets":39,"ionic-angular":431}],19:[function(t,e,n){"use strict";var i=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(3>o?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},r=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),s=t("@angular/core"),a=t("../../directives/helpers"),c=t("../../providers/api-data"),u=t("../../components/class-list/class-list"),l=t("../../components/select-list/select-list"),p=function(){function t(t,e,n,i,r){this.nav=t,this.navParams=e,this.apiData=n,this.config=i,this.view=r}return t.prototype.ngOnInit=function(){this.expense=this.navParams.data||{};var t=(this.expense.user_name+" "+this.expense.user_email).trim().split(" ")[0];this.expense.expense_id?(this.title="Expense by "+t+" on"+this.setDate(this.expense.date,!1,!0),this.expense.note=a.linebreaks(this.expense.note,!0),this.expense.note_internal=a.linebreaks(this.expense.note_internal,!0)):this.expense.number?this.title="Add Expense to#"+this.expense.number+" "+this.expense.subject:this.title="Create Expense",this.expense.amount=this.getFixed(this.expense.amount),this.isbillable="undefined"==typeof this.expense.billable?!0:this.expense.billable,this.he=this.config.getCurrent("user");var e={};this.expense.number||this.expense.expense_id||this.expense.account||(e=this.config.current.recent||{});var n=(this.expense.account||{}).id||this.expense.account_id||(e.account||{}).selected||this.he.account_id||-1,i=(this.expense.project||{}).id||this.expense.project_id||(e.project||{}).selected||0;this.selects={account:{name:"Account",value:this.expense.account_name||(this.expense.account||{}).name||(e.account||{}).value||this.he.account_name,selected:n,url:"accounts?is_with_statistics=false",hidden:!1},project:{name:"Project",value:this.expense.project_name||(e.project||{}).value||"Default",selected:i,url:"projects?account="+n+"&is_with_statistics=false",hidden:!1}}},t.prototype.saveSelect=function(t){var e=t.type,n=this.selects.account.selected;switch(e){case"account":if(this.selects.account.selected===t.id)break;this.selects.project.url="projects?account="+t.id+"&is_with_statistics=false",this.selects.project.value="Default",this.selects.project.selected=0,n=t.id,this.selects.project.hidden=!1}this.selects[e].selected=t.id,this.selects[e].value=t.name},t.prototype.onSubmit=function(t){var e=this;if(t.valid){if(this.expense.in_progress&&Date.now()-this.expense.in_progress<1500)return;this.expense.in_progress=Date.now();var n=isNaN(t.value.amount)?0:Number(t.value.amount);if(0>=n)return void this.nav.alert("Not enough amount",!0);var i=(a.htmlEscape(this.expense.note.trim()).substr(0,5e3),!!this.expense.expense_id),r={ticket_key:this.expense.ticket_number||null,account_id:this.selects.account.selected,project_id:this.expense.ticket_number?null:this.selects.project.selected,tech_id:i?this.expense.user_id:this.he.user_id,note:this.expense.note,note_internal:this.expense.note_internal,amount:n,is_billable:this.isbillable,vendor:this.expense.vendor};this.apiData.get("expenses"+(i?"/"+this.expense.expense_id:""),r,i?"PUT":"POST").subscribe(function(t){e.expense.number||e.expense.expense_id||e.expense.account||e.config.setRecent({account:e.selects.account,project:e.selects.project}),e.nav.alert("Expense was successfully added :)"),setTimeout(function(){return e.close()},500)},function(t){console.log(t||"Server error")})}},t.prototype.setDate=function(t,e,n){return t?a.getDateTime(t,e,n):null},t.prototype.getFixed=function(t){return Number(t||"0").toFixed(2).toString()},t.prototype.close=function(){this.view.dismiss()},t=i([o.Page({template:'<ion-toolbar><button (click)="close()" class="bar-button bar-button-default"><span *ngIf="title?.length < 15" primary>Cancel</span><ion-icon *ngIf="title?.length > 15" primary class="invoiceCircle" name="ios-arrow-back"></ion-icon></button><ion-title class="ellipsis padding-right24">{{title}}</ion-title></ion-toolbar><ion-content class="expense-create"><form #addForm="ngForm"><ion-list class="list max-width700 general-alignment" no-lines><input class="width100 textLogin commentText subject-create" placeholder="Amount" required ngControl="amount" [ngModel]="expense.amount"><div class="class-margin"><select-list *ngIf="!expense.number" [list]="selects.account" ajax="true" preload="true" (onChanged)="saveSelect($event)"></select-list><select-list *ngIf="!expense.number" [list]="selects.project" preload="true" (onChanged)="saveSelect($event)"></select-list></div><div class="tooltips"><textarea required [(ngModel)]="expense.note" ngControl="note" #note="ngForm" class="width100 textLogin commentText" type="text" placeholder="Note" maxlength="4000"></textarea> <span [hidden]="note.valid || note.untouched">Note is required and less 4000 chars</span></div><br><textarea [(ngModel)]="expense.vendor" class="width100 textLogin commentText subject-create" type="text" placeholder="Vendor"></textarea> <textarea [(ngModel)]="expense.note_internal" class="width100 textLogin commentText subject-create" type="text" placeholder="Internal Notes"></textarea><ion-item no-lines class="left toggle-width"><ion-toggle class="toggle" [(ngModel)]="isbillable"></ion-toggle></ion-item><p class="left width30 text-toggle color">Billable</p><div><button (click)="onSubmit(addForm)" secondary block type="submit" [disabled]="!addForm.valid" class="disable-hover button button-default button-block">{{expense.expense_id ? \'Update\' : \'Add\'}} Expense</button></div></ion-list></form></ion-content>',directives:[s.forwardRef(function(){return u.ClassListComponent}),s.forwardRef(function(){return l.SelectListComponent})]}),r("design:paramtypes",[o.Nav,o.NavParams,c.ApiData,o.Config,o.ViewController])],t)}();n.ExpenseCreatePage=p},{"../../components/class-list/class-list":4,"../../components/select-list/select-list":8,"../../directives/helpers":14,"../../providers/api-data":53,"@angular/core":193,"ionic-angular":431}],20:[function(t,e,n){"use strict";var i=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(3>o?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},r=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),s=t("../../providers/data-provider"),a=t("../../directives/helpers"),c=t("../expense-create/expense-create"),u=t("../../pipes/pipes"),l=function(){function t(t,e,n,i,r){this.nav=t,this.dataProvider=e,this.config=n,this.navParams=i,this.view=r,this.LIMIT=15,this.is_empty=!1}return t.prototype.onPageLoaded=function(){this.params=this.navParams.data||{},this.pager={page:0},this.params.account={id:this.params.account_id||-1,name:this.params.account_name||this.config.getCurrent("user").account_name}},t.prototype.onPageWillEnter=function(){var t=this;if(this.params.account_name&&this.view.setBackButtonText(""),this.params.is_empty&&(this.params.count=0),0!==this.params.count){var e=setTimeout(function(){t.busy=!0},500);this.getItems(null,e)}else this.is_empty=!0},t.prototype.getItems=function(t,e){var n=this;this.dataProvider.getExpenses(this.params.account.id,this.pager).subscribe(function(i){e?(n.is_empty=!i.length,clearTimeout(e),n.busy=!1,n.expenses=i):(r=n.expenses).push.apply(r,i),t&&(t.enable(i.length==n.LIMIT),t.complete()),n.count=i.length;var r},function(t){e&&(clearTimeout(e),n.busy=!1),console.log(t||"Server error")})},t.prototype.doInfinite=function(t){return this.is_empty||this.count<this.LIMIT?(t.enable(!1),void t.complete()):(this.pager.page+=1,void this.getItems(t,null))},t.prototype.itemTapped=function(t){t=t||{},t.account=t.account||this.params.account,this.nav.push(c.ExpenseCreatePage,t)},t.prototype.setDate=function(t,e,n){return t?a.getDateTime(t,e,n):null},t.prototype.getCurrency=function(t){return a.getCurrency(t)},t=i([o.Page({template:'<ion-navbar *navbar><button menuToggle><ion-icon name="menu"></ion-icon></button><ion-title class="padding-right24">Expenses {{params.account_name ? "of&nbsp;" + params.account.name : ""}}</ion-title></ion-navbar><ion-content><div *ngIf="is_empty" class="table grey2 menu-text">No Expenses yet</div><ion-list class="list general-alignment2" no-lines><a detail-none href="#" ion-item *ngFor="let expense of expenses" (click)="itemTapped(expense)" class="margin-top0"><ion-avatar item-left><img [alt]="expense.user_firstname" class="img" [src]="expense.user_email | Gravatar"></ion-avatar><div class="expenses"><li class="text-left left"><h2 class="ellipsis color">{{expense.user_name}} @ {{setDate(expense.date, false, true)}}</h2><h3 class="timelogs ellipsis color" [innerHTML]="expense.note | Linebreaks"></h3><h3 class="timelogs ellipsis color" *ngIf="expense.ticket_id">{{"#"+expense.ticket_number+": "+expense.ticket_subject}}</h3><h3 class="timelogs ellipsis" *ngIf="expense.project_id">{{"Project: "+expense.project_name}}</h3></li><li class="right margin font-time text-right"><span class="expense-hours color">{{getCurrency(expense.amount)}}</span></li></div></a></ion-list></ion-content><button (click)="itemTapped()" secondary item-right fab fab-right fab-bottom style="z-index: 2"><ion-icon class="button_circle action-but" name="md-add"></ion-icon></button>',pipes:[u.GravatarPipe,u.MorePipe,u.LinebreaksPipe]}),r("design:paramtypes",[o.Nav,s.DataProvider,o.Config,o.NavParams,o.ViewController])],t)}();n.ExpensesPage=l},{"../../directives/helpers":14,"../../pipes/pipes":52,"../../providers/data-provider":55,"../expense-create/expense-create":19,"ionic-angular":431}],21:[function(t,e,n){"use strict";var i=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(3>o?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},r=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),s=t("../../directives/helpers"),a=t("../../pipes/pipes"),c=t("../../providers/data-provider"),u=t("../../providers/api-data"),l=function(){function t(t,e,n,i,r,o){this.nav=t,this.navParams=e,this.dataProvider=n,this.apiData=i,this.config=r,this.view=o}return t.prototype.onPageLoaded=function(){var t=this;this.invoice=this.navParams.data||{},this.invoice.id?this.title="Send Invoice #"+this.invoice.id+" to"+this.invoice.account_name:this.title="Create Invoice on"+this.invoice.account_name,this.dataProvider.getInvoice(this.invoice.id,this.invoice.account_id,this.invoice.project_id).subscribe(function(e){1==e.length&&(e=e[0]),e.recipients&&(e.recipients=e.recipients.sort(function(t,e){return t.is_accounting_contact<e.is_accounting_contact?1:-1})),t.invoice=e},function(t){console.log(t||"Server error")})},t.prototype.onPageWillEnter=function(){this.view.setBackButtonText("")},t.prototype.setDate=function(t,e,n){return s.getDateTime(t||new Date,e,n)},t.prototype.getCurrency=function(t){return s.getCurrency(t)},t.prototype.changeContact=function(t){t.is_accounting_contact=!t.is_accounting_contact},t.prototype.send=function(){var t=this;if(!this.invoice.recipients.filter(function(t){return t.is_accounting_contact}).length)return void this.nav.alert("No accounting contacts selected",!0);if(!(this.invoice.in_progress&&Date.now()-this.invoice.in_progress<1500)){this.invoice.in_progress=Date.now();var e="";this.invoice.recipients.forEach(function(t){t.is_accounting_contact&&(e+=t.email+",")});var n={};this.invoice.id?n.action="sendEmail":(n.status="unbilled",n.account=this.invoice.account_id,n.project=this.invoice.project_id,n.start_date=new Date(this.invoice.start_date||Date.now().toString()).toJSON(),n.end_date=new Date(this.invoice.end_date||Date.now().toString()).toJSON()),n.recipients=e,this.apiData.get("invoices/"+(this.invoice.id||""),n,this.invoice.id?"PUT":"POST").subscribe(function(e){t.nav.alert("Hurray! Invoice sent :)"),t.invoice.id?t.nav.pop():t.nav.popTo(t.nav.getByIndex(t.nav.length()-3))},function(t){console.log(t||"Server error")})}},t=i([o.Page({template:'<ion-navbar *navbar><button menuToggle><ion-icon name="menu"></ion-icon></button><ion-title class="ellipsis padding-right24">{{title}}</ion-title></ion-navbar><ion-content padding class="invoice-details"><ion-item><p item-right class="text_list color">{{setDate(invoice.start_date, true)}} - {{setDate(invoice.end_date, true)}}</p></ion-item><ion-item no-lines class="width65 left"><h2 class="color" item-left>Time</h2></ion-item><ion-item no-lines class="width35 left"><h2 item-right class="color">{{getCurrency(invoice.amount)}}</h2></ion-item><ion-item no-lines class="width65 left"><h2 item-left class="color">Travel</h2></ion-item><ion-item no-lines class="width35 left"><h2 item-right class="color">{{getCurrency(invoice.travel_cost)}}</h2></ion-item><ion-item no-lines class="width65 left"><h2 item-left class="color">Expenses</h2></ion-item><ion-item no-lines class="width35 left"><h2 item-right class="color">{{getCurrency(invoice.misc_cost)}}</h2></ion-item><ion-item no-lines class="width65 left"><h2 item-left class="color">Adjustments</h2></ion-item><ion-item no-lines class="width35 left"><h2 item-right class="color">{{getCurrency(invoice.adjustments)}}</h2></ion-item><ion-item class="width45 right basic-margin color"></ion-item><ion-item no-lines><h2 item-right class="font-invoice color">{{getCurrency(invoice.total_cost)}}</h2></ion-item><br><ion-item padding><br><h2 class="color">Recipients</h2></ion-item><ion-list class="list"><div *ngIf="!invoice.recipients" class="table grey2 menu-text">No recipients yet</div><div *ngFor="let recipient of invoice.recipients"><div><ion-avatar class="ticketImg left recipient width23"><img class="avatarInvoice margin-top10 img_avatar" [alt]="recipient.fullname" [src]="recipient.email | Gravatar"></ion-avatar></div><ion-item class="blue3 width80 invoicelist right margin" no-lines><h3 class="recipient-calc left textLogin margin-top2 ellipsis">{{recipient.email}}</h3><button fab class="{{recipient.is_accounting_contact ? \'green\' : \'red\'}} buttonInvoice right topInvoice email-invoice button-fab" (click)="changeContact(recipient)"><ion-icon *ngIf="recipient.is_accounting_contact" class="invoiceCircle" name="checkmark"></ion-icon><ion-icon *ngIf="!recipient.is_accounting_contact" class="invoiceCircle" name="close"></ion-icon></button></ion-item></div></ion-list><div><button (click)="send()" [disabled]="!invoice.recipients" secondary class="disable-hover button button-default button-block img-top display">{{!invoice.id ? "Create &" : ""}} Send</button></div></ion-content>',pipes:[a.GravatarPipe]}),r("design:paramtypes",[o.Nav,o.NavParams,c.DataProvider,u.ApiData,o.Config,o.ViewController])],t)}();n.InvoiceDetailsPage=l},{"../../directives/helpers":14,"../../pipes/pipes":52,"../../providers/api-data":53,"../../providers/data-provider":55,"ionic-angular":431}],22:[function(t,e,n){"use strict";var i=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(3>o?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},r=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),s=t("../../providers/data-provider"),a=t("../../pipes/pipes"),c=t("../invoice-details/invoice-details"),u=t("../uninvoices/uninvoices"),l=t("../../directives/helpers"),p=function(){function t(t,e,n,i,r){this.nav=t,this.dataProvider=e,this.config=n,this.navParams=i,this.view=r,this.LIMIT=15,this.is_empty=!1,this.invoices=[]}return t.prototype.onPageLoaded=function(){var t=this;if(this.params=this.navParams.data||{},this.pager={page:0,limit:this.LIMIT},this.params.account={id:this.params.account_id||0,name:this.params.account_name||this.config.getCurrent("user").account_name},this.params.is_empty&&(this.params.count=0),0!==this.params.count){var e=setTimeout(function(){t.busy=!0},500);this.getItems(null,e)}else this.is_empty=!0},t.prototype.onPageWillEnter=function(){this.params.account_name&&this.view.setBackButtonText("")},t.prototype.getItems=function(t,e){var n=this;this.dataProvider.getInvoices(this.params.account.id,!0,this.pager).subscribe(function(i){e?(n.is_empty=!i.length,clearTimeout(e),n.busy=!1,n.invoices=i):(r=n.invoices).push.apply(r,i),t&&(t.enable(i.length==n.LIMIT),t.complete()),n.count=i.length;var r},function(t){e&&(clearTimeout(e),n.busy=!1),console.log(t||"Server error")})},
t.prototype.doInfinite=function(t){return this.is_empty||this.count<this.LIMIT?(t.enable(!1),void t.complete()):(this.pager.page+=1,void this.getItems(t,null))},t.prototype.itemTapped=function(t){this.nav.push(c.InvoiceDetailsPage,t)},t.prototype.showUninvoiced=function(){this.nav.push(u.UnInvoicesPage,this.params)},t.prototype.setDate=function(t,e,n){return l.getDateTime(t||new Date,e,n)},t.prototype.getCurrency=function(t){return l.getCurrency(t)},t=i([o.Page({template:'<ion-navbar *navbar><button menuToggle><ion-icon name="menu"></ion-icon></button><ion-title class="padding-right24">Invoices {{params.account_name ? "of&nbsp;" + params.account.name : ""}}</ion-title></ion-navbar><ion-content padding><img *ngIf="busy" class="imglogo img-padding" src="img/loading2.gif"><div *ngIf="is_empty" class="table grey2 menu-text">No Invoices yet</div><div><ion-list class="invoices" padding><a detail-none href="#" ion-item (click)="itemTapped(invoice)" *ngFor="let invoice of invoices"><p>{{setDate(invoice.end_date || invoice.date, true)}}</p><h2>{{invoice.account_name || invoice.customer}}</h2><h4 item-right>{{getCurrency(invoice.total_cost)}}</h4></a></ion-list><ion-infinite-scroll (infinite)="doInfinite($event)" threshold="30%"><ion-infinite-scroll-content loadingSpinner="circles" loadingText="Loading more data..."></ion-infinite-scroll-content></ion-infinite-scroll></div></ion-content><button (click)="showUninvoiced()" secondary item-right fab fab-right fab-bottom style="z-index: 2"><ion-icon class="button_circle action-but" name="md-add"></ion-icon></button>',pipes:[a.MorePipe]}),r("design:paramtypes",[o.Nav,s.DataProvider,o.Config,o.NavParams,o.ViewController])],t)}();n.InvoicesPage=p},{"../../directives/helpers":14,"../../pipes/pipes":52,"../../providers/data-provider":55,"../invoice-details/invoice-details":21,"../uninvoices/uninvoices":44,"ionic-angular":431}],23:[function(t,e,n){"use strict";var i=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(3>o?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},r=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),s=t("../../providers/config"),a=t("../../directives/helpers"),c=t("../../providers/data-provider"),u=t("../organizations/organizations"),l=t("../signup/signup"),p=function(){function t(t,e,n,i){this.nav=t,this.dataProvider=e,this.config=n,this.events=i,this.google_action="",this.busy=!1,this.is_sd=s.isSD,this.fileDest={ticket:"wonvhr"},"true"!==localStorage.getItem("isPhonegap")&&(this.google_action=s.ApiSite+"auth/auth0"),"true"===localStorage.getItem("isExtension")&&window.top.postMessage("logout","*"),i.publish("app:logout")}return t.prototype.onPageLoaded=function(){document.title=s.AppTitle+"Mobile App",this.login={username:localStorage.getItem("username")||""}},t.prototype.onLogin=function(t){var e=this;this.busy=!0,t.valid?(localStorage.setItem("username",t.value.email||""),this.dataProvider.checkLogin(t.value.email,t.value.password).subscribe(function(t){e.config.setCurrent({key:t.api_token}),e.nav.setRoot(u.OrganizationsPage,null,{animation:"wp-transition"})},function(n){var i="There was a problem with your login.  Check your login and password.";t.value.email&&~t.value.email.indexOf("@gmail.com")&&(i="Wrong Password, maybe you used Google password"),e.nav.alert(i,!0),e.login.password="",e.busy=!1})):(this.nav.alert("Please enter email and password!",!0),this.busy=!1)},t.prototype.ngAfterViewInit=function(){},t.prototype.support=function(){a.openURLsystem("https://support."+s.Site+"portal/")},t.prototype.onGoogleSignin=function(){if("true"===localStorage.getItem("isPhonegap")){var t=a.openURL(s.ApiSite+"auth/auth0"),e=function(){location.href="index.html"};return t.addEventListener("loadstop",function(){var n=setInterval(function(){t.executeScript({code:"localStorage.getItem('isGoogle')"},function(i){var r=i[0];r&&(clearInterval(n),t.close(),e())})})}),void t.addEventListener("exit",e)}window.location.href=s.ApiSite+"auth/auth0"},t.prototype.onSignup=function(){this.nav.push(l.SignupPage,null,{animation:"wp-transition"})},t=i([o.Page({template:'<ion-content padding class="login"><div class="list max-width"><a title="Support Portal" (click)="support()"><img class="imglogo img-padding" src="img/logo.png"></a><form #loginForm="ngForm" novalidate><div class="tooltips"><input class="width100 blue3 subject-create commentText" type="email" [(ngModel)]="login.username" placeholder="email" ngControl="email" #username="ngForm" required pattern="^[^@\\s]+@[^@\\s]+(\\.[^@\\s]+)+$"> <span *ngIf="username.dirty && !username.valid">Valid Email is required</span></div><br><div class="tooltips"><input class="width100 blue3 subject-create commentText" [(ngModel)]="login.password" placeholder="password" ngControl="password" type="password" #password="ngForm" required> <span *ngIf="password.dirty && !password.valid">Password is required</span></div><br><button class="login-margin" [disabled]="!loginForm.valid || busy" (click)="onLogin(loginForm)" type="submit" block secondary>Login</button></form><br><template [ngIf]="is_sd == false"><div><ul class="googleStripes"><li></li><li></li><li></li><li></li></ul></div><button class="login-margin text-google itemTech grey3 itemTech2" (click)="onGoogleSignin()" block light><span>Sign in with&nbsp;<big>Google</big></span></button><br><button (click)="onSignup()" block dark class="login-margin">Create New Account</button></template></div></ion-content>'}),r("design:paramtypes",[o.Nav,c.DataProvider,o.Config,o.Events])],t)}();n.LoginPage=p},{"../../directives/helpers":14,"../../providers/config":54,"../../providers/data-provider":55,"../organizations/organizations":33,"../signup/signup":37,"ionic-angular":431}],24:[function(t,e,n){"use strict";var i=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(3>o?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},r=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),s=t("../../../providers/data-provider"),a=function(){function t(t,e,n,i,r){this.nav=t,this.navParams=e,this.dataProvider=n,this.config=i,this.viewCtrl=r,this.firstname_m="",t.swipeBackEnabled=!1}return t.prototype.ngOnInit=function(){this.ispassword=!0,this.data=(this.navParams.data||{}).type||{},this.firstname_m=(this.navParams.data||{}).name||" "},t.prototype.ngAfterViewInit=function(){this.firstname_m=this.firstname_m.trim()},t.prototype.dismissPage=function(t){this.viewCtrl.dismiss(t)},t.prototype.onSubmit=function(t){var e=this;t.valid&&this.dataProvider.addUser(t.value.email,t.value.firstname,t.value.lastname,this.data.type).subscribe(function(t){e.nav.alert(e.data.charAt(0).toUpperCase()+e.data.slice(1)+" was created :)"),setTimeout(function(){e.dismissPage(t)},1e3)},function(n){e.nav.alert(t.value.email+" already exists! Please try again",!0),console.log(n||"Server error")})},t=i([o.Page({template:'<ion-toolbar><ion-buttons start class="searchbar"><button (click)="dismissPage()"><span primary>Cancel</span></button></ion-buttons><ion-title>Add {{data != "tech" ? config.current.names.user.a : config.current.names.tech.a}}</ion-title></ion-toolbar><ion-content><ion-list class="list"><p class="general-alignment"></p><form #addForm="ngForm"><div class="tooltips"><input class="add-user-input" autofocus tabindex="1" type="email" [ngModel]="email_m" placeholder="Valid Email" ngControl="email" #username="ngForm" required pattern="^[^@\\s]+@[^@\\s]+(\\.[^@\\s]+)+$"> <span *ngIf="username.dirty && !username.valid">Valid Email is required</span></div><div class="tooltips"><input class="add-user-input" type="text" [ngModel]="firstname_m" placeholder="Firstname" ngControl="firstname" #firstname="ngForm" required> <span *ngIf="firstname.dirty && !firstname.valid">Firstname cannot be empty</span></div><div class="tooltips"><input class="add-user-input" type="text" [ngModel]="lastname_m" placeholder="Lastname" ngControl="lastname" #lastname="ngForm" required> <span *ngIf="lastname.dirty && !lastname.valid">Lastname cannot be empty</span></div><div class="img-top"><button [disabled]="!addForm.valid" secondary block (click)="onSubmit(addForm)" type="submit" class="disable-hover button button-default button-block">Add New {{data != "tech" ? "User" : "Tech"}}</button><br><button *ngIf="config.current.is_time_tracking" (click)="dismissPage()" block type="submit" class="blue2 disable-hover button button-default button-block class-margin">Cancel</button></div></form></ion-list></ion-content>'}),r("design:paramtypes",[o.Nav,o.NavParams,s.DataProvider,o.Config,o.ViewController])],t)}();n.AddUserModal=a},{"../../../providers/data-provider":55,"ionic-angular":431}],25:[function(t,e,n){"use strict";var i=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(3>o?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},r=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),s=t("../../../providers/api-data"),a=t("../../../providers/config"),c=t("../modals"),u=t("../../../directives/helpers"),l=function(){function t(t,e,n,i,r){this.nav=t,this.navParams=e,this.config=n,this.apiData=i,this.viewCtrl=r,this.isdefault_enabled=!1,this.isnew_enabled=!1,t.swipeBackEnabled=!1}return t.prototype.ngOnInit=function(){var t=this;if(this.term="",this.name=this.navParams.data.name||"List",this.isdefault_enabled=!~["user","account","tech","task type"].indexOf(this.name.toLowerCase()),this.isnew_enabled=!!~["user","tech"].indexOf(this.name.toLowerCase()),this.url=this.navParams.data.url||"",this.data=this.navParams.data.items||{},this.pager={limit:20},this.items=this.data,this.count=this.items.length,this.is_empty=!1,0===this.items.length){var e=setTimeout(function(){t.busy=!0},500);this.getItems(null,e)}},t.prototype.dismiss=function(t){t=t||{},this.viewCtrl.dismiss(t)},t.prototype.invite=function(){var t=this,e=o.Modal.create(c.AddUserModal,{type:this.name.toLowerCase(),name:this.term});e.onDismiss(function(e){e&&(e.name=u.getFullName(e.firstname,e.lastname,e.email),t.dismiss(e))}),this.nav.present(e)},t.prototype.searchItems=function(t){var e=this;this.items=this.data;var n=t.value.trim();if(""==n.trim()||this.busy)return void(""==n.trim()&&(this.is_empty=!this.items.length));if(n.length<3)this.items=this.items.filter(function(t){return t.name.toLowerCase().indexOf(n.toLowerCase())>-1}),this.is_empty=!this.items.length;else{var i=setTimeout(function(){e.busy=!0},500);this.getItems(n,i)}},t.prototype.getItems=function(t,e){var n=this;this.items=[],a.isSD&&~["location","account"].indexOf(this.name.toLowerCase())&&(t+="*"),this.apiData.getPaged(u.addp(this.url,"search",t),this.pager).subscribe(function(i){if(i.length&&!i[0].name){var r=[];i.forEach(function(t){var e;t.email&&(e=u.getFullName(t.firstname,t.lastname,t.email," ")),r.push({id:t.id,name:e})}),i=r}e&&(clearTimeout(e),n.busy=!1),n.is_empty=!i.length,t?n.items=i:n.items=n.data=i,n.count=i.length},function(t){e&&(clearTimeout(e),n.busy=!1),console.log(t||"Server error")})},t=i([o.Page({template:'<ion-toolbar><ion-buttons style="flex: 1;" start><button (click)="dismiss()"><span>Cancel</span></button></ion-buttons><ion-searchbar debounce="400" [(ngModel)]="term" (input)="searchItems($event)" placeholder="{{name}} (min 3 chars)" hideCancelButton="true"></ion-searchbar></ion-toolbar><ion-content><img *ngIf="busy" src="img/loading2.gif" class="imglogo img-padding"><ion-list class="ajax"><a *ngIf="isdefault_enabled" detail-none href="#" ion-item (click)="dismiss({name: \'Default\', id: 0})"><h2>Default (no selection)</h2></a> <a *ngIf="isnew_enabled" detail-none href="#" ion-item (click)="invite()"><h2><ion-icon name="add-circle"></ion-icon>&nbsp;&nbsp;&nbsp;Invite new {{name}} {{is_empty ? \'"\'+term+\'"\' : ""}}</h2></a> <a detail-none href="#" ion-item *ngFor="let item of items" (click)="dismiss(item)"><h2>{{item.name}}</h2></a></ion-list><div *ngIf="is_empty && !isdefault_enabled && !isnew_enabled" class="table grey2 menu-text">No {{name}} found yet</div></ion-content>'}),r("design:paramtypes",[o.Nav,o.NavParams,o.Config,s.ApiData,o.ViewController])],t)}();n.AjaxSelectModal=l},{"../../../directives/helpers":14,"../../../providers/api-data":53,"../../../providers/config":54,"../modals":29,"ionic-angular":431}],26:[function(t,e,n){"use strict";var i=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(3>o?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},r=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),s=t("../modals"),a=t("../../../directives/helpers"),c=function(){function t(t,e,n){this.nav=t,this.params=e,this.viewCtrl=n,this.searchQuery="",this.is_empty=!1,this.isdefault_enabled=!1,this.isnew_enabled=!1,this.name=this.params.data.name,this.isdefault_enabled=!~["user","account","tech","task type"].indexOf(this.name.toLowerCase()),this.isnew_enabled=!!~["user","tech"].indexOf(this.name.toLowerCase()),this.data=this.params.data.items,this.items=this.data}return t.prototype.dismiss=function(t){t=t||{},this.viewCtrl.dismiss(t)},t.prototype.invite=function(){var t=this,e=o.Modal.create(s.AddUserModal,{type:this.name.toLowerCase(),name:this.searchQuery});e.onDismiss(function(e){e&&(e.name=a.getFullName(e.firstname,e.lastname,e.email),t.dismiss(e))}),this.nav.present(e)},t.prototype.getItems=function(t){this.items=this.data;var e=t.value;""!=e.trim()&&(this.items=this.items.filter(function(t){return t.name.toLowerCase().indexOf(e.toLowerCase())>-1}),this.is_empty=!this.items.length)},t=i([o.Page({template:'<ion-toolbar><ion-buttons style="flex: 1;" start><button (click)="dismiss()"><span>Cancel</span></button></ion-buttons><ion-searchbar [ngModel]="searchQuery" (input)="getItems($event)" [placeholder]="name" hideCancelButton="true"></ion-searchbar></ion-toolbar><ion-content><ion-list class="basic-list"><a *ngIf="isdefault_enabled" detail-none href="#" ion-item (click)="dismiss({name: \'Default\', id: 0})"><h2>Default (no selection)</h2></a> <a *ngIf="isnew_enabled" detail-none href="#" ion-item (click)="invite()"><h2><ion-icon name="add-circle"></ion-icon>&nbsp;&nbsp;&nbsp;Invite new {{name}} {{is_empty ? \'"\'+searchQuery+\'"\' : ""}}</h2></a> <a detail-none href="#" ion-item *ngFor="let item of items" (click)="dismiss(item)"><h2>{{item.name}}</h2></a></ion-list><div *ngIf="is_empty && !isdefault_enabled && !isnew_enabled" class="table grey2 menu-text">No {{name}} found yet</div></ion-content>'}),r("design:paramtypes",[o.Nav,o.NavParams,o.ViewController])],t)}();n.BasicSelectModal=c},{"../../../directives/helpers":14,"../modals":29,"ionic-angular":431}],27:[function(t,e,n){"use strict";var i=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(3>o?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},r=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),s=t("@angular/core"),a=t("../../../providers/ticket-provider"),c=t("../../../providers/api-data"),u=t("../../../directives/helpers"),l=t("../../../components/select-list/select-list"),p=function(){function t(t,e,n,i,r,o){this.nav=t,this.navParams=e,this.apiData=n,this.ticketProvider=i,this.config=r,this.viewCtrl=o,t.swipeBackEnabled=!1,this.config=r}return t.prototype.ngOnInit=function(){var t=this;this.isconfirm=!0,this.ticket=this.navParams.data||0,this.categories=[],this.selects={resolution:{name:"Resolution",value:"Resolved",selected:1,hidden:!1,items:[{name:"Resolved",id:1},{name:"UnResolved",id:0}]},category:{name:"Category",value:"Choose",selected:0,hidden:!1,items:[]}},this.config.current.is_resolution_tracking&&this.apiData.get("resolution_categories").subscribe(function(e){t.categories=e,t.selects.category.items=e.filter(function(t){return t.is_resolved}),t.selects.category.hidden=!t.selects.category.items.length},function(t){console.log(t||"Server error")})},t.prototype.dismiss=function(t){this.viewCtrl.dismiss(t||0)},t.prototype.saveSelect=function(t){var e=t.type;this.selects[e].selected=t.id,this.selects[e].value=t.name,"resolution"==e&&(this.selects.category.value="Choose",this.selects.category.selected=0,this.selects.category.items=this.selects.resolution.selected?this.categories.filter(function(t){return t.is_resolved}):this.categories.filter(function(t){return!t.is_resolved}),this.selects.category.hidden=!this.selects.category.items.length)},t.prototype.onSubmit=function(t){var e=this;if(t.valid){var n=u.htmlEscape((this.ticketnote||"").trim()).substr(0,5e3);if(this.config.current.is_ticket_require_closure_note&&!n.length)return void this.nav.alert("Note is required!",!0);var i={status:"closed",note_text:n,is_send_notifications:!0,resolved:1==this.selects.resolution.selected,resolution_id:this.selects.category.selected,confirmed:this.isconfirm,confirm_note:""};this.ticketProvider.closeOpenTicket(this.ticket.key,i).subscribe(function(t){e.nav.alert("Ticket has been closed :)"),e.dismiss(1)},function(t){console.log(t||"Server error")})}},t=i([o.Page({template:'<ion-toolbar><ion-buttons start class="searchbar"><button (click)="dismiss()"><span primary>Cancel</span></button></ion-buttons><ion-title class="ellipsis padding-right24 padding-left87">Close {{config.current.names.ticket.s}} #{{ticket.number}} {{ticket.subject}}</ion-title></ion-toolbar><ion-content class="has-header"><div class="list max-width700 general-alignment"><select-list [list]="selects.resolution" preload="true" (onChanged)="saveSelect($event)"></select-list><select-list [list]="selects.category" preload="true" (onChanged)="saveSelect($event)"></select-list><form #addForm="ngForm" class="response-ticket"><template [ngIf]="config.current.is_confirmation_tracking"><ion-item no-lines class="left toggle-width"><ion-toggle class="toggle" [(ngModel)]="isconfirm" disabled="false"></ion-toggle></ion-item><p class="left width35 text-toggle color">Confirm Now?</p></template><div class="tooltips"><textarea class="width100 textLogin commentText" [(ngModel)]="ticketnote" type="text" placeholder="Add closing comments" ngControl="note" #note="ngForm" maxlength="4000"></textarea> <span [hidden]="note.valid || note.untouched">Note should be less 5000 chars</span></div><button secondary class="button_reply img-top right" [disabled]="!addForm.valid" (click)="onSubmit(addForm)" type="submit">Close {{config.current.names.ticket.s}}</button></form></div></ion-content>',directives:[s.forwardRef(function(){return l.SelectListComponent})]}),r("design:paramtypes",[o.Nav,o.NavParams,c.ApiData,a.TicketProvider,o.Config,o.ViewController])],t)}();n.CloseTicketModal=p},{"../../../components/select-list/select-list":8,"../../../directives/helpers":14,"../../../providers/api-data":53,"../../../providers/ticket-provider":58,"@angular/core":193,"ionic-angular":431}],28:[function(t,e,n){"use strict";var i=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(3>o?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},r=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),s=t("../../../providers/api-data"),a=t("../../../providers/config"),c=t("../../../directives/helpers"),u=t("../modals"),l=function(){function t(t,e,n,i,r){this.nav=t,this.navParams=e,this.config=n,this.apiData=i,this.viewCtrl=r,this.isdefault_enabled=!1,this.isnew_enabled=!1,t.swipeBackEnabled=!1}return t.prototype.ngOnInit=function(){var t=this;if(this.term="",this.name=this.navParams.data.name||"List",this.isdefault_enabled=!~["user","account","tech","task type"].indexOf(this.name.toLowerCase()),this.isnew_enabled=!!~["user","tech"].indexOf(this.name.toLowerCase()),this.url=this.navParams.data.url||"",this.data=this.navParams.data.items||{},this.items=this.data,this.count=this.items.length,this.isbutton=this.navParams.data.isbutton,this.is_empty=!1,this.pager={page:0,limit:25},0===this.items.length){var e=setTimeout(function(){t.busy=!0},500);this.getItems("",null,e)}},t.prototype.dismiss=function(t){t=t||{},this.viewCtrl.dismiss(t)},t.prototype.invite=function(){var t=this,e=o.Modal.create(u.AddUserModal,{type:this.name.toLowerCase(),name:this.term});e.onDismiss(function(e){e&&(e.name=c.getFullName(e.firstname,e.lastname,e.email),t.dismiss(e))}),this.nav.present(e)},t.prototype.searchItems=function(t){var e=this;this.items=this.data;var n=t.value.trim();if(""==n.trim()||this.busy)return void(""==n.trim()&&(this.is_empty=!this.items.length));if(this.date=Date.now(),n.length<3)this.items=this.items.filter(function(t){return t.name.toLowerCase().indexOf(n.toLowerCase())>-1}),this.is_empty=!this.items.length;else{var i=setTimeout(function(){e.busy=!0},500);this.getItems(n,null,i)}},t.prototype.getItems=function(t,e,n){var i=this,r={page:this.pager.page,limit:this.pager.limit},o=t;t.length>2&&(r.page=0),a.isSD&&~["location","account"].indexOf(this.name.toLowerCase())&&(o=t+"*"),this.apiData.getPaged(c.addp(this.url,"search",o),r).subscribe(function(r){if(r.length&&!r[0].name){var o=[];r.forEach(function(t){var e;t.email?e=c.getFullName(t.firstname,t.lastname,t.email,i.isbutton?"":" "):t.number&&(e="#"+t.number+": "+t.subject),o.push({id:t.id,name:e})}),r=o}n&&(i.is_empty=!r.length,clearTimeout(n),i.busy=!1),i.count=25,!t||t.length<3?(n?i.data=r:(s=i.data).push.apply(s,r),e&&e.enable(25==r.length),i.count=r.length,i.searchItems({value:t})):r.length?i.items=r:i.items=i.data,e&&e.complete();var s},function(t){n&&(clearTimeout(n),i.busy=!1),console.log(t||"Server error")})},t.prototype.doInfinite=function(t){return this.date&&Date.now()-this.date<1e3?void t.complete():this.is_empty||this.count<25?(t.complete(),void((this.is_empty&&!this.term||this.count<25)&&t.enable(!1))):(this.pager.page+=1,this.term="",void this.getItems("",t))},t=i([o.Page({template:'<ion-toolbar><ion-buttons style="flex: 1;" start><button (click)="dismiss()"><span>Cancel</span></button></ion-buttons><ion-searchbar debounce="400" [(ngModel)]="term" (input)="searchItems($event)" placeholder="{{name}} (min 3 chars)" hideCancelButton="true"></ion-searchbar></ion-toolbar><ion-content class="has-header"><img *ngIf="busy" class="imglogo img-padding" src="img/loading2.gif"><ion-list class="list"><a *ngIf="isdefault_enabled" detail-none href="#" ion-item class="basic-margin text-left" (click)="dismiss({name: \'Default (no selection)\', id: 0})"><h2 class="color">Default (no selection)</h2></a> <a *ngIf="isnew_enabled" detail-none href="#" ion-item (click)="invite()"><h2><ion-icon name="add-circle"></ion-icon>&nbsp;&nbsp;&nbsp;Invite new {{name}} {{is_empty ? \'"\'+term+\'"\' : ""}}</h2></a> <a detail-none href="#" ion-item class="basic-margin text-left" *ngFor="let item of items" (click)="dismiss(item)"><h2 class="color">{{item.name}}</h2></a></ion-list><div *ngIf="is_empty && !isdefault_enabled && !isnew_enabled" class="table grey2 menu-text">No {{name}} found yet</div><ion-infinite-scroll (infinite)="doInfinite($event)" threshold="30%"><ion-infinite-scroll-content loadingSpinner="circles" loadingText="Loading more data..."></ion-infinite-scroll-content></ion-infinite-scroll></ion-content>'}),r("design:paramtypes",[o.Nav,o.NavParams,o.Config,s.ApiData,o.ViewController])],t)}();n.InfinitySelectModal=l},{"../../../directives/helpers":14,"../../../providers/api-data":53,"../../../providers/config":54,"../modals":29,"ionic-angular":431}],29:[function(t,e,n){"use strict";function i(t){for(var e in t)n.hasOwnProperty(e)||(n[e]=t[e])}i(t("./basic-select/basic-select")),i(t("./ajax-select/ajax-select")),i(t("./infinity-select/infinity-select")),i(t("./close-ticket/close-ticket")),i(t("./tree-modal/tree-modal")),i(t("./ticket-create/ticket-create")),i(t("./add-user/add-user")),i(t("./privacy/privacy"))},{"./add-user/add-user":24,"./ajax-select/ajax-select":25,"./basic-select/basic-select":26,"./close-ticket/close-ticket":27,"./infinity-select/infinity-select":28,"./privacy/privacy":30,"./ticket-create/ticket-create":31,"./tree-modal/tree-modal":32}],30:[function(t,e,n){"use strict";var i=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(3>o?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},r=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),s=function(){function t(t,e){this.nav=t,this.viewCtrl=e,t.swipeBackEnabled=!1}return t.prototype.dismiss=function(t){this.viewCtrl.dismiss()},t=i([o.Page({template:'<ion-toolbar><ion-buttons start><button nav-pop><span primary>Cancel</span></button></ion-buttons></ion-toolbar><ion-content padding><div class="list max-width"><img class="imglogo img-padding" src="img/logo.png"><div><p class="margin-top0">When you register for a SherpaDesk trial you can be certain that we have implemented comprehensive security practices to ensure that only you and those people you provide authorized access to can see your help desk. We respect your right to privacy and feel it is important for you to know how we handle the information we receive from you via our website at http:www.sherpadesk.com (the Site) and through our on-demand support platform, tools and services offered on the Site (the Service).</p><h4>Information you Provide</h4><p class="margin-top0">When you register for the Service, we ask for information such as your name, e-mail address, company name and address. bigWebApps uses a third-party intermediary to manage credit card processing. This intermediary is not permitted to store, retain, or use your billing information except for the sole purpose of credit card processing on bigWebApps behalf.</p><p class="margin-top0">bigWebApps practice is not to use such personal information for marketing purposes. bigWebApps may use the collected personal information and other information bigWebApps collects about your use of the Service to operate and make the Service available to you, for billing, identification and authentication, to contact you about your use of the Service, research purposes and to generally improve the content and functionality of the Service and Site.</p><p>bigWebApps may also transmit or share your personal information with its third party vendors and hosting partners to provide the necessary hardware, software, networking, storage, and other technology and services required to operate and maintain the Service, which may require that your personal information be transferred from your current location to the offices and servers of bigWebApps and the authorized third parties referred to here. Although bigWebApps owns the software, code, databases, all rights to the SherpaDesk application, you retain all rights to your data.</p><h4>Cookies</h4><p class="margin-top0">When you visit the Site or use the Service, we use session cookies  a piece of information stored on your computer  to allow the Site or Service to uniquely identify your browser while you are logged in and to enable bigWebApps to process your online transactions. Session cookies also help us confirm your identity and are required in order to use the Service. SherpaDesk uses persistent cookies that only SherpaDesk can read and use, to identify you as a SherpaDesk customer and make it easier for you to log in to the Service. Users who disable their web browsers ability to accept cookies will be able to browse our Site, but will not be able to access or take advantage of the Service.</p><h4>Information Sharing</h4><p class="margin-top0">Except as described in this policy, bigWebApps will not give, sell, rent, or loan any identifiable personal information to any third party. We may disclose such information to respond to subpoenas, court orders, or legal process, or to establish or exercise our legal rights or defend against legal claims. We may also share such information if we believe it is necessary in order to investigate, prevent, or take action regarding illegal activities, suspected fraud, situations involving potential threats to the physical safety of any person, violations of our Terms of Service, or as otherwise required by law. bigWebApps may also provide non-personal, summary or group statistics about our customers, sales, traffic patterns, and related Site information to reputable third-party vendors, but these statistics will include no personally identifying information.</p><h4>Childrens Personal Information</h4><p class="margin-top0">The Service and Site are not intended for, nor does bigWebApps knowingly collect any personally identifiable information from children under the age of 13.</p><h4>Protection of Information</h4><p class="margin-top0">bigWebApps maintains reasonable security measures to protect your information from loss, destruction, misuse, unauthorized access or disclosure. These technologies help ensure that your data is safe, secure, and only available to you and to those you provided authorized access. However, no data transmission over the Internet or information storage technology can be guaranteed to be 100% secure.</p><h4>Changes to Privacy Policy</h4><p class="margin-top0">bigWebApps may update this policy from time to time. You can review the most current version of this privacy policy at any time at http://www.sherpadesk.com/privacy. Your continued use of the Site or Service constitutes your agreement to be bound by such changes to the privacy policy. Your only remedy, if you do not accept the terms of this privacy policy, is to discontinue use of the Site and Service.</p><h4>Business Transactions</h4><p class="margin-top0">bigWebApps may assign or transfer this privacy policy, and your user account and related information and data, to any person or entity that acquires or is merged with SherpaDesk.</p><h4>Terms of Service</h4><p class="margin-top0">When you access and use the Service, you are subject to the SherpaDesk Terms of Service.</p><h4>Contact Us</h4><p class="margin-top0">If you have questions regarding this privacy policy or about the security practices of bigWebApps, please contact us by email at corporate@bigwebapps.com.</p></div></div></ion-content>'}),r("design:paramtypes",[o.Nav,o.ViewController])],t);
}();n.PrivacyModal=s},{"ionic-angular":431}],31:[function(t,e,n){"use strict";var i=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(3>o?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},r=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),s=t("@angular/core"),a=t("../../../providers/providers"),c=t("../../../directives/helpers"),u=t("../../../components/class-list/class-list"),l=t("../../../components/select-list/select-list"),p=t("../../../pages/ticket-details/ticket-details"),h=function(){function t(t,e,n,i,r){this.nav=t,this.navParams=e,this.ticketProvider=n,this.config=i,this.viewCtrl=r,this.fileDest={ticket:"11"},this.files=[],t.swipeBackEnabled=!1}return t.prototype.ngOnInit=function(){this.he=this.config.getCurrent("user"),this.data=this.navParams.data||{};var t={};this.data.account||(t=this.config.current.recent||{});var e=(this.data.account||{}).id||(t.account||{}).selected||this.he.account_id||-1;this.selects={user:{name:"User",value:c.getFullName(this.he.firstname,this.he.lastname,this.he.email),selected:this.he.user_id,url:"users",hidden:!1},location:{name:"Location",value:(t.location||{}).value||"Default",selected:(t.location||{}).selected||0,url:"locations?account="+e,hidden:!1},project:{name:"Project",value:(t.project||{}).value||"Default",selected:(t.project||{}).selected||0,url:"projects?account="+e+"&is_with_statistics=false",hidden:!1},"class":{name:"Class",value:(t["class"]||{}).value||"Default",selected:(t["class"]||{}).selected||0,url:"classes",hidden:!1}},this.selects.tech={name:"Tech",value:(this.data.tech||{}).name||"Default",selected:(this.data.tech||{}).id||0,url:"technicians",hidden:!1},this.selects.account={name:"Account",value:(this.data.account||{}).name||(t.account||{}).value||this.he.account_name,selected:e,url:"accounts?is_with_statistics=false",hidden:!1},this.ticket={subject:"",initial_post:"",class_id:null,account_id:e,location_id:null,user_id:this.he.user_id,tech_id:0}},t.prototype.dismissPage=function(t){t&&this.nav.alert(this.config.current.names.ticket.s+" was Succesfully Created :)"),this.viewCtrl.dismiss(t)},t.prototype.saveSelect=function(t){var e=t.type;switch(this.selects[e].selected=t.id,this.selects[e].value=t.name,e){case"account":this.selects.project.url="projects?account="+t.id+"&is_with_statistics=false",this.selects.project.value="Default",this.selects.project.selected=0,this.selects.location.url="locations?account="+t.id,this.selects.location.value="Default",this.selects.location.selected=0}},t.prototype.uploadedFile=function(t){this.dismissPage(this.ticket)},t.prototype.selectedFile=function(t){this.files=t,this.ticket.initial_post=this.ticket.initial_post.trim(),t.length&&!this.ticket.initial_post&&(this.ticket.initial_post="  ")},t.prototype.onSubmit=function(t){var e=this;if(t.valid){if(this.ticket.in_progress&&Date.now()-this.ticket.in_progress<1500)return;this.ticket.in_progress=Date.now(),this.ticket.subject=c.htmlEscape(this.ticket.subject.trim()),this.ticket.initial_post=c.htmlEscape(this.ticket.initial_post.trim()).substr(0,4500),this.files.length&&(this.ticket.initial_post+="\n\nFollowing file"+(this.files.length>1?"s were":" was")+" uploaded: "+this.files.join(", ")+"."),this.ticket.class_id=this.selects["class"].selected,this.ticket.account_id=this.selects.account.selected,this.ticket.location_id=this.selects.location.selected,this.ticket.user_id=this.he.is_techoradmin?this.selects.user.selected:this.he.user_id,this.ticket.tech_id=this.selects.tech.selected,this.ticketProvider.addTicket(this.ticket).subscribe(function(t){e.data.account||e.config.setRecent({account:e.selects.account,location:e.selects.location,project:e.selects.project,"class":e.selects["class"]}),e.files.length?(e.ticket=t,e.fileDest.ticket=t.key,e.uploadComponent.onUpload()):e.dismissPage(t)},function(t){e.nav.alert(e.he.is_techoradmin?"Please select "+e.config.current.names.tech.s:t,!0),console.log(t||"Server error")})}},i([s.ViewChild(p.UploadButtonComponent),r("design:type",p.UploadButtonComponent)],t.prototype,"uploadComponent",void 0),t=i([o.Page({template:'<ion-toolbar><ion-buttons start class="searchbar"><button (click)="dismissPage()"><span primary>Cancel</span></button></ion-buttons><ion-title>New {{config.current.names.ticket.s}}</ion-title></ion-toolbar><ion-content><div class="list max-width700 margin-top-5"><template [ngIf]="config.current.user.is_techoradmin"><select-list ajax="true" [list]="selects.user" (onChanged)="saveSelect($event)" preload="true"></select-list><select-list [list]="selects.account" preload="true" ajax="true" (onChanged)="saveSelect($event)"></select-list><select-list [list]="selects.location" preload="true" ajax="true" (onChanged)="saveSelect($event)"></select-list><select-list [list]="selects.project" preload="true" (onChanged)="saveSelect($event)"></select-list><class-list preload="true" [list]="selects.class" (onChanged)="saveSelect($event)"></class-list><select-list is_me="true" [list]="selects.tech" ajax="true" preload="true" (onChanged)="saveSelect($event)"></select-list></template></div><form margin-top class="container_list" #addForm="ngForm"><div class="list max-width700"><div class="tooltips"><input class="width100 blue3 subject-create commentText margin-bottom3" [(ngModel)]="ticket.subject" placeholder="Subject" ngControl="subject" #subject="ngForm" required maxlength="100"> <span [hidden]="subject.valid || subject.untouched">Subject is required and less 100 chars</span></div><br><textarea class="width100 textLogin commentText margin-bottom1" type="text" [(ngModel)]="ticket.initial_post" ngControl="text" #note="ngForm" placeholder="Details..."></textarea><br><upload-button #u (filesUploaded)="uploadedFile($event)" (filesSelected)="selectedFile($event)" [fileDest]="fileDest"></upload-button><button [disabled]="!addForm.valid" secondary block (click)="onSubmit(addForm)" type="submit" class="disable-hover button button-default button-block">Add Ticket</button> <span class="span-block"></span></div></form></ion-content>',directives:[s.forwardRef(function(){return u.ClassListComponent}),s.forwardRef(function(){return l.SelectListComponent}),p.UploadButtonComponent]}),r("design:paramtypes",[o.Nav,o.NavParams,a.TicketProvider,o.Config,o.ViewController])],t)}();n.TicketCreatePage=h},{"../../../components/class-list/class-list":4,"../../../components/select-list/select-list":8,"../../../directives/helpers":14,"../../../pages/ticket-details/ticket-details":38,"../../../providers/providers":57,"@angular/core":193,"ionic-angular":431}],32:[function(t,e,n){"use strict";var i=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(3>o?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},r=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),s=t("../../../components/tree-view/tree-view"),a=function(){function t(t,e){this.params=t,this.viewCtrl=e,this.name=this.params.data.name,this.Nodes=this.params.data.items}return t.prototype.onSelectNode=function(t){this.selectedNode=t},t.prototype.onRequest=function(t){},t.prototype.dismiss=function(t){var e={};this.selectedNode&&!t&&(e={id:this.selectedNode.id,name:this.selectedNode.name}),this.viewCtrl.dismiss(e)},t=i([o.Page({template:'<ion-toolbar><ion-buttons start><button (click)="dismiss(\'1\')"><span primary>Cancel</span></button></ion-buttons><ion-buttons end style="flex: 1;"><button (click)="dismiss()"><span primary>Select</span></button></ion-buttons></ion-toolbar><ion-content class="has-header"><div class="basic-margin class-list list"><tree-view [Nodes]="Nodes" [SelectedNode]="selectedNode" (onSelectedChanged)="onSelectNode($event)"></tree-view></div></ion-content>',directives:[s.TreeViewComponent]}),r("design:paramtypes",[o.NavParams,o.ViewController])],t)}();n.TreeModal=a},{"../../../components/tree-view/tree-view":11,"ionic-angular":431}],33:[function(t,e,n){"use strict";var i=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(3>o?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},r=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),s=t("../../providers/data-provider"),a=t("../../providers/ticket-provider"),c=t("../../providers/time-provider"),u=t("../../providers/config"),l=t("../../directives/helpers"),p=t("../login/login"),h=function(){function t(t,e,n,i,r,o){var s=this;this.nav=t,this.dataProvider=e,this.config=n,this.events=i,this.ticketProvider=r,this.timeProvider=o,this.list=[];var a=this.config.getCurrent("key");i.publish("app:logout",a),this.ticketProvider._dataStore={all:[],alt:[],tech:[],user:[]},this.dataProvider._dataStore=this.timeProvider._dataStore={},"true"===localStorage.getItem("isExtension")&&window.top.postMessage("logout","*"),this.dataProvider.getOrganizations(a).subscribe(function(t){var e=localStorage.getItem("loadOrgKey")||"";e&&localStorage.setItem("loadOrgKey","");var n=e?t.filter(function(t){return t.key==e}):null;if(n&&(t=n),1==t.length){if(1==t[0].instances.length)return s.config.setCurrent({is_multiple_org:!1}),void s.onSelectInst({org:t[0].key,inst:t[0].instances[0].key});s.list=t,s.toggle(t[0],0)}else s.list=t;s.config.setCurrent({is_multiple_org:!0})},function(t){s.nav.alert("Cannot get list of Organizations",!0),s.config.clearCurrent(),s.nav.setRoot(p.LoginPage,null,{animation:"wp-transition"})})}return t.prototype.onPageLoaded=function(){document.title="Organizations : "+document.title},t.prototype.toggle=function(t,e){return 1==t.instances.length?void this.onSelectInst({org:t.key,inst:t.instances[0].key}):(this.list.forEach(function(t,e){return t.expanded=!1}),void(this.list[e].expanded=!this.list[e].expanded))},t.prototype.support=function(){l.openURLsystem("https://support."+u.Site+"portal/")},t.prototype.alertOrg=function(t){this.nav.alert(t+" has expired or inactivated. Contact SherpaDesk for assistance. Email: support@sherpadesk.com Phone: +1 (866) 996-1200, then press 2",!0)},t.prototype.onSelectInst=function(t){var e=o.Loading.create({content:"Loading configuration...",duration:3e3,dismissOnPageChange:!0});this.nav.present(e),this.config.setCurrent({org:t.org,instance:t.inst}),this.events.publish("config:get",!0)},t=i([o.Page({template:'<ion-content padding class="organizations"><ion-list class="list max-width" no-lines><a title="Support Portal" (click)="support()"><img class="imglogo img-padding" src="img/logo.png"></a><div *ngFor="let org of list; let i = index"><a detail-none href="#" ion-item [hidden]="!org.is_expired && org.instances.length" class="blue1 org expired" (click)="alertOrg(org.name)">{{org.name}} (Expired)</a> <a detail-none href="#" ion-item [hidden]="org.is_expired || !org.instances.length" class="blue1 org" (click)="toggle(org, i)"><ion-label class="padding-left8">{{org.name}} {{org.instances.length == 1 ? org.instances[0].name : \'\' }}</ion-label></a><div *ngIf="org.expanded && org.instances.length > 1"><a detail-none href="#" ion-item *ngFor="let inst of org.instances" (click)="onSelectInst({org: org.key, inst: inst.key})" class="inst org2"><ion-label class="padding-left8">{{inst.name}}</ion-label></a></div></div></ion-list></ion-content>'}),r("design:paramtypes",[o.Nav,s.DataProvider,o.Config,o.Events,a.TicketProvider,c.TimeProvider])],t)}();n.OrganizationsPage=h},{"../../directives/helpers":14,"../../providers/config":54,"../../providers/data-provider":55,"../../providers/ticket-provider":58,"../../providers/time-provider":59,"../login/login":23,"ionic-angular":431}],34:[function(t,e,n){"use strict";function i(t){for(var e in t)n.hasOwnProperty(e)||(n[e]=t[e])}i(t("./account-details/account-details")),i(t("./accounts/accounts")),i(t("./ajax-search/ajax-search")),i(t("./dashboard/dashboard")),i(t("./expense-create/expense-create")),i(t("./expenses/expenses")),i(t("./invoice-details/invoice-details")),i(t("./invoices/invoices")),i(t("./login/login")),i(t("./organizations/organizations")),i(t("./queue-tickets/queue-tickets")),i(t("./queues/queues")),i(t("./signup/signup")),i(t("./ticket-details/ticket-details")),i(t("./tickets/tickets")),i(t("./timelog/timelog")),i(t("./timelogs/timelogs")),i(t("./uninvoices/uninvoices")),i(t("./todos/todos")),i(t("./todo-create/todo-create"))},{"./account-details/account-details":15,"./accounts/accounts":16,"./ajax-search/ajax-search":17,"./dashboard/dashboard":18,"./expense-create/expense-create":19,"./expenses/expenses":20,"./invoice-details/invoice-details":21,"./invoices/invoices":22,"./login/login":23,"./organizations/organizations":33,"./queue-tickets/queue-tickets":35,"./queues/queues":36,"./signup/signup":37,"./ticket-details/ticket-details":38,"./tickets/tickets":39,"./timelog/timelog":40,"./timelogs/timelogs":41,"./todo-create/todo-create":42,"./todos/todos":43,"./uninvoices/uninvoices":44}],35:[function(t,e,n){"use strict";var i=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(3>o?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},r=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),s=t("../modals/modals"),a=t("../ticket-details/ticket-details"),c=t("../../components/tickets-list/tickets-list"),u=function(){function t(t,e,n,i){this.nav=t,this.navParams=e,this.view=n,this.config=i,this.queue=this.navParams.data}return t.prototype.onPageWillEnter=function(){this.view.setBackButtonText("")},t.prototype.addTicket=function(){var t=this,e=o.Modal.create(s.TicketCreatePage,{tech:{id:this.queue.id,name:"Queue "+this.queue.fullname}});e.onDismiss(function(e){e&&setTimeout(function(){t.queue.tickets_count+=1,t.nav.push(a.TicketDetailsPage,e)},500)}),this.nav.present(e)},t=i([o.Page({template:'<ion-navbar *navbar><button menuToggle><ion-icon name="menu"></ion-icon></button><ion-title class="padding-right24">{{config.current.names.ticket.p}} of&nbsp;{{queue.fullname}} Queue</ion-title></ion-navbar><div class="queues mycontent"><tickets-list [mode]="[\'queue\', queue.id]" [count]="queue.tickets_count"></tickets-list></div><button (click)="addTicket()" secondary item-right fab fab-right fab-bottom style="z-index: 2"><ion-icon class="button_circle action-but" name="md-add"></ion-icon></button>',directives:[c.TicketsListComponent]}),r("design:paramtypes",[o.Nav,o.NavParams,o.ViewController,o.Config])],t)}();n.QueueTicketsPage=u},{"../../components/tickets-list/tickets-list":9,"../modals/modals":29,"../ticket-details/ticket-details":38,"ionic-angular":431}],36:[function(t,e,n){"use strict";var i=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(3>o?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},r=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),s=t("../../providers/data-provider"),a=t("../../components/components"),c=function(){function t(t,e){this.nav=t,this.dataProvider=e}return t.prototype.onPageLoaded=function(){var t=this;this.dataProvider.getQueueList().subscribe(function(e){t.queues=e},function(t){console.log(t||"Server error")})},t=i([o.Page({template:'<ion-navbar *navbar><button menuToggle><ion-icon name="menu"></ion-icon></button><ion-title>Queues</ion-title></ion-navbar><ion-content class="queues"><p class="general-alignment"></p><queues-list margin-top [queues]="queues" [simple]="true"></queues-list><span class="span-block"></span></ion-content><action-button></action-button>',directives:[a.QueuesListComponent,a.ActionButtonComponent]}),r("design:paramtypes",[o.Nav,s.DataProvider])],t)}();n.QueuesPage=c},{"../../components/components":5,"../../providers/data-provider":55,"ionic-angular":431}],37:[function(t,e,n){"use strict";var i=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(3>o?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},r=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),s=t("../../directives/helpers"),a=t("../../providers/data-provider"),c=t("../login/login"),u=t("../organizations/organizations"),l=t("../modals/modals"),p=function(){function t(t,e,n,i){this.nav=t,this.dataProvider=e,this.config=n,this.events=i,this.login={},this.is_force_registration=!1}return t.prototype.onPageLoaded=function(){this.is_force_registration=!1},t.prototype.getUrl=function(t){this.login.name=t.value||"",this.login.url=t.value?t.value.toLowerCase().replace(/[^a-zA-Z0-9-]/g,""):""},t.prototype.onSignup=function(t){var e=this;if(t.valid){var n={name:t.value.name,email:t.value.email,url:t.value.url,is_force_registration:this.is_force_registration,is_force_redirect:!1,firstname:t.value.firstname,lastname:t.value.lastname,password:t.value.password,password_confirm:t.value.password_confirm,how:t.value.how,note:"true"===localStorage.getItem("isPhonegap")?"registered by iPhone app":"registered from m.sherpadesk.com"};this.dataProvider.registerOrganization(n).subscribe(function(n){return n.api_token?n.organization&&n.instance?(e.config.setCurrent({key:n.api_token,org:n.organization,instance:n.instance}),s.spicePixelTrackConversion(),s.getappTrackConversion(t.value.url),e.nav.alert("Thanks for registration! You are redirected to new org now ..."),void setTimeout(function(){return e.events.publish("config:get",!0)},3e3)):void e.nav.setRoot(u.OrganizationsPage,null,{animation:"wp-transition"}):void e.nav.setRoot(c.LoginPage,null,{animation:"wp-transition"})},function(t){~t.toString().indexOf("409")?e.presentConfirm():e.nav.alert(t,!0)})}else this.nav.alert("Please fill the form!",!0)},t.prototype.presentConfirm=function(){var t=this,e=o.Alert.create({title:"Wait. Haven't I seen you?",subTitle:"This email is already in use.",message:"Would you like to",cssClass:"hello",buttons:[{text:"Login",role:"cancel",handler:function(){return localStorage.setItem("username",t.login.email||""),e.dismiss().then(function(){t.nav.setRoot(c.LoginPage,null,{animation:"wp-transition"})}),!1}},{text:"Create New Org",handler:function(){var n=e.dismiss();return t.is_force_registration=!0,n.then(function(){var e={valid:!0,value:t.login};t.onSignup(e)}),!1}}]});this.nav.present(e)},t.prototype.onGoogleSignip=function(){this.nav.setRoot(t),{animation:"wp-transition"}},t.prototype.gotoPrivacy=function(){this.nav.present(o.Modal.create(l.PrivacyModal))},t.prototype.onCancel=function(){this.nav.setRoot(c.LoginPage,null,{animation:"wp-transition"})},t=i([o.Page({template:'<ion-content padding class="signup"><div class="list max-width"><img class="imglogo img-padding" src="img/logo.png"><form #loginForm="ngForm" novalidate><div class="tooltips"><input autofocus class="width100 blue3 subject-create commentText" [ngModel]="login.name" (ngModelChange)="getUrl(name)" ngControl="name" #name="ngForm" required minlength="3" placeholder="Company name (required)"> <span *ngIf="name.dirty && !name.valid">Name is required</span></div><div class="tooltips"><input class="width100 blue3 subject-create commentText" type="email" [(ngModel)]="login.email" ngControl="email" #username="ngForm" required pattern="^[^@\\s]+@[^@\\s]+(\\.[^@\\s]+)+$" placeholder="Email (required)"> <span *ngIf="username.dirty && !username.valid">Valid Email is required</span></div><div class="tooltips"><div class="width21 left signup-font">https://</div><input class="width30 blue3 subject-create commentText left padding5" [(ngModel)]="login.url" ngControl="url" placeholder="Company url (optional)"><div class="text-right right width48 signup-font ellipsis">.sherpadesk.com</div></div><div class="tooltips"><input class="width100 blue3 subject-create commentText" [(ngModel)]="login.firstname" ngControl="firstname" #firstname="ngForm" required minlength="3" placeholder="First Name (required)"> <span *ngIf="firstname.dirty && !firstname.valid">First Name is required</span></div><div class="tooltips"><input class="width100 blue3 subject-create commentText" [(ngModel)]="login.lastname" ngControl="lastname" #lastname="ngForm" required minlength="3" placeholder="Last Name (required)"> <span *ngIf="lastname.dirty && !lastname.valid">Valid Email is required</span></div><div class="tooltips"><input class="width100 blue3 subject-create commentText" [(ngModel)]="login.password" ngControl="password" type="password" #password="ngForm" placeholder="Password (optional)"></div><div class="tooltips"><input class="width100 blue3 subject-create commentText" [(ngModel)]="login.password_confirm" ngControl="password_confirm" #password_confirm="ngForm" type="password" placeholder="Confirm Pass (optional)"> <span *ngIf="password_confirm.dirty && password.dirty && (password_confirm.value != password.value)">Passwords should match</span></div><div class="tooltips"><input class="width100 blue3 subject-create commentText" [(ngModel)]="login.how" ngControl="how" placeholder="How\'d You Hear About Us"></div><br><button [disabled]="!loginForm.valid" class="login-margin" block secondary (click)="onSignup(loginForm)">Create My Account</button><br><button class="login-margin grey3" block nav-pop>Back to Login Page</button><br>By clicking the button above I agree to <a href="#" (click)="gotoPrivacy()">Terms of Use and Privacy Policy</a></form></div></ion-content><script>\n          var SWPX = SWPX || {};\n          SWPX.cmd = SWPX.cmd || [];\n          SWPX.cmd.push(function() {\n              SWPX.pixel.setPixel(\'mvc7\');\n              // Uncomment the following line to place an identifer\n              SWPX.pixel.setIdentifier(\'121806\');\n              SWPX.pixel.fire();\n          });\n      </script><script src="//px.spiceworks.com/px.js" async></script><noscript><img src="//px.spiceworks.com/px/mvc7" height="1" width="1"></noscript>'}),r("design:paramtypes",[o.Nav,a.DataProvider,o.Config,o.Events])],t)}();n.SignupPage=p},{"../../directives/helpers":14,"../../providers/data-provider":55,"../login/login":23,"../modals/modals":29,"../organizations/organizations":33,"ionic-angular":431}],38:[function(t,e,n){"use strict";var i=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(3>o?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},r=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),s=t("../../providers/config"),a=t("../../providers/data-provider"),c=t("../../providers/ticket-provider"),u=t("../../directives/helpers"),l=t("../../components/posts-list/posts-list"),p=t("../../components/select-list/select-list"),h=t("../../components/class-list/class-list"),d=t("../../pages/modals/modals"),f=t("../../pages/timelog/timelog"),v=t("../../pages/expense-create/expense-create"),m=t("../../pipes/pipes"),g=t("@angular/core"),y=t("ionic-angular"),b=t("../../providers/config"),_=function(){function t(t,e,n){this.nav=t,this.renderer=e,this.config=n,this.filesSelected=new g.EventEmitter(!1),this.filesUploaded=new g.EventEmitter(!1),this.allowMultiple=!0,this.multi="multiple",this.error="",this.files=[],this.MAX_SIZE=4194304,this.allowMultiple===!1&&(this.multi="")}return t.prototype.ngOnInit=function(){},t.prototype.upload=function(t,e){var n=this;return new Promise(function(i,r){var o=new XMLHttpRequest;o.onreadystatechange=function(){4===o.readyState&&(200===o.status?i(o.response):r(o.response))};var s=n.config.getCurrent("key"),a=n.config.getCurrent("org"),c=n.config.getCurrent("instance");o.open("POST",t+"files/",!0),o.setRequestHeader("Authorization","Basic "+btoa(a+"-"+c+":"+s));var u=new FormData;for(var l in n.fileDest)u.append(l,n.fileDest[l]);for(var p=0;p<e.length;p++)u.append("uploads[]",e[p],e[p].upload_name);o.send(u)})},t.prototype.onUpload=function(){var t=this;if(!this.files.length)return void this.filesUploaded.next("ok no files");if(!(this.in_progress&&Date.now()-this.in_progress<1500)){this.in_progress=Date.now();var e=null;(this.files.length>=2||this.files[0].size>2e4)&&(e=y.Loading.create({content:"Uploading file(s)...",dismissOnPageChange:!0}),this.nav.present(e)),this.upload(b.ApiSite,this.files).then(function(n){t.reset(),e&&e.dismiss(),t.filesUploaded.next("ok "+n)})["catch"](function(n){e&&setTimeout(function(){return e.dismiss()},1e3),console.error("Error uploading files",n),t.filesUploaded.next("error "+n),t.nav.alert("Error uploading files! Cannot add files! Please try again later ... or try to upload one file or check your internet connection",!0)})}},t.prototype.reset=function(t){t&&(this.files=this.files.filter(function(e){return e!==t}),this.filesSelected.next(this.files.map(function(t){return t.upload_name}))),t&&this.files.length||(this.error="",this.files=[],this.nativeInputBtn.nativeElement.value="")},t.prototype.callback=function(t){this.log("UploadButton: Callback executed triggerig click event",this.nativeInputBtn.nativeElement);var e=new MouseEvent("click",{bubbles:!0});this.renderer.invokeElementMethod(this.nativeInputBtn.nativeElement,"dispatchEvent",[e])},t.prototype.filesAdded=function(t){this.log("UploadButton: Added files",this.nativeInputBtn.nativeElement.files);var e=this.nativeInputBtn.nativeElement.files.length,n=[];if(this.error="",e){var i={},r={};if(this.filesExist)for(var o=0;o<this.filesExist.length;o++)r[this.filesExist[o].name.trim()]=this.filesExist[o].size;for(var s=0;e>s;s++){var a=this.nativeInputBtn.nativeElement.files[s];if(this.isFile(a))if(a.size>this.MAX_SIZE)this.error+="File "+a.name+" will be skipped. It is more 4 MB<br>";else if(0===a.size)this.error+="File "+a.name+" will be skipped. It has zero size <br>";else if(a.name.trim()){var c=a.name.trim();a.size!=(r[c.trim()]||a.size)&&(c=this.add_tag(c,a.size)),a.size!=(i[c]||a.size)&&(c=this.add_tag(c,a.size)),a.upload_name=c,n.push(a),i[c]=a.size}else this.error+="File #"+s+" will be skipped. It has empty name<br>";else this.error+="File #"+s+" will be skipped. It is empty<br>"}}this.files=n,this.filesSelected.next(this.files.map(function(t){return t.upload_name}))},t.prototype.add_tag=function(t,e){var n=t.lastIndexOf("."),i=t.length;return t.substr(0,n)+"_"+e+t.substr(n,i)},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];this.logCallback&&console.log(t)},t.prototype.humanizeBytes=function(t){if(0===t)return"0 Byte";var e=1024,n=["Bytes","KB","MB","GB","TB","PB"],i=Math.floor(Math.log(t)/Math.log(e));return parseFloat((t/Math.pow(e,i)).toFixed(2))+" "+n[i]},t.prototype.isImage=function(t){return t&&null!==t.trim().match(/(jpeg|jpg|gif|png|ico)$/i)?"md-image":"md-document"},t.prototype.isFile=function(t){return null!==t&&t instanceof Blob},i([g.ViewChild("input"),r("design:type",g.ElementRef)],t.prototype,"nativeInputBtn",void 0),i([g.Output(),r("design:type",g.EventEmitter)],t.prototype,"filesSelected",void 0),i([g.Output(),r("design:type",g.EventEmitter)],t.prototype,"filesUploaded",void 0),i([g.Input(),r("design:type",String)],t.prototype,"fileDest",void 0),i([g.Input(),r("design:type",Array)],t.prototype,"filesExist",void 0),i([g.Input(),r("design:type",String)],t.prototype,"btnStyle",void 0),i([g.Input(),r("design:type",Boolean)],t.prototype,"allowMultiple",void 0),i([g.Input(),r("design:type",Function)],t.prototype,"logCallback",void 0),t=i([g.Component({directives:[y.IONIC_DIRECTIVES],selector:"upload-button",template:'<div><div><div><button type="button" (click)="callback($event)" left class="button-attach attach color"><ion-icon class="button-font action-but color" name="md-attach"></ion-icon>Add Files</button></div></div><span *ngIf="error" class="error-button" [innerHTML]="error"></span> <input type="file" (change)="filesAdded($event)" style="display: none" [multiple]="multi" #input><div *ngFor="let file of files"><p class="comment_image_link files-tkts width100"><ion-icon name="{{isImage(file.name)}}" role="img" dark class="button_circle ion-{{isImage(file.name)}}"></ion-icon>&nbsp;<span class="decoration width100 flex1 color">{{file.upload_name}}&nbsp;({{humanizeBytes(file.size)}})</span> <button block (click)="reset(file)" fab class="red buttonInvoice email-invoice button-fab position-initial"><ion-icon class="invoiceCircle" name="close"></ion-icon></button></p></div><button type="button" *ngIf="!fileDest?.ticket" [disabled]="!files.length" block secondary (click)="onUpload()">Upload</button> <span class="span-block2"></span></div>'}),r("design:paramtypes",[o.Nav,g.Renderer,o.Config])],t)}();n.UploadButtonComponent=_;var w=function(){function t(t,e,n,i,r){this.nav=t,this.navParams=e,this.ticketProvider=n,this.dataProvider=i,this.config=r,this.ticket={},this.is_editnote=!0,this.cachename="",this.closed_index=0,this.fileDest={ticket:""},this.files=[],this.is_showlogs=!1,this.posts=[{id:0,ticket_key:"",user_id:0,user_email:" ",user_firstname:" ",user_lastname:" ",record_date:"2016-01-01T00:00:00.0000000",log_type:"Initial Post",note:" ",ticket_time_id:0,sent_to:" ",is_waiting:!1,sla_used:0}]}return t.prototype.onPageLoaded=function(){this.ticket.customfields=[],this.active=!0,this.he=this.config.getCurrent("user"),this.details_tab="Reply";var t=this.navParams.data||{};this.cachename=t.cachename,this.posts[0].record_date=t.updated_time||this.posts[0].record_date,this.is_showlogs=!1,this.ticketnote="",this.fileDest={ticket:t.key},this.getPosts(t.key),this.processDetails(t,!0)},t.prototype.initSelects=function(t){var e=t.account_id||-1;this.username=u.getFullName(t.user_firstname,t.user_lastname,t.user_email),this.techname=u.getFullName(t.technician_firstname||t.tech_firstname,t.technician_lastname||t.tech_lastname,t.technician_email||t.tech_email),this.select_button={tech:{name:"Tech",value:"Transfer "+this.config.current.names.ticket.s,selected:t.tech_id,url:"technicians",hidden:!1}},this.selects={user:{name:"User",value:this.username,selected:t.user_id,url:"users",hidden:!1},location:{name:"Location",value:t.location_name||"( Not Set )",selected:t.location_id||0,url:"locations?account="+e,hidden:!1},tech:{name:"Tech",value:this.techname,selected:t.tech_id,url:"technicians",hidden:!1},project:{name:"Project",value:t.project_name||"( Not Set )",selected:t.project_id||0,url:"projects?account="+e+"&is_with_statistics=false",hidden:!1},level:{name:"Level",
value:t.level_name?t.level+" - "+t.level_name:"( Not Set )",selected:t.level||0,url:"levels",hidden:!1},priority:{name:"Priority",value:t.priority_name?t.priority+" - "+t.priority_name:"( Not Set )",selected:t.priority_id||0,url:"priorities",hidden:!1},"class":{name:"Class",value:t.class_name||"( Not Set )",selected:t.class_id||0,url:"classes",hidden:!1}},this.selects.account={name:"Account",value:(t.account||{}).name||this.he.account_name,selected:e,url:"accounts?is_with_statistics=false",hidden:!1}},t.prototype.uploadedFile=function(t){0==t.indexOf("ok")&&(this.config.current.user.is_techoradmin||"Closed"==this.ticket.status?this.onSubmit():this.onClose())},t.prototype.selectedFile=function(t){this.files=t,this.ticketnote=this.ticketnote.trim(),t.length&&!this.ticketnote&&(this.ticketnote="  ")},t.prototype.getPosts=function(t){var e=this;this.ticketProvider.getTicketDetails(t).subscribe(function(t){e.processDetails(t)},function(t){console.log(t||"Server error"),e.redirectOnEmpty()})},t.prototype.processDetails=function(t,e){if(!(e||t&&t.ticketlogs&&0!=t.ticketlogs))return void this.redirectOnEmpty();if(this.ticket=t,this.is_editnote=!(this.ticket.workpad||"").length,this.ticket.customfields=[],this.initSelects(t),t.ticketlogs&&t.ticketlogs.length>0&&(this.posts=t.ticketlogs),!e){this.attachments=(t.attachments||[]).slice().reverse();var n=u.parseXml(this.ticket.customfields_xml);if(n){for(var i=[],r=n.documentElement.firstChild;r;r=r.nextSibling)i.push({id:r.attributes[0].nodeValue,name:r.firstChild.innerHTML,value:r.firstChild.nextSibling.innerHTML||""});this.ticket.customfields=i}}},t.prototype.redirectOnEmpty=function(){var t=this;this.nav.alert("Incorrect ticket. Going back...",!0),setTimeout(function(){t.nav.pop()},1e3)},t.prototype.saveSelect=function(t){var e=t.type;this.selects[e].selected=t.id,this.selects[e].value=t.name},t.prototype.onSubmit=function(){var t=this;if(!(this.ticket.in_progress&&Date.now()-this.ticket.in_progress<1500)){this.ticket.in_progress=Date.now();var e=u.htmlEscape(this.ticketnote.trim()).substr(0,5e3);this.ticketProvider.addTicketPost(this.ticket.id,e,this.files).subscribe(function(e){t.nav.alert("New post added :)"),t.ticketnote="",t.active=!1,setTimeout(function(){return t.active=!0},0),t.files=[],t.getPosts(t.ticket.key)},function(t){console.log(t||"Server error")})}},t.prototype.saveNote=function(t){var e=this,n=(t.value||"").trim();n!=(this.ticket.workpad||"").trim()?this.ticketProvider.addTicketNote(this.ticket.id,n).subscribe(function(t){return e.saveNoteSuccess(n)},function(t){console.log(t||"Server error")}):this.saveNoteSuccess(n)},t.prototype.saveNoteSuccess=function(t){this.nav.alert("Note saved :)"),this.ticket.workpad=(t||"").trim(),this.is_editnote=!this.ticket.workpad.length},t.prototype.onClose=function(){var t=this;if(!(this.ticket.in_progress&&Date.now()-this.ticket.in_progress<1500)){this.ticket.in_progress=Date.now();var e=u.htmlEscape(this.ticketnote.trim()).substr(0,5e3),n={status:"closed",note_text:e,is_send_notifications:!0,resolved:!0,resolution_id:0,confirmed:!0,confirm_note:""};this.ticketProvider.closeOpenTicket(this.ticket.key,n).subscribe(function(e){t.update_tlist_logic(!0),t.nav.alert(t.config.current.names.ticket.s+" has been closed :)"),t.ticket.status="Closed"},function(t){console.log(t||"Server error")})}},t.prototype.onUpdate=function(){var t=this;if(!(this.ticket.in_progress&&Date.now()-this.ticket.in_progress<1500)){this.ticket.in_progress=Date.now();var e={class_id:this.selects["class"].selected,level_id:this.selects.level.selected,priority_id:this.selects.priority.selected,project_id:this.selects.project.selected,location_id:this.selects.location.selected,account_id:this.selects.account.selected,tech_id:this.selects.tech.selected,user_id:this.selects.user.selected};this.ticketProvider.closeOpenTicket(this.ticket.key,e).subscribe(function(e){t.nav.alert(t.config.current.names.ticket.s+" was successfully updated :)"),t.getPosts(t.ticket.key)},function(t){console.log(t||"Server error")})}},t.prototype.transferTicket=function(t){var e=this;if(t){var n=t.id;this.select_button.tech.selected=n,this.select_button.tech.value="Transfer "+this.config.current.names.ticket.s;var i={tech_id:n};this.ticketProvider.closeOpenTicket(this.ticket.key,i).subscribe(function(i){e.nav.alert(e.config.current.names.ticket.s+" has been transferred :)"),e.techname=e.selects.tech.value=e.ticket.tech_firstname=t.name,e.ticket.tech_lastname=e.ticket.tech_email="",e.selects.tech.selected=n},function(t){console.log(t||"Server error")})}},t.prototype.pickUp=function(){var t=this,e={action:"pickup",note_text:""};this.ticket.in_progress&&Date.now()-this.ticket.in_progress<1500||(this.ticket.in_progress=Date.now(),this.ticketProvider.closeOpenTicket(this.ticket.key,e).subscribe(function(e){t.nav.alert(t.config.current.names.ticket.s+" pickup was Succesfull!"),t.techname=t.selects.tech.value=t.ticket.tech_firstname=u.getFullName(t.he.firstname,t.he.lastname,t.he.email),t.ticket.tech_lastname=t.ticket.tech_email="",t.selects.tech.selected=t.he.user_id},function(t){console.log(t||"Server error")}))},t.prototype.onDelete=function(t){var e=this,n={ticket:this.ticket.key,file_id:t.id};this.dataProvider.deleteFile(n).subscribe(function(n){e.attachments=e.attachments.filter(function(e){return e!==t}),e.getPosts(e.ticket.key),e.nav.alert("File "+t.name+" deleted!")},function(t){console.log(t||"Server error")})},t.prototype.reopenTicket=function(){var t=this,e={status:"open",note_text:""};this.ticketProvider.closeOpenTicket(this.ticket.key,e).subscribe(function(e){t.update_tlist_logic(!1),t.nav.alert(t.config.current.names.ticket.s+" has been Reopened!"),t.ticket.status="Open"},function(t){console.log(t||"Server error")})},t.prototype.update_tlist_logic=function(t){var e=this;this.cachename&&(~this.cachename.indexOf("closed")&&(t=!t,this.closed_index=0),t?(this.closed_index=this.ticketProvider._dataStore[this.cachename].findIndex(function(t){return t.key===e.ticket.key}),this.ticketProvider._dataStore[this.cachename].splice(this.closed_index,1),~this.cachename.indexOf("closed")&&this.ticketProvider._dataStore[this.cachename.replace("closed","open")].splice(0,0,this.ticket)):(this.ticketProvider._dataStore[this.cachename].splice(this.closed_index,0,this.ticket),~this.cachename.indexOf("closed")&&this.ticketProvider._dataStore[this.cachename.replace("open","closed")].splice(this.ticketProvider._dataStore[this.cachename.replace("open","closed")].findIndex(function(t){return t.key===e.ticket.key}),1)))},t.prototype.closeTicket=function(){var t=this;if("Closed"==this.ticket.status)return void this.reopenTicket();var e=o.Modal.create(d.CloseTicketModal,{number:this.ticket.number,key:this.ticket.key,subject:this.ticket.subject});e.onDismiss(function(e){e&&(t.ticket.status="Closed",t.update_tlist_logic(!0))}),this.nav.present(e)},t.prototype.addTime=function(){var t=o.Modal.create(f.TimelogPage,{number:this.ticket.number,ticket_number:this.ticket.key,subject:this.ticket.subject,account_id:this.ticket.account_id});this.nav.present(t)},t.prototype.addExpense=function(){var t=o.Modal.create(v.ExpenseCreatePage,{number:this.ticket.number,ticket_number:this.ticket.key,subject:this.ticket.subject,account_id:this.ticket.account_id});this.nav.present(t)},t.prototype.getFullapplink=function(t){var e=this.config.getCurrent();u.fullapplink(s.AppSite,t,e.instance,e.org)},t.prototype.getFullName=function(t,e,n,i){return u.getFullName(t,e,n,i)},t.prototype.getCurrency=function(t){return u.getCurrency(t)},t.prototype.getFileLink=function(t){return u.FileUrlHelper.getFileLink(t.url,t.name)},t.prototype.setDate=function(t,e,n){return t?u.getDateTime(t,e,n):null},t=i([o.Page({template:'<ion-navbar *navbar><button menuToggle><ion-icon name="menu"></ion-icon></button><ion-title class="padding-right24">{{ticket.status}} | <a href="#" class="text-decor">{{ticket.number}}&nbsp;<ion-icon class="outline" name="ios-open-outline"></ion-icon></a></ion-title></ion-navbar><ion-content><ion-toolbar class="blue3 display_flex"><h4 class="width90">{{ticket.subject | Htmlsafe}}</h4><span no-lines class="span-left"><p *ngIf="config.current.is_class_tracking && ticket.class_name"><u>Class</u>:&nbsp;{{ticket.class_name}}</p><p><u>{{config.current.names.tech.a}}</u>: {{techname}}</p><p><u>{{config.current.names.user.a}}</u>: {{username}}</p><p *ngIf="config.current.is_account_manager && ticket.account_name"><u>{{config.current.names.account.a}}</u>:&nbsp;{{ticket.account_name}}</p><p *ngIf="config.current.is_location_tracking && ticket.location_name"><u>{{config.current.names.location.a}}</u>:&nbsp;{{ticket.location_name}}</p></span> <span class="span-right"><p><u>{{ticket.days_old_in_minutes | Daysold}}</u></p><br><template [ngIf]="config.current.is_time_tracking && ticket.total_hours > 0"><p><u>{{ticket.total_hours}}</u>&nbsp;Hours</p><br></template><template [ngIf]="ticket.sla_complete_date != null"><p><u>SLA</u>: {{setDate(ticket.sla_complete_date, false, true)}}</p><br></template><template [ngIf]="config.current.is_expenses && ticket.misc_cost > 0"><p><u>Expenses</u>: {{getCurrency(ticket.misc_cost)}}</p><br></template></span></ion-toolbar><ion-segment [(ngModel)]="details_tab"><ion-segment-button value="Reply">Reply</ion-segment-button><ion-segment-button value="Info">Info</ion-segment-button><ion-segment-button value="Notes">Notes</ion-segment-button><ion-segment-button value="Files">Files</ion-segment-button><ion-segment-button value="Options">Options</ion-segment-button></ion-segment><div [ngSwitch]="details_tab"><div class="list" [hidden]="details_tab != \'Reply\'"><ion-item no-lines class="margin-bottom10"><ion-label class="width30 font-size17 text-right">Show logs</ion-label><ion-toggle [(ngModel)]="is_showlogs"></ion-toggle></ion-item><posts-list [posts]="posts" [is_first]="true" [attachments]="attachments" [is_showlogs]="is_showlogs"></posts-list><form *ngIf="active" #addForm="ngForm"><div class="tooltips"><textarea class="width100 textLogin commentText" [(ngModel)]="ticketnote" type="text" placeholder="Add Response" ngControl="note" #note="ngForm" required maxlength="4000"></textarea> <span [hidden]="note.valid || note.untouched">Response is required (max 5000 chars)</span></div><button secondary class="button_reply right indent-bottom margin-left10" [disabled]="!addForm.valid && !files?.length" (click)="u.onUpload()" type="submit">Reply</button> <button *ngIf="!config.current.user.is_techoradmin && ticket.status != \'Closed\'" secondary class="button_reply right indent-bottom margin-left10" (click)="u.onUpload()" [disabled]="!addForm.valid && !files?.length">Reply & Close</button><upload-button #u (filesUploaded)="uploadedFile($event)" (filesSelected)="selectedFile($event)" btnStyle="add-circle" [allowMultiple]="true" [fileDest]="fileDest" [filesExist]="attachments" [logCallback]></upload-button></form><posts-list [posts]="posts" [attachments]="attachments" class="general-alignment" [is_showlogs]="is_showlogs"></posts-list><span class="span-block"></span></div><div *ngSwitchWhen="\'Info\'" class="list max-width700 general-alignment"><select-list is_me="true" ajax="true" [list]="selects.user" (onChanged)="saveSelect($event)" preload="true"></select-list><select-list [list]="selects.account" preload="true" ajax="true" (onChanged)="saveSelect($event)"></select-list><class-list preload="true" [list]="selects.class" (onChanged)="saveSelect($event)"></class-list><select-list preload="true" [list]="selects.level" (onChanged)="saveSelect($event)"></select-list><select-list preload="true" [list]="selects.priority" (onChanged)="saveSelect($event)"></select-list><select-list is_me="true" preload="true" [list]="selects.tech" (onChanged)="saveSelect($event)"></select-list><select-list preload="true" [list]="selects.location" ajax="true" (onChanged)="saveSelect($event)"></select-list><select-list preload="true" [list]="selects.project" (onChanged)="saveSelect($event)"></select-list><button *ngFor="let customfield of ticket.customfields" class="width100 button-icon-only {{ isbutton? \'blue2 general-alignment2\' : \'blue4\'}} class-margin disable-hover button button-default"><p class="textLogin text-left text-bold" [innerHTML]="customfield.name"></p><ion-label class="{{isbutton ? \'center\' : \'tkts-table\'}} select-list">&nbsp;&nbsp;{{customfield.value || \'&nbsp;\'}}</ion-label></button><div>&nbsp;&nbsp;</div><button secondary block (click)="onUpdate()" type="submit" class="disable-hover button button-default button-block">Update</button></div><ion-list class="list general-alignment max-width700" [hidden]="details_tab != \'Notes\'"><div [hidden]="is_editnote" class="width100 textLogin note-account commentText" [innerHTML]="ticket?.workpad" type="text" (click)="is_editnote = true"></div><button [hidden]="is_editnote" secondary class="button_reply img-top right" (click)="is_editnote = true">Edit Notes</button> <textarea autofocus [hidden]="!is_editnote" [ngModel]="ticket?.workpad" class="glow width100 textLogin commentText" #workpadtext type="text" placeholder="Notes:"></textarea> <button [hidden]="!is_editnote" secondary class="button_reply img-top right" (click)="saveNote(workpadtext)">{{ticket?.workpad?.length ? \'Save\' : \'Add\'}} Notes</button> <span class="span-block"></span> <span class="span-block"></span> <span class="span-block"></span></ion-list><ion-list class="list img-top" no-lines *ngSwitchWhen="\'Files\'"><div [hidden]="attachments?.length" class="table grey2 menu-text">No Files yet</div><ion-item *ngFor="let file of attachments"><div class="left width59 tkts-table" [innerHTML]="getFileLink(file)"></div><div class="files-tkts"><span class="color right text-left space-initial flex1 font-size_span subject-ticket">{{file.name}}</span> <button (click)="onDelete(file)" block fab class="red buttonInvoice email-invoice button-fab position-initial button-files margin-left5"><ion-icon class="invoiceCircle" name="close"></ion-icon></button></div></ion-item></ion-list><div *ngSwitchWhen="\'Options\'" class="list max-width700 general-alignment"><button *ngIf="config.current.is_time_tracking" (click)="addTime()" block type="submit" class="blue2 disable-hover button button-default button-block class-margin">Add Time</button> <button *ngIf="config.current.is_expenses" (click)="addExpense()" block type="submit" class="blue2 disable-hover button button-default button-block class-margin">Add Expense</button><select-list class="class-margin" preload="true" [isbutton]="true" [list]="select_button.tech" (onChanged)="transferTicket($event)"></select-list><button *ngIf="(ticket.technician_email || ticket.tech_email) != he.email" (click)="pickUp()" block type="submit" class="blue2 class-margin">Pick Up {{config.current.names.ticket.s}}</button> <button (click)="closeTicket()" secondary block type="submit" class="class-margin">{{ticket.status != \'Closed\' ? \'Close\' : \'ReOpen\'}} {{config.current.names.ticket.s}}</button></div></div></ion-content>',directives:[l.PostsListComponent,g.forwardRef(function(){return p.SelectListComponent}),g.forwardRef(function(){return h.ClassListComponent}),_],pipes:[m.GravatarPipe,m.LinebreaksPipe,m.DaysoldPipe,m.HtmlsafePipe]}),r("design:paramtypes",[o.Nav,o.NavParams,c.TicketProvider,a.DataProvider,o.Config])],t)}();n.TicketDetailsPage=w},{"../../components/class-list/class-list":4,"../../components/posts-list/posts-list":6,"../../components/select-list/select-list":8,"../../directives/helpers":14,"../../pages/expense-create/expense-create":19,"../../pages/modals/modals":29,"../../pages/timelog/timelog":40,"../../pipes/pipes":52,"../../providers/config":54,"../../providers/data-provider":55,"../../providers/ticket-provider":58,"@angular/core":193,"ionic-angular":431}],39:[function(t,e,n){"use strict";var i=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(3>o?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},r=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),s=t("../../providers/providers"),a=t("../modals/modals"),c=t("../ticket-details/ticket-details"),u=t("../ajax-search/ajax-search"),l=t("../../components/components"),p=t("../../directives/directives"),h=t("../../directives/helpers"),d=function(){function t(t,e,n,i){this.nav=t,this.navParams=e,this.config=n,this.apiData=i,this.term="",this.counts={}}return t.prototype.onPageLoaded=function(){this.is_tech=this.config.getCurrent("user").is_techoradmin;var t=this.navParams.data||{};t.count&&(this.counts[t.tab]=t.count),this.is_tech?this.ticket_tab=this.config.current.user.is_limit_assigned_tkts||!t.tab?"tech":t.tab:this.ticket_tab="user",this.nav.tickets_tab=null,t.key&&this.gotoTicket(t)},t.prototype.onPageDidEnter=function(){this.term=""},t.prototype.addTicket=function(){var t=this,e=o.Modal.create(a.TicketCreatePage);e.onDismiss(function(e){return t.gotoTicket(e)}),this.nav.present(e)},t.prototype.gotoTicket=function(t){var e=this;this.test=!1,this.clearSearch(),t&&setTimeout(function(){e.nav.push(c.TicketDetailsPage,t)},500)},t.prototype.searchItems=function(t){var e=this;this.search_results=[];var n=t.value;if(""!=n.trim()&&!this.busy&&n.length>1){var i=setTimeout(function(){e.busy=!0},500);this.getItems(n,i)}},t.prototype.getItems=function(t,e){var n=this;this.search_results=[];var i="tickets?query=all",r={limit:3},o=" "==t[t.length-1]||","==t[t.length-1];o?i="tickets/"+t.trim()+",":t+="*",this.apiData.getPaged(h.addp(i,"search",t),r).subscribe(function(t){e&&(clearTimeout(e),n.busy=!1),n.search_results=t},function(t){e&&(clearTimeout(e),n.busy=!1),console.log(t||"Server error")})},t.prototype.clearSearch=function(t){this.search_results=[],this.busy=!1,t&&(t.value="")},t.prototype.getSearch=function(t){this.test=!1,this.clearSearch();var e=t.target.value;e.length<4&&(e+="    ");var n={search:e};this.test=!1,this.nav.push(u.AjaxSearchPage,n)},t=i([o.Page({template:'<ion-navbar *navbar><ion-buttons start><button menuToggle><ion-icon name="menu"></ion-icon></button></ion-buttons><ion-title class="names">{{config.current.names.ticket.p}}</ion-title><ion-buttons end><button danger class="right transparent" (click)="test = !test"><ion-icon name="ios-search"></ion-icon></button></ion-buttons></ion-navbar><div class="tickets mycontent"><ion-searchbar *ngIf="test" [focuser] debounce="700" (cancel)="test = !test" (input)="searchItems($event)" [(ngModel)]="term" placeholder="{{config.current.names.ticket.s}} number (2 chars) or Enter to search" (search)="getSearch($event)"></ion-searchbar><img *ngIf="busy" class="imglogo" src="img/loading2.gif"><ion-list class="ajax" [hidden]="!search_results"><a detail-none href="#" ion-item *ngFor="let item of search_results" (click)="gotoTicket(item)"><h2>{{item.status}} | #{{item.number}} - {{item.subject}} ({{item.user_firstname}} {{item.user_lastname}})</h2></a></ion-list><div *ngIf="is_tech" class="tabsTicket"><ion-segment [(ngModel)]="ticket_tab"><ion-segment-button value="user">{{config.current.names.user.a}}</ion-segment-button><ion-segment-button value="tech">{{config.current.names.tech.a}}</ion-segment-button><ion-segment-button value="alt">Alt</ion-segment-button><ion-segment-button *ngIf="!config.current.user.is_limit_assigned_tkts" value="all">All Open</ion-segment-button></ion-segment></div><tickets-list [hidden]="ticket_tab != \'user\' && is_tech" [preload]="ticket_tab == \'user\' ? 0 : 1500" [mode]="[\'user\']" [count]="counts.user"></tickets-list><tickets-list *ngIf="is_tech" [hidden]="ticket_tab != \'tech\'" [preload]="ticket_tab == \'tech\' ? 0 : 1500" [mode]="[\'tech\']" [count]="counts.tech"></tickets-list><tickets-list *ngIf="is_tech" [hidden]="ticket_tab != \'alt\'" [preload]="ticket_tab == \'alt\' ? 0 : 1500" [mode]="[\'alt\']" [count]="counts.alt"></tickets-list><tickets-list *ngIf="is_tech" [hidden]="ticket_tab != \'all\'" [preload]="ticket_tab == \'all\' ? 0 : 1500" [mode]="[\'all\']" [count]="counts.all"></tickets-list></div><button (click)="addTicket()" secondary item-right fab fab-right fab-bottom style="z-index: 2"><ion-icon class="button_circle action-but" name="md-add"></ion-icon></button>',directives:[l.TicketsListComponent,p.Focuser]}),r("design:paramtypes",[o.Nav,o.NavParams,o.Config,s.ApiData])],t)}();n.TicketsPage=d},{"../../components/components":5,"../../directives/directives":12,"../../directives/helpers":14,"../../providers/providers":57,"../ajax-search/ajax-search":17,"../modals/modals":29,"../ticket-details/ticket-details":38,"ionic-angular":431}],40:[function(t,e,n){"use strict";var i=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(3>o?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},r=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),s=t("@angular/core"),a=t("../../directives/helpers"),c=t("../../providers/time-provider"),u=t("../../components/class-list/class-list"),l=t("../../components/select-list/select-list"),p=function(){function t(t,e,n,i,r){this.nav=t,this.navParams=e,this.timeProvider=n,this.config=i,this.view=r,this.time={},this.title="",this.selects={},this.minuteValues=[0,15,30,45,0],this.start_time="",this.stop_time="",this.UserDateOffset=-5,this.start_stop_hours=0}return t.prototype.decrement=function(){this.timecount=Math.max(Number(this.timecount)-this.inc,0).toFixed(2)},t.prototype.increment=function(){this.timecount=(Number(this.timecount)+this.inc).toFixed(2)},t.prototype.ngAfterViewInit=function(){},t.prototype.AddHours=function(t,e){if(t){19==t.length&&(t=t.slice(0,-3));var n=new Date(t);return new Date(n.setTime(n.getTime()+60*e*60*1e3)).toJSON()}return t},t.prototype.ngOnInit=function(){this.UserDateOffset=this.config.getCurrent("timezone_offset"),this.time=this.navParams.data||{};var t=(this.time.user_name+" "+this.time.user_email).trim().split(" ")[0];if(this.time.time_id?(this.title="Timelog #"+this.time.time_id+" by"+t+" on"+this.setDate(this.time.date,!1,!0),this.start_time=this.AddHours(this.time.start_time,this.time.time_offset),this.stop_time=this.AddHours(this.time.stop_time,this.time.time_offset),this.start_time&&this.stop_time&&(this.start_stop_hours=Number(Math.round((+new Date(this.stop_time)-+new Date(this.start_time))/6e4)/60))):this.time.number?this.title="Add Time to #"+this.time.number+" "+this.time.subject:this.title="Add Time",this.mintime=this.config.getCurrent("time_minimum_time")||.25,this.mintime=this.mintime>0?this.mintime:.25,this.isbillable="undefined"==typeof this.time.billable?!0:this.time.billable,this.inc=this.config.getCurrent("time_hour_increment")>0?this.config.getCurrent("time_hour_increment"):.25,this.displayFormat=a.getPickerDateTimeFormat(!1,!0),this.inc>=1)this.minuteValues=[0];else if(.25!=this.inc){this.minuteValues=[];var e=0;do this.minuteValues.push(e),e+=60*this.inc;while(60>e);this.minuteValues.push(0)}this.timecount=(this.time.hours||this.mintime).toFixed(2),this.timenote=a.linebreaks(this.time.note||"",!0),this.he=this.config.getCurrent("user");var n={};this.time.number||this.time.time_id||(this.time.account||{}).id||(n=this.config.current.recent||{});var i=(this.time.account||{}).id||this.time.account_id||(n.account||{}).selected||this.he.account_id||-1,r=(this.time.project||{}).id||this.time.project_id||(n.project||{}).selected||0;this.selects={account:{name:"Account",value:(this.time.account||{}).name||this.time.account_name||(n.account||{}).value||this.he.account_name,selected:i,url:"accounts?is_with_statistics=false",hidden:!1},project:{name:"Project",value:this.time.project_name||(n.project||{}).value||"Default",selected:r,url:"projects?account="+i+"&is_with_statistics=false",hidden:!1},ticket:{name:"Ticket",value:this.time.ticket_number?"#"+this.time.ticket_number+": "+this.time.ticket_subject:"Choose (optional)",selected:this.time.ticket_number||0,url:"tickets?status=open&account="+i+"&project="+r,hidden:this.time.is_project_log||this.time.task_type_id||!1},tasktype:{name:"Task Type",value:this.time.task_type||(n.tasktype||{}).value||"Choose",selected:this.time.task_type_id||this.config.getRecent("tasktype").selected||0,url:this.time.ticket_number?"task_types?ticket="+this.time.ticket_number:"task_types?account="+i,hidden:!1}}},t.prototype.saveSelect=function(t){var e=t.type,n=this.selects.account.selected;switch(e){case"account":if(this.selects.account.selected===t.id)break;this.selects.project.url="projects?account="+t.id+"&is_with_statistics=false",this.selects.project.value="Default",this.selects.project.selected=0,n=t.id,this.selects.ticket.hidden=this.time.is_project_log||this.time.task_type_id||!1,this.selects.project.hidden=!this.config.current.is_project_tracking;case"project":if(this.selects.project.selected===t.id)break;this.time.task_type_id||(this.selects.ticket.hidden=this.time.is_project_log||this.time.task_type_id||!1,this.selects.ticket.url="tickets?status=open&account="+n+"&project="+t.id,this.selects.ticket.value="Choose (optional)",this.selects.ticket.selected=0);break;case"ticket":if(this.selects.ticket.selected===t.id)break;this.selects.tasktype.url=t.id?"task_types?ticket="+t.id:"task_types?account="+n,this.selects.tasktype.value="Choose",this.selects.tasktype.selected=0}this.selects[e].selected=t.id,this.selects[e].value=t.name},t.prototype.onSubmit=function(t){var e=this,n=Number(this.timecount);if(n<this.mintime)return void this.nav.alert("Not enough time",!0);if(this.start_stop_hours&&n>this.start_stop_hours)return void this.nav.alert("Hours value should be lesser or equal than Start/Stop range.",!0);if(!this.selects.tasktype.selected)return void this.nav.alert("Please, select Task Type from the list.",!0);if(t.valid){if(this.time.in_progress&&Date.now()-this.time.in_progress<1500)return;this.time.in_progress=Date.now();var i=a.htmlEscape(this.timenote.trim()).substr(0,5e3),r=!!this.time.time_id,o=-1*(r?this.time.time_offset:this.UserDateOffset),s={tech_id:r?this.time.user_id:this.he.user_id,project_id:this.selects.project.selected,is_project_log:!this.selects.ticket.selected,ticket_key:this.selects.ticket.selected,account_id:this.selects.account.selected,note_text:i,task_type_id:this.selects.tasktype.selected,hours:n,is_billable:this.isbillable,date:this.AddHours(this.start_time,o)||"",start_date:this.AddHours(this.start_time,o)||"",stop_date:this.AddHours(this.stop_time,o)||""};this.timeProvider.addTime(this.time.time_id,s,r?"PUT":"POST").subscribe(function(t){if(e.time.number||e.time.time_id||(e.time.account||{}).id||e.config.setRecent({account:e.selects.account,project:e.selects.project,tasktype:e.selects.tasktype}),r)e.time.start_time=s.start_date,e.time.stop_time=s.stop_date,e.time.hours=s.hours,e.time.is_billable=s.is_billable;else{var n=s.date||e.AddHours(new Date,e.UserDateOffset),i={time_id:0,account_id:s.account_id,account_name:e.selects.account.value,billable:s.is_billable,date:n,hours:s.hours,is_project_log:s.is_project_log,note:s.note_text,project_id:s.project_id,project_name:e.selects.project.value,start_time:s.start_date,stop_time:s.stop_date,time_offset:o,task_type:e.selects.tasktype.value,task_type_id:s.task_type_id,ticket_number:s.ticket_key,ticket_subject:e.selects.ticket.value,user_email:e.he.email,user_id:e.he.user_id,user_name:e.he.firstname+" "+e.he.lastname};(e.timeProvider._dataStore[e.time.cachename]||[]).splice(0,0,i)}e.nav.alert("Time was successfully "+(r?"updated":"added")+" :)"),e.close()},function(t){console.log(t||"Server error")})}},t.prototype.setDate=function(t,e,n){return t?a.getDateTime(t,e,n):null},t.prototype.setMinTime=function(t){return(t||this.time.date||this.AddHours(new Date,this.UserDateOffset)).substring(0,4)},t.prototype.setMaxTime=function(t){return(t||this.time.date||this.AddHours(new Date,this.UserDateOffset)).substring(0,4)},t.prototype.getStartDate=function(t){return(t||this.time.date||this.AddHours(new Date,this.UserDateOffset)).substring(0,19)},t.prototype.setStartDate=function(t){t&&(this.start_time=t.substring(0,19),this.stop_time&&this.updateHours())},t.prototype.setStopDate=function(t){t&&(this.stop_time=t.substring(0,19),this.start_time&&this.updateHours())},t.prototype.updateHours=function(){var t=Math.round((+new Date(this.stop_time)-+new Date(this.start_time))/6e4);0>t?(this.start_time=this.AddHours(this.start_time,-24),this.start_stop_hours=Number(24+t/60)):this.start_stop_hours=Number(t/60),this.timecount=this.start_stop_hours.toFixed(2)},t.prototype.getFixed=function(t){return Number(t||"0").toFixed(2).toString()},t.prototype.close=function(){this.view.dismiss()},t=i([o.Page({template:'<ion-toolbar><button (click)="close()" class="bar-button bar-button-default"><span *ngIf="title?.length < 9" primary>Cancel</span><ion-icon *ngIf="title?.length > 9" primary class="invoiceCircle" name="ios-arrow-back"></ion-icon></button><ion-title class="ellipsis padding-right24">{{title}}</ion-title></ion-toolbar><ion-content class="timelog"><div class="list max-width700"><div class="img-top"><a detail-none href="#" (click)="decrement()" class="left width30 button-timelog"><ion-item no-lines class="width100 blue4"><ion-icon name="remove" class="padding-left8"></ion-icon></ion-item></a><ion-item no-lines class="blue3 left width30 button-timelog line-height5 height51"><ion-input class="timelog-input width100 right margin padding-1px" [(ngModel)]="timecount"></ion-input></ion-item><a detail-none href="#" (click)="increment()" class="right width30 button-timelog dashboardRight"><ion-item no-lines class="width100 blue4"><ion-icon name="add" class="padding-left8"></ion-icon></ion-item></a></div><ion-item no-lines class="start-end top0">Start Time</ion-item><ion-item no-lines class="blue3 top0 bottom5"><ion-label class="start-end2">Start Time</ion-label><ion-datetime [ngClass]="{\'nocolor\': !start_time, \'text-color\': start_time}" #starttime [displayFormat]="displayFormat" [min]="setMinTime(start_time)" [max]="setMaxTime(stop_time)" [minuteValues]="minuteValues" (ngModelChange)="setStartDate($event)" [ngModel]="getStartDate(start_time)"></ion-datetime></ion-item><div class="general-alignment2"><ion-item no-lines class="start-end">End Time</ion-item><ion-item no-lines class="blue3 top0 bottom5"><ion-label class="start-end2">End Time</ion-label><ion-datetime [ngClass]="{\'nocolor\': !stop_time, \'text-color\': stop_time}" #stoptime [displayFormat]="displayFormat" [min]="setMinTime(start_time)" [max]="setMaxTime(stop_time)" [minuteValues]="minuteValues" (ngModelChange)="setStopDate($event)" [ngModel]="getStartDate(stop_time)"></ion-datetime></ion-item></div><div class="general-alignment2"><select-list *ngIf="!time.number" [list]="selects.account" ajax="true" preload="true" (onChanged)="saveSelect($event)"></select-list><select-list *ngIf="!time.number" [list]="selects.project" preload="true" (onChanged)="saveSelect($event)"></select-list><select-list *ngIf="!time.number" [list]="selects.ticket" preload="true" (onChanged)="saveSelect($event)"></select-list><select-list [list]="selects.tasktype" preload="true" (onChanged)="saveSelect($event)"></select-list></div><form #addForm="ngForm"><ion-item no-lines class="left toggle-width"><ion-toggle class="toggle" [(ngModel)]="isbillable"></ion-toggle></ion-item><p class="left width30 text-toggle color">Billable</p><textarea class="width100 textLogin commentText" type="text" placeholder="I completed..." [(ngModel)]="timenote" ngControl="note" #note="ngForm" maxlength="4000">{{time.note}}</textarea><div class="img-top"><button secondary block type="submit" class="disable-hover button button-default button-block" [disabled]="!addForm.valid" (click)="onSubmit(addForm)">{{time.time_id ? \'Update\' : \'Add\'}} Time</button> <span class="span-block"></span></div></form></div></ion-content>',
directives:[u.ClassListComponent,s.forwardRef(function(){return l.SelectListComponent})]}),r("design:paramtypes",[o.Nav,o.NavParams,c.TimeProvider,o.Config,o.ViewController])],t)}();n.TimelogPage=p},{"../../components/class-list/class-list":4,"../../components/select-list/select-list":8,"../../directives/helpers":14,"../../providers/time-provider":59,"@angular/core":193,"ionic-angular":431}],41:[function(t,e,n){"use strict";var i=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(3>o?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},r=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),s=t("../../providers/time-provider"),a=t("../../directives/helpers"),c=t("../timelog/timelog"),u=t("../../components/action-button/action-button"),l=t("../../directives/helpers"),p=t("../../pipes/pipes"),h=function(){function t(t,e,n,i,r){this.nav=t,this.timeProvider=e,this.config=n,this.navParams=i,this.view=r,this.LIMIT=25,this.is_empty=!1,this.initial_load=!0,this.pager={page:0,limit:this.LIMIT}}return t.prototype.onPageLoaded=function(){this.params=this.navParams.data||{},this.pager={page:0},this.params.account={id:this.params.account_id||"",name:this.params.account_name||""},this.cachename=a.addp("time","account",this.params.account.id),this.cachelen=(this.timeProvider._dataStore[this.cachename]||{}).length,this.params.is_empty&&(this.params.count=0),0!==this.params.count?this.getTimeLogs():this.is_empty=!0},t.prototype.getTimeLogs=function(){var t=this;if(this.timeProvider.getTimelogs(this.params.account.id,this.pager),this.timelogs=this.timeProvider.times$[this.cachename],!this.cachelen){var e=setTimeout(function(){t.busy=!0},500);setTimeout(function(){t.busy=!1},3e3),this.timelogs.subscribe(function(n){clearTimeout(e),t.busy=!1,t.is_empty=!n.length})}},t.prototype.onPageWillEnter=function(){this.params.account_name&&this.view.setBackButtonText(""),this.initial_load||this.getTimeLogs(),this.initial_load=!1},t.prototype.doInfinite=function(t){var e=this;if(this.is_empty||this.cachelen>0&&(this.cachelen>=this.params.count||this.cachelen<this.LIMIT)||this.params.count>0&&this.params.count<this.LIMIT)return t.enable(!1),void t.complete();this.pager.page+=1;var n=(this.timeProvider._dataStore[this.cachename]||{}).length;this.timeProvider.getTimelogs(this.params.account.id,this.pager),this.timelogs.subscribe(function(i){t.complete();var r=i.length;t.enable(!(n==r||r%e.LIMIT)),e.cachelen=r})},t.prototype.itemTapped=function(t){t=t||{},t.account=t.account||this.params.account,t.cachename=this.cachename,this.nav.push(c.TimelogPage,t)},t.prototype.setDate=function(t,e,n){return t?l.getDateTime(t,e,n):null},t.prototype.getFixed=function(t){return Number(t||"0").toFixed(2).toString()},t=i([o.Page({template:'<ion-navbar *navbar><button menuToggle><ion-icon name="menu"></ion-icon></button><ion-title class="padding-right24">Timelogs {{params.account_name ? "of&nbsp;" + params.account.name : ""}}</ion-title></ion-navbar><ion-content><ion-list class="list general-alignment2" no-lines><img *ngIf="busy" class="imglogo img-padding" src="img/loading2.gif"><ion-item-sliding class="timelog-item" *ngFor="let time of timelogs | async" #slidingItem><a detail-none href="#" ion-item (click)="itemTapped(time)"><ion-avatar padding item-left><li><img class="img_avatar" [alt]="time.user_firstname" [src]="time.user_email | Gravatar"><p>{{time.user_name}} {{time.user_lastname}}</p></li></ion-avatar><div><li class="font-hours"><ion-icon name="time">&nbsp;</ion-icon><h2>{{getFixed(time.hours)}}</h2><p>{{setDate(time.date)}}</p></li><span class="timelog-span"><h3 [innerHTML]="((time.ticket_number ? (\'#\'+time.ticket_number+\': \'+time.ticket_subject + (time.note ? \' - \' : \'\')) : \'\') + time.note) | Linebreaks"></h3></span></div></a></ion-item-sliding></ion-list><div *ngIf="is_empty" class="table grey2 menu-text">No Timelogs yet</div><ion-infinite-scroll (infinite)="doInfinite($event)" threshold="30%"><ion-infinite-scroll-content loadingSpinner="circles" loadingText="Loading more data..."></ion-infinite-scroll-content></ion-infinite-scroll></ion-content><button (click)="itemTapped()" secondary item-right fab fab-right fab-bottom style="z-index: 2"><ion-icon class="button_circle action-but" name="md-add"></ion-icon></button>',directives:[u.ActionButtonComponent],pipes:[p.GravatarPipe,p.MorePipe,p.LinebreaksPipe]}),r("design:paramtypes",[o.Nav,s.TimeProvider,o.Config,o.NavParams,o.ViewController])],t)}();n.TimelogsPage=h},{"../../components/action-button/action-button":3,"../../directives/helpers":14,"../../pipes/pipes":52,"../../providers/time-provider":59,"../timelog/timelog":40,"ionic-angular":431}],42:[function(t,e,n){"use strict";var i=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(3>o?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},r=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),s=t("../../directives/helpers"),a=t("../../providers/todo-provider"),c=function(){function t(t,e,n,i,r){this.nav=t,this.navParams=e,this.todoProvider=n,this.config=i,this.view=r,this.UserDateOffset=-5,this.he=i.current.user}return t.prototype.ngOnInit=function(){this.todo=this.navParams.data||{},this.UserDateOffset=this.config.getCurrent("timezone_offset"),this.displayFormat=s.getPickerDateTimeFormat(!1,!1),this.todo.due_date=this.todo.due_date?this.AddHours(this.todo.due_date,this.UserDateOffset):""},t.prototype.AddHours=function(t,e){if(t){19==t.length&&(t=t.slice(0,-3));var n=new Date(t);return new Date(n.setTime(n.getTime()+60*e*60*1e3)).toJSON()}return t},t.prototype.onSubmit=function(t){var e=this,n=this.todo.estimated_remain||"";if(t.valid){if(n)if(~n.indexOf(".")){var i=n.split(".");n=Number(i[0])+Number(i[1])/60}else if(~n.indexOf(":")){var i=n.split(":");n=Number(i[0])+Number(i[1])/60}else Number(n)&&(n=Number(n));else n=0;if(this.todo.in_progress&&Date.now()-this.todo.in_progress<2500)return;this.todo.in_progress=Date.now();var r={task_id:null,title:this.todo.title,text:this.todo.note,assigned_id:this.he.user_id,estimated_remain:n,due_date:this.AddHours(this.todo.due_date,-1*this.UserDateOffset)||"",notify:!1,list_id:this.todo.list_id,ticket_key:null,project_id:0};this.todoProvider.addTodo(r).subscribe(function(t){e.nav.alert("Todo was successfully added :)"),e.todoProvider.getTodos(e.he.user_id,{page:0,limit:5e3}),setTimeout(function(){return e.close()},500)},function(t){console.log(t||"Server error")})}},t.prototype.setMinTime=function(t){return(t||this.todo.due_date||this.AddHours(new Date,this.UserDateOffset)).substring(0,4)},t.prototype.getStartDate=function(t){return(t||this.todo.due_date||this.AddHours(new Date,this.UserDateOffset)).substring(0,19)},t.prototype.setStartDate=function(t){t&&(this.todo.due_date=t.substring(0,19))},t.prototype.close=function(){this.view.dismiss()},t=i([o.Page({template:'<ion-toolbar><button (click)="close()" class="bar-button bar-button-default"><span *ngIf="title?.length < 15" primary>Cancel</span><ion-icon *ngIf="title?.length > 15" primary class="invoiceCircle" name="ios-arrow-back"></ion-icon></button><ion-title class="ellipsis padding-right24">Add ToDo</ion-title></ion-toolbar><ion-content class="expense-create"><form #addForm="ngForm"><ion-list class="list max-width700 general-alignment" no-lines><div class="tooltips"><input [(ngModel)]="todo.title" class="width100 blue3 subject-create commentText margin-bottom3" placeholder="Title" ngControl="title" required maxlength="100"></div><br><textarea [(ngModel)]="todo.note" ngControl="note" #note="ngForm" class="width100 textLogin commentText margin" type="text" placeholder="Note" maxlength="4000"></textarea><br><div class="general-alignment2"><ion-item no-lines class="start-end">Due Date</ion-item><ion-item no-lines class="blue3 top0 bottom5"><ion-label class="start-end2">Due Date</ion-label><ion-datetime [ngClass]="{\'nocolor\': !todo.due_date, \'text-color\': todo.due_date}" #due_date [displayFormat]="displayFormat" [min]="setMinTime(todo.due_date)" (ngModelChange)="setStartDate($event)" [ngModel]="getStartDate(todo.due_date)"></ion-datetime></ion-item></div><br><textarea [(ngModel)]="todo.estimated_remain" class="width100 textLogin commentText subject-create" type="text" placeholder="Est. Time hh:mm"></textarea><br><div><button (click)="onSubmit(addForm)" secondary block type="submit" [disabled]="!addForm.valid" class="disable-hover button button-default button-block">Add ToDo</button></div></ion-list></form></ion-content>'}),r("design:paramtypes",[o.Nav,o.NavParams,a.TodoProvider,o.Config,o.ViewController])],t)}();n.TodoCreatePage=c},{"../../directives/helpers":14,"../../providers/todo-provider":60,"ionic-angular":431}],43:[function(t,e,n){"use strict";var i=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(3>o?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},r=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),s=t("../todo-create/todo-create"),a=t("../../components/components"),c=function(){function t(t,e,n){this.nav=t,this.config=e,this.navParams=n,this.is_empty=!1}return t.prototype.onPageLoaded=function(){this.params=this.navParams.data||{},this.params.user={id:this.params.user_id||this.config.current.user.user_id,name:this.params.user_name||""}},t.prototype.AddTodo=function(){var t=o.Modal.create(s.TodoCreatePage,{list_id:""});this.nav.present(t)},t=i([o.Page({template:'<ion-navbar *navbar><button menuToggle><ion-icon name="menu"></ion-icon></button><ion-title class="padding-right24">ToDo\'s</ion-title></ion-navbar><ion-content><todo-list></todo-list></ion-content><button (click)="AddTodo()" secondary item-right fab fab-right fab-bottom style="z-index: 2"><ion-icon class="button_circle action-but" name="md-add"></ion-icon></button>',directives:[a.TodoListComponent]}),r("design:paramtypes",[o.Nav,o.Config,o.NavParams])],t)}();n.TodosPage=c},{"../../components/components":5,"../todo-create/todo-create":42,"ionic-angular":431}],44:[function(t,e,n){"use strict";var i=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(3>o?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},r=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("ionic-angular"),s=t("../../providers/data-provider"),a=t("../../pipes/pipes"),c=t("../invoice-details/invoice-details"),u=t("../../directives/helpers"),l=function(){function t(t,e,n,i,r){this.nav=t,this.dataProvider=e,this.config=n,this.navParams=i,this.view=r,this.LIMIT=15,this.is_empty=!1,this.invoices=[],t.swipeBackEnabled=!1}return t.prototype.onPageLoaded=function(){var t=this;if(this.params=this.navParams.data||{},this.pager={page:0,limit:this.LIMIT},this.params.account={id:this.params.account_id||0,name:this.params.account_name||this.config.getCurrent("user").account_name},this.params.is_empty&&(this.params.count=0),0!==this.params.count){var e=setTimeout(function(){t.busy=!0},500);this.getItems(null,e)}else this.is_empty=!0},t.prototype.onPageWillEnter=function(){this.params.account_name&&this.view.setBackButtonText("")},t.prototype.getItems=function(t,e){var n=this;this.dataProvider.getInvoices(this.params.account.id,!1,this.pager).subscribe(function(i){e?(n.is_empty=!i.length,clearTimeout(e),n.busy=!1,n.invoices=i):(r=n.invoices).push.apply(r,i),t&&(t.enable(i.length==n.LIMIT),t.complete()),n.count=i.length;var r},function(t){e&&(clearTimeout(e),n.busy=!1),console.log(t||"Server error")})},t.prototype.doInfinite=function(t){return this.is_empty||this.count<this.LIMIT?(t.enable(!1),void t.complete()):(this.pager.page+=1,void this.getItems(t,null))},t.prototype.itemTapped=function(t){this.nav.push(c.InvoiceDetailsPage,t)},t.prototype.setDate=function(t,e,n){return u.getDateTime(t||new Date,e,n)},t.prototype.getCurrency=function(t){return u.getCurrency(t)},t=i([o.Page({template:'<ion-navbar *navbar><button menuToggle><ion-icon name="menu"></ion-icon></button><ion-title class="padding-right24">Create Invoices {{params.account_name ? "on&nbsp;" + params.account.name : ""}}</ion-title></ion-navbar><ion-content padding><img *ngIf="busy" class="imglogo img-padding" src="img/loading2.gif"><div *ngIf="is_empty" class="table grey2 menu-text">No Invoices yet</div><div><ion-list class="general-alignment2"><a detail-none href="#" ion-item class="margin" (click)="itemTapped(invoice)" *ngFor="let invoice of invoices"><p class="width45 tkts-table left invoices color padding-top6">{{setDate(invoice.end_date || invoice.date, true)}}</p><h2 class="width55 tkts-table right color">{{invoice.account_name || invoice.customer}}</h2><p item-right class="text width30 text-right color">{{getCurrency(invoice.total_cost)}}</p></a></ion-list><ion-infinite-scroll (infinite)="doInfinite($event)" threshold="30%"><ion-infinite-scroll-content loadingSpinner="circles" loadingText="Loading more data..."></ion-infinite-scroll-content></ion-infinite-scroll></div></ion-content>',pipes:[a.MorePipe]}),r("design:paramtypes",[o.Nav,s.DataProvider,o.Config,o.NavParams,o.ViewController])],t)}();n.UnInvoicesPage=l},{"../../directives/helpers":14,"../../pipes/pipes":52,"../../providers/data-provider":55,"../invoice-details/invoice-details":21,"ionic-angular":431}],45:[function(t,e,n){"use strict";var i=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(3>o?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},r=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("@angular/core"),s=function(){function t(){}return t.prototype.transform=function(t,e){return t?t.charAt(0).toUpperCase()+t.slice(1):t},t=i([o.Pipe({name:"Capitalize"}),r("design:paramtypes",[])],t)}();n.CapitalizePipe=s},{"@angular/core":193}],46:[function(t,e,n){"use strict";var i=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(3>o?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},r=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("@angular/core"),s=function(){function t(){}return t.prototype.transform=function(t){t=t||0,isNaN(t)&&(t=Math.round((Date.now()-+new Date(t))/6e4));var e=t/60,n="";return n=!t||15>t?"a minute ago":60>t?"within hour":e>24?parseInt((e/24).toString())+" days ago":parseInt(e.toString())+" hours ago"},t=i([o.Pipe({name:"Daysold"}),r("design:paramtypes",[])],t)}();n.DaysoldPipe=s},{"@angular/core":193}],47:[function(t,e,n){"use strict";var i=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(3>o?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},r=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("@angular/core"),s=t("../directives/helpers"),a=function(){function t(){}return t.prototype.transform=function(t,e){"true"===localStorage.getItem("isPhonegap");t=t||"";var n=e||[];return t&&n&&0!=n.length&&(~t.indexOf("cid:")||~t.indexOf("ollowing file"))?(n.sort(function(t,e){return e.name.length-t.name.length}),t=s.FileUrlHelper.addUrls(t,n)):t},t=i([o.Pipe({name:"Files"}),r("design:paramtypes",[])],t)}();n.FilesPipe=a},{"../directives/helpers":14,"@angular/core":193}],48:[function(t,e,n){"use strict";var i=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(3>o?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},r=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("@angular/core"),s=t("md5-hex"),a=function(){function t(){}return t.prototype.transform=function(t,e){var n="";return t?(n=s(t),"https://secure.gravatar.com/avatar/"+n+"?s=80&d=mm"):"img/def_ava.png"},t=i([o.Pipe({name:"Gravatar"}),r("design:paramtypes",[])],t)}();n.GravatarPipe=a},{"@angular/core":193,"md5-hex":473}],49:[function(t,e,n){"use strict";var i=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(3>o?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},r=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("@angular/core"),s=function(){function t(){}return t.prototype.transform=function(t,e){if(t=(t||"").trim(),t.length){var n=document.createElement("div"),i=/&(?:#x[a-f0-9]+|#[0-9]+|[a-z0-9]+);?/gi;t=t.replace(i,function(t){return n.innerHTML=t,n.textContent}),n.textContent=""}return t},t=i([o.Pipe({name:"Htmlsafe"}),r("design:paramtypes",[])],t)}();n.HtmlsafePipe=s},{"@angular/core":193}],50:[function(t,e,n){"use strict";var i=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(3>o?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},r=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("@angular/core"),s=t("../directives/helpers"),a=function(){function t(){}return t.prototype.transform=function(t,e){return s.linebreaks(t,e)},t=i([o.Pipe({name:"Linebreaks"}),r("design:paramtypes",[])],t)}();n.LinebreaksPipe=a},{"../directives/helpers":14,"@angular/core":193}],51:[function(t,e,n){"use strict";var i=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(3>o?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},r=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("@angular/core"),s=function(){function t(){}return t.prototype.transform=function(t,e){e=e||[100,"VV"],t=t||0;var n=e[0],i=e[1]||"VV";if(t>=n)t=n-1+"<sup>+</sup>";else{var r=t.toString();(~i.indexOf("$")||~r.indexOf("."))&&(t=t.toFixed(t>99&&~r.indexOf(".00")?0:2))}return~i.indexOf("$")&&(i=i.replace("$",localStorage.getItem("currency"))),t=i.replace("VV",t)},t=i([o.Pipe({name:"More"}),r("design:paramtypes",[])],t)}();n.MorePipe=s},{"@angular/core":193}],52:[function(t,e,n){"use strict";function i(t){for(var e in t)n.hasOwnProperty(e)||(n[e]=t[e])}i(t("./more")),i(t("./capitalize")),i(t("./linebreaks")),i(t("./htmlsafe")),i(t("./gravatar")),i(t("./daysold")),i(t("./files"))},{"./capitalize":45,"./daysold":46,"./files":47,"./gravatar":48,"./htmlsafe":49,"./linebreaks":50,"./more":51}],53:[function(t,e,n){"use strict";var i=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(3>o?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},r=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("@angular/core"),s=t("ionic-angular"),a=t("@angular/http"),c=t("rxjs/Observable"),u=t("./config"),l=t("../directives/helpers"),p=t("./mocks");t("rxjs/add/operator/map"),t("rxjs/add/operator/catch"),t("rxjs/add/observable/throw");var h=function(){function t(t,e,n){this.http=t,this.config=e,this.events=n}return t.prototype.request=function(t,e,n,i){var r=this;if(u.dontClearCache)return this.mock_get(t);var o=new a.Request({method:n||"GET",url:u.ApiSite+t,headers:i,body:JSON.stringify(e)});return this.http.request(o).map(function(t){return t.json()})["catch"](function(t){return r.handleError(t)})},t.prototype.mock_get=function(t){var e=null,n=t.indexOf("?");return-1!=n&&(t=t.substring(0,n)),e=p.MOCKS[t],c.Observable.create(function(t){t.next(e),t.complete()})},t.prototype.get=function(t,e,n){var i=this.config.getCurrent("key"),r=this.config.getCurrent("org"),o=this.config.getCurrent("instance");if(!i||!r||!o||32!=i.length)return this.handleError("403: Invalid organization!");var s=new a.Headers({Accept:"application/json","Content-Type":"application/json",Authorization:"Basic "+btoa(r+"-"+o+":"+i)});return this.request(t,e,n,s)},t.prototype.processData=function(t){return t},t.prototype.getPager=function(t,e){return e&&(e.limit&&(t=l.addp(t,"limit",e.limit)),e.page&&(t=l.addp(t,"page",e.page))),t},t.prototype.getPaged=function(t,e){return t=this.getPager(t,e),this.get(t)},t.prototype.handleError=function(t){var e="";try{var n=JSON.parse(t._body);e="string"==typeof n?n:((n||{}).ResponseStatus||{}).Message}catch(n){e=t._body,"[object ProgressEvent]"==e&&(e="Cannot connect to API server")}e=e||"Error. Please contact Administrator";var i=t.url||"",r=(t.status||{}).toString();return e+=" ("+r+") ",("403"==r&&!~i.indexOf("organizations")||~i.indexOf("config")||~e.indexOf("User with token"))&&this.events.publish("login:failed"),this.events.publish("connection:error",(e||"Error occured")+" Please contact Administator!"),c.Observable["throw"](new Error(e))},t=i([o.Injectable(),r("design:paramtypes",[a.Http,s.Config,s.Events])],t)}();n.ApiData=h},{"../directives/helpers":14,"./config":54,"./mocks":56,"@angular/core":193,"@angular/http":269,"ionic-angular":431,"rxjs/Observable":479,"rxjs/add/observable/throw":506,"rxjs/add/operator/catch":517,"rxjs/add/operator/map":542}],54:[function(t,e,n){"use strict";n.isPhonegap=!1,n.dontClearCache=!1,n.isSD=!0,n.Site=n.isSD?"sherpadesk.com/":"bigwebapps.com/",n.MobileSite="http://m."+n.Site,n.AppSite="https://app."+n.Site,n.ApiSite="http://api."+n.Site,n.year="2017",n.appVersion="24",n.AppTitle=n.isSD?"SherpaDesk ":"HelpDesk "},{}],55:[function(t,e,n){"use strict";var i=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(3>o?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},r=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("@angular/core"),s=t("@angular/http"),a=t("./api-data"),c=t("../directives/helpers");t("rxjs/add/operator/map"),t("rxjs/add/operator/share");var u=function(){function t(t){this.apiData=t,this.data$={},this._dataObserver={},this._dataStore={}}return t.prototype.checkLogin=function(t,e){if(!t||!e)return this.apiData.handleError("Please enter login and password!");var n="login",i=new s.Headers({"Content-Type":"text/plain;charset=UTF-8",Accept:"application/json, text/javascript, */*",Authorization:"Basic "+btoa(t+":"+e)});return this.apiData.request(n,"","POST",i)},t.prototype.getOrganizations=function(t){if(!t||32!=t.length)return this.apiData.handleError("Invalid token!");var e="organizations",n=new s.Headers({Accept:"application/json","Content-Type":"application/json",Authorization:"Basic "+btoa("x:"+t)});return this.apiData.request(e," ","",n)},t.prototype.registerOrganization=function(t){var e="organizations",n=new s.Headers({Accept:"application/json","Content-Type":"application/json"});return this.apiData.request(e,t,"POST",n)},t.prototype.deleteFile=function(t){var e="files/"+t.file_id;return this.apiData.get(e,t,"DELETE")},t.prototype.getConfig=function(){var t="config";return this.apiData.get(t)},t.prototype.getQueueList=function(t){var e=c.addp("queues","sort_by","tickets_count");return this.apiData.get(e).map(function(e){return e&&t&&(e=e.filter(function(t){return t.tickets_count>0}).slice(0,t)),e})},t.prototype.getInvoices=function(t,e,n){var i=c.addp("invoices","account",t);return e===!1&&(i=c.addp(i,"status","unbilled")),this.apiData.getPaged(i,n)},t.prototype.getInvoice=function(t,e,n){var i="invoices",r={};return t?(i+="/"+t,i=c.addp(i,"action","sendEmail")):(i=c.addp(i,"status","unbilled"),i=c.addp(i,"account",e),i=c.addp(i,"project",n)),this.apiData.get(i,r)},t.prototype.getExpenses=function(t,e){var n=c.addp("expenses","account",t);return this.apiData.getPaged(n,e)},t.prototype.getAccountList=function(t,e,n,i){var r="accounts";return n&&(r=c.addp(r,"is_with_statistics","false")),i&&(r=c.addp(r,"is_open_tickets","true")),this.apiData.getPaged(r,e).map(function(e){return t&&e&&(e=e.filter(function(t){return t.account_statistics.ticket_counts.open>0})),e})},t.prototype.getAccountDetails=function(t,e){var n="accounts/"+t;return e&&(n=c.addp(n,"is_with_statistics","false")),this.apiData.get(n)},t.prototype.addAccountNote=function(t,e){var n="accounts/"+t,i={note:e};return this.apiData.get(n,i,"PUT")},t.prototype.addUser=function(t,e,n,i){var r="users",o={Lastname:n,Firstname:e,email:t,role:i};return this.apiData.get(r,o,"POST")},t=i([o.Injectable(),r("design:paramtypes",[a.ApiData])],t)}();n.DataProvider=u},{"../directives/helpers":14,"./api-data":53,"@angular/core":193,"@angular/http":269,"rxjs/add/operator/map":542,"rxjs/add/operator/share":565}],56:[function(t,e,n){"use strict";n.MOCKS={"tickets/counts":{new_messages:1,open_all:284,open_as_tech:10,open_as_alttech:2,open_as_user:1001,onhold:3,reminder:0,parts_on_order:0,unconfirmed:45,waiting:2},todos:[{list_id:"d71f45cd260b4ae48761fa20e92af85d",id:null,name:"test2",text:"",title:"",order_list:1,order_item:-1,assigned_id:null,assigned_name:"",type:1,ticket_id:0,project_id:0,account_id:0,due_date:null,updated_at:null,is_completed:!1,estimated_remain:null,ticket_number:null,time_hours:null,time_is_billable:!0,time_task_type_id:null,time_task_type_name:"",time_payment_id:null,time_invoice_id:null,time_start_time:null,time_stop_time:null,sub:[{list_id:"d71f45cd260b4ae48761fa20e92af85d",id:"0b3d804f15cb4687afc3305aa0156f94",name:"test2",text:"test2-1-1",title:"test2-1",order_list:1,order_item:1,assigned_id:1325,assigned_name:"Tech/Admin Eugene",type:2,ticket_id:0,project_id:0,account_id:0,due_date:"2016-12-13T00:00:00.0000000",updated_at:"2016-12-08T15:53:27.3700000",is_completed:!1,estimated_remain:10,ticket_number:null,time_hours:null,time_is_billable:!0,time_task_type_id:null,time_task_type_name:"",time_payment_id:null,time_invoice_id:null,time_start_time:null,time_stop_time:null,sub:null},{list_id:"d71f45cd260b4ae48761fa20e92af85d",id:"6fbcdb59d8c740c89e5fdea55f98d757",name:"test2",text:"test2-2-2",title:"test2-2",order_list:1,order_item:2,assigned_id:1325,assigned_name:"Tech/Admin Eugene",type:2,ticket_id:0,project_id:0,account_id:0,due_date:"2016-12-07T00:00:00.0000000",updated_at:"2016-12-08T15:53:41.2130000",is_completed:!1,estimated_remain:11,ticket_number:null,time_hours:null,time_is_billable:!0,time_task_type_id:null,time_task_type_name:"",time_payment_id:null,time_invoice_id:null,time_start_time:null,time_stop_time:null,sub:null}]},{list_id:"2e6e6a93dc254993abc4b072059d1468",id:null,name:"My ToDo's",text:"",title:"",order_list:5,order_item:-1,assigned_id:null,assigned_name:"",type:1,ticket_id:0,project_id:0,account_id:0,due_date:null,updated_at:null,is_completed:!1,estimated_remain:null,ticket_number:null,time_hours:null,time_is_billable:!0,time_task_type_id:null,time_task_type_name:"",time_payment_id:null,time_invoice_id:null,time_start_time:null,time_stop_time:null,sub:[{list_id:"2e6e6a93dc254993abc4b072059d1468",id:"1863275673334b468fbd6f1eb2356ea3",name:"My ToDo's",text:"",title:"my-1",order_list:5,order_item:1,assigned_id:1325,assigned_name:"Tech/Admin Eugene",type:2,ticket_id:0,project_id:0,account_id:0,due_date:null,updated_at:"2016-12-08T15:53:59.2470000",is_completed:!1,estimated_remain:null,ticket_number:null,time_hours:null,time_is_billable:!0,time_task_type_id:null,time_task_type_name:"",time_payment_id:null,time_invoice_id:null,time_start_time:null,time_stop_time:null,sub:null}]}],login:{api_token:"re36rym3mjqxm8ej2cscfajmxpsew33m"},organizations:[{key:"u0diuk",name:"bigWebApps",is_expired:!1,is_trial:!1,instances:[{key:"b95s6o",name:"Support",is_expired:!1,is_trial:!1}]}],config:{stat:{},key:"2mzer2k5k0srgncebsizvfmip0isp2ii",org:"u0diuk",instance:"b95s6o",is_onhold_status:!1,is_time_tracking:!0,is_freshbooks:!1,freshbooks_url:"https://micajah3.freshbooks.com",is_parts_tracking:!1,is_project_tracking:!0,is_unassigned_queue:!0,is_location_tracking:!0,is_waiting_on_response:!0,is_invoice:!0,is_payments:!0,is_expenses:!0,is_class_tracking:!0,is_travel_costs:!0,is_priorities_general:!0,is_confirmation_tracking:!0,is_resolution_tracking:!0,is_ticket_levels:!0,is_account_manager:!0,is_require_ticket_initial_post:!0,is_ticket_require_closure_note:!0,is_asset_tracking:!0,assets:{unique1_caption:"",unique2_caption:"",unique3_caption:"",unique4_caption:"",unique5_caption:"",unique6_caption:"",unique7_caption:""},time_hour_increment:-1,time_minimum_time:-1,timezone_offset:-5,timezone_name:"Eastern Standard Time",currency:"$",businessday_length:540,logo:"/mafsf.axd?d=aW5zdGFuY2UtbG9nby9jOTMzMWE1OWNiNzY0YjQyYmM2M2JhZDRhNTAwZTE4My9zaGVycGFkZXNrXzMxMHg5NS5wbmd8MzAwfDQ1fDB8YzkzMzFhNTljYjc2NGI0MmJjNjNiYWQ0YTUwMGUxODNw0",user:{account_name:"bigWebApps Support",login_id:"51b348ac5ef34ecea7d043f0d2688634",user_id:1325,email:"jtrue@mail.ru",firstname:"Tech/Admin",lastname:"Eugene",is_techoradmin:!0,is_admin:!0,is_limit_assigned_tkts:!1,is_useworkdaystimer:!1,account_id:0,time_format:1,date_format:0}}}},{}],57:[function(t,e,n){"use strict";function i(t){for(var e in t)n.hasOwnProperty(e)||(n[e]=t[e])}i(t("./api-data")),i(t("./data-provider")),i(t("./ticket-provider")),i(t("./time-provider")),i(t("./todo-provider"))},{"./api-data":53,
"./data-provider":55,"./ticket-provider":58,"./time-provider":59,"./todo-provider":60}],58:[function(t,e,n){"use strict";var i=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(3>o?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},r=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("@angular/core"),s=t("ionic-angular"),a=t("./config"),c=t("rxjs/Observable"),u=t("./api-data");t("rxjs/add/operator/map"),t("rxjs/add/operator/share");var l=t("./mocks"),p=function(){function t(t,e,n){this.apiData=t,this.config=e,this.events=n,this.URL="tickets",this.tickets$={},this._ticketsObserver={},this._dataStore={all:[],alt:[],tech:[],user:[]}}return t.prototype.getTicketsList=function(t,e,n){var i=this,r="";switch(t.toString()){case"tech":r=this.URL+"?status=open&role=tech";break;case"all":r=this.URL+"?status=allopen&query=all";break;case"alt":r=this.URL+"?status=open&role=alt_tech";break;case"open":r=this.URL+"?status=open&account="+e;break;case"closed":r=this.URL+"?status=closed&account="+e;break;case"queue":r="queues/"+e;break;default:r=this.URL+"?status=open,onhold&role=user"}n.limit=n.limit||25,n.page=n.page||0,t+=e||"",this._dataStore[t]=this._dataStore[t]||[],a.dontClearCache&&(this.tickets$[t]=new c.Observable(function(e){return i._ticketsObserver[t]=e}).share(),this._dataStore[t]=l.MOCKS.tickets);var o=this._dataStore[t].length;return 0==n.page&&(n.limit=o||n.limit,o?setTimeout(function(){i._ticketsObserver[t]&&i._ticketsObserver[t].next(i._dataStore[t]||[])},0):this.tickets$[t]=new c.Observable(function(e){return i._ticketsObserver[t]=e}).share()),this.apiData.getPaged(r,n).subscribe(function(e){n.page>0&&o>0?(r=i._dataStore[t]).push.apply(r,e):i._dataStore[t]=e,i._ticketsObserver[t]&&i._ticketsObserver[t].next(i._dataStore[t]);var r},function(t){return i.apiData.handleError("Could not load tickets.")}),o},t.prototype.getTicketDetails=function(t){var e=this.URL+"/"+t;return this.apiData.get(e)},t.prototype.getTicketsCounts=function(){var t=this,e=this.URL+"/counts";this._dataStore[e]?this._dataStore[e].open_all>=0&&setTimeout(function(){t._ticketsObserver[e].next(t._dataStore[e]||[])},0):(this._dataStore[e]=[],this.tickets$[e]=new c.Observable(function(n){t._ticketsObserver[e]=n}).share()),this.apiData.get(e).subscribe(function(n){t._dataStore[e]=n,t._ticketsObserver[e].next(t._dataStore[e])},function(t){return console.log("Could not load tickets.")})},t.prototype.addTicket=function(t){return t.status="open",this.apiData.get(this.URL,t,"POST")},t.prototype.closeOpenTicket=function(t,e){var n=this.URL+"/"+t;return this.apiData.get(n,e,"PUT")},t.prototype.addTicketPost=function(t,e,n){var i=this.URL+"/"+t,r={action:"response",note_text:e,files:n||[]};return this.apiData.get(i,r,"POST")},t.prototype.addTicketNote=function(t,e){var n=this.URL+"/"+t,i={action:"note",workpad:e};return this.apiData.get(n,i,"POST")},t=i([o.Injectable(),r("design:paramtypes",[u.ApiData,s.Config,s.Events])],t)}();n.TicketProvider=p},{"./api-data":53,"./config":54,"./mocks":56,"@angular/core":193,"ionic-angular":431,"rxjs/Observable":479,"rxjs/add/operator/map":542,"rxjs/add/operator/share":565}],59:[function(t,e,n){"use strict";var i=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(3>o?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},r=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("@angular/core"),s=t("ionic-angular"),a=t("./config"),c=t("rxjs/Observable"),u=t("./api-data"),l=t("../directives/helpers");t("rxjs/add/operator/map"),t("rxjs/add/operator/share");var p=t("./mocks"),h=function(){function t(t,e,n){this.apiData=t,this.config=e,this.events=n,this.URL="time",this.times$={},this._timesObserver={},this._dataStore={}}return t.prototype.getTimelogs=function(t,e){var n=this,i=l.addp(this.URL,"account",t);e.limit=e.limit||25,e.page=e.page||0,this._dataStore[i]=this._dataStore[i]||[],a.dontClearCache&&(this.times$[i]=new c.Observable(function(t){return n._timesObserver[i]=t}).share(),this._dataStore[i]=p.MOCKS.time);var r=this._dataStore[i].length;return 0==e.page&&(e.limit=r||e.limit,r?setTimeout(function(){n._timesObserver[i]&&n._timesObserver[i].next(n._dataStore[i]||[])},0):this.times$[i]=new c.Observable(function(t){return n._timesObserver[i]=t}).share()),this.apiData.getPaged(i,e).subscribe(function(t){e.page>0&&r>0?(o=n._dataStore[i]).push.apply(o,t):n._dataStore[i]=t,n._timesObserver[i]&&n._timesObserver[i].next(n._dataStore[i]);var o},function(t){return console.log("Could not load timelogs.")}),r},t.prototype.addTime=function(t,e,n){var i=this.URL+(t?"/"+t:"");return this.apiData.get(i,e,n)},t=i([o.Injectable(),r("design:paramtypes",[u.ApiData,s.Config,s.Events])],t)}();n.TimeProvider=h},{"../directives/helpers":14,"./api-data":53,"./config":54,"./mocks":56,"@angular/core":193,"ionic-angular":431,"rxjs/Observable":479,"rxjs/add/operator/map":542,"rxjs/add/operator/share":565}],60:[function(t,e,n){"use strict";var i=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(3>o?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},r=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},o=t("@angular/core"),s=t("ionic-angular"),a=t("./config"),c=t("rxjs/Observable"),u=t("./api-data"),l=t("../directives/helpers");t("rxjs/add/operator/map"),t("rxjs/add/operator/share"),t("rxjs/add/operator/publishLast");var p=t("./mocks"),h=function(){function t(t,e,n){this.apiData=t,this.config=e,this.events=n,this.URL="todos",this.todos$={},this._todosObserver={},this._dataStore={}}return t.prototype.getTodos=function(t,e){var n=this,i=l.addp(this.URL,"assigned_id",t);e.limit=e.limit||25,e.page=e.page||0,this._dataStore[i]=this._dataStore[i]||[],a.dontClearCache&&(this.todos$[i]=new c.Observable(function(t){return n._todosObserver[i]=t}).share(),this._dataStore[i]=p.MOCKS.todo);var r=this._dataStore[i].length;return 0==e.page&&(r?setTimeout(function(){n._todosObserver[i]&&n._todosObserver[i].next(n._dataStore[i]||[])},0):this.todos$[i]=new c.Observable(function(t){return n._todosObserver[i]=t}).share()),this.apiData.getPaged(i+"&all_item_types=true&is_completed=false&is_sub_view=true",e).subscribe(function(t){e.page>0&&r>0?(o=n._dataStore[i]).push.apply(o,t):n._dataStore[i]=t,n._todosObserver[i]&&n._todosObserver[i].next(n._dataStore[i]);var o},function(t){return console.log("Could not load todologs.")}),r},t.prototype.addTodo=function(t){return this.apiData.get(this.URL,t,"POST")},t.prototype.setCompletedTodo=function(t,e){var n=this.URL+"/"+t,i=this.apiData.get(n,{is_completed:e},"PUT").publishLast();return i.connect(),i},t=i([o.Injectable(),r("design:paramtypes",[u.ApiData,s.Config,s.Events])],t)}();n.TodoProvider=h},{"../directives/helpers":14,"./api-data":53,"./config":54,"./mocks":56,"@angular/core":193,"ionic-angular":431,"rxjs/Observable":479,"rxjs/add/operator/map":542,"rxjs/add/operator/publishLast":555,"rxjs/add/operator/share":565}]};

var interval = setInterval(function(){
if (window.test2){
	clearInterval(interval);

e(Object.assign({}, test2, test1),{},[1,750]);
test1 = null;
test2 = null;
}
}, 200);