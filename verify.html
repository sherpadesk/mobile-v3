<style>
    body .container-fluid .row-fluid .website-content .wrapper {
        padding: 80px 20px 20px 15px !important;
    }

    #motto10 {
  display: none;
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  bottom: 180px;
  z-index: 1;
  min-height: 60px;
  }

#lock-modal10 {
  display: none;
  background-color: black;
  opacity: 0.6;
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  border-radius: inherit;
}

#loading-circle10 {
  display: none;
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
  margin: auto;
  width: 40px;
  height: 40px;
  border: 4px solid #f3f3f3;
  border-top: 4px solid #3498db;
  border-radius: 50%;
  animation: spin 0.6s ease-in infinite;
}

@keyframes spin {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
}
    
</style>

<script>
    function getParameterByName(name) {
        var match = RegExp('[?&]' + name + '=([^&]*)').exec(window.location.search);
        return match && decodeURIComponent(match[1].replace(/\+/g, ' '));
    }
    var beta = getParameterByName('beta') || "";
    var ismob = navigator.userAgent.match(/(iPhone|iPod|iPad|Android|BlackBerry|IEMobile)/);
    
    var request_token = getParameterByName("r");
    request_token = decodeURIComponent(request_token || localStorage.request_token || '');

    var resend = getParameterByName("resend");
    resend = decodeURIComponent(resend || localStorage.resend || '');

    var user_email = getParameterByName("e");

    var api_url = beta ? "https://api.beta.sherpadesk.com" : "https://api.sherpadesk.com";

    $(function() {

            //if (window.self !== window.top)
            //window.top.location = window.self.location;

            if (request_token) {
                var xhr = new XMLHttpRequest();
                xhr.open('GET', api_url + "/organization_validated?r="+request_token, true);
                xhr.onload = function(e) { 
                    if (e.target.status == 200 || e.target.status == 201)
                    {
                        var data = JSON.parse(e.target.response);
                            console.log(data);
                            res = encodeURIComponent(data.url);
                            localStorage.request_token = "";
                            localStorage.resend = "";
                            localStorage.redirect = res;
                            window.location = "https://www.sherpadesk.com/thank-you-redirect?redirect="+res+(beta ? "&beta=1" : ""); 
                    }
                    else
                    {
                    console.log(e);
                    alert("Verification Token is INCORRECT. Please click Resend button and check your mailbox for further instructions!")
                    }
            }
            xhr.send();
        }

        function ResendVerification()
        {
            var xhr = new XMLHttpRequest();
                xhr.open('GET', api_url + "/resend_verification?r="+resend+"&token="+request_token, true);
                xhr.onload = function(e) { 
                    if (e.target.status == 200)
                    {
                        alert("Verification Email sent successfuly. Please check your mailbox.")
                    }
                    else
                    {
                    console.log(e);
                    alert("Verification Token is INCORRECT. Please check your mailbox for further instructions!")
                    }
            }
            xhr.send();
        }

        if (user_email)
            $("span#user_email").text(user_email);

    var ResendVerificationLink = $("a[href='https://api.sherpadesk.com/resend_verification']");
    ResendVerificationLink.removeAttr("href");
    ResendVerificationLink.on("click", ResendVerification);
});

</script>